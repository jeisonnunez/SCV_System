using HashCode;
using System;
using System.Collections.Generic;
using System.Data.SqlClient;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Datos
{
    public class ConexionSQLServer
    {
        protected HashCodes hc = new HashCodes();

        protected static string connectionString = "Server=" + ServerName + "; Database=master; User Id=sa; Password=SAPB1Admin1; integrated security=false";

        protected SqlConnection Connection;

        protected SqlDataAdapter data;

        protected SqlTransaction transaction;       

        private static string userID= "sa";

        private static string serverName;

        private static string password= "SAPB1Admin1";

        private static string empresaActual;

        private static string script = "CREATE DATABASE SCV_SAPB1\r\n\r\nGO\r\n\r\nUSE SCV_SAPB1\r\n\r\n\r\nGO\r\n\r\nCREATE TABLE[dbo].[@IDA_COMP_ISLR] (\r\n\t[Code][nvarchar] (50) NOT NULL primary key,\r\n\t[Name][nvarchar] (100) NOT NULL,\r\n\t[U_IDA_NroComp][nvarchar] (100) NULL,\r\n\t[U_IDA_TipoDoc][nvarchar] (30) NULL,\r\n\t[U_IDA_NroControl][nvarchar] (100) NULL,\r\n\t[U_IDA_Agente][nvarchar] (100) NULL,\r\n\t[U_IDA_TaxIdNo][nvarchar] (100) NULL,\r\n\t[U_IDA_CompanyAddress][nvarchar] (254) NULL,\r\n\t[U_IDA_CardName][nvarchar] (100) NULL,\r\n\t[U_IDA_LicTradNum][nvarchar] (100) NULL,\r\n\t[U_IDA_Address][nvarchar] (254) NULL,\r\n\t[U_IDA_Phone1][nvarchar] (100) NULL,\r\n\t[U_IDA_CardCode][nvarchar] (100) NULL,\r\n\t[U_IDA_Ano][nvarchar] (30) NULL,\r\n\t[U_IDA_Mes][nvarchar] (30) NULL,\r\n\t[U_IDA_CodeRetencion][nvarchar] (30) NULL,\r\n\t[U_IDA_ConceptoRet][nvarchar] (250) NULL,\r\n\t[U_IDA_NroFactura][nvarchar] (100) NULL,\r\n\t[U_IDA_NroND][nvarchar] (100) NULL,\r\n\t[U_IDA_NroNC][nvarchar] (100) NULL,\r\n\t[U_IDA_FechaContFact][datetime] NULL,\r\n\t[U_IDA_FechaDoc][datetime] NULL,\r\n\t[U_IDA_FechaComp][datetime] NULL,\r\n\t[U_IDA_BaseRetencion][numeric] (19, 6) NULL,\r\n\t[U_IDA_PrctRetencion][numeric] (19, 6) NULL,\r\n\t[U_IDA_Sustraendo][numeric] (19, 6) NULL,\r\n\t[U_IDA_ValorRetencion][numeric] (19, 6) NULL,\r\n\t[U_IDA_DocTotal][numeric] (19, 6) NULL,\r\n\t[U_IDA_TipoTrans][nvarchar] (100) NULL,\r\n\t[U_IDA_Periodo][nvarchar] (100) NULL,\r\n\t[U_IDA_OfflCode][nvarchar] (30) NULL,\r\n\t[U_IDA_Exento][numeric] (19, 6) NULL,\r\n\t[U_IDA_DocEntry][int] NULL,\r\n\t[U_IDA_ObjType][nvarchar] (30) NULL,\r\n\t[U_IDA_DocSubType][nvarchar] (30) NULL,\r\n\t[U_IDA_Status][nvarchar] (30) NULL,\r\n\t\r\n \r\n)\r\nGO\r\n/****** Object:  Table [dbo].[@IDA_COMPROBANTES]    Script Date: 27/2/2020 10:16:02 a. m. ******/\r\n\r\nCREATE TABLE[dbo].[@IDA_COMPROBANTES] (\r\n\t[Code][nvarchar] (50) NOT NULL primary key,\r\n\t[Name][nvarchar] (100) NOT NULL,\r\n\t[U_IDA_NroControl][nvarchar] (100) NULL,\r\n\t[U_IDA_FechaFact][datetime] NULL,\r\n\t[U_IDA_ObjType][nvarchar] (10) NULL,\r\n\t[U_IDA_DocEntry][int] NULL,\r\n\t[U_IDA_Alicuota][nvarchar] (10) NULL,\r\n\t[U_IDA_IVA][numeric] (19, 6) NULL,\r\n\t[U_IDA_BaseImp][numeric] (19, 6) NULL,\r\n\t[U_IDA_Retencion][numeric] (19, 6) NULL,\r\n\t[U_IDA_Total][numeric] (19, 6) NULL,\r\n\t[U_IDA_Exento][numeric] (19, 6) NULL,\r\n\t[U_IDA_Fafe][nvarchar] (100) NULL,\r\n\t[U_IDA_Factura][nvarchar] (100) NULL,\r\n\t[U_IDA_Credito][nvarchar] (100) NULL,\r\n\t[U_IDA_Debito][nvarchar] (100) NULL,\r\n\t[U_IDA_TipoTran] [nvarchar](100) NULL,\r\n\t[U_IDA_CardCode] [nvarchar](100) NULL,\r\n\t[U_IDA_CardName] [nvarchar](100) NULL,\r\n\t[U_IDA_Agente] [nvarchar](100) NULL,\r\n\t[U_IDA_NroComp] [nvarchar](100) NULL,\r\n\t[U_IDA_LicTradNum] [nvarchar](100) NULL,\r\n\t[U_IDA_TaxIdNo] [nvarchar](100) NULL,\r\n\t[U_IDA_FechaComp] [datetime] NULL,\r\n\t[U_IDA_Row] [int] NULL,\r\n\t[U_IDA_Status] [nvarchar](10) NULL,\r\n\t[U_IDA_PrcntRet] [numeric](19, 6) NULL,\r\n\t[U_IDA_CompanyAddress] [nvarchar](254) NULL,\r\n\t[U_IDA_Address] [nvarchar](254) NULL,\r\n\t[U_IDA_DocSubType] [nvarchar](10) NULL,\r\n\t[U_IDA_Periodo] [nvarchar](10) NULL,\r\n\t[U_IDA_Quincena] [nvarchar](10) NULL,\r\n\t\r\n )\r\nGO\r\nCREATE TABLE [dbo].[LICENSE_CONF](\r\n\t[Code] [nvarchar](50) NOT NULL primary key,\r\n\t[Name] [nvarchar](100) NULL,\r\n\t[DocEntry] [int] NOT NULL,\r\n\t[Canceled] [char](1) NULL,\r\n\t[Object] [nvarchar](20) NULL,\r\n\t[LogInst] [int] NULL,\r\n\t[UserSign] [int] NULL,\r\n\t[Transfered] [char](1) NULL,\r\n\t[CreateDate] [datetime] NULL,\r\n\t[CreateTime] [smallint] NULL,\r\n\t[UpdateDate] [datetime] NULL,\r\n\t[UpdateTime] [smallint] NULL,\r\n\t[DataSource] [char](1) NULL,\r\n\t[U_IDA_FileConf] [ntext] NULL,\r\n\t[U_IDA_Servidor] [nvarchar](50) NULL,\r\n\t[U_IDA_SystemNumber] [nvarchar](50) NULL,\r\n\t[U_IDA_InstNumber] [nvarchar](50) NULL,\r\n\t[U_IDA_FechaInicio] [datetime] NULL,\r\n\t[U_IDA_Vencimiento] [datetime] NULL,\r\n\t[U_IDA_HardwareKey] [nvarchar](50) NULL,\r\n\t[U_IDA_Lic] [ntext] NULL,\r\n\t\r\n)\r\nGO\r\n\r\nCREATE TABLE [dbo].[NRO_COMPROBANTE](\r\n\t[Code] [nvarchar](50) NOT NULL primary key,\t\r\n\t[DocEntry] [int] NULL,\r\n\t[Canceled] [char](1) NULL,\t\r\n\t[UserSign] [int] NULL,\t\r\n\t[CreateDate] [datetime] NULL,\t\r\n\t[UpdateDate] [datetime] NULL,\t\r\n\t[NombreSerie] [nvarchar](50) NULL,\r\n\t[Descripcion] [nvarchar](100) NULL,\r\n\t[TipoSerie] [nvarchar](10) NULL,\r\n\t[Inicio] [nvarchar](15) NULL,\r\n\t[Siguiente] [nvarchar](15) NULL,\r\n\t[Fin] [nvarchar](15) NULL,\r\n\t[Activo] [nvarchar](10) NULL,\r\n\t\r\n )\r\n GO\r\n CREATE TABLE [dbo].[ODCM](\r\n\t[LinkAct_1] [nvarchar](15) NULL,\r\n\t[LinkAct_2] [nvarchar](15) NULL,\r\n\t[LinkAct_3] [nvarchar](15) NULL,\r\n\t[LinkAct_4] [nvarchar](15) NULL,\r\n\t[LinkAct_5] [nvarchar](15) NULL,\r\n\t[LinkAct_6] [nvarchar](15) NULL,\r\n\t[LinkAct_7] [nvarchar](15) NULL,\r\n\t\r\n )\r\n\r\nGO\r\nCREATE TABLE [dbo].[OUSR](\r\n\t[USERID] [smallint] NOT NULL IDENTITY (1,1) PRIMARY KEY,\r\n\t[PASSWORD] [nvarchar](254) NULL,\t\r\n\t[USER_CODE] [nvarchar](25) NOT NULL,\r\n\t[U_NAME] [nvarchar](155) NULL,\t\r\n\t[Locked] [char](1) NULL,\r\n\t[Deleted] [char](1) NULL\r\n )\r\n\r\n GO\r\n/****** Object:  Table [dbo].[OUOM]    Script Date: 23/8/2020 2:32:51 p. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE TABLE [dbo].[OUOM](\r\n\t[UomEntry] [int] NOT NULL IDENTITY(1,1),\r\n\t[UomCode] [nvarchar](20) NOT NULL,\r\n\t[UomName] [nvarchar](100) NULL,\r\n\t[Locked] [char](1) NULL,\r\n\t[DataSource] [char](1) NULL,\r\n\t[UserSign] [smallint] NULL,\r\n\t[LogInstanc] [smallint] NULL,\r\n\t[UserSign2] [smallint] NULL,\r\n\t[UpdateDate] [datetime] NULL,\r\n\t[CreateDate] [datetime] NULL,\r\n\t[Length1] [numeric](19, 6) NULL,\r\n\t[Len1Unit] [smallint] NULL,\r\n\t[length2] [numeric](19, 6) NULL,\r\n\t[Len2Unit] [smallint] NULL,\r\n\t[Width1] [numeric](19, 6) NULL,\r\n\t[Wdth1Unit] [smallint] NULL,\r\n\t[Width2] [numeric](19, 6) NULL,\r\n\t[Wdth2Unit] [smallint] NULL,\r\n\t[Height1] [numeric](19, 6) NULL,\r\n\t[Hght1Unit] [smallint] NULL,\r\n\t[Height2] [numeric](19, 6) NULL,\r\n\t[Hght2Unit] [smallint] NULL,\r\n\t[Volume] [numeric](19, 6) NULL,\r\n\t[VolUnit] [smallint] NULL,\r\n\t[Weight1] [numeric](19, 6) NULL,\r\n\t[WghtUnit] [smallint] NULL,\r\n\t[Weight2] [numeric](19, 6) NULL,\r\n\t[Wght2Unit] [smallint] NULL,\r\n\t[IntSymbol] [nvarchar](20) NULL,\r\n\t[EwbUnit] [int] NULL,\r\n\tconstraint pk_OUOM primary key (UomEntry),\r\n)\r\n\r\n\r\nGO\r\nCREATE TABLE [dbo].[OITM](\r\n\t[ItemCode] [nvarchar](50) NOT NULL PRIMARY KEY,\r\n\t[ItemName] [nvarchar](100) NULL,\t\r\n\t[VATLiable] [char](1) NULL,\r\n\t[PrchseItem] [char](1) NULL,\r\n\t[SellItem] [char](1) NULL,\r\n\t[InvntItem] [char](1) NULL,\r\n\t[OnHand] [numeric](19, 6) NULL,\r\n\t[IsCommited] [numeric](19, 6) NULL,\r\n\t[OnOrder] [numeric](19, 6) NULL,\t\r\n\t[Canceled] [char](1) NULL,\t\r\n\t[UserSign] [smallint] NULL,\t\r\n\t[CreateDate] [datetime] NULL,\r\n\t[UpdateDate] [datetime] NULL,\t\r\n\t[Deleted] [char](1) NULL,\r\n\t[DocEntry] [int] NULL,\r\n\t[StockValue] [numeric](19, 6) NULL,\t\r\n\t[StockValueSC] [numeric](19, 6) NULL,\t\r\n\t[StockValueFC] [numeric](19, 6) NULL,\t\r\n\t[UserSign2] [smallint] NULL,\t\r\n\t[BalInvntAc] [nvarchar](15),\r\n\t[SaleCostAc] [nvarchar](15),\r\n\t[RevenuesAc] [nvarchar](15),\r\n\t[ExpensesAc] [nvarchar](15),\r\n\t[TransferAc] [nvarchar](15),\r\n\t[EvalSystem] [char](1),\r\n\t[UgpEntry] [int],\r\n\t[InvntryUomEntry][int],\r\n\t[InvntryUomCode][nvarchar](20),\r\n\t[InvntryUomName][nvarchar](100),\r\n\t[NumInCnt] [numeric](19,6),\r\n\tCONSTRAINT fk_UserSign FOREIGN KEY ([UserSign]) REFERENCES [dbo].[OUSR] ([USERID])\r\n )\r\nGO\r\nCREATE TABLE [dbo].[ITM1](\r\n\t[ItemCode] [nvarchar](50) NOT NULL  primary key,\t\r\n\t[Price] [numeric](19, 6) NULL,\r\n\t[Currency] [nvarchar](3) NULL,\r\n\t[Ovrwritten] [char](1) NULL,\r\n\t[Factor] [numeric](19, 6) NULL,\r\n\t[LogInstanc] [int] NULL,\r\n\t[ObjType] [nvarchar](20) NULL,\r\n\t[AddPrice1] [numeric](19, 6) NULL,\r\n\t[Currency1] [nvarchar](3) NULL,\r\n\t[AddPrice2] [numeric](19, 6) NULL,\r\n\t[Currency2] [nvarchar](3) NULL,\r\n\t[Ovrwrite1] [char](1) NULL,\r\n\t[Ovrwrite2] [char](1) NULL,\r\n\t[BasePLNum] [smallint] NULL,\r\n\t[UomEntry] [int] NULL,\r\n\t[PriceType] [char](1) NULL,\r\n\tCONSTRAINT fk_ItemCode FOREIGN KEY ([ItemCode]) REFERENCES [dbo].[OITM] ([ItemCode])\r\n)\r\n\r\nGO\r\nCREATE TABLE [dbo].[OACT](\r\n\t[AcctCode] [nvarchar](15) NOT NULL PRIMARY KEY,\r\n\t[AcctName] [nvarchar](100) NULL,\r\n\t[CurrTotal] [numeric](19, 6) NULL,\t\r\n\t[Finanse] [char](1) NULL,\r\n\t[Postable] [char](1) NULL,\t\r\n\t[Levels] [smallint] NULL,\t\r\n\t[GrpLine] [int] NULL,\r\n\t[FatherNum] [nvarchar](15) NULL,\t\r\n\t[ActType] [char](1) NULL,\t\r\n\t[ActCurr] [nvarchar](3) NULL,\t\r\n\t[SysTotal] [numeric](19, 6) NULL,\r\n\t[FcTotal] [numeric](19, 6) NULL,\t\r\n\t[Advance] [char](1) NULL,\r\n\t[CreateDate] [datetime] NULL,\r\n\t[UpdateDate] [datetime] NULL,\t\r\n\t[UserSign] [smallint] NULL,\r\n\t[LocManTran] [char](1) NULL,\t\r\n\t[UserSign2] [smallint] NULL,\r\n\t[GroupMask] [smallint] NULL,\r\n\tCONSTRAINT fk_UserSignOACT FOREIGN KEY ([UserSign]) REFERENCES [dbo].[OUSR] ([USERID])\r\n )\r\n\r\nGO\r\nCREATE TABLE [dbo].[OJDT](\r\n\t\r\n\t[TransId] [int] NOT NULL IDENTITY(1,1) PRIMARY KEY,\t\r\n\t[TransType] [nvarchar](20) NULL,\t\r\n\t[RefDate] [datetime] NULL,\r\n\t[Memo] [nvarchar](50) NULL,\t\r\n\t[LocTotal] [numeric](19, 6) NULL,\r\n\t[FcTotal] [numeric](19, 6) NULL,\r\n\t[SysTotal] [numeric](19, 6) NULL,\t\r\n\t[DueDate] [datetime] NULL,\r\n\t[TaxDate] [datetime] NULL,\t\r\n\t[FinncPriod] [int] NULL,\t\r\n\t[UpdateDate] [datetime] NULL,\r\n\t[CreateDate] [datetime] NULL,\r\n\t[UserSign] [smallint] NULL,\r\n\t[UserSign2] [smallint] NULL,\t\r\n\t[TransCurr] [nvarchar](3) NULL,\t\r\n\t[BaseRef] [int] NULL,\r\n\t[Ref1] [nvarchar](100) null,\r\n\t[Ref2] [nvarchar](100) null,\r\n\tCONSTRAINT fk_UserSignOJDT FOREIGN KEY ([UserSign]) REFERENCES [dbo].[OUSR] ([USERID])\r\n \r\n)\r\n\r\nGO\r\nCREATE TABLE [dbo].[JDT1](\r\n\t[TransId] [int] NOT NULL ,\r\n\t[Line_ID] [int] NOT NULL ,\r\n\t[Account] [nvarchar](15) NULL,\r\n\t[Debit] [numeric](19, 6) NULL,\r\n\t[Credit] [numeric](19, 6) NULL,\r\n\t[SYSCred] [numeric](19, 6) NULL,\r\n\t[SYSDeb] [numeric](19, 6) NULL,\r\n\t[FCDebit] [numeric](19, 6) NULL,\r\n\t[FCCredit] [numeric](19, 6) NULL,\r\n\t[FCCurrency] [nvarchar](3) NULL,\r\n\t[DueDate] [datetime] NULL,\t\r\n\t[ShortName] [nvarchar](15) NULL,\t\r\n\t[ContraAct] [nvarchar](15) NULL,\r\n\t[LineMemo] [nvarchar](50) NULL,\t\r\n\t[TransType] [nvarchar](20) NULL,\r\n\t[RefDate] [datetime] NULL,\t\r\n\t[TaxDate] [datetime] NULL,\t\r\n\t[UserSign] [smallint] NULL,\t\r\n\t[FinncPriod] [int] NULL,\r\n\t[BalDueDeb] [numeric](19, 6) NULL,\r\n\t[BalDueCred] [numeric](19, 6) NULL,\r\n\t[BalFcDeb] [numeric](19, 6) NULL,\r\n\t[BalFcCred] [numeric](19, 6) NULL,\r\n\t[BalScDeb] [numeric](19, 6) NULL,\r\n\t[BalScCred] [numeric](19, 6) NULL,\r\n\t[DataSource] [char](1) null,\r\n\t[WTSum] [numeric](19, 6) NULL,\r\n\t[WTSumFC] [numeric](19, 6) NULL,\r\n\t[WTSumSC] [numeric](19, 6) null,\r\n\tconstraint pk_JDT1 primary key (TransId, Line_ID),\r\n\tCONSTRAINT fk_TransId FOREIGN KEY ([TransId]) REFERENCES [dbo].[OJDT] ([TransId]),\r\n\tCONSTRAINT fk_UserSignJDT1 FOREIGN KEY ([UserSign]) REFERENCES [dbo].[OUSR] ([USERID]),\r\n\tCONSTRAINT fk_AcctCode FOREIGN KEY ([Account]) REFERENCES [dbo].[OACT] ([AcctCode])\r\n )\r\nGO\r\n\r\nCREATE TABLE [dbo].[OJDT_PRUEBA](\r\n\t\r\n\t[TransId] [int] NOT NULL,\r\n\t[TransType] [nvarchar](20) NULL,\t\r\n\t[RefDate] [datetime] NULL,\r\n\t[Memo] [nvarchar](50) NULL,\t\r\n\t[LocTotal] [numeric](19, 6) NULL,\r\n\t[FcTotal] [numeric](19, 6) NULL,\r\n\t[SysTotal] [numeric](19, 6) NULL,\t\r\n\t[DueDate] [datetime] NULL,\r\n\t[TaxDate] [datetime] NULL,\t\r\n\t[FinncPriod] [int] NULL,\t\r\n\t[UpdateDate] [datetime] NULL,\r\n\t[CreateDate] [datetime] NULL,\r\n\t[UserSign] [smallint] NULL,\r\n\t[UserSign2] [smallint] NULL,\t\r\n\t[TransCurr] [nvarchar](3) NULL,\t\r\n\t[BaseRef] [int] NULL,\r\n\t[Ref1] [nvarchar](100) null,\r\n\t[Ref2] [nvarchar](100) null,\r\n \r\n)\r\n\r\nGO\r\nCREATE TABLE [dbo].[JDT1_PRUEBA](\r\n\t[TransId] [int] NOT NULL ,\r\n\t[Line_ID] [int] NOT NULL ,\r\n\t[Account] [nvarchar](15) NULL,\r\n\t[Debit] [numeric](19, 6) NULL,\r\n\t[Credit] [numeric](19, 6) NULL,\r\n\t[SYSCred] [numeric](19, 6) NULL,\r\n\t[SYSDeb] [numeric](19, 6) NULL,\r\n\t[FCDebit] [numeric](19, 6) NULL,\r\n\t[FCCredit] [numeric](19, 6) NULL,\r\n\t[FCCurrency] [nvarchar](3) NULL,\r\n\t[DueDate] [datetime] NULL,\t\r\n\t[ShortName] [nvarchar](15) NULL,\t\r\n\t[ContraAct] [nvarchar](15) NULL,\r\n\t[LineMemo] [nvarchar](50) NULL,\t\r\n\t[TransType] [nvarchar](20) NULL,\r\n\t[RefDate] [datetime] NULL,\t\r\n\t[TaxDate] [datetime] NULL,\t\r\n\t[UserSign] [smallint] NULL,\t\r\n\t[FinncPriod] [int] NULL,\r\n\t[BalDueDeb] [numeric](19, 6) NULL,\r\n\t[BalDueCred] [numeric](19, 6) NULL,\r\n\t[BalFcDeb] [numeric](19, 6) NULL,\r\n\t[BalFcCred] [numeric](19, 6) NULL,\r\n\t[BalScDeb] [numeric](19, 6) NULL,\r\n\t[BalScCred] [numeric](19, 6) NULL,\r\n\t[DataSource] [char](1) null,\r\n\t[WTSum] [numeric](19, 6) NULL,\r\n\t[WTSumFC] [numeric](19, 6) NULL,\r\n\t[WTSumSC] [numeric](19, 6) null,\t\r\n )\r\nGO\r\n/****** Object:  Table [dbo].[OACP]    Script Date: 27/2/2020 10:16:02 a. m. ******/\r\n\r\nCREATE TABLE [dbo].[OACP](\r\n\t[AbsEntry] [int] NOT NULL IDENTITY(1,1) PRIMARY KEY,\r\n\t[PeriodCat] [nvarchar](10) NOT NULL,\r\n\t[FinancYear] [datetime] NULL,\r\n\t[Year] [smallint] NULL,\r\n\t[PeriodName] [nvarchar](20) NULL,\r\n\t[SubType] [char](1) NULL,\r\n\t[PeriodNum] [int] NULL,\r\n\t[F_RefDate] [datetime] NULL,\r\n\t[T_RefDate] [datetime] NULL,\r\n\t[F_DueDate] [datetime] NULL,\r\n\t[T_DueDate] [datetime] NULL,\r\n\t[F_TaxDate] [datetime] NULL,\r\n\t[T_TaxDate] [datetime] NULL,\t\r\n\t[UpdateDate] [datetime] NULL,\r\n\t[UserSign] [smallint] NULL,\r\n\t\r\n\t)\r\n/****** Object:  Table [dbo].[OACT]    Script Date: 27/2/2020 10:16:02 a. m. ******/\r\n\r\n\r\nGO\r\nCREATE TABLE [dbo].[OADM](\r\n\t[CompnyName] [nvarchar](100) NOT NULL PRIMARY KEY,\r\n\t[CompnyAddr] [nvarchar](254) NULL,\r\n\t[Country] [nvarchar](3) NULL,\r\n\t[PrintHeadr] [nvarchar](100) NULL,\r\n\t[Phone1] [nvarchar](20) NULL,\r\n\t[Phone2] [nvarchar](20) NULL,\r\n\t[Fax] [nvarchar](20) NULL,\r\n\t[ZipCode] [int] NULL,\r\n\t[E_Mail] [nvarchar](100) NULL,\r\n\t[MainCurncy] [nvarchar](3) NULL,\r\n\t[SysCurrncy] [nvarchar](3) NULL,\r\n\t[TaxIdNum] [nvarchar](32) NULL,\r\n\t[RevOffice] [nvarchar](100) NULL,\t\r\n\t[UpdateDate] [datetime] NULL,\r\n\t[UserSign] [smallint] NULL,\r\n\t[Name][nvarchar](max) NULL,\r\n\t[Image][image] NULL,\r\n\tCONSTRAINT fk_UserSignOADM FOREIGN KEY ([UserSign]) REFERENCES [dbo].[OUSR] ([USERID])\r\n\t\r\n )\r\nGO\r\nCREATE TABLE [dbo].[OCRD](\r\n\t[CardCode] [nvarchar](15) NOT NULL PRIMARY KEY,\r\n\t[CardName] [nvarchar](100) NULL,\r\n\t[CardType] [char](1) NULL,\t\r\n\t[Address] [nvarchar](100) NULL,\r\n\t[ZipCode] [nvarchar](20) NULL,\r\n\t[MailAddres] [nvarchar](100) NULL,\r\n\t[MailZipCod] [nvarchar](20) NULL,\r\n\t[Phone1] [nvarchar](20) NULL,\r\n\t[Phone2] [nvarchar](20) NULL,\r\n\t[Fax] [nvarchar](20) NULL,\r\n\t[CntctPrsn] [nvarchar](90) NULL,\t\r\n\t[Balance] [numeric](19, 6) NULL,\r\n\t[ChecksBal] [numeric](19, 6) NULL,\r\n\t[DNotesBal] [numeric](19, 6) NULL,\t\r\n\t[VatStatus] [char](1) NULL,\r\n\t[LicTradNum] [nvarchar](32) NULL,\t\r\n\t[DNoteBalFC] [numeric](19, 6) NULL,\t\r\n\t[DNoteBalSy] [numeric](19, 6) NULL,\t\r\n\t[Currency] [nvarchar](3) NULL,\t\r\n\t[BalanceSys] [numeric](19, 6) NULL,\r\n\t[BalanceFC] [numeric](19, 6) NULL,\t\r\n\t[E_Mail] [nvarchar](100) NULL,\t\t\r\n\t[CreateDate] [datetime] NULL,\r\n\t[UpdateDate] [datetime] NULL,\t\r\n\t[UserSign] [smallint] NULL,\r\n\t[DebPayAcct] [nvarchar](15) NULL,\r\n\t[VatGroup][nvarchar](8) NULL,\r\n\t[Deleted] [char] NULL,\r\n\t[U_IDA_TipoPersona] [nvarchar](10) NULL,\r\n\t[U_IDA_Contribuyente] [nvarchar](10) NULL,\r\n\t[U_IDA_Sucursal] [nvarchar](10) NULL,\r\n\t[U_IDA_AplicaITF] [nvarchar](10) NULL,\r\n\tCONSTRAINT fk_UserSignOCRD FOREIGN KEY ([UserSign]) REFERENCES [dbo].[OUSR] ([USERID])\r\n )\r\n\r\nGO\r\nCREATE TABLE [dbo].[OCRN](\r\n\t[CurrCode] [nvarchar](3) NOT NULL PRIMARY KEY,\r\n\t[CurrName] [nvarchar](20) NULL,\t\r\n\t[DocCurrCod] [nvarchar](3) NULL,\t\r\n\t[Locked] [char](1) NULL,\t\r\n\t[UserSign] [smallint] NULL,\t\r\n\t[UserSign2] [smallint] NULL,\r\n\tCONSTRAINT fk_UserSignOCRN FOREIGN KEY ([UserSign]) REFERENCES [dbo].[OUSR] ([USERID])\r\n\t\r\n )\r\n\r\nGO\r\nCREATE TABLE [dbo].[OFPR](\r\n\t[AbsEntry] [int] NOT NULL IDENTITY (1,1) PRIMARY KEY,\r\n\t[Code] [nvarchar](20) NOT NULL,\r\n\t[Name] [nvarchar](20) NOT NULL,\r\n\t[F_RefDate] [datetime] NULL,\r\n\t[T_RefDate] [datetime] NULL,\r\n\t[F_DueDate] [datetime] NULL,\r\n\t[T_DueDate] [datetime] NULL,\r\n\t[F_TaxDate] [datetime] NULL,\r\n\t[T_TaxDate] [datetime] NULL,\t\r\n\t[UserSign] [smallint] NULL,\r\n\t[SubNum] [int] NULL,\t\r\n\t[Category] [nvarchar](10) NULL,\t\r\n\t[UpdateDate] [datetime] NULL,\t\r\n\t[PeriodStat] [char](1) NULL,\r\n\t[UserSign2] [smallint] NULL,\r\n\t\r\n)\r\n\r\nGO\r\n\r\nCREATE TABLE [dbo].[MONTHS](\r\n\r\n\t[Code] [nvarchar](2) NOT NULL PRIMARY KEY,\r\n\t[Month] [nvarchar](20) NOT NULL\r\n\r\n)\r\n\r\nCREATE TABLE [dbo].[Alicuotas](\r\n\r\n\t[Code] [nvarchar](20) NOT NULL PRIMARY KEY,\r\n\t[Name] [nvarchar](20) NOT NULL\r\n\r\n)\r\n\r\nCREATE TABLE [dbo].[OINM](\r\n\t[TransSeq] [int] NOT NULL IDENTITY (1,1) PRIMARY KEY,\t\r\n\t[TransType] [int] NULL,\r\n\t[CreatedBy] [int] NULL,\r\n\t[BASE_REF] [nvarchar](11) NULL,\r\n\t[DocLineNum] [int] NULL,\r\n\t[DocDate] [datetime] NULL,\r\n\t[DocDueDate] [datetime] NULL,\r\n\t[CardCode] [nvarchar](15) NULL,\r\n\t[CardName] [nvarchar](100) NULL,\r\n\t[Comments] [nvarchar](254) NULL,\r\n\t[JrnlMemo] [nvarchar](50) NULL,\r\n\t[ItemCode] [nvarchar](50) NULL,\r\n\t[Dscription] [nvarchar](100) NULL,\r\n\t[InQty] [numeric](19,6) NULL,\r\n\t[OutQty] [numeric](19,6) NULL,\r\n\t[Price] [numeric](19,6) NULL,\r\n\t[Currency] [nvarchar](3) NULL,\r\n\t[Rate] [numeric](19,6) NULL,\r\n\t[SysRate] [numeric](19,6) NULL,\r\n\t[TaxDate] [datetime] NULL,\r\n\t[UserSign] [smallint] NULL,\r\n\t[CalcPrice] [numeric](19,6) NULL,\r\n\t[OpenQty] [numeric](19,6) NULL,\r\n\t[CreateDate] [datetime] NULL,\r\n\t[Balance] [numeric](19,6) NULL,\r\n\t[TransValue] [numeric](19,6) NULL,\t\r\n\t[InvntAct] [nvarchar](15) NULL,\r\n\t[OpenValue] [numeric](19,6) NULL,\r\n\t[CostMethod][char] NULL,\r\n\t[Type][char] NULL,\r\n\tCONSTRAINT fk_AcctCodeOINM FOREIGN KEY ([InvntAct]) REFERENCES [dbo].[OACT] ([AcctCode]),\r\n\tCONSTRAINT fk_CardCodeOINM FOREIGN KEY ([CardCode]) REFERENCES [dbo].[OCRD] ([CardCode]),\r\n\tCONSTRAINT fk_UserSignOINM FOREIGN KEY ([UserSign]) REFERENCES [dbo].[OUSR] ([USERID])\r\n)\r\n\r\nGO\r\n\r\nCREATE TABLE [dbo].[OPCH](\r\n\t[DocEntry] [int] NOT NULL IDENTITY(1,1) PRIMARY KEY,\r\n\t[DocNum] [int] NULL,\r\n\t[Max1099] [numeric](19, 6) NULL,\r\n\t[DocType] [char](1) NULL,\r\n\t[CANCELED] [char](1) NULL,\t\r\n\t[DocStatus] [char](1) NULL,\r\n\t[InvntSttus] [char](1) NULL,\t\r\n\t[DocDate] [datetime] NULL,\r\n\t[DocDueDate] [datetime] NULL,\r\n\t[CardCode] [nvarchar](15) NULL,\r\n\t[CardName] [nvarchar](100) NULL,\r\n\t[Address] [nvarchar](254) NULL,\r\n\t[Address2] [nvarchar](254) NULL,\r\n\t[ObjType] [nvarchar](20) NULL,\r\n\t[NumAtCard] [nvarchar](100) NULL,\t\r\n\t[VatSum] [numeric](19, 6) NULL,\r\n\t[VatSumFC] [numeric](19, 6) NULL,\r\n\t[DocCur] [nvarchar](3) NULL,\t\r\n\t[DocTotal] [numeric](19, 6) NULL,\r\n\t[DocTotalFC] [numeric](19, 6) NULL,\r\n\t[PaidToDate] [numeric](19, 6) NULL,\r\n\t[PaidFC] [numeric](19, 6) NULL,\t\r\n\t[Ref1] [nvarchar](11) NULL,\r\n\t[Comments] [nvarchar](254) NULL,\r\n\t[JrnlMemo] [nvarchar](50) NULL,\r\n\t[TransId] [int] NULL,\t\r\n\t[DocRate] [numeric](19, 6) NULL,\r\n\t[SysRate] [numeric](19, 6) NULL,\t\r\n\t[VatSumSy] [numeric](19, 6) NULL,\t\r\n\t[DocTotalSy] [numeric](19, 6) NULL,\r\n\t[PaidSys] [numeric](19, 6) NULL,\t\r\n\t[UpdateDate] [datetime] NULL,\t\r\n\t[CreateDate] [datetime] NULL,\t\r\n\t[TaxDate] [datetime] NULL,\t\r\n\t[FinncPriod] [int] NULL,\r\n\t[UserSign] [smallint] NULL,\t\r\n\t[VatPaid] [numeric](19, 6) NULL,\r\n\t[VatPaidFC] [numeric](19, 6) NULL,\r\n\t[VatPaidSys] [numeric](19, 6) NULL,\r\n\t[UserSign2] [smallint] NULL,\t\r\n\t[LicTradNum] [nvarchar](32) NULL,\t\r\n\t[WTSum] [numeric](19, 6) NULL,\r\n\t[WTSumFC] [numeric](19, 6) NULL,\r\n\t[WTSumSC] [numeric](19, 6) NULL,\t\r\n\t[WTApplied] [numeric](19, 6) NULL,\r\n\t[WTAppliedF] [numeric](19, 6) NULL,\t\r\n\t[WTAppliedS] [numeric](19, 6) NULL,\t\r\n\t[CtlAccount] [nvarchar](15) NULL,\t\r\n\t[BaseVtAt] [numeric](19, 6) NULL,\r\n\t[BaseVtAtSC] [numeric](19, 6) NULL,\r\n\t[BaseVtAtFC] [numeric](19, 6) NULL,\r\n\t[NnSbVAt] [numeric](19, 6) NULL,\r\n\t[NnSbVAtSC] [numeric](19, 6) NULL,\r\n\t[NbSbVAtFC] [numeric](19, 6) NULL,\t\r\n\t[PaidSum] [numeric](19, 6) NULL,\r\n\t[PaidSumFc] [numeric](19, 6) NULL,\r\n\t[PaidSumSc] [numeric](19, 6) NULL,\t\r\n\t[NnSbAmnt] [numeric](19,6) NULL,\r\n\t[NnSbAmntSC] [numeric](19,6) NULL,\r\n\t[NbSbAmntFC] [numeric](19,6) NULL,\r\n\t[BaseAmnt] [numeric](19,6) NULL,\r\n\t[BaseAmntSC] [numeric](19,6) NULL,\r\n\t[BaseAmntFC] [numeric](19,6) NULL,\r\n\t[U_IDA_NumControl] [nvarchar](20) NULL,\r\n\t[U_IDA_TipoTrans] [nvarchar](10) NULL,\r\n\t[U_IDA_CompIVA] [nvarchar](20) NULL,\t\r\n\t[U_IDA_FechaComp] [datetime] NULL,\r\n\t[U_IDA_FechaContComp] [datetime] NULL,\r\n\t[U_IDA_MontoCompIVA] [numeric](19, 6) NULL,\t\r\n\t[U_IDA_RetenTercero] [nvarchar](10) NULL,\r\n\t[U_IDA_TipoRet] [nvarchar](10) NULL,\r\n\t[U_IDA_Tercero] [nvarchar](100) NULL,\t\r\n\t[U_IDA_CompISLR] [nvarchar](20) NULL,\r\n\t[U_IDA_DateCompISLR] [datetime] NULL,\r\n\t[U_IDA_DateContISLR] [datetime] NULL,\r\n\t[U_IDA_CodSerie] [nvarchar](10) NULL,\r\n\t[U_IDA_Serie] [nvarchar](10) NULL,\t\r\n\t[U_IDA_Fafe] [nvarchar](30) NULL,\t\r\n\t[U_IDA_NumExport] [nvarchar](50) NULL,\r\n\t[U_IDA_TipoDoc] [nvarchar](20) NULL,\r\n\t[U_IDA_NumFile] [nvarchar](50) NULL,\r\n\t[U_IDA_NumImport] [nvarchar](50) NULL,\t\r\n\t[U_IDA_MontoFafe] [numeric](19, 6) NULL,\r\n\t[U_IDA_FechaFafe] [datetime] NULL,\r\n\t[U_IDA_IsPlanilla] [nvarchar](10) NULL,\r\n\t[U_IDA_PagoElectronic] [nvarchar](10) NULL,\r\n\t[U_IDA_Alicuota] [nvarchar](10) NULL,\t\r\n\t[U_IDA_CompMunicipal] [nvarchar](20) NULL,\r\n\t[U_IDA_DateCompMun] [datetime] NULL,\r\n\t[U_IDA_CorteZ] [nvarchar](100) NULL,\r\n\t[U_IDA_SerialImpre] [nvarchar](100) NULL,\r\n\t[U_IDA_DocAnulado] [nvarchar](10) NULL,\t\r\n\t[DocSubType][nvarchar](2) null,\r\n\t[DiscPrcnt] [numeric](19, 6) NULL,\r\n\t[DiscSum] [numeric](19, 6) NULL,\r\n\t[DiscSumFC] [numeric](19, 6) NULL,\r\n\t[DiscSumSy] [numeric](19, 6) NULL,\r\n\t[DocTime] [smallint] NULL,\r\n\tCONSTRAINT fk_CardCodeOPCH FOREIGN KEY ([CardCode]) REFERENCES [dbo].[OCRD] ([CardCode]),\r\n\tCONSTRAINT fk_UserSignOPCH FOREIGN KEY ([UserSign]) REFERENCES [dbo].[OUSR] ([USERID])\r\n )\r\n\r\nGO\r\nCREATE TABLE [dbo].[OPDN](\r\n\t[DocEntry] [int] NOT NULL IDENTITY(1,1)  PRIMARY KEY,\r\n\t[Max1099] [numeric](19, 6) NULL,\r\n\t[DocNum] [int] NULL,\r\n\t[DocType] [char](1) NULL,\r\n\t[CANCELED] [char](1) NULL,\t\r\n\t[DocStatus] [char](1) NULL,\r\n\t[InvntSttus] [char](1) NULL,\t\r\n\t[DocDate] [datetime] NULL,\r\n\t[DocDueDate] [datetime] NULL,\r\n\t[CardCode] [nvarchar](15) NULL,\r\n\t[CardName] [nvarchar](100) NULL,\t\r\n\t[Address] [nvarchar](254) NULL,\r\n\t[Address2] [nvarchar](254) NULL,\r\n\t[ObjType] [nvarchar](20) NULL,\r\n\t[NumAtCard] [nvarchar](100) NULL,\t\r\n\t[VatSum] [numeric](19, 6) NULL,\r\n\t[VatSumFC] [numeric](19, 6) NULL,\r\n\t[DocCur] [nvarchar](3) NULL,\t\r\n\t[DocTotal] [numeric](19, 6) NULL,\r\n\t[DocTotalFC] [numeric](19, 6) NULL,\r\n\t[PaidToDate] [numeric](19, 6) NULL,\r\n\t[PaidFC] [numeric](19, 6) NULL,\t\r\n\t[Ref1] [nvarchar](11) NULL,\r\n\t[Comments] [nvarchar](254) NULL,\r\n\t[JrnlMemo] [nvarchar](50) NULL,\r\n\t[TransId] [int] NULL,\t\r\n\t[DocRate] [numeric](19, 6) NULL,\r\n\t[SysRate] [numeric](19, 6) NULL,\t\r\n\t[VatSumSy] [numeric](19, 6) NULL,\t\r\n\t[DocTotalSy] [numeric](19, 6) NULL,\r\n\t[PaidSys] [numeric](19, 6) NULL,\t\r\n\t[UpdateDate] [datetime] NULL,\t\r\n\t[CreateDate] [datetime] NULL,\t\r\n\t[TaxDate] [datetime] NULL,\t\r\n\t[FinncPriod] [int] NULL,\r\n\t[UserSign] [smallint] NULL,\t\r\n\t[VatPaid] [numeric](19, 6) NULL,\r\n\t[VatPaidFC] [numeric](19, 6) NULL,\r\n\t[VatPaidSys] [numeric](19, 6) NULL,\r\n\t[NnSbAmnt] [numeric](19,6) NULL,\r\n\t[NnSbAmntSC] [numeric](19,6) NULL,\r\n\t[NbSbAmntFC] [numeric](19,6) NULL,\r\n\t[BaseAmnt] [numeric](19,6) NULL,\r\n\t[BaseAmntSC] [numeric](19,6) NULL,\r\n\t[BaseAmntFC] [numeric](19,6) NULL,\r\n\t[UserSign2] [smallint] NULL,\t\r\n\t[LicTradNum] [nvarchar](32) NULL,\t\r\n\t[WTSum] [numeric](19, 6) NULL,\r\n\t[WTSumFC] [numeric](19, 6) NULL,\r\n\t[WTSumSC] [numeric](19, 6) NULL,\t\r\n\t[WTApplied] [numeric](19, 6) NULL,\r\n\t[WTAppliedF] [numeric](19, 6) NULL,\t\r\n\t[WTAppliedS] [numeric](19, 6) NULL,\t\r\n\t[CtlAccount] [nvarchar](15) NULL,\t\r\n\t[BaseVtAt] [numeric](19, 6) NULL,\r\n\t[BaseVtAtSC] [numeric](19, 6) NULL,\r\n\t[BaseVtAtFC] [numeric](19, 6) NULL,\r\n\t[NnSbVAt] [numeric](19, 6) NULL,\r\n\t[NnSbVAtSC] [numeric](19, 6) NULL,\r\n\t[NbSbVAtFC] [numeric](19, 6) NULL,\t\r\n\t[PaidSum] [numeric](19, 6) NULL,\r\n\t[PaidSumFc] [numeric](19, 6) NULL,\r\n\t[PaidSumSc] [numeric](19, 6) NULL,\t\r\n\t[U_IDA_CodSerie] [nvarchar](10) NULL,\r\n\t[U_IDA_Serie] [nvarchar](10) NULL,\r\n\t[U_IDA_NumControl] [nvarchar](20) NULL,\r\n\t[U_IDA_TipoTrans] [nvarchar](10) NULL,\r\n\t[U_IDA_Fafe] [nvarchar](30) NULL,\r\n\t[U_IDA_CompIVA] [nvarchar](20) NULL,\r\n\t[U_IDA_NumExport] [nvarchar](50) NULL,\r\n\t[U_IDA_TipoDoc] [nvarchar](20) NULL,\r\n\t[U_IDA_NumFile] [nvarchar](50) NULL,\r\n\t[U_IDA_NumImport] [nvarchar](50) NULL,\r\n\t[U_IDA_FechaComp] [datetime] NULL,\r\n\t[U_IDA_FechaContComp] [datetime] NULL,\r\n\t[U_IDA_MontoCompIVA] [numeric](19, 6) NULL,\r\n\t[U_IDA_MontoFafe] [numeric](19, 6) NULL,\r\n\t[U_IDA_FechaFafe] [datetime] NULL,\r\n\t[U_IDA_IsPlanilla] [nvarchar](10) NULL,\r\n\t[U_IDA_PagoElectronic] [nvarchar](10) NULL,\r\n\t[U_IDA_Alicuota] [nvarchar](10) NULL,\r\n\t[U_IDA_RetenTercero] [nvarchar](10) NULL,\r\n\t[U_IDA_TipoRet] [nvarchar](10) NULL,\r\n\t[U_IDA_Tercero] [nvarchar](100) NULL,\r\n\t[U_IDA_CompMunicipal] [nvarchar](20) NULL,\r\n\t[U_IDA_DateCompMun] [datetime] NULL,\r\n\t[U_IDA_CorteZ] [nvarchar](100) NULL,\r\n\t[U_IDA_SerialImpre] [nvarchar](100) NULL,\r\n\t[U_IDA_DocAnulado] [nvarchar](10) NULL,\r\n\t[U_IDA_CompISLR] [nvarchar](20) NULL,\r\n\t[U_IDA_DateCompISLR] [datetime] NULL,\r\n\t[U_IDA_DateContISLR] [datetime] NULL,\r\n\t[DiscPrcnt] [numeric](19, 6) NULL,\r\n\t[DiscSum] [numeric](19, 6) NULL,\r\n\t[DiscSumFC] [numeric](19, 6) NULL,\r\n\t[DiscSumSy] [numeric](19, 6) NULL,\r\n\t[DocTime] [smallint] NULL,\r\n\tCONSTRAINT fk_CardCodeOPND FOREIGN KEY ([CardCode]) REFERENCES [dbo].[OCRD] ([CardCode]),\r\n\tCONSTRAINT fk_UserSignOPND FOREIGN KEY ([UserSign]) REFERENCES [dbo].[OUSR] ([USERID])\r\n )\r\nGO\r\n\r\nCREATE TABLE [dbo].[ORPC](\r\n\t[DocEntry] [int] NOT NULL IDENTITY(1,1)  PRIMARY KEY,\r\n\t[DocNum] [int] NULL,\r\n\t[Max1099] [numeric](19, 6) NULL,\r\n\t[DocType] [char](1) NULL,\r\n\t[CANCELED] [char](1) NULL,\t\r\n\t[DocStatus] [char](1) NULL,\r\n\t[InvntSttus] [char](1) NULL,\t\r\n\t[DocDate] [datetime] NULL,\r\n\t[DocDueDate] [datetime] NULL,\r\n\t[CardCode] [nvarchar](15) NULL,\r\n\t[CardName] [nvarchar](100) NULL,\r\n\t[Address] [nvarchar](254) NULL,\r\n\t[Address2] [nvarchar](254) NULL,\r\n\t[ObjType] [nvarchar](20) NULL,\r\n\t[NumAtCard] [nvarchar](100) NULL,\t\r\n\t[VatSum] [numeric](19, 6) NULL,\r\n\t[VatSumFC] [numeric](19, 6) NULL,\r\n\t[NnSbAmnt] [numeric](19,6) NULL,\r\n\t[NnSbAmntSC] [numeric](19,6) NULL,\r\n\t[NbSbAmntFC] [numeric](19,6) NULL,\r\n\t[BaseAmnt] [numeric](19,6) NULL,\r\n\t[BaseAmntSC] [numeric](19,6) NULL,\r\n\t[BaseAmntFC] [numeric](19,6) NULL,\r\n\t[DocCur] [nvarchar](3) NULL,\t\r\n\t[DocTotal] [numeric](19, 6) NULL,\r\n\t[DocTotalFC] [numeric](19, 6) NULL,\r\n\t[PaidToDate] [numeric](19, 6) NULL,\r\n\t[PaidFC] [numeric](19, 6) NULL,\t\r\n\t[Ref1] [nvarchar](11) NULL,\r\n\t[Comments] [nvarchar](254) NULL,\r\n\t[JrnlMemo] [nvarchar](50) NULL,\r\n\t[TransId] [int] NULL,\t\r\n\t[DocRate] [numeric](19, 6) NULL,\r\n\t[SysRate] [numeric](19, 6) NULL,\t\r\n\t[VatSumSy] [numeric](19, 6) NULL,\t\r\n\t[DocTotalSy] [numeric](19, 6) NULL,\r\n\t[PaidSys] [numeric](19, 6) NULL,\t\r\n\t[UpdateDate] [datetime] NULL,\t\r\n\t[CreateDate] [datetime] NULL,\t\r\n\t[TaxDate] [datetime] NULL,\t\r\n\t[FinncPriod] [int] NULL,\r\n\t[UserSign] [smallint] NULL,\t\r\n\t[VatPaid] [numeric](19, 6) NULL,\r\n\t[VatPaidFC] [numeric](19, 6) NULL,\r\n\t[VatPaidSys] [numeric](19, 6) NULL,\r\n\t[UserSign2] [smallint] NULL,\t\r\n\t[LicTradNum] [nvarchar](32) NULL,\t\r\n\t[WTSum] [numeric](19, 6) NULL,\r\n\t[WTSumFC] [numeric](19, 6) NULL,\r\n\t[WTSumSC] [numeric](19, 6) NULL,\t\r\n\t[WTApplied] [numeric](19, 6) NULL,\r\n\t[WTAppliedF] [numeric](19, 6) NULL,\t\r\n\t[WTAppliedS] [numeric](19, 6) NULL,\t\r\n\t[CtlAccount] [nvarchar](15) NULL,\t\r\n\t[BaseVtAt] [numeric](19, 6) NULL,\r\n\t[BaseVtAtSC] [numeric](19, 6) NULL,\r\n\t[BaseVtAtFC] [numeric](19, 6) NULL,\r\n\t[NnSbVAt] [numeric](19, 6) NULL,\r\n\t[NnSbVAtSC] [numeric](19, 6) NULL,\r\n\t[NbSbVAtFC] [numeric](19, 6) NULL,\t\r\n\t[PaidSum] [numeric](19, 6) NULL,\r\n\t[PaidSumFc] [numeric](19, 6) NULL,\r\n\t[PaidSumSc] [numeric](19, 6) NULL,\t\r\n\t[U_IDA_CodSerie] [nvarchar](10) NULL,\r\n\t[U_IDA_Serie] [nvarchar](10) NULL,\r\n\t[U_IDA_NumControl] [nvarchar](20) NULL,\r\n\t[U_IDA_TipoTrans] [nvarchar](10) NULL,\r\n\t[U_IDA_Fafe] [nvarchar](30) NULL,\r\n\t[U_IDA_CompIVA] [nvarchar](20) NULL,\r\n\t[U_IDA_NumExport] [nvarchar](50) NULL,\r\n\t[U_IDA_TipoDoc] [nvarchar](20) NULL,\r\n\t[U_IDA_NumFile] [nvarchar](50) NULL,\r\n\t[U_IDA_NumImport] [nvarchar](50) NULL,\r\n\t[U_IDA_FechaComp] [datetime] NULL,\r\n\t[U_IDA_FechaContComp] [datetime] NULL,\r\n\t[U_IDA_MontoCompIVA] [numeric](19, 6) NULL,\r\n\t[U_IDA_MontoFafe] [numeric](19, 6) NULL,\r\n\t[U_IDA_FechaFafe] [datetime] NULL,\r\n\t[U_IDA_IsPlanilla] [nvarchar](10) NULL,\r\n\t[U_IDA_PagoElectronic] [nvarchar](10) NULL,\r\n\t[U_IDA_Alicuota] [nvarchar](10) NULL,\r\n\t[U_IDA_RetenTercero] [nvarchar](10) NULL,\r\n\t[U_IDA_TipoRet] [nvarchar](10) NULL,\r\n\t[U_IDA_Tercero] [nvarchar](100) NULL,\r\n\t[U_IDA_CompMunicipal] [nvarchar](20) NULL,\r\n\t[U_IDA_DateCompMun] [datetime] NULL,\r\n\t[U_IDA_CorteZ] [nvarchar](100) NULL,\r\n\t[U_IDA_SerialImpre] [nvarchar](100) NULL,\r\n\t[U_IDA_DocAnulado] [nvarchar](10) NULL,\r\n\t[U_IDA_CompISLR] [nvarchar](20) NULL,\r\n\t[U_IDA_DateCompISLR] [datetime] NULL,\r\n\t[U_IDA_DateContISLR] [datetime] NULL,\r\n\t[DocSubType][nvarchar](2) null,\r\n\t[DiscPrcnt] [numeric](19, 6) NULL,\r\n\t[DiscSum] [numeric](19, 6) NULL,\r\n\t[DiscSumFC] [numeric](19, 6) NULL,\r\n\t[DiscSumSy] [numeric](19, 6) NULL,\r\n\t[DocTime] [smallint] NULL,\r\n\tCONSTRAINT fk_CardCodeORPC FOREIGN KEY ([CardCode]) REFERENCES [dbo].[OCRD] ([CardCode]),\r\n\tCONSTRAINT fk_UserSignORPC FOREIGN KEY ([UserSign]) REFERENCES [dbo].[OUSR] ([USERID])\r\n)\r\nGO\r\n/****** Object:  Table [dbo].[ORTT]    Script Date: 27/2/2020 10:16:02 a. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE TABLE [dbo].[ORTT](\r\n\t[RateDate] [datetime] NOT NULL,\r\n\t[Currency] [nvarchar](3) NOT NULL ,\r\n\t[Rate] [numeric](19, 6) NULL,\r\n\t[DataSource] [char](1) NULL,\r\n\t[UserSign] [smallint] NULL,\r\n\tCONSTRAINT fk_UserSignORTT FOREIGN KEY ([UserSign]) REFERENCES [dbo].[OUSR] ([USERID])\r\n)\r\nGO\r\n\r\nCREATE TABLE [dbo].[OSTA](\r\n\t[Code] [nvarchar](8) NOT NULL PRIMARY KEY,\r\n\t[Name] [nvarchar](100) NULL,\r\n\t[Rate] [numeric](19, 6) NULL,\r\n\t[SalesTax] [nvarchar](15) NULL,\r\n\t[UserSign] [smallint] NULL,\r\n\t[PurchTax] [nvarchar](15) NULL,\r\n\tCONSTRAINT fk_UserSignOSTA FOREIGN KEY ([UserSign]) REFERENCES [dbo].[OUSR] ([USERID])\r\n\t\r\n)\r\nGO\r\n/****** Object:  Table [dbo].[OSTC]    Script Date: 27/2/2020 10:16:02 a. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE TABLE [dbo].[OSTC](\r\n\t[Code] [nvarchar](8) NOT NULL PRIMARY KEY,\r\n\t[Name] [nvarchar](100) NULL,\r\n\t[Rate] [numeric](19, 6) NULL,\r\n\t[Freight] [char](1) NULL,\r\n\t[UserSign] [smallint] NULL,\r\n\t[ValidForAR] [char](1) NULL,\r\n\t[ValidForAP] [char](1) NULL,\t\r\n\t[Lock] [char](1) NULL,\t\r\n\t[UserSign2] [smallint] NULL,\r\n\t[UpdateDate] [datetime] NULL,\t\r\n\t[U_IDA_Alicuota] [nvarchar](20) NULL,\r\n\tCONSTRAINT fk_UserSignOSTC FOREIGN KEY ([UserSign]) REFERENCES [dbo].[OUSR] ([USERID])\r\n)\r\n\r\n\r\nGO\r\n/****** Object:  Table [dbo].[OSTC]    Script Date: 27/2/2020 10:16:02 a. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE TABLE [dbo].[STC1](\r\n\t[STCCode] [nvarchar](8) NOT NULL,\r\n\t[Line_ID] [int] NOT NULL,\r\n\t[STACode] [nvarchar](8) NULL,\r\n\t[EfctivRate] [numeric](19, 6) NULL,\t\r\n\tconstraint pk_STCCode primary key (STCCode, Line_ID),\r\n\tCONSTRAINT fk_STACode FOREIGN KEY ([STACode]) REFERENCES [dbo].[OSTA] ([Code])\r\n)\r\n\r\n\r\nGO\r\n\r\nCREATE TABLE [dbo].[OWHT](\r\n\t[WTCode] [nvarchar](4) NOT NULL PRIMARY KEY,\r\n\t[WTName] [nvarchar](50) NULL,\r\n\t[Rate] [numeric](19, 6) NULL,\r\n\t[EffecDate] [datetime] NULL,\r\n\t[Category] [char](1) NULL,\r\n\t[BaseType] [char](1) NULL,\r\n\t[PrctBsAmnt] [numeric](19, 6) NULL,\t\r\n\t[Account] [nvarchar](15) NULL,\t\r\n\t[UserSign] [smallint] NULL,\t\r\n\t[Inactive] [char](1) NULL,\t\r\n\t[U_IDA_TipoRetencion] [nvarchar](20) NULL,\r\n\t[U_IDA_BaseMinima] [numeric](19, 6) NULL,\r\n\t[U_IDA_Sustraendo] [numeric](19, 6) NULL,\r\n\t[Offclcode] [NVARCHAR](15) NULL,\r\n\tCONSTRAINT fk_UserSignOWHT FOREIGN KEY ([UserSign]) REFERENCES [dbo].[OUSR] ([USERID])\r\n )\r\nGO\r\n\r\nGO --Linea Factura de Proveedores\r\nCREATE TABLE [dbo].[PCH1](\r\n\t[DocEntry] [int] NOT NULL,\r\n\t[LineNum] [int] NOT NULL ,\t\r\n\t[LineStatus] [char](1) NULL,\r\n\t[ItemCode] [nvarchar](50) NULL,\r\n\t[Dscription] [nvarchar](100) NULL,\r\n\t[Quantity] [numeric](19, 6) NULL,\t\r\n\t[OpenQty] [numeric](19, 6) NULL,\r\n\t[Price] [numeric](19, 6) NULL,\r\n\t[Currency] [nvarchar](3) NULL,\t\r\n\t[LineTotal] [numeric](19, 6) NULL,\r\n\t[OpenSum] [numeric](19, 6) NULL,\r\n\t[OpenSumFC] [numeric](19, 6) NULL,\t\r\n\t[AcctCode] [nvarchar](15) NULL,\t\r\n\t[DocDate] [datetime] NULL,\t\r\n\t[OpenCreQty] [numeric](19, 6) NULL,\t\r\n\t[BaseCard] [nvarchar](15) NULL,\r\n\t[TotalSumSy] [numeric](19, 6) NULL,\r\n\t[OpenSumSys] [numeric](19, 6) NULL,\r\n\t[InvntSttus] [char](1) NULL,\r\n\t[VatPrcnt] [numeric](19, 6) NULL,\r\n\t[VatGroup] [nvarchar](8) NULL,\r\n\t[PriceAfVAT] [numeric](19, 6) NULL,\t\r\n\t[VatSum] [numeric](19, 6) NULL,\r\n\t[VatSumFrgn] [numeric](19, 6) NULL,\r\n\t[VatSumSy] [numeric](19, 6) NULL,\r\n\t[FinncPriod] [int] NULL,\r\n\t[ObjType] [nvarchar](20) NULL,\t\r\n\t[DedVatSum] [numeric](19, 6) NULL,\r\n\t[DedVatSumF] [numeric](19, 6) NULL,\r\n\t[DedVatSumS] [numeric](19, 6) NULL,\t\r\n\t[Address] [nvarchar](254) NULL,\t\r\n\t[VatAppld] [numeric](19, 6) NULL,\r\n\t[VatAppldFC] [numeric](19, 6) NULL,\r\n\t[VatAppldSC] [numeric](19, 6) NULL,\r\n\t[BaseQty] [numeric](19, 6) NULL,\r\n\t[BaseOpnQty] [numeric](19, 6) NULL,\r\n\t[VatDscntPr] [numeric](19, 6) NULL,\r\n\t[WtLiable] [char](1) NULL,\t\r\n\t[LineVat] [numeric](19, 6) NULL,\r\n\t[LineVatlF] [numeric](19, 6) NULL,\t\r\n\t[StockSum] [numeric](19, 6) NULL,\r\n\t[StockSumFc] [numeric](19, 6) NULL,\r\n\t[StockSumSc] [numeric](19, 6) NULL,\r\n\t[InvQty] [numeric](19, 6) NULL,\r\n\t[OpenInvQty] [numeric](19, 6) NULL,\r\n\t[GTotal] [numeric](19, 6) NULL,\r\n\t[GTotalFC] [numeric](19, 6) NULL,\r\n\t[GTotalSC] [numeric](19, 6) NULL,\r\n\t[TotalFrgn] [numeric](19, 6) NULL,\r\n\t[DataSource] [char](1) null,\r\n\t[BaseEntry] [INT] NULL,\r\n\t[NumPerMsr] [numeric](19, 6),\r\n\t[NumPerMsr2] [numeric](19, 6),\r\n\t[UomEntry] [int],\r\n\t[UomEntry2] [int],\r\n\t[UomCode] [nvarchar](20),\r\n\t[UomCode2] [nvarchar](20),\r\n\t[unitMsr] [nvarchar](100),\r\n\t[unitMsr2] [nvarchar](100),\r\n\t[StartValue] [char] (1),\r\n\t[IsTax] [char] (1),\r\n\tconstraint pk_PCH1 primary key ([DocEntry], LineNum),\r\n\tCONSTRAINT fk_UomEntryPCH1 FOREIGN KEY ([UomEntry]) REFERENCES [dbo].[OUOM] ([UomEntry]),\r\n\tCONSTRAINT fk_DocEntryPCH1 FOREIGN KEY ([DocEntry]) REFERENCES [dbo].[OPCH] ([DocEntry]),\r\n\tCONSTRAINT fk_AcctCodePCH1 FOREIGN KEY ([AcctCode]) REFERENCES [dbo].[OACT] ([AcctCode])\r\n)\r\n\r\nGO\r\nCREATE TABLE [dbo].[PDN1](\r\n\t[DocEntry] [int] NOT NULL,\r\n\t[LineNum] [int] NOT NULL ,\t\r\n\t[LineStatus] [char](1) NULL,\r\n\t[ItemCode] [nvarchar](50) NULL,\r\n\t[Dscription] [nvarchar](100) NULL,\r\n\t[Quantity] [numeric](19, 6) NULL,\t\r\n\t[OpenQty] [numeric](19, 6) NULL,\r\n\t[Price] [numeric](19, 6) NULL,\r\n\t[Currency] [nvarchar](3) NULL,\t\r\n\t[LineTotal] [numeric](19, 6) NULL,\r\n\t[OpenSum] [numeric](19, 6) NULL,\r\n\t[OpenSumFC] [numeric](19, 6) NULL,\t\r\n\t[AcctCode] [nvarchar](15) NULL,\t\r\n\t[DocDate] [datetime] NULL,\t\r\n\t[OpenCreQty] [numeric](19, 6) NULL,\t\r\n\t[BaseCard] [nvarchar](15) NULL,\r\n\t[TotalSumSy] [numeric](19, 6) NULL,\r\n\t[OpenSumSys] [numeric](19, 6) NULL,\r\n\t[InvntSttus] [char](1) NULL,\r\n\t[VatPrcnt] [numeric](19, 6) NULL,\r\n\t[VatGroup] [nvarchar](8) NULL,\r\n\t[PriceAfVAT] [numeric](19, 6) NULL,\t\r\n\t[VatSum] [numeric](19, 6) NULL,\r\n\t[VatSumFrgn] [numeric](19, 6) NULL,\r\n\t[VatSumSy] [numeric](19, 6) NULL,\r\n\t[FinncPriod] [int] NULL,\r\n\t[ObjType] [nvarchar](20) NULL,\t\r\n\t[DedVatSum] [numeric](19, 6) NULL,\r\n\t[DedVatSumF] [numeric](19, 6) NULL,\r\n\t[DedVatSumS] [numeric](19, 6) NULL,\t\r\n\t[Address] [nvarchar](254) NULL,\t\r\n\t[VatAppld] [numeric](19, 6) NULL,\r\n\t[VatAppldFC] [numeric](19, 6) NULL,\r\n\t[VatAppldSC] [numeric](19, 6) NULL,\r\n\t[BaseQty] [numeric](19, 6) NULL,\r\n\t[BaseOpnQty] [numeric](19, 6) NULL,\r\n\t[VatDscntPr] [numeric](19, 6) NULL,\r\n\t[WtLiable] [char](1) NULL,\t\r\n\t[LineVat] [numeric](19, 6) NULL,\r\n\t[LineVatlF] [numeric](19, 6) NULL,\t\r\n\t[StockSum] [numeric](19, 6) NULL,\r\n\t[StockSumFc] [numeric](19, 6) NULL,\r\n\t[StockSumSc] [numeric](19, 6) NULL,\r\n\t[InvQty] [numeric](19, 6) NULL,\r\n\t[OpenInvQty] [numeric](19, 6) NULL,\r\n\t[GTotal] [numeric](19, 6) NULL,\r\n\t[GTotalFC] [numeric](19, 6) NULL,\r\n\t[GTotalSC] [numeric](19, 6) NULL,\r\n\t[TotalFrgn] [numeric](19, 6) NULL,\r\n\t[DataSource] [char](1) null,\r\n\t[NumPerMsr] [numeric](19, 6),\r\n\t[NumPerMsr2] [numeric](19, 6),\r\n\t[UomEntry] [int],\r\n\t[UomEntry2] [int],\r\n\t[UomCode] [nvarchar](20),\r\n\t[UomCode2] [nvarchar](20),\r\n\t[unitMsr] [nvarchar](100),\r\n\t[unitMsr2] [nvarchar](100),\r\n\t[StartValue] [char] (1),\r\n\t[IsTax] [char] (1),\r\n\tconstraint pk_PDN1 primary key ([DocEntry], LineNum),\r\n\tCONSTRAINT fk_UomEntryPDN1 FOREIGN KEY ([UomEntry]) REFERENCES [dbo].[OUOM] ([UomEntry]),\r\n\tCONSTRAINT fk_DocEntryPDN1 FOREIGN KEY ([DocEntry]) REFERENCES [dbo].[OPDN] ([DocEntry]),\r\n\tCONSTRAINT fk_AcctCodePDN1 FOREIGN KEY ([AcctCode]) REFERENCES [dbo].[OACT] ([AcctCode])\r\n )\r\n\r\nGO\r\nCREATE TABLE [dbo].[RPC1](\r\n\t[DocEntry] [int] NOT NULL,\r\n\t[LineNum] [int] NOT NULL ,\t\r\n\t[LineStatus] [char](1) NULL,\r\n\t[ItemCode] [nvarchar](50) NULL,\r\n\t[Dscription] [nvarchar](100) NULL,\r\n\t[Quantity] [numeric](19, 6) NULL,\t\r\n\t[OpenQty] [numeric](19, 6) NULL,\r\n\t[Price] [numeric](19, 6) NULL,\r\n\t[Currency] [nvarchar](3) NULL,\t\r\n\t[LineTotal] [numeric](19, 6) NULL,\r\n\t[OpenSum] [numeric](19, 6) NULL,\r\n\t[OpenSumFC] [numeric](19, 6) NULL,\t\r\n\t[AcctCode] [nvarchar](15) NULL,\t\r\n\t[DocDate] [datetime] NULL,\t\r\n\t[OpenCreQty] [numeric](19, 6) NULL,\t\r\n\t[BaseCard] [nvarchar](15) NULL,\r\n\t[TotalSumSy] [numeric](19, 6) NULL,\r\n\t[OpenSumSys] [numeric](19, 6) NULL,\r\n\t[InvntSttus] [char](1) NULL,\r\n\t[VatPrcnt] [numeric](19, 6) NULL,\r\n\t[VatGroup] [nvarchar](8) NULL,\r\n\t[PriceAfVAT] [numeric](19, 6) NULL,\t\r\n\t[VatSum] [numeric](19, 6) NULL,\r\n\t[VatSumFrgn] [numeric](19, 6) NULL,\r\n\t[VatSumSy] [numeric](19, 6) NULL,\r\n\t[FinncPriod] [int] NULL,\r\n\t[ObjType] [nvarchar](20) NULL,\t\r\n\t[DedVatSum] [numeric](19, 6) NULL,\r\n\t[DedVatSumF] [numeric](19, 6) NULL,\r\n\t[DedVatSumS] [numeric](19, 6) NULL,\t\r\n\t[Address] [nvarchar](254) NULL,\t\r\n\t[VatAppld] [numeric](19, 6) NULL,\r\n\t[VatAppldFC] [numeric](19, 6) NULL,\r\n\t[VatAppldSC] [numeric](19, 6) NULL,\r\n\t[BaseQty] [numeric](19, 6) NULL,\r\n\t[BaseOpnQty] [numeric](19, 6) NULL,\r\n\t[VatDscntPr] [numeric](19, 6) NULL,\r\n\t[WtLiable] [char](1) NULL,\t\r\n\t[LineVat] [numeric](19, 6) NULL,\r\n\t[LineVatlF] [numeric](19, 6) NULL,\t\r\n\t[StockSum] [numeric](19, 6) NULL,\r\n\t[StockSumFc] [numeric](19, 6) NULL,\r\n\t[StockSumSc] [numeric](19, 6) NULL,\r\n\t[InvQty] [numeric](19, 6) NULL,\r\n\t[OpenInvQty] [numeric](19, 6) NULL,\r\n\t[GTotal] [numeric](19, 6) NULL,\r\n\t[GTotalFC] [numeric](19, 6) NULL,\r\n\t[GTotalSC] [numeric](19, 6) NULL,\r\n\t[TotalFrgn] [numeric](19, 6) NULL,\r\n\t[DataSource] [char](1) null,\r\n\t[BaseEntry] [INT] NULL,\r\n\t[NumPerMsr] [numeric](19, 6),\r\n\t[NumPerMsr2] [numeric](19, 6),\r\n\t[UomEntry] [int],\r\n\t[UomEntry2] [int],\r\n\t[UomCode] [nvarchar](20),\r\n\t[UomCode2] [nvarchar](20),\r\n\t[unitMsr] [nvarchar](100),\r\n\t[unitMsr2] [nvarchar](100),\r\n\t[StartValue] [char] (1),\r\n\t[IsTax] [char] (1),\r\n\tconstraint pk_RPC1 primary key ([DocEntry], LineNum),\r\n\tCONSTRAINT fk_UomEntryRPC1 FOREIGN KEY ([UomEntry]) REFERENCES [dbo].[OUOM] ([UomEntry]),\r\n\tCONSTRAINT fk_DocEntryRPC1 FOREIGN KEY ([DocEntry]) REFERENCES [dbo].[ORPC] ([DocEntry]),\r\n\tCONSTRAINT fk_AcctCodeRPC1 FOREIGN KEY ([AcctCode]) REFERENCES [dbo].[OACT] ([AcctCode])\r\n \r\n )\r\nGO\r\nCREATE TABLE [dbo].[OINV](\r\n\t[DocEntry] [int] NOT NULL IDENTITY(1,1) PRIMARY KEY,\r\n\t[DocNum] [int] NULL,\r\n\t[Max1099] [numeric](19, 6) NULL,\r\n\t[DocType] [char](1) NULL,\r\n\t[CANCELED] [char](1) NULL,\t\r\n\t[DocStatus] [char](1) NULL,\r\n\t[InvntSttus] [char](1) NULL,\t\r\n\t[DocDate] [datetime] NULL,\r\n\t[DocDueDate] [datetime] NULL,\r\n\t[CardCode] [nvarchar](15) NULL,\r\n\t[CardName] [nvarchar](100) NULL,\r\n\t[Address] [nvarchar](254) NULL,\r\n\t[Address2] [nvarchar](254) NULL,\r\n\t[ObjType] [nvarchar](20) NULL,\r\n\t[NumAtCard] [nvarchar](100) NULL,\t\r\n\t[VatSum] [numeric](19, 6) NULL,\r\n\t[VatSumFC] [numeric](19, 6) NULL,\r\n\t[DocCur] [nvarchar](3) NULL,\t\r\n\t[NnSbAmnt] [numeric](19,6) NULL,\r\n\t[NnSbAmntSC] [numeric](19,6) NULL,\r\n\t[NbSbAmntFC] [numeric](19,6) NULL,\r\n\t[BaseAmnt] [numeric](19,6) NULL,\r\n\t[BaseAmntSC] [numeric](19,6) NULL,\r\n\t[BaseAmntFC] [numeric](19,6) NULL,\r\n\t[DocTotal] [numeric](19, 6) NULL,\r\n\t[DocTotalFC] [numeric](19, 6) NULL,\r\n\t[PaidToDate] [numeric](19, 6) NULL,\r\n\t[PaidFC] [numeric](19, 6) NULL,\t\r\n\t[Ref1] [nvarchar](11) NULL,\r\n\t[Comments] [nvarchar](254) NULL,\r\n\t[JrnlMemo] [nvarchar](50) NULL,\r\n\t[TransId] [int] NULL,\t\r\n\t[DocRate] [numeric](19, 6) NULL,\r\n\t[SysRate] [numeric](19, 6) NULL,\t\r\n\t[VatSumSy] [numeric](19, 6) NULL,\t\r\n\t[DocTotalSy] [numeric](19, 6) NULL,\r\n\t[PaidSys] [numeric](19, 6) NULL,\t\r\n\t[UpdateDate] [datetime] NULL,\t\r\n\t[CreateDate] [datetime] NULL,\t\r\n\t[TaxDate] [datetime] NULL,\t\r\n\t[FinncPriod] [int] NULL,\r\n\t[UserSign] [smallint] NULL,\t\r\n\t[VatPaid] [numeric](19, 6) NULL,\r\n\t[VatPaidFC] [numeric](19, 6) NULL,\r\n\t[VatPaidSys] [numeric](19, 6) NULL,\r\n\t[UserSign2] [smallint] NULL,\t\r\n\t[LicTradNum] [nvarchar](32) NULL,\t\r\n\t[WTSum] [numeric](19, 6) NULL,\r\n\t[WTSumFC] [numeric](19, 6) NULL,\r\n\t[WTSumSC] [numeric](19, 6) NULL,\t\r\n\t[WTApplied] [numeric](19, 6) NULL,\r\n\t[WTAppliedF] [numeric](19, 6) NULL,\t\r\n\t[WTAppliedS] [numeric](19, 6) NULL,\t\r\n\t[CtlAccount] [nvarchar](15) NULL,\t\r\n\t[BaseVtAt] [numeric](19, 6) NULL,\r\n\t[BaseVtAtSC] [numeric](19, 6) NULL,\r\n\t[BaseVtAtFC] [numeric](19, 6) NULL,\r\n\t[NnSbVAt] [numeric](19, 6) NULL,\r\n\t[NnSbVAtSC] [numeric](19, 6) NULL,\r\n\t[NbSbVAtFC] [numeric](19, 6) NULL,\t\r\n\t[PaidSum] [numeric](19, 6) NULL,\r\n\t[PaidSumFc] [numeric](19, 6) NULL,\r\n\t[PaidSumSc] [numeric](19, 6) NULL,\t\r\n\t[U_IDA_CodSerie] [nvarchar](10) NULL,\r\n\t[U_IDA_Serie] [nvarchar](10) NULL,\r\n\t[U_IDA_NumControl] [nvarchar](20) NULL,\r\n\t[U_IDA_TipoTrans] [nvarchar](10) NULL,\r\n\t[U_IDA_Fafe] [nvarchar](30) NULL,\r\n\t[U_IDA_CompIVA] [nvarchar](20) NULL,\r\n\t[U_IDA_NumExport] [nvarchar](50) NULL,\r\n\t[U_IDA_TipoDoc] [nvarchar](20) NULL,\r\n\t[U_IDA_NumFile] [nvarchar](50) NULL,\r\n\t[U_IDA_NumImport] [nvarchar](50) NULL,\r\n\t[U_IDA_FechaComp] [datetime] NULL,\r\n\t[U_IDA_FechaContComp] [datetime] NULL,\r\n\t[U_IDA_MontoCompIVA] [numeric](19, 6) NULL,\r\n\t[U_IDA_MontoFafe] [numeric](19, 6) NULL,\r\n\t[U_IDA_FechaFafe] [datetime] NULL,\r\n\t[U_IDA_IsPlanilla] [nvarchar](10) NULL,\r\n\t[U_IDA_PagoElectronic] [nvarchar](10) NULL,\r\n\t[U_IDA_Alicuota] [nvarchar](10) NULL,\r\n\t[U_IDA_RetenTercero] [nvarchar](10) NULL,\r\n\t[U_IDA_TipoRet] [nvarchar](10) NULL,\r\n\t[U_IDA_Tercero] [nvarchar](100) NULL,\r\n\t[U_IDA_CompMunicipal] [nvarchar](20) NULL,\r\n\t[U_IDA_DateCompMun] [datetime] NULL,\r\n\t[U_IDA_CorteZ] [nvarchar](100) NULL,\r\n\t[U_IDA_SerialImpre] [nvarchar](100) NULL,\r\n\t[U_IDA_DocAnulado] [nvarchar](10) NULL,\r\n\t[U_IDA_CompISLR] [nvarchar](20) NULL,\r\n\t[U_IDA_DateCompISLR] [datetime] NULL,\r\n\t[U_IDA_DateContISLR] [datetime] NULL,\r\n\t[DocSubType][nvarchar](2) null,\r\n\t[DiscPrcnt] [numeric](19, 6) NULL,\r\n\t[DiscSum] [numeric](19, 6) NULL,\r\n\t[DiscSumFC] [numeric](19, 6) NULL,\r\n\t[DiscSumSy] [numeric](19, 6) NULL,\r\n\t[DocTime] [smallint] NULL,\r\n\tCONSTRAINT fk_CardCodeOINV FOREIGN KEY ([CardCode]) REFERENCES [dbo].[OCRD] ([CardCode]),\r\n\tCONSTRAINT fk_UserSignOINV FOREIGN KEY ([UserSign]) REFERENCES [dbo].[OUSR] ([USERID])\r\n )\r\n\r\nGO\r\n\r\nCREATE TABLE [dbo].[INV1](\r\n\t[DocEntry] [int] NOT NULL,\r\n\t[LineNum] [int] NOT NULL ,\t\r\n\t[LineStatus] [char](1) NULL,\r\n\t[ItemCode] [nvarchar](50) NULL,\r\n\t[Dscription] [nvarchar](100) NULL,\r\n\t[Quantity] [numeric](19, 6) NULL,\t\r\n\t[OpenQty] [numeric](19, 6) NULL,\r\n\t[Price] [numeric](19, 6) NULL,\r\n\t[Currency] [nvarchar](3) NULL,\t\r\n\t[LineTotal] [numeric](19, 6) NULL,\r\n\t[OpenSum] [numeric](19, 6) NULL,\r\n\t[OpenSumFC] [numeric](19, 6) NULL,\t\r\n\t[AcctCode] [nvarchar](15) NULL,\t\r\n\t[DocDate] [datetime] NULL,\t\r\n\t[OpenCreQty] [numeric](19, 6) NULL,\t\r\n\t[BaseCard] [nvarchar](15) NULL,\r\n\t[TotalSumSy] [numeric](19, 6) NULL,\r\n\t[OpenSumSys] [numeric](19, 6) NULL,\r\n\t[InvntSttus] [char](1) NULL,\r\n\t[VatPrcnt] [numeric](19, 6) NULL,\r\n\t[VatGroup] [nvarchar](8) NULL,\r\n\t[PriceAfVAT] [numeric](19, 6) NULL,\t\r\n\t[VatSum] [numeric](19, 6) NULL,\r\n\t[VatSumFrgn] [numeric](19, 6) NULL,\r\n\t[VatSumSy] [numeric](19, 6) NULL,\r\n\t[FinncPriod] [int] NULL,\r\n\t[ObjType] [nvarchar](20) NULL,\t\r\n\t[DedVatSum] [numeric](19, 6) NULL,\r\n\t[DedVatSumF] [numeric](19, 6) NULL,\r\n\t[DedVatSumS] [numeric](19, 6) NULL,\t\r\n\t[Address] [nvarchar](254) NULL,\t\r\n\t[VatAppld] [numeric](19, 6) NULL,\r\n\t[VatAppldFC] [numeric](19, 6) NULL,\r\n\t[VatAppldSC] [numeric](19, 6) NULL,\r\n\t[BaseQty] [numeric](19, 6) NULL,\r\n\t[BaseOpnQty] [numeric](19, 6) NULL,\r\n\t[VatDscntPr] [numeric](19, 6) NULL,\r\n\t[WtLiable] [char](1) NULL,\t\r\n\t[LineVat] [numeric](19, 6) NULL,\r\n\t[LineVatlF] [numeric](19, 6) NULL,\t\r\n\t[StockSum] [numeric](19, 6) NULL,\r\n\t[StockSumFc] [numeric](19, 6) NULL,\r\n\t[StockSumSc] [numeric](19, 6) NULL,\r\n\t[InvQty] [numeric](19, 6) NULL,\r\n\t[OpenInvQty] [numeric](19, 6) NULL,\r\n\t[GTotal] [numeric](19, 6) NULL,\r\n\t[GTotalFC] [numeric](19, 6) NULL,\r\n\t[GTotalSC] [numeric](19, 6) NULL,\r\n\t[TotalFrgn] [numeric](19, 6) NULL,\r\n\t[DataSource] [char](1) null,\r\n\t[BaseEntry] [INT] NULL,\r\n\t[NumPerMsr] [numeric](19, 6),\r\n\t[NumPerMsr2] [numeric](19, 6),\r\n\t[UomEntry] [int],\r\n\t[UomEntry2] [int],\r\n\t[UomCode] [nvarchar](20),\r\n\t[UomCode2] [nvarchar](20),\r\n\t[unitMsr] [nvarchar](100),\r\n\t[unitMsr2] [nvarchar](100),\r\n\t[StartValue] [char] (1),\r\n\t[IsTax] [char] (1),\r\n\tconstraint pk_INV1 primary key ([DocEntry], LineNum),\r\n\tCONSTRAINT fk_DocEntryINV1 FOREIGN KEY ([DocEntry]) REFERENCES [dbo].[OINV] ([DocEntry]),\r\n\tCONSTRAINT fk_AcctCodeINV1 FOREIGN KEY ([AcctCode]) REFERENCES [dbo].[OACT] ([AcctCode]),\r\n\tCONSTRAINT fk_UomEntryINV1 FOREIGN KEY ([UomEntry]) REFERENCES [dbo].[OUOM] ([UomEntry])\r\n )\r\n GO\r\nCREATE TABLE [dbo].[ORIN](\r\n\t[DocEntry] [int] NOT NULL IDENTITY(1,1) PRIMARY KEY,\r\n\t[DocNum] [int] NULL,\r\n\t[Max1099] [numeric](19, 6) NULL,\r\n\t[DocType] [char](1) NULL,\r\n\t[CANCELED] [char](1) NULL,\t\r\n\t[DocStatus] [char](1) NULL,\r\n\t[InvntSttus] [char](1) NULL,\t\r\n\t[DocDate] [datetime] NULL,\r\n\t[DocDueDate] [datetime] NULL,\r\n\t[CardCode] [nvarchar](15) NULL,\r\n\t[CardName] [nvarchar](100) NULL,\r\n\t[Address] [nvarchar](254) NULL,\r\n\t[Address2] [nvarchar](254) NULL,\r\n\t[ObjType] [nvarchar](20) NULL,\r\n\t[NumAtCard] [nvarchar](100) NULL,\t\r\n\t[VatSum] [numeric](19, 6) NULL,\r\n\t[VatSumFC] [numeric](19, 6) NULL,\r\n\t[DocCur] [nvarchar](3) NULL,\t\r\n\t[NnSbAmnt] [numeric](19,6) NULL,\r\n\t[NnSbAmntSC] [numeric](19,6) NULL,\r\n\t[NbSbAmntFC] [numeric](19,6) NULL,\r\n\t[BaseAmnt] [numeric](19,6) NULL,\r\n\t[BaseAmntSC] [numeric](19,6) NULL,\r\n\t[BaseAmntFC] [numeric](19,6) NULL,\r\n\t[DocTotal] [numeric](19, 6) NULL,\r\n\t[DocTotalFC] [numeric](19, 6) NULL,\r\n\t[PaidToDate] [numeric](19, 6) NULL,\r\n\t[PaidFC] [numeric](19, 6) NULL,\t\r\n\t[Ref1] [nvarchar](11) NULL,\r\n\t[Comments] [nvarchar](254) NULL,\r\n\t[JrnlMemo] [nvarchar](50) NULL,\r\n\t[TransId] [int] NULL,\r\n\t[DocRate] [numeric](19, 6) NULL,\r\n\t[SysRate] [numeric](19, 6) NULL,\t\r\n\t[VatSumSy] [numeric](19, 6) NULL,\t\r\n\t[DocTotalSy] [numeric](19, 6) NULL,\r\n\t[PaidSys] [numeric](19, 6) NULL,\t\r\n\t[UpdateDate] [datetime] NULL,\t\r\n\t[CreateDate] [datetime] NULL,\t\r\n\t[TaxDate] [datetime] NULL,\t\r\n\t[FinncPriod] [int] NULL,\r\n\t[UserSign] [smallint] NULL,\t\r\n\t[VatPaid] [numeric](19, 6) NULL,\r\n\t[VatPaidFC] [numeric](19, 6) NULL,\r\n\t[VatPaidSys] [numeric](19, 6) NULL,\r\n\t[UserSign2] [smallint] NULL,\t\r\n\t[LicTradNum] [nvarchar](32) NULL,\t\r\n\t[WTSum] [numeric](19, 6) NULL,\r\n\t[WTSumFC] [numeric](19, 6) NULL,\r\n\t[WTSumSC] [numeric](19, 6) NULL,\t\r\n\t[WTApplied] [numeric](19, 6) NULL,\r\n\t[WTAppliedF] [numeric](19, 6) NULL,\t\r\n\t[WTAppliedS] [numeric](19, 6) NULL,\t\r\n\t[CtlAccount] [nvarchar](15) NULL,\t\r\n\t[BaseVtAt] [numeric](19, 6) NULL,\r\n\t[BaseVtAtSC] [numeric](19, 6) NULL,\r\n\t[BaseVtAtFC] [numeric](19, 6) NULL,\r\n\t[NnSbVAt] [numeric](19, 6) NULL,\r\n\t[NnSbVAtSC] [numeric](19, 6) NULL,\r\n\t[NbSbVAtFC] [numeric](19, 6) NULL,\t\r\n\t[PaidSum] [numeric](19, 6) NULL,\r\n\t[PaidSumFc] [numeric](19, 6) NULL,\r\n\t[PaidSumSc] [numeric](19, 6) NULL,\t\r\n\t[U_IDA_CodSerie] [nvarchar](10) NULL,\r\n\t[U_IDA_Serie] [nvarchar](10) NULL,\r\n\t[U_IDA_NumControl] [nvarchar](20) NULL,\r\n\t[U_IDA_TipoTrans] [nvarchar](10) NULL,\r\n\t[U_IDA_Fafe] [nvarchar](30) NULL,\r\n\t[U_IDA_CompIVA] [nvarchar](20) NULL,\r\n\t[U_IDA_NumExport] [nvarchar](50) NULL,\r\n\t[U_IDA_TipoDoc] [nvarchar](20) NULL,\r\n\t[U_IDA_NumFile] [nvarchar](50) NULL,\r\n\t[U_IDA_NumImport] [nvarchar](50) NULL,\r\n\t[U_IDA_FechaComp] [datetime] NULL,\r\n\t[U_IDA_FechaContComp] [datetime] NULL,\r\n\t[U_IDA_MontoCompIVA] [numeric](19, 6) NULL,\r\n\t[U_IDA_MontoFafe] [numeric](19, 6) NULL,\r\n\t[U_IDA_FechaFafe] [datetime] NULL,\r\n\t[U_IDA_IsPlanilla] [nvarchar](10) NULL,\r\n\t[U_IDA_PagoElectronic] [nvarchar](10) NULL,\r\n\t[U_IDA_Alicuota] [nvarchar](10) NULL,\r\n\t[U_IDA_RetenTercero] [nvarchar](10) NULL,\r\n\t[U_IDA_TipoRet] [nvarchar](10) NULL,\r\n\t[U_IDA_Tercero] [nvarchar](100) NULL,\r\n\t[U_IDA_CompMunicipal] [nvarchar](20) NULL,\r\n\t[U_IDA_DateCompMun] [datetime] NULL,\r\n\t[U_IDA_CorteZ] [nvarchar](100) NULL,\r\n\t[U_IDA_SerialImpre] [nvarchar](100) NULL,\r\n\t[U_IDA_DocAnulado] [nvarchar](10) NULL,\r\n\t[U_IDA_CompISLR] [nvarchar](20) NULL,\r\n\t[U_IDA_DateCompISLR] [datetime] NULL,\r\n\t[U_IDA_DateContISLR] [datetime] NULL,\r\n\t[DocSubType][nvarchar](2) null,\r\n\t[DiscPrcnt] [numeric](19, 6) NULL,\r\n\t[DiscSum] [numeric](19, 6) NULL,\r\n\t[DiscSumFC] [numeric](19, 6) NULL,\r\n\t[DiscSumSy] [numeric](19, 6) NULL,\r\n\t[DocTime] [smallint] NULL,\r\n\tCONSTRAINT fk_CardCodeORIN FOREIGN KEY ([CardCode]) REFERENCES [dbo].[OCRD] ([CardCode]),\r\n\tCONSTRAINT fk_UserSignORIN FOREIGN KEY ([UserSign]) REFERENCES [dbo].[OUSR] ([USERID])\r\n )\r\nGO\r\nCREATE TABLE [dbo].[RIN1](\r\n\t[DocEntry] [int] NOT NULL,\r\n\t[LineNum] [int] NOT NULL ,\t\r\n\t[LineStatus] [char](1) NULL,\r\n\t[ItemCode] [nvarchar](50) NULL,\r\n\t[Dscription] [nvarchar](100) NULL,\r\n\t[Quantity] [numeric](19, 6) NULL,\t\r\n\t[OpenQty] [numeric](19, 6) NULL,\r\n\t[Price] [numeric](19, 6) NULL,\r\n\t[Currency] [nvarchar](3) NULL,\t\r\n\t[LineTotal] [numeric](19, 6) NULL,\r\n\t[OpenSum] [numeric](19, 6) NULL,\r\n\t[OpenSumFC] [numeric](19, 6) NULL,\t\r\n\t[AcctCode] [nvarchar](15) NULL,\t\r\n\t[DocDate] [datetime] NULL,\t\r\n\t[OpenCreQty] [numeric](19, 6) NULL,\t\r\n\t[BaseCard] [nvarchar](15) NULL,\r\n\t[TotalSumSy] [numeric](19, 6) NULL,\r\n\t[OpenSumSys] [numeric](19, 6) NULL,\r\n\t[InvntSttus] [char](1) NULL,\r\n\t[VatPrcnt] [numeric](19, 6) NULL,\r\n\t[VatGroup] [nvarchar](8) NULL,\r\n\t[PriceAfVAT] [numeric](19, 6) NULL,\t\r\n\t[VatSum] [numeric](19, 6) NULL,\r\n\t[VatSumFrgn] [numeric](19, 6) NULL,\r\n\t[VatSumSy] [numeric](19, 6) NULL,\r\n\t[FinncPriod] [int] NULL,\r\n\t[ObjType] [nvarchar](20) NULL,\t\r\n\t[DedVatSum] [numeric](19, 6) NULL,\r\n\t[DedVatSumF] [numeric](19, 6) NULL,\r\n\t[DedVatSumS] [numeric](19, 6) NULL,\t\r\n\t[Address] [nvarchar](254) NULL,\t\r\n\t[VatAppld] [numeric](19, 6) NULL,\r\n\t[VatAppldFC] [numeric](19, 6) NULL,\r\n\t[VatAppldSC] [numeric](19, 6) NULL,\r\n\t[BaseQty] [numeric](19, 6) NULL,\r\n\t[BaseOpnQty] [numeric](19, 6) NULL,\r\n\t[VatDscntPr] [numeric](19, 6) NULL,\r\n\t[WtLiable] [char](1) NULL,\t\r\n\t[LineVat] [numeric](19, 6) NULL,\r\n\t[LineVatlF] [numeric](19, 6) NULL,\t\r\n\t[StockSum] [numeric](19, 6) NULL,\r\n\t[StockSumFc] [numeric](19, 6) NULL,\r\n\t[StockSumSc] [numeric](19, 6) NULL,\r\n\t[InvQty] [numeric](19, 6) NULL,\r\n\t[OpenInvQty] [numeric](19, 6) NULL,\r\n\t[GTotal] [numeric](19, 6) NULL,\r\n\t[GTotalFC] [numeric](19, 6) NULL,\r\n\t[GTotalSC] [numeric](19, 6) NULL,\r\n\t[TotalFrgn] [numeric](19, 6) NULL,\r\n\t[DataSource] [char](1) null,\r\n\t[BaseEntry] [INT] NULL,\r\n\t[NumPerMsr] [numeric](19, 6),\r\n\t[NumPerMsr2] [numeric](19, 6),\r\n\t[UomEntry] [int],\r\n\t[UomEntry2] [int],\r\n\t[UomCode] [nvarchar](20),\r\n\t[UomCode2] [nvarchar](20),\r\n\t[unitMsr] [nvarchar](100),\r\n\t[unitMsr2] [nvarchar](100),\r\n\t[StartValue] [char] (1),\r\n\t[IsTax] [char] (1),\r\n\tconstraint pk_RIN1 primary key ([DocEntry], LineNum),\r\n\tCONSTRAINT fk_UomEntryRIN1 FOREIGN KEY ([UomEntry]) REFERENCES [dbo].[OUOM] ([UomEntry]),\r\n\tCONSTRAINT fk_DocEntryRIN1 FOREIGN KEY ([DocEntry]) REFERENCES [dbo].[ORIN] ([DocEntry]),\r\n\tCONSTRAINT fk_AcctCodeRIN1 FOREIGN KEY ([AcctCode]) REFERENCES [dbo].[OACT] ([AcctCode])\r\n )\r\n\r\n GO\r\n CREATE TABLE [dbo].[ODLN](\r\n\t[DocEntry] [int] NOT NULL IDENTITY(1,1) PRIMARY KEY,\r\n\t[DocNum] [int] NULL,\r\n\t[Max1099] [numeric](19, 6) NULL,\r\n\t[DocType] [char](1) NULL,\r\n\t[CANCELED] [char](1) NULL,\t\r\n\t[DocStatus] [char](1) NULL,\r\n\t[InvntSttus] [char](1) NULL,\t\r\n\t[DocDate] [datetime] NULL,\r\n\t[DocDueDate] [datetime] NULL,\r\n\t[CardCode] [nvarchar](15) NULL,\r\n\t[CardName] [nvarchar](100) NULL,\t\r\n\t[Address] [nvarchar](254) NULL,\r\n\t[Address2] [nvarchar](254) NULL,\r\n\t[ObjType] [nvarchar](20) NULL,\r\n\t[NumAtCard] [nvarchar](100) NULL,\t\r\n\t[VatSum] [numeric](19, 6) NULL,\r\n\t[VatSumFC] [numeric](19, 6) NULL,\r\n\t[DocCur] [nvarchar](3) NULL,\t\r\n\t[NnSbAmnt] [numeric](19,6) NULL,\r\n\t[NnSbAmntSC] [numeric](19,6) NULL,\r\n\t[NbSbAmntFC] [numeric](19,6) NULL,\r\n\t[BaseAmnt] [numeric](19,6) NULL,\r\n\t[BaseAmntSC] [numeric](19,6) NULL,\r\n\t[BaseAmntFC] [numeric](19,6) NULL,\r\n\t[DocTotal] [numeric](19, 6) NULL,\r\n\t[DocTotalFC] [numeric](19, 6) NULL,\r\n\t[PaidToDate] [numeric](19, 6) NULL,\r\n\t[PaidFC] [numeric](19, 6) NULL,\t\r\n\t[Ref1] [nvarchar](11) NULL,\r\n\t[Comments] [nvarchar](254) NULL,\r\n\t[JrnlMemo] [nvarchar](50) NULL,\r\n\t[TransId] [int] NULL,\r\n\t[DocRate] [numeric](19, 6) NULL,\r\n\t[SysRate] [numeric](19, 6) NULL,\t\r\n\t[VatSumSy] [numeric](19, 6) NULL,\t\r\n\t[DocTotalSy] [numeric](19, 6) NULL,\r\n\t[PaidSys] [numeric](19, 6) NULL,\t\r\n\t[UpdateDate] [datetime] NULL,\t\r\n\t[CreateDate] [datetime] NULL,\t\r\n\t[TaxDate] [datetime] NULL,\t\r\n\t[FinncPriod] [int] NULL,\r\n\t[UserSign] [smallint] NULL,\t\r\n\t[VatPaid] [numeric](19, 6) NULL,\r\n\t[VatPaidFC] [numeric](19, 6) NULL,\r\n\t[VatPaidSys] [numeric](19, 6) NULL,\r\n\t[UserSign2] [smallint] NULL,\t\r\n\t[LicTradNum] [nvarchar](32) NULL,\t\r\n\t[WTSum] [numeric](19, 6) NULL,\r\n\t[WTSumFC] [numeric](19, 6) NULL,\r\n\t[WTSumSC] [numeric](19, 6) NULL,\t\r\n\t[WTApplied] [numeric](19, 6) NULL,\r\n\t[WTAppliedF] [numeric](19, 6) NULL,\t\r\n\t[WTAppliedS] [numeric](19, 6) NULL,\t\r\n\t[CtlAccount] [nvarchar](15) NULL,\t\r\n\t[BaseVtAt] [numeric](19, 6) NULL,\r\n\t[BaseVtAtSC] [numeric](19, 6) NULL,\r\n\t[BaseVtAtFC] [numeric](19, 6) NULL,\r\n\t[NnSbVAt] [numeric](19, 6) NULL,\r\n\t[NnSbVAtSC] [numeric](19, 6) NULL,\r\n\t[NbSbVAtFC] [numeric](19, 6) NULL,\t\r\n\t[PaidSum] [numeric](19, 6) NULL,\r\n\t[PaidSumFc] [numeric](19, 6) NULL,\r\n\t[PaidSumSc] [numeric](19, 6) NULL,\t\r\n\t[U_IDA_CodSerie] [nvarchar](10) NULL,\r\n\t[U_IDA_Serie] [nvarchar](10) NULL,\r\n\t[U_IDA_NumControl] [nvarchar](20) NULL,\r\n\t[U_IDA_TipoTrans] [nvarchar](10) NULL,\r\n\t[U_IDA_Fafe] [nvarchar](30) NULL,\r\n\t[U_IDA_CompIVA] [nvarchar](20) NULL,\r\n\t[U_IDA_NumExport] [nvarchar](50) NULL,\r\n\t[U_IDA_TipoDoc] [nvarchar](20) NULL,\r\n\t[U_IDA_NumFile] [nvarchar](50) NULL,\r\n\t[U_IDA_NumImport] [nvarchar](50) NULL,\r\n\t[U_IDA_FechaComp] [datetime] NULL,\r\n\t[U_IDA_FechaContComp] [datetime] NULL,\r\n\t[U_IDA_MontoCompIVA] [numeric](19, 6) NULL,\r\n\t[U_IDA_MontoFafe] [numeric](19, 6) NULL,\r\n\t[U_IDA_FechaFafe] [datetime] NULL,\r\n\t[U_IDA_IsPlanilla] [nvarchar](10) NULL,\r\n\t[U_IDA_PagoElectronic] [nvarchar](10) NULL,\r\n\t[U_IDA_Alicuota] [nvarchar](10) NULL,\r\n\t[U_IDA_RetenTercero] [nvarchar](10) NULL,\r\n\t[U_IDA_TipoRet] [nvarchar](10) NULL,\r\n\t[U_IDA_Tercero] [nvarchar](100) NULL,\r\n\t[U_IDA_CompMunicipal] [nvarchar](20) NULL,\r\n\t[U_IDA_DateCompMun] [datetime] NULL,\r\n\t[U_IDA_CorteZ] [nvarchar](100) NULL,\r\n\t[U_IDA_SerialImpre] [nvarchar](100) NULL,\r\n\t[U_IDA_DocAnulado] [nvarchar](10) NULL,\r\n\t[U_IDA_CompISLR] [nvarchar](20) NULL,\r\n\t[U_IDA_DateCompISLR] [datetime] NULL,\r\n\t[U_IDA_DateContISLR] [datetime] NULL,\r\n\t[DiscPrcnt] [numeric](19, 6) NULL,\r\n\t[DiscSum] [numeric](19, 6) NULL,\r\n\t[DiscSumFC] [numeric](19, 6) NULL,\r\n\t[DiscSumSy] [numeric](19, 6) NULL,\r\n\t[DocTime] [smallint] NULL,\r\n\tCONSTRAINT fk_CardCodeODLN FOREIGN KEY ([CardCode]) REFERENCES [dbo].[OCRD] ([CardCode]),\r\n\tCONSTRAINT fk_UserSignODLN FOREIGN KEY ([UserSign]) REFERENCES [dbo].[OUSR] ([USERID])\r\n\t\r\n\t\r\n)\r\nGO\r\n\tCREATE TABLE [dbo].[DLN1](\r\n\t[DocEntry] [int] NOT NULL,\r\n\t[LineNum] [int] NOT NULL ,\t\r\n\t[LineStatus] [char](1) NULL,\r\n\t[ItemCode] [nvarchar](50) NULL,\r\n\t[Dscription] [nvarchar](100) NULL,\r\n\t[Quantity] [numeric](19, 6) NULL,\t\r\n\t[OpenQty] [numeric](19, 6) NULL,\r\n\t[Price] [numeric](19, 6) NULL,\r\n\t[Currency] [nvarchar](3) NULL,\t\r\n\t[LineTotal] [numeric](19, 6) NULL,\r\n\t[OpenSum] [numeric](19, 6) NULL,\r\n\t[OpenSumFC] [numeric](19, 6) NULL,\t\r\n\t[AcctCode] [nvarchar](15) NULL,\t\r\n\t[DocDate] [datetime] NULL,\t\r\n\t[OpenCreQty] [numeric](19, 6) NULL,\t\r\n\t[BaseCard] [nvarchar](15) NULL,\r\n\t[TotalSumSy] [numeric](19, 6) NULL,\r\n\t[OpenSumSys] [numeric](19, 6) NULL,\r\n\t[InvntSttus] [char](1) NULL,\r\n\t[VatPrcnt] [numeric](19, 6) NULL,\r\n\t[VatGroup] [nvarchar](8) NULL,\r\n\t[PriceAfVAT] [numeric](19, 6) NULL,\t\r\n\t[VatSum] [numeric](19, 6) NULL,\r\n\t[VatSumFrgn] [numeric](19, 6) NULL,\r\n\t[VatSumSy] [numeric](19, 6) NULL,\r\n\t[FinncPriod] [int] NULL,\r\n\t[ObjType] [nvarchar](20) NULL,\t\r\n\t[DedVatSum] [numeric](19, 6) NULL,\r\n\t[DedVatSumF] [numeric](19, 6) NULL,\r\n\t[DedVatSumS] [numeric](19, 6) NULL,\t\r\n\t[Address] [nvarchar](254) NULL,\t\r\n\t[VatAppld] [numeric](19, 6) NULL,\r\n\t[VatAppldFC] [numeric](19, 6) NULL,\r\n\t[VatAppldSC] [numeric](19, 6) NULL,\r\n\t[BaseQty] [numeric](19, 6) NULL,\r\n\t[BaseOpnQty] [numeric](19, 6) NULL,\r\n\t[VatDscntPr] [numeric](19, 6) NULL,\r\n\t[WtLiable] [char](1) NULL,\t\r\n\t[LineVat] [numeric](19, 6) NULL,\r\n\t[LineVatlF] [numeric](19, 6) NULL,\t\r\n\t[StockSum] [numeric](19, 6) NULL,\r\n\t[StockSumFc] [numeric](19, 6) NULL,\r\n\t[StockSumSc] [numeric](19, 6) NULL,\r\n\t[InvQty] [numeric](19, 6) NULL,\r\n\t[OpenInvQty] [numeric](19, 6) NULL,\r\n\t[GTotal] [numeric](19, 6) NULL,\r\n\t[GTotalFC] [numeric](19, 6) NULL,\r\n\t[GTotalSC] [numeric](19, 6) NULL,\r\n\t[TotalFrgn] [numeric](19, 6) NULL,\r\n\t[DataSource] [char](1) null,\r\n\t[NumPerMsr] [numeric](19, 6),\r\n\t[NumPerMsr2] [numeric](19, 6),\r\n\t[UomEntry] [int],\r\n\t[UomEntry2] [int],\r\n\t[UomCode] [nvarchar](20),\r\n\t[UomCode2] [nvarchar](20),\r\n\t[unitMsr] [nvarchar](100),\r\n\t[unitMsr2] [nvarchar](100),\r\n\t[StartValue] [char] (1),\r\n\t[IsTax] [char] (1),\r\n\tCONSTRAINT fk_UomEntryDLN1 FOREIGN KEY ([UomEntry]) REFERENCES [dbo].[OUOM] ([UomEntry]),\r\n\tconstraint pk_DLN1 primary key ([DocEntry], LineNum),\r\n\tCONSTRAINT fk_DocEntryDLN1 FOREIGN KEY ([DocEntry]) REFERENCES [dbo].[ODLN] ([DocEntry]),\r\n\tCONSTRAINT fk_AcctCodeDLN1 FOREIGN KEY ([AcctCode]) REFERENCES [dbo].[OACT] ([AcctCode])\r\n )\r\n\r\n GO \r\n\r\n CREATE TABLE [dbo].[PCH5]\r\n(\r\n\t[AbsEntry] [int] NOT NULL,\r\n\t[WTCode] [nvarchar](4) NOT NULL ,\t\r\n\t[Rate] [numeric](19, 6) NULL,\r\n\t[BaseAmnt] [numeric](19, 6) NULL,\r\n\t[BaseAmntSC] [numeric](19, 6) NULL,\r\n\t[BaseAmntFC] [numeric](19, 6) NULL,\r\n\t[TaxbleAmnt] [numeric](19, 6) NULL,\r\n\t[TaxbleAmntSC] [numeric](19, 6) NULL,\r\n\t[TaxbleAmntFC] [numeric](19, 6) NULL,\t\r\n\t[WTAmnt] [numeric](19, 6) NULL,\r\n\t[WTAmntSC] [numeric](19, 6) NULL,\r\n\t[WTAmntFC] [numeric](19, 6) NULL,\r\n\t[ApplAmnt] [numeric](19, 6) NULL,\r\n\t[ApplAmntSC] [numeric](19, 6) NULL,\r\n\t[ApplAmntFC] [numeric](19, 6) NULL,\r\n\t[Category] [char](1) NULL,\r\n\t[Account] [nvarchar](15) NULL,\t\r\n\t[Type] [char](1) NULL,\r\n\t[BaseType] [char](1) NULL,\t\r\n\t[LineNum] [int] NOT NULL,\r\n\t[Status] [char](1) NULL,\r\n\t[ObjType][nvarchar](20) NULL,\r\n\tCONSTRAINT fk_DocEntryPCH5 FOREIGN KEY ([AbsEntry]) REFERENCES [dbo].[OPCH] ([DocEntry]),\r\n\tCONSTRAINT fk_WTCodeOWHT FOREIGN KEY ([WTCode]) REFERENCES [dbo].[OWHT] ([WTCode])\r\n )\r\n\r\n GO \r\n\r\n CREATE TABLE [dbo].[INV5]\r\n(\r\n\t[AbsEntry] [int] NOT NULL,\r\n\t[WTCode] [nvarchar](4) NOT NULL ,\t\r\n\t[Rate] [numeric](19, 6) NULL,\r\n\t[BaseAmnt] [numeric](19, 6) NULL,\r\n\t[BaseAmntSC] [numeric](19, 6) NULL,\r\n\t[BaseAmntFC] [numeric](19, 6) NULL,\r\n\t[TaxbleAmnt] [numeric](19, 6) NULL,\r\n\t[TaxbleAmntSC] [numeric](19, 6) NULL,\r\n\t[TaxbleAmntFC] [numeric](19, 6) NULL,\t\r\n\t[WTAmnt] [numeric](19, 6) NULL,\r\n\t[WTAmntSC] [numeric](19, 6) NULL,\r\n\t[WTAmntFC] [numeric](19, 6) NULL,\r\n\t[ApplAmnt] [numeric](19, 6) NULL,\r\n\t[ApplAmntSC] [numeric](19, 6) NULL,\r\n\t[ApplAmntFC] [numeric](19, 6) NULL,\r\n\t[Category] [char](1) NULL,\r\n\t[Account] [nvarchar](15) NULL,\t\r\n\t[Type] [char](1) NULL,\r\n\t[BaseType] [char](1) NULL,\t\r\n\t[LineNum] [int] NOT NULL,\r\n\t[Status] [char](1) NULL,\r\n\t[ObjType][nvarchar](20) NULL,\r\n\tCONSTRAINT fk_DocEntryINV5 FOREIGN KEY ([AbsEntry]) REFERENCES [dbo].[OINV] ([DocEntry]),\r\n\tCONSTRAINT fk_WTCodeOWHT1 FOREIGN KEY ([WTCode]) REFERENCES [dbo].[OWHT] ([WTCode])\r\n )\r\n\r\n GO \r\n\r\n  CREATE TABLE [dbo].[RPC5]\r\n(\r\n\t[AbsEntry] [int] NOT NULL,\r\n\t[WTCode] [nvarchar](4) NOT NULL ,\t\r\n\t[Rate] [numeric](19, 6) NULL,\r\n\t[BaseAmnt] [numeric](19, 6) NULL,\r\n\t[BaseAmntSC] [numeric](19, 6) NULL,\r\n\t[BaseAmntFC] [numeric](19, 6) NULL,\r\n\t[TaxbleAmnt] [numeric](19, 6) NULL,\r\n\t[TaxbleAmntSC] [numeric](19, 6) NULL,\r\n\t[TaxbleAmntFC] [numeric](19, 6) NULL,\t\r\n\t[WTAmnt] [numeric](19, 6) NULL,\r\n\t[WTAmntSC] [numeric](19, 6) NULL,\r\n\t[WTAmntFC] [numeric](19, 6) NULL,\r\n\t[ApplAmnt] [numeric](19, 6) NULL,\r\n\t[ApplAmntSC] [numeric](19, 6) NULL,\r\n\t[ApplAmntFC] [numeric](19, 6) NULL,\r\n\t[Category] [char](1) NULL,\r\n\t[Account] [nvarchar](15) NULL,\t\r\n\t[Type] [char](1) NULL,\r\n\t[BaseType] [char](1) NULL,\t\r\n\t[LineNum] [int] NOT NULL,\r\n\t[Status] [char](1) NULL,\r\n\t[ObjType][nvarchar](20) NULL,\r\n\tCONSTRAINT fk_DocEntryRPC5 FOREIGN KEY ([AbsEntry]) REFERENCES [dbo].[ORPC] ([DocEntry]),\r\n\tCONSTRAINT fk_WTCodeOWHT2 FOREIGN KEY ([WTCode]) REFERENCES [dbo].[OWHT] ([WTCode])\r\n )\r\n\r\n GO\r\n CREATE TABLE [dbo].[RIN5]\r\n(\r\n\t[AbsEntry] [int] NOT NULL,\r\n\t[WTCode] [nvarchar](4) NOT NULL ,\t\r\n\t[Rate] [numeric](19, 6) NULL,\r\n\t[BaseAmnt] [numeric](19, 6) NULL,\r\n\t[BaseAmntSC] [numeric](19, 6) NULL,\r\n\t[BaseAmntFC] [numeric](19, 6) NULL,\r\n\t[TaxbleAmnt] [numeric](19, 6) NULL,\r\n\t[TaxbleAmntSC] [numeric](19, 6) NULL,\r\n\t[TaxbleAmntFC] [numeric](19, 6) NULL,\t\r\n\t[WTAmnt] [numeric](19, 6) NULL,\r\n\t[WTAmntSC] [numeric](19, 6) NULL,\r\n\t[WTAmntFC] [numeric](19, 6) NULL,\r\n\t[ApplAmnt] [numeric](19, 6) NULL,\r\n\t[ApplAmntSC] [numeric](19, 6) NULL,\r\n\t[ApplAmntFC] [numeric](19, 6) NULL,\r\n\t[Category] [char](1) NULL,\r\n\t[Account] [nvarchar](15) NULL,\t\r\n\t[Type] [char](1) NULL,\r\n\t[BaseType] [char](1) NULL,\t\r\n\t[LineNum] [int] NOT NULL,\r\n\t[Status] [char](1) NULL,\r\n\t[ObjType][nvarchar](20) NULL,\r\n\tCONSTRAINT fk_DocEntryRIN5 FOREIGN KEY ([AbsEntry]) REFERENCES [dbo].[ORIN] ([DocEntry]),\r\n\tCONSTRAINT fk_WTCodeOWHT3 FOREIGN KEY ([WTCode]) REFERENCES [dbo].[OWHT] ([WTCode])\r\n )\r\n GO\r\n CREATE TABLE [dbo].[PDN5]\r\n(\r\n\t[AbsEntry] [int] NOT NULL,\r\n\t[WTCode] [nvarchar](4) NOT NULL ,\t\r\n\t[Rate] [numeric](19, 6) NULL,\r\n\t[BaseAmnt] [numeric](19, 6) NULL,\r\n\t[BaseAmntSC] [numeric](19, 6) NULL,\r\n\t[BaseAmntFC] [numeric](19, 6) NULL,\r\n\t[TaxbleAmnt] [numeric](19, 6) NULL,\r\n\t[TaxbleAmntSC] [numeric](19, 6) NULL,\r\n\t[TaxbleAmntFC] [numeric](19, 6) NULL,\t\r\n\t[WTAmnt] [numeric](19, 6) NULL,\r\n\t[WTAmntSC] [numeric](19, 6) NULL,\r\n\t[WTAmntFC] [numeric](19, 6) NULL,\r\n\t[ApplAmnt] [numeric](19, 6) NULL,\r\n\t[ApplAmntSC] [numeric](19, 6) NULL,\r\n\t[ApplAmntFC] [numeric](19, 6) NULL,\r\n\t[Category] [char](1) NULL,\r\n\t[Account] [nvarchar](15) NULL,\t\r\n\t[Type] [char](1) NULL,\r\n\t[BaseType] [char](1) NULL,\t\r\n\t[LineNum] [int] NOT NULL,\r\n\t[Status] [char](1) NULL,\r\n\t[ObjType][nvarchar](20) NULL,\r\n\tCONSTRAINT fk_DocEntryPDN5 FOREIGN KEY ([AbsEntry]) REFERENCES [dbo].[OPDN] ([DocEntry]),\r\n\tCONSTRAINT fk_WTCodeOWHT5 FOREIGN KEY ([WTCode]) REFERENCES [dbo].[OWHT] ([WTCode])\r\n )\r\n\r\n GO\r\n CREATE TABLE [dbo].[DLN5]\r\n(\r\n\t[AbsEntry] [int] NOT NULL,\r\n\t[WTCode] [nvarchar](4) NOT NULL ,\t\r\n\t[Rate] [numeric](19, 6) NULL,\r\n\t[BaseAmnt] [numeric](19, 6) NULL,\r\n\t[BaseAmntSC] [numeric](19, 6) NULL,\r\n\t[BaseAmntFC] [numeric](19, 6) NULL,\r\n\t[TaxbleAmnt] [numeric](19, 6) NULL,\r\n\t[TaxbleAmntSC] [numeric](19, 6) NULL,\r\n\t[TaxbleAmntFC] [numeric](19, 6) NULL,\t\r\n\t[WTAmnt] [numeric](19, 6) NULL,\r\n\t[WTAmntSC] [numeric](19, 6) NULL,\r\n\t[WTAmntFC] [numeric](19, 6) NULL,\r\n\t[ApplAmnt] [numeric](19, 6) NULL,\r\n\t[ApplAmntSC] [numeric](19, 6) NULL,\r\n\t[ApplAmntFC] [numeric](19, 6) NULL,\r\n\t[Category] [char](1) NULL,\r\n\t[Account] [nvarchar](15) NULL,\t\r\n\t[Type] [char](1) NULL,\r\n\t[BaseType] [char](1) NULL,\t\r\n\t[LineNum] [int] NOT NULL,\r\n\t[Status] [char](1) NULL,\r\n\t[ObjType][nvarchar](20) NULL,\r\n\tCONSTRAINT fk_DocEntryDLN5 FOREIGN KEY ([AbsEntry]) REFERENCES [dbo].[ODLN] ([DocEntry]),\r\n\tCONSTRAINT fk_WTCodeOWHT4 FOREIGN KEY ([WTCode]) REFERENCES [dbo].[OWHT] ([WTCode])\r\n )\r\n\r\n GO\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE TABLE [dbo].[ORCT](\r\n\t[DocEntry] [int] NOT NULL IDENTITY(1,1) PRIMARY KEY,\r\n\t[DocNum] [int] NOT NULL,\r\n\t[DocType] [char](1) NULL,\r\n\t[Canceled] [char](1) NULL,\t\r\n\t[DocDate] [datetime] NULL,\r\n\t[DocDueDate] [datetime] NULL,\r\n\t[CardCode] [nvarchar](15) NULL,\r\n\t[CardName] [nvarchar](100) NULL,\r\n\t[Address] [nvarchar](254) NULL,\t\r\n\t[CashAcct] [nvarchar](15) NULL,\r\n\t[CashSum] [numeric](19, 6) NULL,\r\n\t[CashSumFC] [numeric](19, 6) NULL,\r\n\t[CreditSum] [numeric](19, 6) NULL,\r\n\t[CredSumFC] [numeric](19, 6) NULL,\r\n\t[CheckAcct] [nvarchar](15) NULL,\r\n\t[CheckSum] [numeric](19, 6) NULL,\r\n\t[CheckSumFC] [numeric](19, 6) NULL,\r\n\t[TrsfrAcct] [nvarchar](15) NULL,\r\n\t[TrsfrSum] [numeric](19, 6) NULL,\r\n\t[TrsfrSumFC] [numeric](19, 6) NULL,\r\n\t[TrsfrDate] [datetime] NULL,\r\n\t[TrsfrRef] [nvarchar](27) NULL,\r\n\t[PayNoDoc] [char](1) NULL,\r\n\t[NoDocSum] [numeric](19, 6) NULL,\r\n\t[NoDocSumFC] [numeric](19, 6) NULL,\t\r\n\t[DiffCurr] [char](1) NULL,\r\n\t[DocRate] [numeric](19, 6) NULL,\r\n\t[SysRate] [numeric](19, 6) NULL,\r\n\t[DocTotal] [numeric](19, 6) NULL,\r\n\t[DocTotalFC] [numeric](19, 6) NULL,\r\n\t[Ref1] [nvarchar](11) NULL,\t\r\n\t[CounterRef] [nvarchar](8) NULL,\r\n\t[Comments] [nvarchar](254) NULL,\r\n\t[JrnlMemo] [nvarchar](50) NULL,\r\n\t[TransId] [int] NULL,\t\r\n\t[CntctCode] [int] NULL,\t\r\n\t[CashSumSy] [numeric](19, 6) NULL,\r\n\t[CredSumSy] [numeric](19, 6) NULL,\r\n\t[CheckSumSy] [numeric](19, 6) NULL,\r\n\t[TrsfrSumSy] [numeric](19, 6) NULL,\r\n\t[NoDocSumSy] [numeric](19, 6) NULL,\r\n\t[DocTotalSy] [numeric](19, 6) NULL,\r\n\t[ObjType] [nvarchar](20) NULL,\t\r\n\t[UpdateDate] [datetime] NULL,\r\n\t[CreateDate] [datetime] NULL,\t\r\n\t[TaxDate] [datetime] NULL,\t\r\n\t[DataSource] [char](1) NULL,\r\n\t[UserSign] [smallint] NULL,\t\r\n\t[VatGroup] [nvarchar](8) NULL,\r\n\t[VatSum] [numeric](19, 6) NULL,\r\n\t[VatSumFC] [numeric](19, 6) NULL,\r\n\t[VatSumSy] [numeric](19, 6) NULL,\r\n\t[FinncPriod] [int] NULL,\r\n\t[VatPrcnt] [numeric](19, 6) NULL,\t\t\r\n\t[WtCode] [nvarchar](4) NULL,\r\n\t[WtSum] [numeric](19, 6) NULL,\r\n\t[WtSumFrgn] [numeric](19, 6) NULL,\r\n\t[WtSumSys] [numeric](19, 6) NULL,\r\n\t[WtAccount] [nvarchar](15) NULL,\r\n\t[WtBaseAmnt] [numeric](19, 6) NULL,\t\r\n\t[BpAct] [nvarchar](15) NULL,\r\n\t[BcgSum] [numeric](19, 6) NULL,\r\n\t[BcgSumFC] [numeric](19, 6) NULL,\r\n\t[BcgSumSy] [numeric](19, 6) NULL,\t\r\n\t[WtBaseSum] [numeric](19, 6) NULL,\r\n\t[WtBaseSumF] [numeric](19, 6) NULL,\r\n\t[WtBaseSumS] [numeric](19, 6) NULL,\t\r\n\t[VatDate] [datetime] NULL,\t\r\n\t[CancelDate] [datetime] NULL,\t\r\n\t[UserSign2] [smallint] NULL,\t\r\n\t[U_IDA_TransIdDebit] [int] NULL,\r\n\t[U_IDA_TransIdDebAnu] [int] NULL,\r\n\t[U_IDA_CostingCode] [nvarchar](30) NULL,\r\n\t[U_NX_IdAsiento] [int] NULL,\r\n\t[U_NX_IdND] [int] NULL,\r\n\t[U_NX_IdNC] [int] NULL,\r\n\t[DocCurr] [nvarchar](3) NULL,\r\n\tCONSTRAINT fk_CardCodeORCT FOREIGN KEY ([CardCode]) REFERENCES [dbo].[OCRD] ([CardCode]),\r\n\tCONSTRAINT fk_UserSignORCT FOREIGN KEY ([UserSign]) REFERENCES [dbo].[OUSR] ([USERID]),\r\n\tCONSTRAINT fk_AcctCodeORCT FOREIGN KEY ([BpAct]) REFERENCES [dbo].[OACT] ([AcctCode])\r\n)\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE TABLE [dbo].[OVPM](\r\n\t[DocEntry] [int] NOT NULL IDENTITY(1,1) PRIMARY KEY,\r\n\t[DocNum] [int] NOT NULL,\r\n\t[DocType] [char](1) NULL,\r\n\t[Canceled] [char](1) NULL,\t\r\n\t[DocDate] [datetime] NULL,\r\n\t[DocDueDate] [datetime] NULL,\r\n\t[CardCode] [nvarchar](15) NULL,\r\n\t[CardName] [nvarchar](100) NULL,\r\n\t[Address] [nvarchar](254) NULL,\t\r\n\t[CashAcct] [nvarchar](15) NULL,\r\n\t[CashSum] [numeric](19, 6) NULL,\r\n\t[CashSumFC] [numeric](19, 6) NULL,\r\n\t[CreditSum] [numeric](19, 6) NULL,\r\n\t[CredSumFC] [numeric](19, 6) NULL,\r\n\t[CheckAcct] [nvarchar](15) NULL,\r\n\t[CheckSum] [numeric](19, 6) NULL,\r\n\t[CheckSumFC] [numeric](19, 6) NULL,\r\n\t[TrsfrAcct] [nvarchar](15) NULL,\r\n\t[TrsfrSum] [numeric](19, 6) NULL,\r\n\t[TrsfrSumFC] [numeric](19, 6) NULL,\r\n\t[TrsfrDate] [datetime] NULL,\r\n\t[TrsfrRef] [nvarchar](27) NULL,\r\n\t[PayNoDoc] [char](1) NULL,\r\n\t[NoDocSum] [numeric](19, 6) NULL,\r\n\t[NoDocSumFC] [numeric](19, 6) NULL,\t\r\n\t[DiffCurr] [char](1) NULL,\r\n\t[DocRate] [numeric](19, 6) NULL,\r\n\t[SysRate] [numeric](19, 6) NULL,\r\n\t[DocTotal] [numeric](19, 6) NULL,\r\n\t[DocTotalFC] [numeric](19, 6) NULL,\r\n\t[Ref1] [nvarchar](11) NULL,\t\r\n\t[CounterRef] [nvarchar](8) NULL,\r\n\t[Comments] [nvarchar](254) NULL,\r\n\t[JrnlMemo] [nvarchar](50) NULL,\r\n\t[TransId] [int] NULL,\t\r\n\t[CntctCode] [int] NULL,\t\r\n\t[CashSumSy] [numeric](19, 6) NULL,\r\n\t[CredSumSy] [numeric](19, 6) NULL,\r\n\t[CheckSumSy] [numeric](19, 6) NULL,\r\n\t[TrsfrSumSy] [numeric](19, 6) NULL,\r\n\t[NoDocSumSy] [numeric](19, 6) NULL,\r\n\t[DocTotalSy] [numeric](19, 6) NULL,\r\n\t[ObjType] [nvarchar](20) NULL,\t\r\n\t[UpdateDate] [datetime] NULL,\r\n\t[CreateDate] [datetime] NULL,\t\r\n\t[TaxDate] [datetime] NULL,\t\r\n\t[DataSource] [char](1) NULL,\r\n\t[UserSign] [smallint] NULL,\t\r\n\t[VatGroup] [nvarchar](8) NULL,\r\n\t[VatSum] [numeric](19, 6) NULL,\r\n\t[VatSumFC] [numeric](19, 6) NULL,\r\n\t[VatSumSy] [numeric](19, 6) NULL,\r\n\t[FinncPriod] [int] NULL,\r\n\t[VatPrcnt] [numeric](19, 6) NULL,\t\t\r\n\t[WtCode] [nvarchar](4) NULL,\r\n\t[WtSum] [numeric](19, 6) NULL,\r\n\t[WtSumFrgn] [numeric](19, 6) NULL,\r\n\t[WtSumSys] [numeric](19, 6) NULL,\r\n\t[WtAccount] [nvarchar](15) NULL,\r\n\t[WtBaseAmnt] [numeric](19, 6) NULL,\t\r\n\t[BpAct] [nvarchar](15) NULL,\r\n\t[BcgSum] [numeric](19, 6) NULL,\r\n\t[BcgSumFC] [numeric](19, 6) NULL,\r\n\t[BcgSumSy] [numeric](19, 6) NULL,\t\r\n\t[WtBaseSum] [numeric](19, 6) NULL,\r\n\t[WtBaseSumF] [numeric](19, 6) NULL,\r\n\t[WtBaseSumS] [numeric](19, 6) NULL,\t\r\n\t[VatDate] [datetime] NULL,\t\r\n\t[CancelDate] [datetime] NULL,\t\r\n\t[UserSign2] [smallint] NULL,\t\r\n\t[U_IDA_TransIdDebit] [int] NULL,\r\n\t[U_IDA_TransIdDebAnu] [int] NULL,\r\n\t[U_IDA_CostingCode] [nvarchar](30) NULL,\r\n\t[U_NX_IdAsiento] [int] NULL,\r\n\t[U_NX_IdND] [int] NULL,\r\n\t[U_NX_IdNC] [int] NULL,\r\n\t[DocCurr] [nvarchar](3) NULL,\r\n\tCONSTRAINT fk_CardCodeOVPM FOREIGN KEY ([CardCode]) REFERENCES [dbo].[OCRD] ([CardCode]),\r\n\tCONSTRAINT fk_UserSignOVPM FOREIGN KEY ([UserSign]) REFERENCES [dbo].[OUSR] ([USERID]),\r\n\tCONSTRAINT fk_AcctCodeOVPM FOREIGN KEY ([BpAct]) REFERENCES [dbo].[OACT] ([AcctCode])\r\n)\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE TABLE [dbo].[RCT2](\r\n\t[DocNum] [int] NOT NULL,\r\n\t[InvoiceId] [int] NOT NULL,\r\n\t[DocEntry] [int] NULL,\r\n\t[SumApplied] [numeric](19, 6) NULL,\r\n\t[AppliedFC] [numeric](19, 6) NULL,\r\n\t[AppliedSys] [numeric](19, 6) NULL,\r\n\t[InvType] [nvarchar](20) NULL,\r\n\t[DocRate] [numeric](19, 6) NULL,\t\r\n\t[DocLine] [int] NULL,\r\n\t[vatApplied] [numeric](19, 6) NULL,\r\n\t[vatAppldFC] [numeric](19, 6) NULL,\r\n\t[vatAppldSy] [numeric](19, 6) NULL,\r\n\t[selfInv] [char](1) NULL,\r\n\t[ObjType] [nvarchar](20) NULL,\t\r\n\t[BfDcntSum] [numeric](19, 6) NULL,\r\n\t[BfDcntSumF] [numeric](19, 6) NULL,\r\n\t[BfDcntSumS] [numeric](19, 6) NULL,\r\n\t[BfNetDcnt] [numeric](19, 6) NULL,\r\n\t[BfNetDcntF] [numeric](19, 6) NULL,\r\n\t[BfNetDcntS] [numeric](19, 6) NULL,\r\n\t[PaidSum] [numeric](19, 6) NULL,\t\r\n\t[WtAppld] [numeric](19, 6) NULL,\r\n\t[WtAppldFC] [numeric](19, 6) NULL,\r\n\t[WtAppldSC] [numeric](19, 6) NULL,\t\r\n\t[WtInvCatS] [numeric](19, 6) NULL,\r\n\t[WtInvCatSF] [numeric](19, 6) NULL,\r\n\t[WtInvCatSS] [numeric](19, 6) NULL,\t\r\n\t[DocTransId] [int] NULL,\t\r\n\t[baseAbs] [int] NULL,\r\n\t[DocSubType] [nvarchar](2) NULL,\t\r\n\t[U_IDA_CompIVA] [nvarchar](20) NULL,\r\n\t[U_IDA_FechaComp] [datetime] NULL,\r\n\t[U_IDA_MontoCompIVA] [numeric](19, 6) NULL,\r\n\t[U_IDA_CompISLR] [nvarchar](20) NULL,\r\n\t[U_IDA_DateCompISLR] [datetime] NULL,\r\n\tCONSTRAINT fk_DocEntryRCT2 FOREIGN KEY ([DocNum]) REFERENCES [dbo].[ORCT] ([DocEntry]),\r\n)\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE TABLE [dbo].[VPM2](\r\n\t[DocNum] [int] NOT NULL,\r\n\t[InvoiceId] [int] NOT NULL,\r\n\t[DocEntry] [int] NULL,\r\n\t[SumApplied] [numeric](19, 6) NULL,\r\n\t[AppliedFC] [numeric](19, 6) NULL,\r\n\t[AppliedSys] [numeric](19, 6) NULL,\r\n\t[InvType] [nvarchar](20) NULL,\r\n\t[DocRate] [numeric](19, 6) NULL,\t\r\n\t[DocLine] [int] NULL,\r\n\t[vatApplied] [numeric](19, 6) NULL,\r\n\t[vatAppldFC] [numeric](19, 6) NULL,\r\n\t[vatAppldSy] [numeric](19, 6) NULL,\r\n\t[selfInv] [char](1) NULL,\r\n\t[ObjType] [nvarchar](20) NULL,\t\r\n\t[BfDcntSum] [numeric](19, 6) NULL,\r\n\t[BfDcntSumF] [numeric](19, 6) NULL,\r\n\t[BfDcntSumS] [numeric](19, 6) NULL,\r\n\t[BfNetDcnt] [numeric](19, 6) NULL,\r\n\t[BfNetDcntF] [numeric](19, 6) NULL,\r\n\t[BfNetDcntS] [numeric](19, 6) NULL,\r\n\t[PaidSum] [numeric](19, 6) NULL,\t\r\n\t[WtAppld] [numeric](19, 6) NULL,\r\n\t[WtAppldFC] [numeric](19, 6) NULL,\r\n\t[WtAppldSC] [numeric](19, 6) NULL,\t\r\n\t[WtInvCatS] [numeric](19, 6) NULL,\r\n\t[WtInvCatSF] [numeric](19, 6) NULL,\r\n\t[WtInvCatSS] [numeric](19, 6) NULL,\t\r\n\t[DocTransId] [int] NULL,\t\r\n\t[baseAbs] [int] NULL,\r\n\t[DocSubType] [nvarchar](2) NULL,\t\r\n\t[U_IDA_CompIVA] [nvarchar](20) NULL,\r\n\t[U_IDA_FechaComp] [datetime] NULL,\r\n\t[U_IDA_MontoCompIVA] [numeric](19, 6) NULL,\r\n\t[U_IDA_CompISLR] [nvarchar](20) NULL,\r\n\t[U_IDA_DateCompISLR] [datetime] NULL,\r\n\tCONSTRAINT fk_DocEntryVPM2 FOREIGN KEY ([DocNum]) REFERENCES [dbo].[OVPM] ([DocEntry]),\r\n )\r\n\r\n SET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE TABLE [dbo].[INV3](\r\n\t[DocEntry] [int] NOT NULL,\r\n\t[ExpnsCode] [int] NULL,\r\n\t[LineTotal] [numeric](19, 6) NULL,\r\n\t[TotalFrgn] [numeric](19, 6) NULL,\r\n\t[TotalSumSy] [numeric](19, 6) NULL,\r\n\t[PaidToDate] [numeric](19, 6) NULL,\r\n\t[PaidFC] [numeric](19, 6) NULL,\r\n\t[PaidSys] [numeric](19, 6) NULL,\r\n\t[Comments] [nvarchar](100) NULL,\r\n\t[ObjType] [nvarchar](20) NULL,\r\n\t[LogInstanc] [int] NULL,\r\n\t[DistrbMthd] [char](1) NULL,\r\n\t[TaxStatus] [char](1) NULL,\r\n\t[VatGroup] [nvarchar](8) NULL,\r\n\t[VatPrcnt] [numeric](19, 6) NULL,\r\n\t[VatSum] [numeric](19, 6) NULL,\r\n\t[VatSumFrgn] [numeric](19, 6) NULL,\r\n\t[VatSumSy] [numeric](19, 6) NULL,\r\n\t[DedVatSum] [numeric](19, 6) NULL,\r\n\t[DedVatSumF] [numeric](19, 6) NULL,\r\n\t[DedVatSumS] [numeric](19, 6) NULL,\r\n\t[IsAcquistn] [char](1) NULL,\r\n\t[TaxCode] [nvarchar](8) NULL,\r\n\t[TaxType] [char](1) NULL,\r\n\t[WTLiable] [char](1) NULL,\r\n\t[VatApplied] [numeric](19, 6) NULL,\r\n\t[VatAppldFC] [numeric](19, 6) NULL,\r\n\t[VatAppldSC] [numeric](19, 6) NULL,\r\n\t[EquVatPer] [numeric](19, 6) NULL,\r\n\t[EquVatSum] [numeric](19, 6) NULL,\r\n\t[EquVatSumF] [numeric](19, 6) NULL,\r\n\t[EquVatSumS] [numeric](19, 6) NULL,\r\n\t[LineVat] [numeric](19, 6) NULL,\r\n\t[LineVatF] [numeric](19, 6) NULL,\r\n\t[LineVatS] [numeric](19, 6) NULL,\r\n\t[BaseMethod] [char](1) NULL,\r\n\t[Stock] [char](1) NULL,\r\n\t[LstPchPrce] [char](1) NULL,\r\n\t[AnalysRpt] [char](1) NULL,\r\n\t[BaseAbsEnt] [int] NULL,\r\n\t[BaseType] [int] NULL,\r\n\t[BaseRef] [int] NULL,\r\n\t[BaseLnNum] [int] NULL,\r\n\t[LineNum] [int] NOT NULL,\r\n\t[Status] [char](1) NULL,\r\n\t[TrgType] [int] NULL,\r\n\t[TrgAbsEnt] [int] NULL,\r\n\t[StDstr] [numeric](19, 6) NULL,\r\n\t[StDstrSC] [numeric](19, 6) NULL,\r\n\t[StDstrFC] [numeric](19, 6) NULL,\r\n\t[FixCurr] [nvarchar](3) NULL,\r\n\t[VatDscntPr] [numeric](19, 6) NULL,\r\n\t[OcrCode] [nvarchar](8) NULL,\r\n\t[TaxDistMtd] [char](1) NULL,\r\n\t[OcrCode2] [nvarchar](8) NULL,\r\n\t[OcrCode3] [nvarchar](8) NULL,\r\n\t[OcrCode4] [nvarchar](8) NULL,\r\n\t[OcrCode5] [nvarchar](8) NULL,\r\n\t[Project] [nvarchar](20) NULL,\r\n\t[VatGrpSrc] [char](1) NULL,\r\n\t[DrawnTotal] [numeric](19, 6) NULL,\r\n\t[DrawnFC] [numeric](19, 6) NULL,\r\n\t[DrawnSC] [numeric](19, 6) NULL,\r\n\t[GrsAmount] [numeric](19, 6) NULL,\r\n\t[GrsFC] [numeric](19, 6) NULL,\r\n\t[GrsSC] [numeric](19, 6) NULL,\r\n\t[BaseTotal] [char](1) NULL,\r\n\t[RetReqLC] [numeric](19, 6) NULL,\r\n\t[RetReqFC] [numeric](19, 6) NULL,\r\n\t[RetReqSC] [numeric](19, 6) NULL,\r\n\t[RRVatLC] [numeric](19, 6) NULL,\r\n\t[RRVatFC] [numeric](19, 6) NULL,\r\n\t[RRVatSC] [numeric](19, 6) NULL,\r\nCONSTRAINT fk_INV3_PRIMARY FOREIGN KEY ([DocEntry]) REFERENCES [dbo].[OINV] ([DocEntry]),\r\n)\r\nGO\r\n/****** Object:  Table [dbo].[PCH3]    Script Date: 15/6/2020 5:30:36 p. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE TABLE [dbo].[PCH3](\r\n\t[DocEntry] [int] NOT NULL,\r\n\t[ExpnsCode] [int] NULL,\r\n\t[LineTotal] [numeric](19, 6) NULL,\r\n\t[TotalFrgn] [numeric](19, 6) NULL,\r\n\t[TotalSumSy] [numeric](19, 6) NULL,\r\n\t[PaidToDate] [numeric](19, 6) NULL,\r\n\t[PaidFC] [numeric](19, 6) NULL,\r\n\t[PaidSys] [numeric](19, 6) NULL,\r\n\t[Comments] [nvarchar](100) NULL,\r\n\t[ObjType] [nvarchar](20) NULL,\r\n\t[LogInstanc] [int] NULL,\r\n\t[DistrbMthd] [char](1) NULL,\r\n\t[TaxStatus] [char](1) NULL,\r\n\t[VatGroup] [nvarchar](8) NULL,\r\n\t[VatPrcnt] [numeric](19, 6) NULL,\r\n\t[VatSum] [numeric](19, 6) NULL,\r\n\t[VatSumFrgn] [numeric](19, 6) NULL,\r\n\t[VatSumSy] [numeric](19, 6) NULL,\r\n\t[DedVatSum] [numeric](19, 6) NULL,\r\n\t[DedVatSumF] [numeric](19, 6) NULL,\r\n\t[DedVatSumS] [numeric](19, 6) NULL,\r\n\t[IsAcquistn] [char](1) NULL,\r\n\t[TaxCode] [nvarchar](8) NULL,\r\n\t[TaxType] [char](1) NULL,\r\n\t[WTLiable] [char](1) NULL,\r\n\t[VatApplied] [numeric](19, 6) NULL,\r\n\t[VatAppldFC] [numeric](19, 6) NULL,\r\n\t[VatAppldSC] [numeric](19, 6) NULL,\r\n\t[EquVatPer] [numeric](19, 6) NULL,\r\n\t[EquVatSum] [numeric](19, 6) NULL,\r\n\t[EquVatSumF] [numeric](19, 6) NULL,\r\n\t[EquVatSumS] [numeric](19, 6) NULL,\r\n\t[LineVat] [numeric](19, 6) NULL,\r\n\t[LineVatF] [numeric](19, 6) NULL,\r\n\t[LineVatS] [numeric](19, 6) NULL,\r\n\t[BaseMethod] [char](1) NULL,\r\n\t[Stock] [char](1) NULL,\r\n\t[LstPchPrce] [char](1) NULL,\r\n\t[AnalysRpt] [char](1) NULL,\r\n\t[BaseAbsEnt] [int] NULL,\r\n\t[BaseType] [int] NULL,\r\n\t[BaseRef] [int] NULL,\r\n\t[BaseLnNum] [int] NULL,\r\n\t[LineNum] [int] NOT NULL,\r\n\t[Status] [char](1) NULL,\r\n\t[TrgType] [int] NULL,\r\n\t[TrgAbsEnt] [int] NULL,\r\n\t[StDstr] [numeric](19, 6) NULL,\r\n\t[StDstrSC] [numeric](19, 6) NULL,\r\n\t[StDstrFC] [numeric](19, 6) NULL,\r\n\t[FixCurr] [nvarchar](3) NULL,\r\n\t[VatDscntPr] [numeric](19, 6) NULL,\r\n\t[OcrCode] [nvarchar](8) NULL,\r\n\t[TaxDistMtd] [char](1) NULL,\r\n\t[OcrCode2] [nvarchar](8) NULL,\r\n\t[OcrCode3] [nvarchar](8) NULL,\r\n\t[OcrCode4] [nvarchar](8) NULL,\r\n\t[OcrCode5] [nvarchar](8) NULL,\r\n\t[Project] [nvarchar](20) NULL,\r\n\t[VatGrpSrc] [char](1) NULL,\r\n\t[DrawnTotal] [numeric](19, 6) NULL,\r\n\t[DrawnFC] [numeric](19, 6) NULL,\r\n\t[DrawnSC] [numeric](19, 6) NULL,\r\n\t[GrsAmount] [numeric](19, 6) NULL,\r\n\t[GrsFC] [numeric](19, 6) NULL,\r\n\t[GrsSC] [numeric](19, 6) NULL,\r\n\t[BaseTotal] [char](1) NULL,\r\n\t[RetReqLC] [numeric](19, 6) NULL,\r\n\t[RetReqFC] [numeric](19, 6) NULL,\r\n\t[RetReqSC] [numeric](19, 6) NULL,\r\n\t[RRVatLC] [numeric](19, 6) NULL,\r\n\t[RRVatFC] [numeric](19, 6) NULL,\r\n\t[RRVatSC] [numeric](19, 6) NULL,\r\nCONSTRAINT fk_PCH3_PRIMARY FOREIGN KEY ([DocEntry]) REFERENCES [dbo].[OPCH] ([DocEntry]),\r\n)\r\nGO\r\n/****** Object:  Table [dbo].[RIN3]    Script Date: 15/6/2020 5:30:36 p. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE TABLE [dbo].[RIN3](\r\n\t[DocEntry] [int] NOT NULL,\r\n\t[ExpnsCode] [int] NULL,\r\n\t[LineTotal] [numeric](19, 6) NULL,\r\n\t[TotalFrgn] [numeric](19, 6) NULL,\r\n\t[TotalSumSy] [numeric](19, 6) NULL,\r\n\t[PaidToDate] [numeric](19, 6) NULL,\r\n\t[PaidFC] [numeric](19, 6) NULL,\r\n\t[PaidSys] [numeric](19, 6) NULL,\r\n\t[Comments] [nvarchar](100) NULL,\r\n\t[ObjType] [nvarchar](20) NULL,\r\n\t[LogInstanc] [int] NULL,\r\n\t[DistrbMthd] [char](1) NULL,\r\n\t[TaxStatus] [char](1) NULL,\r\n\t[VatGroup] [nvarchar](8) NULL,\r\n\t[VatPrcnt] [numeric](19, 6) NULL,\r\n\t[VatSum] [numeric](19, 6) NULL,\r\n\t[VatSumFrgn] [numeric](19, 6) NULL,\r\n\t[VatSumSy] [numeric](19, 6) NULL,\r\n\t[DedVatSum] [numeric](19, 6) NULL,\r\n\t[DedVatSumF] [numeric](19, 6) NULL,\r\n\t[DedVatSumS] [numeric](19, 6) NULL,\r\n\t[IsAcquistn] [char](1) NULL,\r\n\t[TaxCode] [nvarchar](8) NULL,\r\n\t[TaxType] [char](1) NULL,\r\n\t[WTLiable] [char](1) NULL,\r\n\t[VatApplied] [numeric](19, 6) NULL,\r\n\t[VatAppldFC] [numeric](19, 6) NULL,\r\n\t[VatAppldSC] [numeric](19, 6) NULL,\r\n\t[EquVatPer] [numeric](19, 6) NULL,\r\n\t[EquVatSum] [numeric](19, 6) NULL,\r\n\t[EquVatSumF] [numeric](19, 6) NULL,\r\n\t[EquVatSumS] [numeric](19, 6) NULL,\r\n\t[LineVat] [numeric](19, 6) NULL,\r\n\t[LineVatF] [numeric](19, 6) NULL,\r\n\t[LineVatS] [numeric](19, 6) NULL,\r\n\t[BaseMethod] [char](1) NULL,\r\n\t[Stock] [char](1) NULL,\r\n\t[LstPchPrce] [char](1) NULL,\r\n\t[AnalysRpt] [char](1) NULL,\r\n\t[BaseAbsEnt] [int] NULL,\r\n\t[BaseType] [int] NULL,\r\n\t[BaseRef] [int] NULL,\r\n\t[BaseLnNum] [int] NULL,\r\n\t[LineNum] [int] NOT NULL,\r\n\t[Status] [char](1) NULL,\r\n\t[TrgType] [int] NULL,\r\n\t[TrgAbsEnt] [int] NULL,\r\n\t[StDstr] [numeric](19, 6) NULL,\r\n\t[StDstrSC] [numeric](19, 6) NULL,\r\n\t[StDstrFC] [numeric](19, 6) NULL,\r\n\t[FixCurr] [nvarchar](3) NULL,\r\n\t[VatDscntPr] [numeric](19, 6) NULL,\r\n\t[OcrCode] [nvarchar](8) NULL,\r\n\t[TaxDistMtd] [char](1) NULL,\r\n\t[OcrCode2] [nvarchar](8) NULL,\r\n\t[OcrCode3] [nvarchar](8) NULL,\r\n\t[OcrCode4] [nvarchar](8) NULL,\r\n\t[OcrCode5] [nvarchar](8) NULL,\r\n\t[Project] [nvarchar](20) NULL,\r\n\t[VatGrpSrc] [char](1) NULL,\r\n\t[DrawnTotal] [numeric](19, 6) NULL,\r\n\t[DrawnFC] [numeric](19, 6) NULL,\r\n\t[DrawnSC] [numeric](19, 6) NULL,\r\n\t[GrsAmount] [numeric](19, 6) NULL,\r\n\t[GrsFC] [numeric](19, 6) NULL,\r\n\t[GrsSC] [numeric](19, 6) NULL,\r\n\t[BaseTotal] [char](1) NULL,\r\n\t[RetReqLC] [numeric](19, 6) NULL,\r\n\t[RetReqFC] [numeric](19, 6) NULL,\r\n\t[RetReqSC] [numeric](19, 6) NULL,\r\n\t[RRVatLC] [numeric](19, 6) NULL,\r\n\t[RRVatFC] [numeric](19, 6) NULL,\r\n\t[RRVatSC] [numeric](19, 6) NULL,\r\nCONSTRAINT fk_RIN3_PRIMARY FOREIGN KEY ([DocEntry]) REFERENCES [dbo].[ORIN] ([DocEntry]),\r\n)\r\nGO\r\n/****** Object:  Table [dbo].[RPC3]    Script Date: 15/6/2020 5:30:36 p. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE TABLE [dbo].[RPC3](\r\n\t[DocEntry] [int] NOT NULL,\r\n\t[ExpnsCode] [int] NULL,\r\n\t[LineTotal] [numeric](19, 6) NULL,\r\n\t[TotalFrgn] [numeric](19, 6) NULL,\r\n\t[TotalSumSy] [numeric](19, 6) NULL,\r\n\t[PaidToDate] [numeric](19, 6) NULL,\r\n\t[PaidFC] [numeric](19, 6) NULL,\r\n\t[PaidSys] [numeric](19, 6) NULL,\r\n\t[Comments] [nvarchar](100) NULL,\r\n\t[ObjType] [nvarchar](20) NULL,\r\n\t[LogInstanc] [int] NULL,\r\n\t[DistrbMthd] [char](1) NULL,\r\n\t[TaxStatus] [char](1) NULL,\r\n\t[VatGroup] [nvarchar](8) NULL,\r\n\t[VatPrcnt] [numeric](19, 6) NULL,\r\n\t[VatSum] [numeric](19, 6) NULL,\r\n\t[VatSumFrgn] [numeric](19, 6) NULL,\r\n\t[VatSumSy] [numeric](19, 6) NULL,\r\n\t[DedVatSum] [numeric](19, 6) NULL,\r\n\t[DedVatSumF] [numeric](19, 6) NULL,\r\n\t[DedVatSumS] [numeric](19, 6) NULL,\r\n\t[IsAcquistn] [char](1) NULL,\r\n\t[TaxCode] [nvarchar](8) NULL,\r\n\t[TaxType] [char](1) NULL,\r\n\t[WTLiable] [char](1) NULL,\r\n\t[VatApplied] [numeric](19, 6) NULL,\r\n\t[VatAppldFC] [numeric](19, 6) NULL,\r\n\t[VatAppldSC] [numeric](19, 6) NULL,\r\n\t[EquVatPer] [numeric](19, 6) NULL,\r\n\t[EquVatSum] [numeric](19, 6) NULL,\r\n\t[EquVatSumF] [numeric](19, 6) NULL,\r\n\t[EquVatSumS] [numeric](19, 6) NULL,\r\n\t[LineVat] [numeric](19, 6) NULL,\r\n\t[LineVatF] [numeric](19, 6) NULL,\r\n\t[LineVatS] [numeric](19, 6) NULL,\r\n\t[BaseMethod] [char](1) NULL,\r\n\t[Stock] [char](1) NULL,\r\n\t[LstPchPrce] [char](1) NULL,\r\n\t[AnalysRpt] [char](1) NULL,\r\n\t[BaseAbsEnt] [int] NULL,\r\n\t[BaseType] [int] NULL,\r\n\t[BaseRef] [int] NULL,\r\n\t[BaseLnNum] [int] NULL,\r\n\t[LineNum] [int] NOT NULL,\r\n\t[Status] [char](1) NULL,\r\n\t[TrgType] [int] NULL,\r\n\t[TrgAbsEnt] [int] NULL,\r\n\t[StDstr] [numeric](19, 6) NULL,\r\n\t[StDstrSC] [numeric](19, 6) NULL,\r\n\t[StDstrFC] [numeric](19, 6) NULL,\r\n\t[FixCurr] [nvarchar](3) NULL,\r\n\t[VatDscntPr] [numeric](19, 6) NULL,\r\n\t[OcrCode] [nvarchar](8) NULL,\r\n\t[TaxDistMtd] [char](1) NULL,\r\n\t[OcrCode2] [nvarchar](8) NULL,\r\n\t[OcrCode3] [nvarchar](8) NULL,\r\n\t[OcrCode4] [nvarchar](8) NULL,\r\n\t[OcrCode5] [nvarchar](8) NULL,\r\n\t[Project] [nvarchar](20) NULL,\r\n\t[VatGrpSrc] [char](1) NULL,\r\n\t[DrawnTotal] [numeric](19, 6) NULL,\r\n\t[DrawnFC] [numeric](19, 6) NULL,\r\n\t[DrawnSC] [numeric](19, 6) NULL,\r\n\t[GrsAmount] [numeric](19, 6) NULL,\r\n\t[GrsFC] [numeric](19, 6) NULL,\r\n\t[GrsSC] [numeric](19, 6) NULL,\r\n\t[BaseTotal] [char](1) NULL,\r\n\t[RetReqLC] [numeric](19, 6) NULL,\r\n\t[RetReqFC] [numeric](19, 6) NULL,\r\n\t[RetReqSC] [numeric](19, 6) NULL,\r\n\t[RRVatLC] [numeric](19, 6) NULL,\r\n\t[RRVatFC] [numeric](19, 6) NULL,\r\n\t[RRVatSC] [numeric](19, 6) NULL,\r\n CONSTRAINT fk_RPC3_PRIMARY FOREIGN KEY ([DocEntry]) REFERENCES [dbo].[ORPC] ([DocEntry]),\r\n)\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE TABLE [dbo].[OITR](\r\n\t[ReconNum] [int] NOT NULL IDENTITY(1,1),\r\n\t[IsCard] [char](1) NULL,\r\n\t[ReconType] [nvarchar](2) NULL,\r\n\t[ReconDate] [datetime] NULL,\r\n\t[Total] [numeric](19, 6) NULL,\r\n\t[ReconCurr] [nvarchar](3) NULL,\r\n\t[Canceled] [char](1) NULL,\r\n\t[CancelAbs] [int] NULL,\r\n\t[IsSystem] [char](1) NULL,\r\n\t[InitObjTyp] [nvarchar](20) NULL,\r\n\t[InitObjAbs] [int] NULL,\r\n\t[CreateDate] [datetime] NULL,\r\n\t[CreateTime] [smallint] NULL,\r\n\t[DataSource] [char](1) NULL,\r\n\t[UserSign] [smallint] NULL,\r\n\t[ReconRule1] [nvarchar](2) NULL,\r\n\t[ReconRule2] [nvarchar](2) NULL,\r\n\t[ReconRule3] [nvarchar](2) NULL,\r\n\t[IsMultiBP] [char](1) NULL,\r\n\t[VersionNum] [nvarchar](11) NULL,\r\n\t[OldMatNum] [int] NULL,\r\n\t[ReconJEId] [int] NULL,\r\n\t[BuildDesc] [nvarchar](50) NULL,\r\n\t[BPLId] [int] NULL,\r\n\t[BPLName] [nvarchar](100) NULL,\r\n\t[VATRegNum] [nvarchar](32) NULL,\r\n\t[IsElectr] [char](1) NULL,\r\n\t[CreateTS] [int] NULL,\r\n\t[UpdateTS] [int] NULL,\r\n\t[ObjType] [nvarchar](20) NULL,\r\n\tconstraint pk_OITR primary key (ReconNum),\r\n\r\n\t)\r\n\r\nGO\r\n/****** Object:  Table [dbo].[ITR1]    Script Date: 27/6/2020 3:18:11 p. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE TABLE [dbo].[ITR1](\r\n\t[ReconNum] [int] NOT NULL,\r\n\t[LineSeq] [int] NOT NULL,\r\n\t[ShortName] [nvarchar](15) NULL,\r\n\t[TransId] [int] NULL,\r\n\t[TransRowId] [int] NULL,\r\n\t[SrcObjTyp] [nvarchar](20) NULL,\r\n\t[SrcObjAbs] [int] NULL,\r\n\t[ReconSum] [numeric](19, 6) NULL,\r\n\t[ReconSumFC] [numeric](19, 6) NULL,\r\n\t[ReconSumSC] [numeric](19, 6) NULL,\r\n\t[FrgnCurr] [nvarchar](3) NULL,\r\n\t[SumMthCurr] [numeric](19, 6) NULL,\r\n\t[IsCredit] [char](1) NULL,\r\n\t[Account] [nvarchar](15) NULL,\r\n\t[CashDisSum] [numeric](19, 6) NULL,\r\n\t[WTSum] [numeric](19, 6) NULL,\r\n\t[WTSumFC] [numeric](19, 6) NULL,\r\n\t[WTSumSC] [numeric](19, 6) NULL,\r\n\t[ExpSum] [numeric](19, 6) NULL,\r\n\t[ExpSumFC] [numeric](19, 6) NULL,\r\n\t[ExpSumSC] [numeric](19, 6) NULL,\r\n\t[netBefDisc] [numeric](19, 6) NULL,\r\n\t[MIEntry] [int] NULL,\r\n\t[MIType] [nvarchar](20) NULL,\r\n\t[InstID] [int] NULL,\r\n\tconstraint pk_ITR1 primary key (ReconNum, LineSeq),\r\n)\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE TABLE [dbo].[OUGP](\r\n\t[UgpEntry] [int] NOT NULL IDENTITY (1,1),\r\n\t[UgpCode] [nvarchar](20) NOT NULL,\r\n\t[UgpName] [nvarchar](100) NULL,\r\n\t[BaseUom] [int] NULL,\r\n\t[DataSource] [char](1) NULL,\r\n\t[UserSign] [smallint] NULL,\r\n\t[LogInstanc] [int] NULL,\r\n\t[UserSign2] [smallint] NULL,\r\n\t[UpdateDate] [datetime] NULL,\r\n\t[CreateDate] [datetime] NULL,\r\n\t[Locked] [char](1) NULL,\r\n CONSTRAINT pk_OUGP primary key (UgpEntry),\r\n)\r\nGO\r\n/****** Object:  Table [dbo].[UGP1]    Script Date: 23/8/2020 1:25:45 p. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE TABLE [dbo].[UGP1](\r\n\t[UgpEntry] [int] NOT NULL,\r\n\t[UomEntry] [int] NOT NULL,\r\n\t[AltQty] [numeric](19, 6) NULL,\r\n\t[BaseQty] [numeric](19, 6) NULL,\r\n\t[LogInstanc] [int] NULL,\r\n\t[LineNum] [int] NOT NULL,\r\n\t[WghtFactor] [smallint] NULL,\r\n\t[UdfFactor] [int] NULL,\r\n\tconstraint pk_UGP1 primary key (UgpEntry,LineNum),\r\n)\r\n\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[AddUser]\r\n@User nvarchar(20), \r\n@Password nvarchar(max),\r\n@FullName nvarchar(20),\r\n@Locked char\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO OUSR (U_NAME, USER_CODE, PASSWORD, Locked) values (@FullName, @User, @Password, @Locked)\r\n\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[SocietyDates]\r\n@Society nvarchar(max), \r\n@UpdateDate datetime,\r\n@User smallint,\r\n@MainCurncy nvarchar(3),\r\n@SysCurncy nvarchar(3)\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO OADM(CompnyName,UpdateDate,UserSign, MainCurncy,SysCurrncy) values (@Society,@UpdateDate,@User, @MainCurncy,@SysCurncy)\r\n\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GetUserCode]\r\n@User nvarchar(25)\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT USERID FROM OUSR WHERE USER_CODE=@User\r\n\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[AddPeriods]\r\n@PeriodCat nvarchar(10), \r\n@FinancYear datetime,\r\n@Year smallint, \r\n@PeriodName nvarchar(20), \r\n@SubType char(1),\r\n@PeriodNum int, \r\n@F_RefDate datetime, \r\n@T_RefDate datetime, \r\n@F_DueDate datetime, \r\n@T_DueDate datetime, \r\n@F_TaxDate datetime, \r\n@T_TaxDate datetime,  \r\n@UpdateDate datetime, \r\n@UserSign smallint \r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO OACP(PeriodCat,FinancYear,Year,PeriodName,SubType, PeriodNum, F_RefDate, T_RefDate, F_DueDate,T_DueDate, F_TaxDate, T_TaxDate, UpdateDate, UserSign ) values (@PeriodCat,@FinancYear,@Year,@PeriodName,@SubType,@PeriodNum,@F_RefDate,@T_RefDate,@F_DueDate,@T_DueDate,@F_TaxDate,@T_TaxDate,@UpdateDate,@UserSign)\r\n\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[AddSubPeriods]\r\n@Code nvarchar(20), \r\n@Name nvarchar(20),\r\n@F_RefDate datetime, \r\n@T_RefDate datetime, \r\n@F_DueDate datetime, \r\n@T_DueDate datetime, \r\n@F_TaxDate datetime, \r\n@T_TaxDate datetime,  \r\n@UserSign smallint,\r\n@SubNum int,\r\n@Category nvarchar(10),\r\n@UpdateDate datetime,\r\n@PeriodStat char,\r\n@UserSign2 smallint\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO OFPR(Code,Name,F_RefDate, T_RefDate, F_DueDate,T_DueDate, F_TaxDate, T_TaxDate, UserSign, SubNum, Category, UpdateDate, PeriodStat, UserSign2 ) values (@Code,@Name,@F_RefDate,@T_RefDate,@F_DueDate,@T_DueDate,@F_TaxDate,@T_TaxDate,@UserSign, @SubNum,@Category,@UpdateDate,@PeriodStat,@UserSign2)\r\n\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[AddUpdateCurency]\r\n\r\n@OldCurrCode nvarchar(3),\r\n@CurrCode nvarchar(3), \r\n@CurrName nvarchar(20),\r\n@DocCurrCod nvarchar(3), \r\n@UserSign smallint,\r\n@Locked char(1)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nIF EXISTS (SELECT * FROM OCRN WHERE CurrCode=@OldCurrCode)\r\nBEGIN\r\nUPDATE OCRN SET CurrCode=@CurrCode, CurrName=@CurrName, DocCurrCod=@DocCurrCod, UserSign2=@UserSign WHERE CurrCode=@OldCurrCode\r\nEND\r\nELSE\r\nBEGIN\r\nINSERT INTO OCRN(CurrCode,CurrName,DocCurrCod, UserSign, Locked) VALUES (@CurrCode,@CurrName,@DocCurrCod,@UserSign,@Locked)\r\nEND\r\nEND\r\n\r\n\r\nGO\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeleteCurency]\r\n@CurrCode nvarchar(3)\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @CurrencyOJDT int\r\nDECLARE @CurrencyJDT1 int\r\nDECLARE @CurrencyOCRD int\r\nDECLARE @CurrencyOPCH int\r\nDECLARE @CurrencyPCH1 int\r\nDECLARE @CurrencyOINV int\r\nDECLARE @CurrencyINV1 int\r\nDECLARE @CurrencyORPC int\r\nDECLARE @CurrencyRPC1 int\r\nDECLARE @CurrencyORIN int\r\nDECLARE @CurrencyRIN1 int\r\nDECLARE @CurrencyOPDN int\r\nDECLARE @CurrencyPDN1 int\r\nDECLARE @CurrencyODLN int\r\nDECLARE @CurrencyDLN1 int\r\nDECLARE @CurrencyMainCurrency int\r\nDECLARE @CurrencySysCurrency int\r\nDECLARE @CurrencyOACT int\r\nDECLARE @Result int\r\n\r\nSET @CurrencyOJDT = (SELECT COUNT(TransCurr) FROM OJDT WHERE TransCurr=@CurrCode)\r\nSET @CurrencyJDT1 = (SELECT COUNT(FCCurrency) FROM JDT1 WHERE FCCurrency=@CurrCode)\r\nSET @CurrencyOCRD = (SELECT COUNT(Currency) FROM OCRD WHERE Currency=@CurrCode)\r\nSET @CurrencyOPCH = (SELECT COUNT(DocCur) FROM OPCH WHERE DocCur=@CurrCode)\r\nSET @CurrencyPCH1 = (SELECT COUNT(Currency) FROM PCH1 WHERE Currency=@CurrCode)\r\nSET @CurrencyOINV = (SELECT COUNT(DocCur) FROM ORIN WHERE DocCur=@CurrCode)\r\nSET @CurrencyINV1 = (SELECT COUNT(Currency) FROM INV1 WHERE Currency=@CurrCode)\r\nSET @CurrencyORPC = (SELECT COUNT(DocCur) FROM ORPC WHERE DocCur=@CurrCode)\r\nSET @CurrencyRPC1 = (SELECT COUNT(Currency) FROM RPC1 WHERE Currency=@CurrCode)\r\nSET @CurrencyORIN = (SELECT COUNT(DocCur) FROM ORIN WHERE DocCur=@CurrCode)\r\nSET @CurrencyRIN1 = (SELECT COUNT(Currency) FROM RIN1 WHERE Currency=@CurrCode)\r\nSET @CurrencyOPDN = (SELECT COUNT(DocCur) FROM OPDN WHERE DocCur=@CurrCode)\r\nSET @CurrencyPDN1 = (SELECT COUNT(Currency) FROM PDN1 WHERE Currency=@CurrCode)\r\nSET @CurrencyODLN = (SELECT COUNT(DocCur) FROM ODLN WHERE DocCur=@CurrCode)\r\nSET @CurrencyDLN1 = (SELECT COUNT(Currency) FROM DLN1 WHERE Currency=@CurrCode)\r\nSET @CurrencyMainCurrency = (SELECT COUNT(MainCurncy) FROM OADM WHERE MainCurncy=@CurrCode)\r\nSET @CurrencySysCurrency = (SELECT COUNT(SysCurrncy) FROM OADM WHERE SysCurrncy=@CurrCode)\r\nSET @CurrencyOACT = (SELECT COUNT(ActCurr) FROM OACT WHERE ActCurr=@CurrCode)\r\n\r\nSET @Result=@CurrencyDLN1+@CurrencyINV1+@CurrencyJDT1+@CurrencyMainCurrency+@CurrencyOACT+@CurrencyOCRD+@CurrencyODLN+@CurrencyOINV+@CurrencyOJDT+@CurrencyOPCH+@CurrencyOPDN+@CurrencyORIN+@CurrencyORPC+@CurrencyPCH1+@CurrencyPDN1+@CurrencyRIN1+@CurrencyRPC1+@CurrencySysCurrency\r\n\r\nIF (@Result=0)\r\nBEGIN\r\nDELETE FROM OCRN WHERE CurrCode=@CurrCode\r\nEND\r\nEND\r\n\r\nGO\r\n/****** Object:  StoredProcedure [dbo].[AddSubPeriods]    Script Date: 29/3/2020 5:11:15 p. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateSubPeriods]\r\n@OldCode nvarchar(20), \r\n@Code nvarchar(20), \r\n@Name nvarchar(20),\r\n@F_RefDate datetime, \r\n@T_RefDate datetime, \r\n@F_DueDate datetime, \r\n@T_DueDate datetime, \r\n@F_TaxDate datetime, \r\n@T_TaxDate datetime,  \r\n@UpdateDate datetime,\r\n@PeriodStat char,\r\n@UserSign2 smallint\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE OFPR SET Code=@Code, Name=@Name,F_RefDate=@F_RefDate, T_RefDate=@T_RefDate, F_DueDate=@F_DueDate,T_DueDate=@T_DueDate, F_TaxDate=@F_TaxDate, T_TaxDate=@T_TaxDate, UserSign2=@UserSign2,UpdateDate=@UpdateDate, PeriodStat=@PeriodStat WHERE Code=@OldCode\r\n\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GetFinancYear]\r\n@Category nvarchar(20)\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT DISTINCT FinancYear FROM OACP T0 LEFT JOIN OFPR T1 ON T0.Year=T1.Category WHERE T1.Category=@Category\r\n\r\nEND\r\n\r\nGO\r\n/****** Object:  StoredProcedure [dbo].[UpdateSociety]    Script Date: 6/4/2020 6:05:59 p. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateSociety]\r\n@CompnyName nvarchar(100), \r\n@CompnyAddr nvarchar(254),\r\n@Country nvarchar(3), \r\n@PrintHeadr nvarchar(100), \r\n@Phone1 nvarchar(20), \r\n@Phone2 nvarchar(20), \r\n@ZipCode int,\r\n@Fax nvarchar(20), \r\n@E_Mail nvarchar(100),  \r\n@MainCurncy nvarchar(3),\r\n@SysCurrncy nvarchar(3),\r\n@TaxIdNum nvarchar(32),\r\n@RevOffice nvarchar(100),\r\n@UpdateDate datetime,\r\n@UserSign smallint\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE OADM SET CompnyName=@CompnyName,CompnyAddr=@CompnyAddr,ZipCode=@ZipCode,Country=@Country, E_Mail=@E_Mail, PrintHeadr=@PrintHeadr,Phone1=@Phone1, Phone2=@Phone2, Fax=@Fax, MainCurncy=@MainCurncy,SysCurrncy=@SysCurrncy, TaxIdNum=@TaxIdNum, RevOffice=@RevOffice, UpdateDate=@UpdateDate, UserSign=@UserSign\r\n\r\nEND\r\n\r\nGO\r\n/****** Object:  StoredProcedure [dbo].[AddUpdateNroComprobante]    Script Date: 6/4/2020 6:06:51 p. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[AddUpdateNroComprobante]\r\n@OldCode nvarchar(50),\r\n@Code nvarchar(50), \r\n@NombreSerie nvarchar(50),\r\n@Descripcion nvarchar(100), \r\n@UserSign smallint,\r\n@TipoSerie nvarchar(10),\r\n@Inicio nvarchar(15),\r\n@Siguiente nvarchar(15),\r\n@Fin nvarchar(15),\r\n@Activo nvarchar(10),\r\n@UpdateDate datetime\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nIF EXISTS (SELECT * FROM NRO_COMPROBANTE WHERE Code=@OldCode)\r\nBEGIN\r\nUPDATE NRO_COMPROBANTE SET Code=@Code, NombreSerie=@NombreSerie, Descripcion=@Descripcion, UserSign=@UserSign, TipoSerie=@TipoSerie, Inicio=@Inicio, Siguiente=@Siguiente, Fin=@Fin, Activo=@Activo, UpdateDate=@UpdateDate WHERE Code=@OldCode\r\nEND\r\nELSE\r\nBEGIN\r\nINSERT INTO NRO_COMPROBANTE(Code,NombreSerie,Descripcion, UserSign, TipoSerie, Inicio, Siguiente, Fin, Activo, UpdateDate, Canceled) VALUES (@Code,@NombreSerie,@Descripcion,@UserSign,@TipoSerie, @Inicio, @Siguiente, @Fin, @Activo, @UpdateDate, 'N')\r\nEND\r\nEND\r\n\r\n\r\nGO\r\n/****** Object:  StoredProcedure [dbo].[AddUpdateNroComprobante]    Script Date: 6/4/2020 6:06:51 p. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[AddAccountFirstLevels]\r\n@UserSign smallint\r\nAS\r\n\r\nBEGIN\r\nINSERT INTO OACT(AcctCode,AcctName,CurrTotal,Finanse,Postable,Levels,GrpLine,ActType,SysTotal,FcTotal,Advance,CreateDate,UserSign,LocManTran, FatherNum, GroupMask) VALUES ('100000000000000','Activos',0,'N','N',1,1,'N',0,0,'Y',GETDATE(),@UserSign,'N','0',1)\r\nINSERT INTO OACT(AcctCode,AcctName,CurrTotal,Finanse,Postable,Levels,GrpLine,ActType,SysTotal,FcTotal,Advance,CreateDate,UserSign,LocManTran, FatherNum, GroupMask) VALUES ('200000000000000','Pasivos',0,'N','N',1,1,'N',0,0,'Y',GETDATE(),@UserSign,'N','0',2)\r\nINSERT INTO OACT(AcctCode,AcctName,CurrTotal,Finanse,Postable,Levels,GrpLine,ActType,SysTotal,FcTotal,Advance,CreateDate,UserSign,LocManTran, FatherNum, GroupMask) VALUES ('300000000000000','Patrimonio',0,'N','N',1,1,'N',0,0,'Y',GETDATE(),@UserSign,'N','0',3)\r\nINSERT INTO OACT(AcctCode,AcctName,CurrTotal,Finanse,Postable,Levels,GrpLine,ActType,SysTotal,FcTotal,Advance,CreateDate,UserSign,LocManTran, FatherNum, GroupMask) VALUES ('400000000000000','Ingresos',0,'N','N',1,1,'N',0,0,'Y',GETDATE(),@UserSign,'N','0',4)\r\nINSERT INTO OACT(AcctCode,AcctName,CurrTotal,Finanse,Postable,Levels,GrpLine,ActType,SysTotal,FcTotal,Advance,CreateDate,UserSign,LocManTran, FatherNum, GroupMask) VALUES ('500000000000000','Gastos',0,'N','N',1,1,'N',0,0,'Y',GETDATE(),@UserSign,'N','0',5)\r\nINSERT INTO OACT(AcctCode,AcctName,CurrTotal,Finanse,Postable,Levels,GrpLine,ActType,SysTotal,FcTotal,Advance,CreateDate,UserSign,LocManTran, FatherNum, GroupMask) VALUES ('600000000000000','Gastos Operacionales',0,'N','N',1,1,'N',0,0,'Y',GETDATE(),@UserSign,'N','0',6)\r\nINSERT INTO OACT(AcctCode,AcctName,CurrTotal,Finanse,Postable,Levels,GrpLine,ActType,SysTotal,FcTotal,Advance,CreateDate,UserSign,LocManTran, FatherNum, GroupMask) VALUES ('700000000000000','Otros Ingresos',0,'N','N',1,1,'N',0,0,'Y',GETDATE(),@UserSign,'N','0',7)\r\nINSERT INTO OACT(AcctCode,AcctName,CurrTotal,Finanse,Postable,Levels,GrpLine,ActType,SysTotal,FcTotal,Advance,CreateDate,UserSign,LocManTran, FatherNum, GroupMask) VALUES ('800000000000000','Otros Gastos',0,'N','N',1,1,'N',0,0,'Y',GETDATE(),@UserSign,'N','0',8)\r\n\r\nEND\r\n\r\nGO\r\n/****** Object:  StoredProcedure [dbo].[AddUpdateNroComprobante]    Script Date: 6/4/2020 6:06:51 p. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[AddCurencyBasic]\r\n@UserSign smallint\r\nAS\r\n\r\nBEGIN\r\nINSERT INTO OCRN(CurrCode,CurrName, DocCurrCod,Locked,UserSign) VALUES ('USD','Dolar Americano','USD','N',@UserSign)\r\nINSERT INTO OCRN(CurrCode,CurrName, DocCurrCod,Locked,UserSign) VALUES ('EUR','Euros','EUR','N',@UserSign)\r\nINSERT INTO OCRN(CurrCode,CurrName, DocCurrCod,Locked,UserSign) VALUES ('VES','Bolivar Sobernano','VES','N',@UserSign)\r\n\r\nEND\r\n\r\nGO\r\n/****** Object:  StoredProcedure [dbo].[AddUpdateNroComprobante]    Script Date: 6/4/2020 6:06:51 p. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[AddRetencionImpuesto]\r\n@UserSign smallint\r\nAS\r\n\r\nBEGIN\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C01', 'C-Retenci�n IVA 75%', CAST(75.000000 AS Numeric(19, 6)),GETDATE(),'P','V', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','IVA', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C02', 'C-Retenci�n IVA 100%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','V', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','IVA', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C03', 'C-Honorarios profesionales PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C04', 'C-Honorarios profesionales PJND  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C05', 'C-Honorarios Profesionales PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C06', 'C-Honorarios Profesionales PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C07', 'C-Preparadores de Animales PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C08', 'C-Preparadores de Animales PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C09', 'C-Honorarios Prof. En Clinicas PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C10', 'C-Honorarios Prof. En Clinicas PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C11', 'C-Comisiones Enajenaci�n Inmuebles PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C12', 'C-Comisiones Enajenaci�n Inmuebles PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C13', 'C-Comisiones Enajenaci�n Inmuebles PJND 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C14', 'C-Comisiones Enajenaci�n Inmuebles PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C15', 'C-Comisiones Mercantiles PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C16', 'C-Comisiones Mercantiles PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C17', 'C-Comisiones Mercantiles PJND 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C18', 'C-Comisiones Mercantiles PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C19', 'C-Intereses ART N� 27 #2 L.I.S.R. PNND 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C20', 'C-Intereses ART N� 27 #2 L.I.S.R. PNNR  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C21', 'C-Intereses ART N� 53 Par 1� PJND 4.95%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(4.950000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C22', 'C-Intereses PNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C23', 'C-Intereses PJND 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C24', 'C-Intereses PNNR  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C25', 'C-Intereses PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C26', 'C-Agencias de Noticias internacional PJND  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C27', 'C-Fletes y Gastos de Transporte Internac. PJND  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C28', 'C-Fletes en el Pa�s a Emp. Internac. PJND  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C29', 'C-Exhibici�n de Pel�culas ART 27 #15 PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C30', 'C-Exhibici�n de Pel�culas ART 27 #15 PJND  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C31', 'C-Regal�as ART 27 #16 PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C32', 'C-Regal�as ART 27 #16 PJND  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C33', 'C-Asistenc�a T�cnica ART 27 #16 PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C34', 'C-Asistenc�a T�cnica ART 27 #16 PJND  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C35', 'C-Servicios Tecnol�gicos PJND 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C36', 'C-Servicios Tecnol�gicos PNNR  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C37', 'C-Primas de Seguro-Reaseg. ART27 #18 PJND 10%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(10.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C38', 'C-Ganancias S/Juegos y Apuestas PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C39', 'C-Ganancias S/Juegos y Apuestas PNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C40', 'C-Ganancias S/Juegos y Apuestas PJND 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C41', 'C-Ganancias S/Juegos y Apuestas PJD 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C42', 'C-Premios Lot. E Hip. ART 65 y 66 PNNR 16%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(16.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C43', 'C-Premios Lot. E Hip. ART 65 y 66 PNR 16%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(16.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C44', 'C-Premios Lot. E Hip. ART 65 y 66 PJND 16%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(16.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C45', 'C-Premios Lot. E Hip. ART 65 y 66 PJD 16%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(16.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C46', 'C-Premios de Animales de Carrera PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C47', 'C-Premios de Animales de Carrera PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C48', 'C-Premios de Animales de Carrera PJND 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C49', 'C-Premios de Animales de Carrera PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C50', 'C-Servicios (Incluye Suministro Bienes) PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C51', 'C-Servicios (Incluye Suministro Bienes) PNR 1%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(1.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(4166.670000 AS Numeric(19, 6)), CAST(41.670000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C52', 'C-Servicios (Incluye Suministro Bienes) PJND  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C53', 'C-Servicios (Incluye Suministro Bienes) PJD 2%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(2.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C54', 'C-Arrendamiento de Bienes Inmuebles PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C55', 'C-Arrendamiento de Bienes Inmuebles PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C56', 'C-Arrendamiento de Bienes Inmuebles PJND  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C57', 'C-Arrendamiento de Bienes Inmuebles PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C58', 'C-Arrendamiento de Bienes Muebles PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C59', 'C-Arrendamiento de Bienes Muebles PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C60', 'C-Arrendamiento de Bienes Muebles PJND 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C61', 'C-Arrendamiento de Bienes Muebles PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C62', 'C-Pagos de Tarjeta de Cr�dito PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C63', 'C-Pagos de Tarjeta de Cr�dito PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C64', 'C-Pagos de Tarjeta de Cr�dito PJND 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C65', 'C-Pagos de Tarjeta de Cr�dito PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C66', 'C-Venta de Gasolina con T. Cr�dito PNNR 1%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(1.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C67', 'C-Venta de Gasolina con T. Cr�dito PJND 1%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(1.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C68', 'C-Fletes y Gastos de Transporte Nacional PNR 1%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(1.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C69', 'C-Fletes y Gastos de Transporte Nacional PJD 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C70', 'C-Pago de Emp. De Seguro a Corredores PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C71', 'C-Pago de Emp. De Seguro a Corredores PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C72', 'C-Pago Rep. Bienes y Atenc. Hosp Aseg. PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C73', 'C-Pago Rep. Bienes y Atenc. Hosp Aseg. PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C74', 'C-Venta de Fondos de Comercio PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C75', 'C-Venta de Fondos de Comercio PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C76', 'C-Venta de Fondos de Comercio PJND 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C77', 'C-Venta de Fondos de Comercio PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C78', 'C-Publicidad y Propaganda PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C79', 'C-Publicidad y Propaganda PJND 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C80', 'C-Publicidad y Propaganda PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C81', 'C-Publicidad y Propaganda Radio PJD 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C82', 'C-Venta de Acciones en Bolsa PNNR 1%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(1.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C83', 'C-Venta de Acciones en Bolsa PNR 1%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(1.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C84', 'C-Venta de Acciones en Bolsa PJND 1%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(1.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C85', 'C-Venta de Acciones en Bolsa PJD 1%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(1.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C86', 'C-Venta de Acciones Fuera de Bolsa PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C87', 'C-Venta de Acciones Fuera de Bolsa PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C88', 'C-Venta de Acciones Fuera de Bolsa PJND 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('C89', 'C-Venta de Acciones Fuera de Bolsa PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'P','N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\n\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P01', 'P- Similares Sueldos y Salarios FAS', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I','N', CAST(10.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'001')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P02', 'P-Retenci�n IVA 75%', CAST(75.000000 AS Numeric(19, 6)),GETDATE(),'I','V', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','IVA', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P03', 'P-Retenci�n IVA 100%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'V', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','IVA', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P04', 'P-Honorarios profesionales PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'003')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P05', 'P-Honorarios profesionales PJND  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'005')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P06', 'P-Honorarios Profesionales PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(4166.670000 AS Numeric(19, 6)), CAST(125.000000 AS Numeric(19, 6)),'002')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P07', 'P-Honorarios Profesionales PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'004')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P08', 'P-Preparadores de Animales PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'011')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P09', 'P-Preparadores de Animales PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'010')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P10', 'P-Honorarios Prof. En Clinicas PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'013')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P11', 'P-Honorarios Prof. En Clinicas PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'012')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P12', 'P-Comisiones Enajenaci�n Inmuebles PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'015')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P13', 'P-Comisiones Enajenaci�n Inmuebles PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'014')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P14', 'P-Comisiones Enajenaci�n Inmuebles PJND 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'017')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P15', 'P-Comisiones Enajenaci�n Inmuebles PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'016')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P16', 'P-Comisiones Mercantiles PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'019')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P17', 'P-Comisiones Mercantiles PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(4166.670000 AS Numeric(19, 6)), CAST(125.000000 AS Numeric(19, 6)),'018')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P18', 'P-Comisiones Mercantiles PJND 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'021')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P19', 'P-Comisiones Mercantiles PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'020')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P20', 'P-Intereses ART N� 27 #2 L.I.S.R. PNND 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'022')\r\n\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P21', 'P-Intereses ART N� 27 #2 L.I.S.R. PNNR  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'023')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P22', 'P-Intereses ART N� 53 Par 1� PJND 4.95%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(4.950000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'024')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P23', 'P-Intereses PNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'025')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P24', 'P-Intereses PJND 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'028')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P25', 'P-Intereses PNNR  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'026')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P26', 'P-Intereses PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'027')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P27', 'P-Agencias de Noticias internacional PJND  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'029')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P28', 'P-Fletes y Gastos de Transporte Internac. PJND  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'P27')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P29', 'P-Fletes en el Pa�s a Emp. Internac. PJND  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'P28')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P30', 'P-Exhibici�n de Pel�culas ART 27 #15 PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'032')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P31', 'P-Exhibici�n de Pel�culas ART 27 #15 PJND  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'033')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P32', 'P-Regal�as ART 27 #16 PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'034')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P33', 'P-Regal�as ART 27 #16 PJND  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'035')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P34', 'P-Asistenc�a T�cnica ART 27 #16 PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'036')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P35', 'P-Asistenc�a T�cnica ART 27 #16 PJND  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'037')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P36', 'P-Servicios Tecnol�gicos PJND 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'038')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P37', 'P-Servicios Tecnol�gicos PNNR  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'039')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P38', 'P-Primas de Seguro-Reaseg. ART27 #18 PJND 10%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(10.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'040')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P39', 'P-Ganancias S/Juegos y Apuestas PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'042')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P40', 'P-Ganancias S/Juegos y Apuestas PNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'041')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P41', 'P-Ganancias S/Juegos y Apuestas PJND 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'044')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P42', 'P-Ganancias S/Juegos y Apuestas PJD 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'043')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P43', 'P-Premios Lot. E Hip. ART 65 y 66 PNNR 16%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(16.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'046')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P44', 'P-Premios Lot. E Hip. ART 65 y 66 PNR 16%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(16.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'045')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P45', 'P-Premios Lot. E Hip. ART 65 y 66 PJND 16%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(16.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'048')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P46', 'P-Premios Lot. E Hip. ART 65 y 66 PJD 16%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(16.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'047')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P47', 'P-Premios de Animales de Carrera PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'050')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P48', 'P-Premios de Animales de Carrera PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'049')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P49', 'P-Premios de Animales de Carrera PJND 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'052')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P50', 'P-Premios de Animales de Carrera PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'051')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P51', 'P-Servicios (Incluye Suministro Bienes) PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'054')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P52', 'P-Servicios (Incluye Suministro Bienes) PNR 1%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(1.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(4166.670000 AS Numeric(19, 6)), CAST(41.670000 AS Numeric(19, 6)),'053')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P53', 'P-Servicios (Incluye Suministro Bienes) PJND  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'056')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P54', 'P-Servicios (Incluye Suministro Bienes) PJD 2%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(2.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'055')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P55', 'P-Arrendamiento de Bienes Inmuebles PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'058')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P56', 'P-Arrendamiento de Bienes Inmuebles PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(4166.670000 AS Numeric(19, 6)), CAST(125.000000 AS Numeric(19, 6)),'057')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P57', 'P-Arrendamiento de Bienes Inmuebles PJND  T2', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(100.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'060')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P58', 'P-Arrendamiento de Bienes Inmuebles PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'059')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P59', 'P-Arrendamiento de Bienes Muebles PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'062')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P60', 'P-Arrendamiento de Bienes Muebles PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(4166.670000 AS Numeric(19, 6)), CAST(125.000000 AS Numeric(19, 6)),'061')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P61', 'P-Arrendamiento de Bienes Muebles PJND 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'064')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P62', 'P-Arrendamiento de Bienes Muebles PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'063')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P63', 'P-Pagos de Tarjeta de Cr�dito PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'066')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P64', 'P-Pagos de Tarjeta de Cr�dito PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'065')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P65', 'P-Pagos de Tarjeta de Cr�dito PJND 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'068')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P66', 'P-Pagos de Tarjeta de Cr�dito PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'067')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P67', 'P-Venta de Gasolina con T. Cr�dito PNNR 1%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(1.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'069')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P68', 'P-Venta de Gasolina con T. Cr�dito PJND 1%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(1.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'070')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P69', 'P-Fletes y Gastos de Transporte Nacional PNR 1%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(1.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(4166.670000 AS Numeric(19, 6)), CAST(41.670000 AS Numeric(19, 6)),'071')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P70', 'P-Fletes y Gastos de Transporte Nacional PJD 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'072')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P71', 'P-Pago de Emp. De Seguro a Corredores PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'073')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P72', 'P-Pago de Emp. De Seguro a Corredores PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'074')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P73', 'P-Pago Rep. Bienes y Atenc. Hosp Aseg. PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'077')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P74', 'P-Pago Rep. Bienes y Atenc. Hosp Aseg. PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'078')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P75', 'P-Venta de Fondos de Comercio PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'080')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P76', 'P-Venta de Fondos de Comercio PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'079')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P77', 'P-Venta de Fondos de Comercio PJND 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'082')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P78', 'P-Venta de Fondos de Comercio PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'081')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P79', 'P-Publicidad y Propaganda PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(4166.670000 AS Numeric(19, 6)), CAST(125.000000 AS Numeric(19, 6)),'083')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P80', 'P-Publicidad y Propaganda PJND 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'085')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P81', 'P-Publicidad y Propaganda PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'084')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P82', 'P-Publicidad y Propaganda Radio PJD 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'086')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P83', 'P-Venta de Acciones en Bolsa PNNR 1%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(1.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P84', 'P-Venta de Acciones en Bolsa PNR 1%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(1.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P85', 'P-Venta de Acciones en Bolsa PJND 1%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(1.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P86', 'P-Venta de Acciones en Bolsa PJD 1%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(1.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P87', 'P-Venta de Acciones Fuera de Bolsa PNNR 34%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(34.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P88', 'P-Venta de Acciones Fuera de Bolsa PNR 3%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(3.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P89', 'P-Venta de Acciones Fuera de Bolsa PJND 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\nINSERT INTO OWHT ([WTCode], [WTName], [Rate], [EffecDate], [Category], [BaseType], [PrctBsAmnt], [Account],[UserSign], [Inactive], [U_IDA_TipoRetencion], [U_IDA_BaseMinima], [U_IDA_Sustraendo], [Offclcode]) VALUES ('P90', 'P-Venta de Acciones Fuera de Bolsa PJD 5%', CAST(100.000000 AS Numeric(19, 6)),GETDATE(),'I', 'N', CAST(5.000000 AS Numeric(19, 6)), NULL,@UserSign, 'N','ISLR', CAST(0.000000 AS Numeric(19, 6)), CAST(0.000000 AS Numeric(19, 6)),'')\r\n\r\nEND\r\n\r\nGO\r\n/****** Object:  StoredProcedure [dbo].[AddUpdateNroComprobante]    Script Date: 6/4/2020 6:06:51 p. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[AddUpdateTaxHolding]\r\n\r\n@OldWtCode nvarchar(4), \r\n@Wt_Code nvarchar(4), \r\n@Wt_Name nvarchar(50),\r\n@Rate numeric(19,6), \r\n@EffecDate datetime,\r\n@Category char(1),\r\n@BaseType char(1),\r\n@PrctBsAmnt numeric(19,6), \r\n@Account nvarchar(15),\r\n@Offclcode nvarchar(15),\r\n@UserSign smallint,\r\n@Inactive char(1),\r\n@U_IDA_TipoRetencion nvarchar(20),\r\n@U_IDA_BaseMinima numeric(19,6), \r\n@U_IDA_Sustraendo numeric(19,6)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nIF EXISTS (SELECT * FROM OWHT WHERE WtCode=@OldWtCode)\r\nBEGIN\r\nUPDATE OWHT SET WTCode=@Wt_Code, WtName=@Wt_Name, Rate=@Rate, EffecDate=@EffecDate, Category=@Category, BaseType=@BaseType, PrctBsAmnt=@PrctBsAmnt, Account=@Account, UserSign=@UserSign, Inactive=@Inactive, U_IDA_TipoRetencion=@U_IDA_TipoRetencion,  U_IDA_BaseMinima=@U_IDA_BaseMinima,  U_IDA_Sustraendo=@U_IDA_Sustraendo, Offclcode=@Offclcode WHERE WtCode=@OldWtCode\r\nEND\r\nELSE\r\nBEGIN\r\nINSERT INTO OWHT(WTCode,WTName,Rate, EffecDate,Category,BaseType, PrctBsAmnt, Account, UserSign, Inactive, U_IDA_TipoRetencion, U_IDA_BaseMinima, U_IDA_Sustraendo,Offclcode) VALUES (@Wt_Code,@Wt_Name,@Rate,@EffecDate,@Category, @BaseType, @PrctBsAmnt, @Account, @UserSign, @Inactive, @U_IDA_TipoRetencion, @U_IDA_BaseMinima, @U_IDA_Sustraendo,@Offclcode)\r\nEND\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeleteNroComprobante]\r\n@Code nvarchar(50)\r\nAS\r\n\r\nBEGIN\r\nDELETE FROM NRO_COMPROBANTE WHERE Code=@Code\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[AddClasesImpuestos]\r\n\r\n@UserSign smallint\r\nAS\r\n\r\nBEGIN\r\nINSERT INTO OSTA(Code,Name,Rate,UserSign) VALUES ('IVA_12', 'IVA 12', CAST(12.000000 AS Numeric(19, 6)), @UserSign)\r\nINSERT INTO OSTA(Code,Name,Rate,UserSign) VALUES ('IVA_16', 'IVA 16', CAST(16.000000 AS Numeric(19, 6)), @UserSign)\r\nINSERT INTO OSTA(Code,Name,Rate,UserSign) VALUES ('IVA_22', 'IVA 22', CAST(22.000000 AS Numeric(19, 6)), @UserSign)\r\nINSERT INTO OSTA(Code,Name,Rate,UserSign) VALUES ('IVA_7', 'IVA 7', CAST(7.000000 AS Numeric(19, 6)), @UserSign)\r\nINSERT INTO OSTA(Code,Name,Rate,UserSign) VALUES ('IVA_8', 'IVA 8', CAST(8.000000 AS Numeric(19, 6)), @UserSign)\r\nINSERT INTO OSTA(Code,Name,Rate,UserSign) VALUES ('IVA_9', 'IVA 9', CAST(9.000000 AS Numeric(19, 6)), @UserSign)\r\nINSERT INTO OSTA(Code,Name,Rate,UserSign) VALUES ('IVA_Exe', 'IVA Exento', CAST(0.000000 AS Numeric(19, 6)), @UserSign)\r\nEND\r\n\r\n/****** Object:  StoredProcedure [dbo].[AddUpdateNroComprobante]    Script Date: 6/4/2020 6:06:51 p. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[AddUpdateClasesImpuestos]\r\n@Code nvarchar(8), \r\n@Name nvarchar(100),\r\n@Rate numeric(19,6), \r\n@SalesTax nvarchar(15),\r\n@PurchTax nvarchar(15),\r\n@UserSign smallint\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nIF EXISTS (SELECT * FROM OSTA WHERE Code=@Code)\r\nBEGIN\r\nUPDATE OSTA SET Name=@Name, Rate=@Rate, SalesTax=@SalesTax, PurchTax=@PurchTax, UserSign=@UserSign WHERE Code=@Code\r\nEND\r\nELSE\r\nBEGIN\r\nINSERT INTO OSTA(Code,Name,Rate, SalesTax,PurchTax,UserSign) VALUES (@Code,@Name,@Rate,@SalesTax,@PurchTax, @UserSign)\r\nEND\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeleteClaseImpuesto]\r\n@Code nvarchar(8)\r\nAS\r\nBEGIN\r\nDECLARE @ClaseImpuestoORCD int\r\nDECLARE @ClaseImpuestoPCH1 int\r\nDECLARE @ClaseImpuestoINV1 int\r\nDECLARE @ClaseImpuestoRPC1 int\r\nDECLARE @ClaseImpuestoRIN1 int\r\nDECLARE @ClaseImpuestoPDN1 int\r\nDECLARE @ClaseImpuestoDLN1 int\r\n\r\nDECLARE @Result int\r\n\r\nSET @ClaseImpuestoORCD = (SELECT COUNT(VatGroup) FROM OCRD WHERE VatGroup=@Code)\r\nSET @ClaseImpuestoPCH1 = (SELECT COUNT(VatGroup) FROM PCH1 WHERE VatGroup=@Code)\r\nSET @ClaseImpuestoINV1 = (SELECT COUNT(VatGroup) FROM INV1 WHERE VatGroup=@Code)\r\nSET @ClaseImpuestoRPC1 = (SELECT COUNT(VatGroup) FROM RPC1 WHERE VatGroup=@Code)\r\nSET @ClaseImpuestoRIN1 = (SELECT COUNT(VatGroup) FROM RIN1 WHERE VatGroup=@Code)\r\nSET @ClaseImpuestoPDN1 = (SELECT COUNT(VatGroup) FROM PDN1 WHERE VatGroup=@Code)\r\nSET @ClaseImpuestoDLN1 = (SELECT COUNT(VatGroup) FROM DLN1 WHERE VatGroup=@Code)\r\n\r\n\r\nSET @Result=@ClaseImpuestoORCD+ @ClaseImpuestoPCH1+@ClaseImpuestoINV1+@ClaseImpuestoRPC1+@ClaseImpuestoRIN1+@ClaseImpuestoPDN1+@ClaseImpuestoDLN1\r\n\r\nIF (@Result=0)\r\nBEGIN\r\nDELETE FROM OSTA WHERE Code=@Code\r\nEND\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[AddCodigosFiscales]\r\n\r\n@UserSign smallint\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO OSTC(Code, Name, Rate, Freight, UserSign, ValidForAP, ValidForAR, Lock, UpdateDate,U_IDA_Alicuota) VALUES ('IVA_12','IVA 12',CAST(12.000000 AS Numeric(19, 6)),'N',@UserSign,'Y','Y','Y',GETDATE(),'GENERAL')\r\nINSERT INTO OSTC(Code, Name, Rate, Freight, UserSign, ValidForAP, ValidForAR, Lock, UpdateDate,U_IDA_Alicuota) VALUES ('IVA_16','IVA 16',CAST(16.000000 AS Numeric(19, 6)),'Y',@UserSign,'Y','Y','N',GETDATE(),'GENERAL')\r\nINSERT INTO OSTC(Code, Name, Rate, Freight, UserSign, ValidForAP, ValidForAR, Lock, UpdateDate,U_IDA_Alicuota) VALUES ('IVA_22','IVA 22',CAST(22.000000 AS Numeric(19, 6)),'Y',@UserSign,'Y','Y','N',GETDATE(),'ADICIONAL')\r\nINSERT INTO OSTC(Code, Name, Rate, Freight, UserSign, ValidForAP, ValidForAR, Lock, UpdateDate,U_IDA_Alicuota) VALUES ('IVA_7','IVA 7',CAST(7.000000 AS Numeric(19, 6)),'Y',@UserSign,'Y','Y','N',GETDATE(),'GENERAL_E2')\r\nINSERT INTO OSTC(Code, Name, Rate, Freight, UserSign, ValidForAP, ValidForAR, Lock, UpdateDate,U_IDA_Alicuota) VALUES ('IVA_8','IVA 8',CAST(8.000000 AS Numeric(19, 6)),'Y',@UserSign,'Y','Y','N',GETDATE(),'REDUCIDA')\r\nINSERT INTO OSTC(Code, Name, Rate, Freight, UserSign, ValidForAP, ValidForAR, Lock, UpdateDate,U_IDA_Alicuota) VALUES ('IVA_9','IVA 9',CAST(9.000000 AS Numeric(19, 6)),'Y',@UserSign,'Y','Y','N',GETDATE(),'GENERAL_E1')\r\nINSERT INTO OSTC(Code, Name, Rate, Freight, UserSign, ValidForAP, ValidForAR, Lock, UpdateDate,U_IDA_Alicuota) VALUES ('IVA_EXE','IVA Exento',CAST(0.000000 AS Numeric(19, 6)),'Y',@UserSign,'Y','Y','N',GETDATE(),'EXENTO')\r\n\r\nINSERT INTO STC1(STCCode, Line_ID, EfctivRate, STACode) VALUES ('IVA_12',0,CAST(12.000000 AS Numeric(19, 6)),'IVA_12')\r\nINSERT INTO STC1(STCCode, Line_ID, EfctivRate, STACode) VALUES ('IVA_16',0,CAST(16.000000 AS Numeric(19, 6)),'IVA_16')\r\nINSERT INTO STC1(STCCode, Line_ID, EfctivRate, STACode) VALUES ('IVA_22',0,CAST(22.000000 AS Numeric(19, 6)),'IVA_22')\r\nINSERT INTO STC1(STCCode, Line_ID, EfctivRate, STACode) VALUES ('IVA_7',0,CAST(7.000000 AS Numeric(19, 6)),'IVA_7')\r\nINSERT INTO STC1(STCCode, Line_ID, EfctivRate, STACode) VALUES ('IVA_8',0,CAST(8.000000 AS Numeric(19, 6)),'IVA_8')\r\nINSERT INTO STC1(STCCode, Line_ID, EfctivRate, STACode) VALUES ('IVA_9',0,CAST(9.000000 AS Numeric(19, 6)),'IVA_9')\r\nINSERT INTO STC1(STCCode, Line_ID, EfctivRate, STACode) VALUES ('IVA_EXE',0,CAST(0.000000 AS Numeric(19, 6)),'IVA_EXE')\r\n\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[AddMonth]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO MONTHS(Code, Month) VALUES ('01','Enero')\r\nINSERT INTO MONTHS(Code, Month) VALUES ('02','Febrero')\r\nINSERT INTO MONTHS(Code, Month) VALUES ('03','Marzo')\r\nINSERT INTO MONTHS(Code, Month) VALUES ('04','Abril')\r\nINSERT INTO MONTHS(Code, Month) VALUES ('05','Mayo')\r\nINSERT INTO MONTHS(Code, Month) VALUES ('06','Junio')\r\nINSERT INTO MONTHS(Code, Month) VALUES ('07','Julio')\r\nINSERT INTO MONTHS(Code, Month) VALUES ('08','Agosto')\r\nINSERT INTO MONTHS(Code, Month) VALUES ('09','Septiembre')\r\nINSERT INTO MONTHS(Code, Month) VALUES ('10','Octubre')\r\nINSERT INTO MONTHS(Code, Month) VALUES ('11','Noviembre')\r\nINSERT INTO MONTHS(Code, Month) VALUES ('12','Diciembre')\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[AddUpdateTipoCambio]\r\n\r\n@RateDate datetime,\r\n@Rate numeric(19,6),\r\n@Currency nvarchar(3),\r\n@UserSign smallint\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nIF EXISTS (SELECT * FROM ORTT WHERE RateDate=@RateDate AND Currency=@Currency)\r\nBEGIN\r\nUPDATE ORTT SET Rate=@Rate, Currency=@Currency, UserSign=@UserSign WHERE RateDate=@RateDate AND Currency=@Currency\r\nEND\r\nELSE\r\nBEGIN\r\nINSERT INTO ORTT(RateDate,Rate,Currency, UserSign) VALUES (@RateDate,@Rate,@Currency,@UserSign)\r\nEND\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[AddAlicuota]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO Alicuotas(Code, Name) VALUES ('GENERAL','GENERAL')\r\nINSERT INTO Alicuotas(Code, Name) VALUES ('REDUCIDA','REDUCIDA')\r\nINSERT INTO Alicuotas(Code, Name) VALUES ('ADICIONAL','ADICIONAL')\r\nINSERT INTO Alicuotas(Code, Name) VALUES ('EXENTO','EXENTO')\r\nINSERT INTO Alicuotas(Code, Name) VALUES ('GENERAL_E1','GENERAL_E1')\r\nINSERT INTO Alicuotas(Code, Name) VALUES ('GENERAL_E2','GENERAL_E2')\r\n\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindCodigosFiscales]\r\n\r\n@Code nvarchar(8),\r\n@Name nvarchar(100),\r\n@U_IDA_Alicuota nvarchar(20),\r\n@ValidForAR char(1),\r\n@ValidForAP char(1),\r\n@Lock char(1)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT * FROM OSTC WHERE Code LIKE  @Code + '%' OR Name LIKE @Name + '%' OR U_IDA_Alicuota LIKE @U_IDA_Alicuota + '%' OR ValidForAR LIKE @ValidForAR + '%' OR ValidForAP LIKE @ValidForAP + '%' OR Lock LIKE @Lock + '%'\r\n\r\nEND\r\n\r\nGO\r\n/****** Object:  StoredProcedure [dbo].[NextCodigoFiscal]    Script Date: 12/4/2020 7:16:41 p. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[PreviousCodigoFiscal]\r\n\r\n@Code nvarchar(8)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result nvarchar(8)\r\n\r\nSET @Result=(SELECT Previous\r\nFROM\r\n    (Select Code,LAG(Code) over (order by Code) Previous\r\n      from OSTC) AS NextQueryCodigoFiscal\r\n Where Code=@Code)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM OSTC WHERE Code=@Result\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM OSTC ORDER BY Code DESC\r\n END\r\n\r\nEND\r\n\r\nGO\r\n/****** Object:  StoredProcedure [dbo].[NextCodigoFiscal]    Script Date: 12/4/2020 7:16:41 p. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[NextCodigoFiscal]\r\n\r\n@Code nvarchar(8)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result nvarchar(8)\r\n\r\nSET @Result=(SELECT Siguiente\r\nFROM\r\n    (Select Code,LEAD(Code) over (order by Code) Siguiente\r\n      from OSTC) AS NextQueryCodigoFiscal\r\n Where Code=@Code)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM OSTC WHERE Code=@Result\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM OSTC ORDER BY Code \r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[LastCodigoFiscal]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM OSTC ORDER BY Code DESC\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FirstCodigoFiscal]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM OSTC ORDER BY Code \r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GetSociety]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT CompnyName FROM OADM\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[AddCodigoFiscal]\r\n\r\n@Code nvarchar(8),\r\n@Name nvarchar(100),\r\n@Rate numeric(19,6),\r\n@UserSign smallint,\r\n@ValidForAR char(1),\r\n@ValidForAP char(1),\r\n@Lock char(1),\r\n@UpdateDate datetime,\r\n@U_IDA_Alicuota nvarchar(20)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO OSTC(Code,Name,Rate,UserSign,ValidForAR, ValidForAP, Lock, UpdateDate, U_IDA_Alicuota) VALUES (@Code,@Name,@Rate,@UserSign,@ValidForAP,@ValidForAR,@Lock,@UpdateDate,@U_IDA_Alicuota)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateCodigoFiscal]\r\n\r\n@Code nvarchar(8),\r\n@Name nvarchar(100),\r\n@Rate numeric(19,6),\r\n@UserSign smallint,\r\n@ValidForAR char(1),\r\n@ValidForAP char(1),\r\n@Lock char(1),\r\n@UpdateDate datetime,\r\n@U_IDA_Alicuota nvarchar(20)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE OSTC SET Code=@Code, Name=@Name, Rate=@Rate, UserSign2=@UserSign, ValidForAR=@ValidForAR, ValidForAP=@ValidForAP, Lock=@Lock, UpdateDate=@UpdateDate, U_IDA_Alicuota=@U_IDA_Alicuota WHERE Code=@Code\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindUsuarios]\r\n\r\n@User_code nvarchar(25),\r\n@User_name nvarchar (155),\r\n@Locked char(1)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT * FROM OUSR WHERE USER_CODE LIKE  @User_code + '%' OR U_NAME LIKE @User_name + '%' OR Locked LIKE @Locked + '%'\r\n\r\nEND\r\n\r\nGO\r\n/****** Object:  StoredProcedure [dbo].[NextCodigoFiscal]    Script Date: 12/4/2020 7:16:41 p. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[PreviousUser]\r\n\r\n@USERID smallint\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result smallint\r\n\r\nSET @Result=(SELECT Previous\r\nFROM\r\n    (Select USERID,LAG(USERID) over (order by USERID) Previous\r\n      from OUSR) AS NextQueryUser\r\n Where USERID=@USERID)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM OUSR WHERE USERID=@Result\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM OUSR ORDER BY USERID DESC\r\n END\r\n\r\nEND\r\n\r\nGO\r\n/****** Object:  StoredProcedure [dbo].[NextCodigoFiscal]    Script Date: 12/4/2020 7:16:41 p. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[NextUser]\r\n\r\n@USERID smallint\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result smallint\r\n\r\nSET @Result=(SELECT Siguiente\r\nFROM\r\n    (Select USERID,LEAD(USERID) over (order by USERID) Siguiente\r\n      from OUSR) AS NextQueryUser\r\n Where USERID=@USERID)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM OUSR WHERE USERID=@Result\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM OUSR ORDER BY USERID\r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[LastUser]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM OUSR ORDER BY USERID DESC\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FirstUser]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM OUSR ORDER BY USERID\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateUser]\r\n\r\n@UserID smallint,\r\n@User nvarchar(25),\r\n@FullName nvarchar (155),\r\n@Locked char(1)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE OUSR SET USER_CODE=@User, U_NAME=@FullName, Locked=@Locked WHERE USERID=@UserID\r\n\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdatePasswordUser]\r\n\r\n@UserID smallint,\r\n@PASSWORD nvarchar(254)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE OUSR SET PASSWORD=@PASSWORD WHERE USERID=@UserID\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindAccount]\r\n\r\n@AcctCode nvarchar(15)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT * FROM OACT WHERE AcctCode=@AcctCode\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateAccount]\r\n\r\n@AcctCode nvarchar(15),\r\n@AcctName nvarchar(100),\r\n@ActCurr nvarchar(3),\r\n@LocManTran char(1),\r\n@UserSign smallint,\r\n@ActType char(1),\r\n@CreateDate datetime\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE OACT SET AcctCode=@AcctCode, AcctName=@AcctName, LocManTran=@LocManTran, UserSign=@UserSign, ActType=@ActType, ActCurr=@ActCurr, UpdateDate=@CreateDate WHERE AcctCode=@AcctCode\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertAccount]\r\n\r\n@AcctCode nvarchar(15),\r\n@AcctName nvarchar(100),\r\n@ActCurr nvarchar(3),\r\n@UserSign smallint,\r\n@CreateDate datetime,\r\n@Postable char(1),\r\n@FatherNum nvarchar(15), \r\n@LocManTran char(1),\r\n@ActType char(1),\r\n@CurrTotal numeric(19,6),\r\n@Finanse char(1),\r\n@Levels smallint,\r\n@SysTotal numeric(19,6),\r\n@FcTotal numeric(19,6),\r\n@Advance char(1),\r\n@GroupMask smallint\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO OACT (AcctCode,AcctName,UserSign,CreateDate,Postable,FatherNum, ActType,ActCurr,LocManTran, CurrTotal,Finanse,Levels,SysTotal,FcTotal,Advance,GroupMask) VALUES(@AcctCode,@AcctName,@UserSign,@CreateDate,@Postable,@FatherNum,@ActType,@ActCurr,@LocManTran,@CurrTotal,@Finanse,@Levels,@SysTotal,@FcTotal,@Advance,@GroupMask)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindFatherNum]\r\n\r\n@AcctCode nvarchar(15)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT FatherNum FROM OACT WHERE AcctCode=@AcctCode\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateAccountTratar]\r\n\r\n@AcctCode nvarchar(15),\r\n@AcctName nvarchar(100),\r\n@UserSign smallint,\r\n@CreateDate datetime,\r\n@FatherNum nvarchar(15),\r\n@Postable char(1)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE OACT SET AcctCode=@AcctCode, AcctName=@AcctName, UserSign=@UserSign, UpdateDate=@CreateDate, FatherNum=@FatherNum, Postable=@Postable WHERE AcctCode=@AcctCode\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\n\r\nCREATE PROC [dbo].[LastBusinessPartner]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM OCRD ORDER BY CardCode DESC\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FirstBusinessPartner]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM OCRD ORDER BY CardCode\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[PreviousBusinessPartner]\r\n\r\n@CardCode nvarchar(15)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result nvarchar(15)\r\n\r\nSET @Result=(SELECT Previous\r\nFROM\r\n    (Select CardCode,LAG(CardCode) over (order by CardCode) Previous\r\n      from OCRD) AS NextQueryBP\r\n Where CardCode=@CardCode)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM OCRD WHERE CardCode=@Result\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM OCRD ORDER BY CardCode DESC\r\n END\r\n\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[NextBusinessPartner]\r\n\r\n@CardCode nvarchar(15)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result nvarchar(15)\r\n\r\nSET @Result=(SELECT Siguiente\r\nFROM\r\n    (Select CardCode,LEAD(CardCode) over (order by CardCode) Siguiente\r\n      from OCRD) AS NextQueryBP\r\n Where CardCode=@CardCode)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM OCRD WHERE CardCode=@Result\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM OCRD ORDER BY CardCode\r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindBusinessPartner]\r\n\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar (100),\r\n@CardType char(1),\r\n@LicTradNum nvarchar(32),\r\n@Currency nvarchar(3),\r\n@TipoPersona nvarchar(10),\r\n@Sucursal nvarchar(10),\r\n@Contribuyente nvarchar(10),\r\n@AplicaITF nvarchar(10)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT * FROM OCRD WHERE CardCode LIKE  @CardCode + '%' OR CardName LIKE @CardName + '%' OR CardType LIKE @CardType + '%' OR LicTradNum LIKE @LicTradNum + '%' OR Currency LIKE @Currency + '%' OR U_IDA_TipoPersona LIKE @TipoPersona + '%' OR U_IDA_Contribuyente LIKE @Contribuyente + '%' OR U_IDA_Sucursal LIKE @Sucursal + '%' OR U_IDA_AplicaITF LIKE @AplicaITF + '%'\r\n\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertBusinessPartner]\r\n\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar (100),\r\n@CardType char(1),\r\n@LicTradNum nvarchar(32),\r\n@Currency nvarchar(3),\r\n@TipoPersona nvarchar(10),\r\n@Sucursal nvarchar(10),\r\n@Contribuyente nvarchar(10),\r\n@AplicaITF nvarchar(10),\r\n@Balance numeric(19,6),\r\n@BalanceSys numeric(19,6),\r\n@BalanceFC numeric(19,6),\r\n@DNotesBal numeric(19,6),\r\n@DNoteBalSy numeric(19,6),\r\n@DNoteBalFC numeric(19,6),\r\n@Phone1 nvarchar(20),\r\n@Phone2 nvarchar(20),\r\n@Fax nvarchar(20),\r\n@E_Mail nvarchar(100),\r\n@MailAddress nvarchar(100),\r\n@CntctPrsn nvarchar(90),\r\n@VatGroup nvarchar(8),\r\n@Address nvarchar(100),\r\n@DebPayAcct nvarchar(15),\r\n@UpdateDate datetime,\r\n@UserSign smallint,\r\n@Deleted char(1)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO OCRD (CardCode,CardName,CardType,LicTradNum,Currency,U_IDA_TipoPersona,U_IDA_Sucursal,U_IDA_Contribuyente,U_IDA_AplicaITF, Balance, Phone1,Phone2,Fax,E_Mail,MailAddres,CntctPrsn, VatGroup, Address, DebPayAcct, CreateDate, UserSign, Deleted, BalanceSys, BalanceFC, DNotesBal, DNoteBalSy, DNoteBalFC) VALUES(@CardCode,@CardName,@CardType,@LicTradNum,@Currency,@TipoPersona, @Sucursal, @Contribuyente, @AplicaITF, @Balance, @Phone1, @Phone2, @Fax, @E_Mail,@MailAddress, @CntctPrsn, @VatGroup, @Address, @DebPayAcct, @UpdateDate,@UserSign,@Deleted,  @BalanceSys, @BalanceFC, @DNotesBal, @DNoteBalSy, @DNoteBalFC)\r\n\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateBusinessPartner]\r\n\r\n@OldCardCode nvarchar(15),\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar (100),\r\n@CardType char(1),\r\n@LicTradNum nvarchar(32),\r\n@Currency nvarchar(3),\r\n@TipoPersona nvarchar(10),\r\n@Sucursal nvarchar(10),\r\n@Contribuyente nvarchar(10),\r\n@AplicaITF nvarchar(10),\r\n@Phone1 nvarchar(20),\r\n@Phone2 nvarchar(20),\r\n@Fax nvarchar(20),\r\n@E_Mail nvarchar(100),\r\n@MailAddress nvarchar(100),\r\n@CntctPrsn nvarchar(90),\r\n@VatGroup nvarchar(8),\r\n@Address nvarchar(100),\r\n@DebPayAcct nvarchar(15),\r\n@UpdateDate datetime,\r\n@UserSign smallint\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE OCRD SET CardCode=@CardCode, CardName=@CardName, CardType=@CardType, LicTradNum=@LicTradNum, Currency=@Currency, U_IDA_TipoPersona=@TipoPersona, U_IDA_Contribuyente=@Contribuyente, U_IDA_AplicaITF=@AplicaITF, U_IDA_Sucursal=@Sucursal, Phone1=@Phone1, Phone2=@Phone2, Fax=@Fax, E_Mail=@E_Mail, MailAddres=@MailAddress, CntctPrsn=@CntctPrsn, VatGroup=@VatGroup, DebPayAcct=@DebPayAcct, Address=@Address, UserSign=@UserSign, UpdateDate=@UpdateDate WHERE CardCode=@OldCardCode\r\n\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindAccountAsociada]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT AcctCode, AcctName FROM OACT WHERE LocManTran='Y' AND Postable='Y'\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindCodigosFiscalesActivos]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT Code,Rate FROM OSTC WHERE Lock='N'\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindAccountNoAsociada]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT AcctCode, AcctName FROM OACT WHERE LocManTran='N' AND Postable='Y'\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\n\r\nCREATE PROC [dbo].[LastItem]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM OITM ORDER BY ItemCode DESC\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FirstItem]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM OITM ORDER BY ItemCode\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[PreviousItem]\r\n\r\n@ItemCode nvarchar(50)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result nvarchar(50)\r\n\r\nSET @Result=(SELECT Previous\r\nFROM\r\n    (Select ItemCode,LAG(ItemCode) over (order by ItemCode) Previous\r\n      from OITM) AS NextQueryItem\r\n Where ItemCode=@ItemCode)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM OITM WHERE ItemCode=@Result\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM OITM ORDER BY ItemCode DESC\r\n END\r\n\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[NextItem]\r\n\r\n@ItemCode nvarchar(50)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result nvarchar(50)\r\n\r\nSET @Result=(SELECT Siguiente\r\nFROM\r\n    (Select ItemCode,LEAD(ItemCode) over (order by ItemCode) Siguiente\r\n      from OITM) AS NextQueryItem\r\n Where ItemCode=@ItemCode)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM OITM WHERE ItemCode=@Result\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM OITM ORDER BY ItemCode\r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindItem]\r\n\r\n@ItemCode nvarchar(50),\r\n@ItemName nvarchar (100),\r\n@PrchseItem char(1),\r\n@SellItem char(1),\r\n@InvntItem char(1),\r\n@EvalSystem char(1),\r\n@UgpEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT * FROM OITM WHERE ItemCode LIKE  @ItemCode + '%' OR ItemName LIKE @ItemName + '%' OR PrchseItem LIKE @PrchseItem + '%' OR SellItem LIKE @SellItem + '%' OR InvntItem LIKE @InvntItem + '%' OR EvalSystem LIKE @EvalSystem + '%' OR UgpEntry LIKE @UgpEntry + '%' \r\n\r\nEND\r\n\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertItem]\r\n\r\n@ItemCode nvarchar(50),\r\n@ItemName nvarchar (100),\r\n@VatLiable char(1),\r\n@PrchseItem char(1),\r\n@SellItem char(1),\r\n@InvnItem char(1),\r\n@OnHand numeric(19,6),\r\n@IsCommited numeric(19,6),\r\n@OnOrders numeric(19,6),\r\n@Deleted char(1),\r\n@CreateDate datetime,\r\n@StockValue numeric(19,6),\r\n@UserSign int,\r\n@BalInvntAc nvarchar(15),\r\n@ExpensesAc nvarchar(15),\r\n@RevenuesAc nvarchar(15),\r\n@SaleCostAc nvarchar(15),\r\n@TransferAc nvarchar(15),\r\n@EvalSystem char(1),\r\n@UgpEntry int,\r\n@InvntryUomCode nvarchar(20),\r\n@InvntryUomName nvarchar(100),\r\n@NumInCnt numeric(19,6),\r\n@InvntryUomEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO OITM (ItemCode,ItemName,VATLiable,PrchseItem,SellItem,InvntItem,OnHand,IsCommited,OnOrder, Deleted,CreateDate,StockValue,UserSign,BalInvntAc,ExpensesAc,RevenuesAc,SaleCostAc, TransferAc, EvalSystem, UgpEntry, InvntryUomCode, InvntryUomName,NumInCnt, InvntryUomEntry) VALUES(@ItemCode,@ItemName,@VatLiable,@PrchseItem,@SellItem,@InvnItem, @OnHand, @IsCommited, @OnOrders, @Deleted, @CreateDate, @StockValue, @UserSign,@BalInvntAc,@ExpensesAc,@RevenuesAc,@SaleCostAc,@TransferAc,@EvalSystem,@UgpEntry,@InvntryUomCode, @InvntryUomName,@NumInCnt,@InvntryUomEntry)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateItem]\r\n\r\n@OldItemCode nvarchar(50),\r\n@ItemCode nvarchar(50),\r\n@ItemName nvarchar (100),\r\n@VatLiable char(1),\r\n@PrchseItem char(1),\r\n@SellItem char(1),\r\n@InvnItem char(1),\r\n@UpdateDate datetime,\r\n@UserSign int,\r\n@BalInvntAc nvarchar(15),\r\n@ExpensesAc nvarchar(15),\r\n@RevenuesAc nvarchar(15),\r\n@SaleCostAc nvarchar(15),\r\n@TransferAc nvarchar(15),\r\n@EvalSystem char(1),\r\n@UgpEntry int, \r\n@InvntryUomCode nvarchar(20),\r\n@InvntryUomName nvarchar(100),\r\n@NumInCnt numeric(19,6),\r\n@InvntryUomEntry int\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE OITM SET ItemCode=@ItemCode, ItemName=@ItemName, VATLiable=@VatLiable, PrchseItem=@PrchseItem, SellItem=@SellItem, InvntItem=@InvnItem, UpdateDate=@UpdateDate, UserSign2=@UserSign, BalInvntAc=@BalInvntAc, ExpensesAc=@ExpensesAc,RevenuesAc=@RevenuesAc,SaleCostAc=@SaleCostAc, TransferAc=@TransferAc, EvalSystem=@EvalSystem, UgpEntry=@UgpEntry, InvntryUomCode=@InvntryUomCode, InvntryUomName=@InvntryUomName, NumInCnt=@NumInCnt, InvntryUomEntry=@InvntryUomEntry WHERE ItemCode=@OldItemCode\r\n\r\nEND\r\n\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeleteBusinessPartner]\r\n@CardCode nvarchar(15)\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @CardCodeOPCH int\r\nDECLARE @CardCodeOINV int\r\nDECLARE @CardCodeODLN int\r\nDECLARE @CardCodeORPC int\r\nDECLARE @CardCodeOPDN int\r\nDECLARE @CardCodeORIN int\r\nDECLARE @CardCodeJDT1 int\r\nDECLARE @Result int\r\n\r\nSET @CardCodeOPCH = (SELECT COUNT(CardCode) FROM OPCH WHERE CardCode=@CardCode)\r\nSET @CardCodeOINV = (SELECT COUNT(CardCode) FROM OINV WHERE CardCode=@CardCode)\r\nSET @CardCodeODLN = (SELECT COUNT(CardCode) FROM ODLN WHERE CardCode=@CardCode)\r\nSET @CardCodeORPC = (SELECT COUNT(CardCode) FROM ORPC WHERE CardCode=@CardCode)\r\nSET @CardCodeOPDN = (SELECT COUNT(CardCode) FROM OPDN WHERE CardCode=@CardCode)\r\nSET @CardCodeORIN = (SELECT COUNT(CardCode) FROM ORIN WHERE CardCode=@CardCode)\r\nSET @CardCodeJDT1 = (SELECT COUNT(ShortName) FROM JDT1 WHERE ShortName=@CardCode)\r\n\r\nSET @Result=@CardCodeOPCH+@CardCodeOINV+@CardCodeODLN+@CardCodeORPC+@CardCodeOPDN+@CardCodeORIN+@CardCodeJDT1\r\n\r\nIF (@Result=0)\r\nBEGIN\r\nDELETE FROM OCRD WHERE CardCode=@CardCode\r\nEND\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeleteItem]\r\n@ItemCode nvarchar(50)\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @ItemCodePCH1 int\r\nDECLARE @ItemCodeINV1 int\r\nDECLARE @ItemCodeDLN1 int\r\nDECLARE @ItemCodeRPC1 int\r\nDECLARE @ItemCodePDN1 int\r\nDECLARE @ItemCodeRIN1 int\r\nDECLARE @Result int\r\n\r\nSET @ItemCodePCH1 = (SELECT COUNT(ItemCode) FROM PCH1 WHERE ItemCode=@ItemCode)\r\nSET @ItemCodeINV1 = (SELECT COUNT(ItemCode) FROM INV1 WHERE ItemCode=@ItemCode)\r\nSET @ItemCodeDLN1 = (SELECT COUNT(ItemCode) FROM DLN1 WHERE ItemCode=@ItemCode)\r\nSET @ItemCodeRPC1 = (SELECT COUNT(ItemCode) FROM RPC1 WHERE ItemCode=@ItemCode)\r\nSET @ItemCodePDN1 = (SELECT COUNT(ItemCode) FROM PDN1 WHERE ItemCode=@ItemCode)\r\nSET @ItemCodeRIN1 = (SELECT COUNT(ItemCode) FROM RIN1 WHERE ItemCode=@ItemCode)\r\n\r\nSET @Result=@ItemCodePCH1+@ItemCodeINV1+@ItemCodeDLN1+@ItemCodeRPC1+@ItemCodePDN1+@ItemCodeRIN1\r\n\r\nIF (@Result=0)\r\nBEGIN\r\nDELETE FROM OITM WHERE ItemCode=@ItemCode\r\nEND\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeleteCodigoFiscal]\r\n@Code nvarchar(8)\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @CodePCH1 int\r\nDECLARE @CodeINV1 int\r\nDECLARE @CodeDLN1 int\r\nDECLARE @CodeRPC1 int\r\nDECLARE @CodePDN1 int\r\nDECLARE @CodeRIN1 int\r\nDECLARE @Result int\r\n\r\n\r\nSET @CodePCH1 = (SELECT COUNT(VatGroup) FROM PCH1 WHERE VatGroup=@Code)\r\nSET @CodeINV1 = (SELECT COUNT(VatGroup) FROM INV1 WHERE VatGroup=@Code)\r\nSET @CodeDLN1 = (SELECT COUNT(VatGroup) FROM DLN1 WHERE VatGroup=@Code)\r\nSET @CodeRPC1 = (SELECT COUNT(VatGroup) FROM RPC1 WHERE VatGroup=@Code)\r\nSET @CodePDN1 = (SELECT COUNT(VatGroup) FROM PDN1 WHERE VatGroup=@Code)\r\nSET @CodeRIN1 = (SELECT COUNT(VatGroup) FROM RIN1 WHERE VatGroup=@Code)\r\n\r\n\r\nSET @Result=@CodeDLN1+@CodeINV1+@CodePCH1+@CodePDN1+@CodeRIN1+@CodeRPC1\r\n\r\nIF (@Result=0)\r\nBEGIN\r\nDELETE FROM OSTC WHERE Code=@Code\r\nEND\r\nEND\r\n\r\nGO\r\n/****** Object:  StoredProcedure [dbo].[DeleteAccount]    Script Date: 17/7/2020 12:35:28 a. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeleteTaxHolding]\r\n@WTCode nvarchar(4)\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @WTCodePCH5 int\r\nDECLARE @WTCodeINV5 int\r\nDECLARE @WTCodeDLN5 int\r\nDECLARE @WTCodeRPC5 int\r\nDECLARE @WTCodePDN5 int\r\nDECLARE @WTCodeRIN5 int\r\nDECLARE @Result int\r\n\r\n\r\nSET @WTCodePCH5 = (SELECT COUNT(WTCode) FROM PCH5 WHERE WTCode=@WTCode)\r\nSET @WTCodeINV5 = (SELECT COUNT(WTCode) FROM INV5 WHERE WTCode=@WTCode)\r\nSET @WTCodeDLN5 = (SELECT COUNT(WTCode) FROM DLN5 WHERE WTCode=@WTCode)\r\nSET @WTCodeRPC5 = (SELECT COUNT(WTCode) FROM RPC5 WHERE WTCode=@WTCode)\r\nSET @WTCodePDN5 = (SELECT COUNT(WTCode) FROM PDN5 WHERE WTCode=@WTCode)\r\nSET @WTCodeRIN5 = (SELECT COUNT(WTCode) FROM RIN5 WHERE WTCode=@WTCode)\r\n\r\n\r\nSET @Result=@WTCodeDLN5+@WTCodeINV5+@WTCodePCH5+@WTCodePDN5+@WTCodeRIN5+@WTCodeRPC5\r\n\r\nIF (@Result=0)\r\nBEGIN\r\nDELETE FROM OWHT WHERE WTCode=@WTCode\r\nEND\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeleteUser]\r\n@USER_CODE nvarchar(25)\r\nAS\r\n\r\nBEGIN\r\nDECLARE @UserSign smallint\r\nDECLARE @UserOCRD int\r\nDECLARE @UserOPCH int\r\nDECLARE @UserOJDT int\r\nDECLARE @UserJDT1 int\r\nDECLARE @UserOACP int\r\nDECLARE @UserOACT int\r\nDECLARE @UserOADM int\r\nDECLARE @UserOCRN int\r\nDECLARE @UserODLN int\r\nDECLARE @UserOFPR int\r\nDECLARE @UserOINV int\r\nDECLARE @UserOITM int\r\nDECLARE @UserOPDN int\r\nDECLARE @UserORIN int\r\nDECLARE @UserORPC int\r\nDECLARE @UserORTT int\r\nDECLARE @UserOSTA int\r\nDECLARE @UserOSTC int\r\nDECLARE @UserOWHT int\r\nDECLARE @Result int\r\n\r\nSET @UserSign=(SELECT USERID FROM OUSR WHERE USER_CODE=@USER_CODE)\r\n\r\nSET @UserOCRD = (SELECT COUNT(UserSign) FROM OCRD WHERE UserSign=@UserSign)\r\nSET @UserOPCH = (SELECT COUNT(UserSign) + COUNT(UserSign2) FROM OPCH WHERE UserSign=@UserSign)\r\nSET @UserOJDT = (SELECT COUNT(UserSign) + COUNT(UserSign2) FROM OJDT WHERE UserSign=@UserSign)\r\nSET @UserJDT1 = (SELECT COUNT(UserSign) FROM JDT1 WHERE UserSign=@UserSign)\r\nSET @UserOACP = (SELECT COUNT(UserSign) FROM OACP WHERE UserSign=@UserSign)\r\nSET @UserOACT = (SELECT COUNT(UserSign) + COUNT(UserSign2) FROM OACT WHERE UserSign=@UserSign)\r\nSET @UserOADM = (SELECT COUNT(UserSign) FROM OADM WHERE UserSign=@UserSign)\r\nSET @UserOCRN = (SELECT COUNT(UserSign) + COUNT(UserSign2) FROM OCRN WHERE UserSign=@UserSign)\r\nSET @UserODLN = (SELECT COUNT(UserSign) + COUNT(UserSign2) FROM ODLN WHERE UserSign=@UserSign)\r\nSET @UserOFPR = (SELECT COUNT(UserSign) + COUNT(UserSign2) FROM OFPR WHERE UserSign=@UserSign)\r\nSET @UserOINV = (SELECT COUNT(UserSign) + COUNT(UserSign2) FROM OINV WHERE UserSign=@UserSign)\r\nSET @UserOITM = (SELECT COUNT(UserSign) + COUNT(UserSign2) FROM OITM WHERE UserSign=@UserSign)\r\nSET @UserOPDN = (SELECT COUNT(UserSign) + COUNT(UserSign2) FROM OPDN WHERE UserSign=@UserSign)\r\nSET @UserORIN = (SELECT COUNT(UserSign) + COUNT(UserSign2) FROM ORIN WHERE UserSign=@UserSign)\r\nSET @UserORPC = (SELECT COUNT(UserSign) + COUNT(UserSign2) FROM ORPC WHERE UserSign=@UserSign)\r\nSET @UserORTT = (SELECT COUNT(UserSign) FROM ORTT WHERE UserSign=@UserSign)\r\nSET @UserOSTA = (SELECT COUNT(UserSign) FROM OSTA WHERE UserSign=@UserSign)\r\nSET @UserOSTC = (SELECT COUNT(UserSign) + COUNT(UserSign2) FROM OSTC WHERE UserSign=@UserSign)\r\nSET @UserOWHT = (SELECT COUNT(UserSign) FROM OSTA WHERE UserSign=@UserSign)\r\n\r\nSET @Result=@UserOCRD+@UserOPCH+@UserOJDT+@UserOACP+@UserOACT+@UserOADM+@UserOCRN+@UserODLN+@UserOFPR+@UserOINV+@UserOITM+@UserOPDN+@UserORIN+@UserORPC+@UserORTT+@UserOSTA+@UserOSTC+@UserOWHT\r\n\r\nIF (@Result=0)\r\nBEGIN\r\nDELETE FROM OUSR WHERE USER_CODE=@USER_CODE\r\nEND\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\n\r\nCREATE PROC [dbo].[LastJournalEntry]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM OJDT ORDER BY TransId DESC\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FirstJournalEntry]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM OJDT ORDER BY TransId\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[PreviousJournalEntry]\r\n\r\n@TransId int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result int\r\n\r\nSET @Result=(SELECT Previous\r\nFROM\r\n    (Select TransId,LAG(TransId) over (order by TransId) Previous\r\n      from OJDT) AS PreviousQueryJournalEntry\r\n Where TransId=@TransId)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM OJDT WHERE TransId=@Result\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM OJDT ORDER BY TransId DESC\r\n END\r\n\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[NextJournalEntry]\r\n\r\n@TransId int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result int\r\n\r\nSET @Result=(SELECT Siguiente\r\nFROM\r\n    (Select TransId,LEAD(TransId) over (order by TransId) Siguiente\r\n      from OJDT) AS NextQueryJournalEntry\r\n Where TransId=@TransId)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM OJDT WHERE TransId=@Result\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM OJDT ORDER BY TransId\r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindJournalEntryLines]\r\n\r\n@TransId int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TransId,Line_ID, Account,Debit,Credit,SYSCred,SYSDeb,FCDebit,FCCredit,ShortName,LineMemo,UserSign,DataSource, FCCurrency, ContraAct FROM JDT1 WHERE TransId=@TransId\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertJournalEntry]\r\n\r\n@RefDate datetime,\r\n@TaxDate datetime,\r\n@DueDate datetime,\r\n@Memo nvarchar(50),\r\n@Ref1 nvarchar(100),\r\n@Ref2 nvarchar(100),\r\n@CreateDate datetime,\r\n@UserSign int,\r\n@TransCurr nvarchar(3),\r\n@BaseRef int,\r\n@FinncPriod int,\r\n@LocTotal numeric(19,6),\r\n@SysTotal numeric(19,6),\r\n@FcTotal numeric(19,6),\r\n@TransType nvarchar(20)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO OJDT (RefDate,TaxDate,DueDate,Memo,Ref1,Ref2,CreateDate,UserSign, TransCurr, BaseRef, FinncPriod, LocTotal, SysTotal, FcTotal, TransType) VALUES(@RefDate,@TaxDate,@DueDate,@Memo,@Ref1, @Ref2, @CreateDate, @UserSign,@TransCurr, @BaseRef, @FinncPriod, @LocTotal, @SysTotal, @FcTotal,@TransType)\r\n\r\nEND\r\n\r\n\r\nGO\r\n/****** Object:  StoredProcedure [dbo].[FindPeriodCode]    Script Date: 25/4/2020 5:16:36 p. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindPeriodCode]\r\n\r\n@RefDate datetime\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT AbsEntry FROM OFPR WHERE @RefDate BETWEEN F_RefDate AND T_RefDate\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindRate]\r\n\r\n@RateDate datetime\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT Rate FROM ORTT WHERE RateDate=@RateDate AND Currency=(SELECT SysCurrncy FROM OADM)\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindMainSysCurrency]\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT MainCurncy, SysCurrncy FROM OADM \r\n \r\nEND\r\n\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindExistFCCurrency]\r\n\r\n@FCCurrency nvarchar(3)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT CurrCode FROM OCRN WHERE CurrCode=@FCCurrency AND CurrCode<>(SELECT MainCurncy FROM OADM)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindRateFC]\r\n\r\n@RateDate datetime,\r\n@Currency nvarchar(3)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT Rate FROM ORTT WHERE RateDate=@RateDate AND Currency=@Currency\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[SelectTransId]\r\n\r\nAS\r\n\r\nDECLARE @TransId int\r\n\r\nBEGIN\r\n\r\nSET @TransId =(SELECT (SELECT DISTINCT TOP 1 TransId FROM OJDT ORDER BY TransId DESC) + 1 AS TransId)\r\n\r\nIF(@TransId IS NULL)\r\nBEGIN \r\nSELECT 1 AS TransId\r\nEND\r\nELSE\r\nBEGIN\r\nSELECT @TransId AS TransId\r\nEND\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertJournalEntryLines]\r\n\r\n@TransId int,\r\n@LineId int,\r\n@RefDate datetime,\r\n@TaxDate datetime,\r\n@DueDate datetime,\r\n@Account nvarchar(15),\r\n@ShortName nvarchar(15),\r\n@LineMemo nvarchar(50),\r\n@TransType nvarchar(20),\r\n@Debit numeric (19,6),\r\n@Credit numeric (19,6),\r\n@SysCred numeric (19,6),\r\n@SysDeb numeric (19,6),\r\n@FCDebit numeric (19,6),\r\n@FCCredit numeric (19,6),\r\n@BalDueDeb numeric (19,6),\r\n@BalDueCred numeric (19,6),\r\n@BalFcDeb numeric (19,6),\r\n@BalFcCred numeric (19,6),\r\n@BalScCred numeric (19,6),\r\n@BalScDeb numeric (19,6),\r\n@UserSign int,\r\n@FinncPriod int,\r\n@FCCurrency nvarchar(3),\r\n@DataSource char(1),\r\n@ContraAct nvarchar(15)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO JDT1 (TransId,Line_ID,RefDate,DueDate,TaxDate,Account,ShortName,LineMemo,TransType, Debit, Credit, FCDebit, FCCredit, SYSDeb, SYSCred, BalDueDeb, BalDueCred, BalFcDeb, BalFcCred,BalScDeb, BalScCred, UserSign, FinncPriod, FCCurrency, DataSource, ContraAct) VALUES(@TransId,@LineId,@RefDate,@DueDate,@TaxDate,@Account,@ShortName,@LineMemo,@TransType, @Debit, @Credit, @FCDebit, @FCCredit, @SysDeb, @SysCred,@BalDueDeb, @BalDueCred, @BalFcDeb, @BalFcCred,@BalScDeb, @BalScCred, @UserSign, @FinncPriod, @FCCurrency, @DataSource,@ContraAct)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateDebitCreditAccount]\r\n\r\n@AcctCode nvarchar(15),\r\n@CurrTotal numeric(19,6),\r\n@SysTotal numeric(19,6),\r\n@FcTotal numeric(19,6)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE OACT SET CurrTotal=(CurrTotal+@CurrTotal), SysTotal=(SysTotal+@SysTotal), FcTotal=(FcTotal+@FcTotal) WHERE AcctCode=@AcctCode\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[SelectBaseRef]\r\n\r\nAS\r\n\r\nDECLARE @BaseRef int\r\n\r\nBEGIN\r\n\r\nSET @BaseRef =(SELECT (SELECT DISTINCT TOP 1 BaseRef FROM OJDT ORDER BY BaseRef DESC) + 1 AS BaseRef)\r\n\r\nIF(@BaseRef IS NULL)\r\nBEGIN \r\nSELECT 1 AS BaseRef\r\nEND\r\nELSE\r\nBEGIN\r\nSELECT @BaseRef AS BaseRef\r\nEND\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindAcctName]\r\n\r\n@AcctCode nvarchar(15)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @AcctName nvarchar(50)\r\n\r\nSET @AcctName=(SELECT TOP 1 AcctName AS 'AcctName' FROM OACT WHERE AcctCode=@AcctCode)\r\n\r\nIF(@AcctName IS NULL)\r\nBEGIN\r\nSELECT TOP 1 CardName AS 'AcctName' FROM OCRD WHERE CardCode=@AcctCode\r\nEND\r\nELSE\r\nBEGIN\r\nSELECT @AcctName AS 'AcctName'\r\nEND\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindJournalEntry]\r\n\r\n@TransId int,\r\n@RefDate datetime, \r\n@TaxDate datetime,\r\n@DueDate datetime,\r\n@Memo nvarchar(50),\r\n@Ref1 nvarchar(100),\r\n@Ref2 nvarchar(100)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TransId,RefDate,TaxDate,DueDate, Memo,TransType,Ref1,Ref2, BaseRef FROM OJDT WHERE TransId LIKE CAST(@TransId AS nvarchar)+ '%' OR RefDate LIKE CAST(@RefDate AS nvarchar) + '%' OR TaxDate LIKE CAST(@TaxDate AS nvarchar)+ '%' OR DueDate LIKE CAST(@DueDate AS NVARCHAR) + '%' OR Memo LIKE @Memo + '%' OR Ref1 LIKE @Ref1 + '%' OR Ref2 LIKE @Ref2 + '%'\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateJournalEntry]\r\n\r\n@TransId int,\r\n@TaxDate datetime, \r\n@DueDate datetime,\r\n@Memo nvarchar(50),\r\n@Ref1 nvarchar(100),\r\n@Ref2 nvarchar(100),\r\n@UserSign smallint,\r\n@UpdateDate datetime\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE OJDT SET TaxDate=@TaxDate, DueDate=@DueDate, Memo=@Memo, Ref1=@Ref1, Ref2=@Ref2, UserSign2=@UserSign, UpdateDate=@UpdateDate WHERE TransId=@TransId\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateJournalEntryLines]\r\n\r\n@TransId int,\r\n@LineId int,\r\n@TaxDate datetime, \r\n@DueDate datetime,\r\n@LineMemo nvarchar(50),\r\n@UserSign smallint\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE JDT1 SET TaxDate=@TaxDate, DueDate=@DueDate, LineMemo=@LineMemo, UserSign=@UserSign WHERE TransId=@TransId AND Line_ID=@LineId\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[SelectDocNumOPCH]\r\n\r\nAS\r\n\r\nDECLARE @DocNum int\r\n\r\nBEGIN\r\n\r\nSET @DocNum =(SELECT (SELECT DISTINCT TOP 1 DocNum FROM OPCH ORDER BY DocNum DESC) + 1 AS DocNum)\r\n\r\nIF(@DocNum IS NULL)\r\nBEGIN \r\nSELECT 1 AS DocNum\r\nEND\r\nELSE\r\nBEGIN\r\nSELECT @DocNum AS DocNum\r\nEND\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindSuppliers]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT * FROM OCRD WHERE CardType='S'\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindBusinessPartnerCurrency]\r\n\r\n@CardCode nvarchar(15)\r\n\r\nAS\r\n\r\nDECLARE @Currency nvarchar(3)\r\n\r\nBEGIN\r\n\r\nSET @Currency=(SELECT Currency FROM OCRD WHERE CardCode=@CardCode)\r\n\r\nIF(@Currency='##')\r\nBEGIN \r\nSELECT CurrCode, CurrName FROM OCRN\r\nEND\r\nELSE\r\nBEGIN\r\nSELECT CurrCode, CurrName FROM OCRN WHERE CurrCode=@Currency\r\nEND\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertPurchaseInvoice]\r\n\r\n@DocNum int,\r\n@DocType char(1),\r\n@Canceled char(1),\r\n@DocStatus char(1),\r\n@InvntSttus char(1),\r\n@DocDate datetime,\r\n@DocDueDate datetime,\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar(100),\r\n@Address2 nvarchar(254),\r\n@TaxDate datetime,\r\n@Comments nvarchar(254),\r\n@JrnlMemo nvarchar(50),\r\n@VatSum numeric (19,6),\r\n@VatSumFC numeric (19,6),\r\n@VatSumSy numeric (19,6),\r\n@UserSign int,\r\n@UpdateDate datetime,\r\n@FinncPriod int,\r\n@DocCurr nvarchar(3),\r\n@DocTotal numeric (19,6),\r\n@DocTotalFC numeric (19,6),\r\n@DocTotalSy numeric (19,6),\r\n@ObjType nvarchar(20),\r\n@LicTradNum nvarchar(32),\r\n@TransId int,\r\n@VatPaid numeric (19,6),\r\n@VatPaidFC numeric (19,6),\r\n@VatPaidSys numeric (19,6),\r\n@PaidToDate numeric (19,6),\r\n@PaidSum numeric (19,6),\r\n@PaidSumFc numeric (19,6),\r\n@PaidSumSc numeric (19,6),\r\n@WtApplied numeric (19,6),\r\n@WtAppliedF numeric (19,6),\r\n@WtAppliedS numeric (19,6),\r\n@WtSum numeric (19,6),\r\n@WtSumFC numeric (19,6),\r\n@WtSumSC numeric (19,6),\r\n@SysRate numeric (19,6),\r\n@DocRate numeric (19,6),\r\n@CtlAccount nvarchar(15),\r\n@BaseAmnt numeric (19,6),\r\n@BaseAmntFC numeric (19,6),\r\n@BaseAmntSC numeric (19,6),\r\n@DocSubType nvarchar(2),\r\n@NumAtCard nvarchar(100),\r\n@NumControl nvarchar(20),\r\n@TipoTrans nvarchar(10),\r\n@Max1099 numeric(19,6)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO OPCH (DocNum,DocType,CANCELED,DocStatus,InvntSttus,DocDate,DocDueDate,CardCode,CardName, Address2, TaxDate, Comments, JrnlMemo, VatSum, VatSumFC,VatSumSy, UserSign, FinncPriod, DocCur, DocTotal, DocTotalFC, DocTotalSy, ObjType, LicTradNum, TransId, VatPaid, VatPaidFC, VatPaidSys, PaidToDate, PaidSum,PaidSumSc, PaidSumFc, WTApplied, WTAppliedF, WTAppliedS, WTSum, WTSumFC, WTSumSC, SysRate, DocRate, CtlAccount, BaseAmnt, BaseAmntFC, BaseAmntSC, DocSubType, NumAtCard, U_IDA_NumControl, U_IDA_TipoTrans, UpdateDate, Max1099) VALUES(@DocNum,@DocType,@Canceled,@DocStatus,@InvntSttus,@DocDate,@DocDueDate,@CardCode,@CardName, @Address2, @TaxDate, @Comments, @JrnlMemo, @VatSum, @VatSumFC,@VatSumSy, @UserSign, @FinncPriod, @DocCurr, @DocTotal, @DocTotalFC, @DocTotalSy, @ObjType, @LicTradNum, @TransId, @VatPaid, @VatPaidFC, @VatPaidSys, @PaidToDate, @PaidSum,@PaidSumSc, @PaidSumFc, @WtApplied, @WtAppliedF, @WtAppliedS, @WtSum, @WtSumFC, @WtSumSC, @SysRate, @DocRate, @CtlAccount, @BaseAmnt, @BaseAmntFC, @BaseAmntSC, @DocSubType, @NumAtCard, @NumControl, @TipoTrans, @UpdateDate,@Max1099)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindHoldingTax]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT WTCode,WTName,Rate,EffecDate, Category, BaseType, PrctBsAmnt, Account, U_IDA_BaseMinima,U_IDA_Sustraendo FROM OWHT WHERE Inactive='N'\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindTaxRate]\r\n\r\n@Code nvarchar(8)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT Rate FROM OSTC WHERE Code=@Code\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindItemPurchase]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT ItemCode, ItemName, OnHand, UgpEntry,InvntryUomCode,InvntryUomName,NumInCnt, EvalSystem, InvntryUomEntry FROM OITM WHERE PrchseItem='Y'\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertPurchaseInvoiceLines]\r\n\r\n@DocEntry int,\r\n@LineNum int,\r\n@LineStatus char(1),\r\n@ItemCode nvarchar(50),\r\n@Dscription nvarchar(100),\r\n@Quantity numeric (19,6),\r\n@OpenQty numeric (19,6),\r\n@InvQty numeric (19,6),\r\n@OpenInvQty numeric (19,6),\r\n@Price numeric (19,6),\r\n@Currency nvarchar(3),\r\n@LineTotal numeric (19,6),\r\n@AcctCode nvarchar(15),\r\n@DocDate datetime,\r\n@BaseCard nvarchar(15),\r\n@TotalSumSy numeric (19,6),\r\n@TotalFrgn numeric (19,6),\r\n@VatSum numeric (19,6),\r\n@VatSumFrgn numeric (19,6),\r\n@VatSumSy numeric (19,6),\r\n@VatGroup nvarchar(8),\r\n@VatPrcnt numeric (19,6),\r\n@FinncPriod int,\r\n@ObjType nvarchar(20),\r\n@Address nvarchar(254),\r\n@GTotal numeric (19,6),\r\n@GTotalFC numeric (19,6),\r\n@GTotalSC numeric (19,6),\r\n@StockSum numeric (19,6),\r\n@StockSumFc numeric (19,6),\r\n@StockSumSc numeric (19,6),\r\n@InvntSttus char(1),\r\n@WtLiable char(1),\r\n@DataSource char(1),\r\n@NumPerMsr numeric (19,6),\r\n@NumPerMsr2 numeric (19,6),\r\n@UomCode nvarchar(20),\r\n@UomCode2 nvarchar(20),\r\n@UomEntry int,\r\n@UomEntry2 int,\r\n@unitMsr nvarchar(100),\r\n@unitMsr2 nvarchar(100),\r\n@IsTax char(1),\r\n@StartValue char(1)\r\n\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO PCH1 (DocEntry,LineNum,LineStatus,ItemCode,Dscription,Quantity,OpenQty,InvQty,OpenInvQty,Price,Currency, LineTotal, TotalSumSy, TotalFrgn, VatSum, VatSumFrgn,VatSumSy, VatGroup,VatPrcnt, FinncPriod, ObjType, Address, GTotal, GTotalFC, GTotalSC, StockSum,StockSumFc,StockSumSc, InvntSttus, WtLiable, AcctCode, DocDate, BaseCard, DataSource, NumPerMsr,NumPerMsr2,UomCode,UomCode2, UomEntry, UomEntry2, unitMsr, unitMsr2, IsTax, StartValue) VALUES(@DocEntry,@LineNum,@LineStatus,@ItemCode,@Dscription,@Quantity,@OpenQty,@InvQty,@OpenInvQty,@Price,@Currency, @LineTotal, @TotalSumSy, @TotalFrgn, @VatSum, @VatSumFrgn,@VatSumSy, @VatGroup,@VatPrcnt, @FinncPriod, @ObjType, @Address, @GTotal, @GTotalFC, @GTotalSC, @StockSum,@StockSumFc,@StockSumSc, @InvntSttus, @WtLiable,  @AcctCode, @DocDate, @BaseCard, @DataSource,@NumPerMsr,@NumPerMsr2,@UomCode,@UomCode2, @UomEntry, @UomEntry2, @unitMsr, @unitMsr2,@IsTax, @StartValue)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindDocEntryOPCH]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT DocEntry FROM OPCH WHERE DocNum=@DocNum AND DocSubType='--'\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertTaxHoldingOPCH]\r\n\r\n@AbsEntry int,\r\n@WTCode nvarchar(4),\r\n@Rate numeric (19,6),\r\n@TaxbleAmnt numeric (19,6),\r\n@TaxbleAmntSC numeric (19,6),\r\n@TaxbleAmntFC numeric (19,6),\r\n@WTAmnt numeric (19,6),\r\n@WTAmntSC numeric (19,6),\r\n@WTAmntFC numeric (19,6),\r\n@Category char(1),\r\n@Account nvarchar(15),\r\n@Type char(1),\r\n@BaseType char(1),\r\n@LineNum int,\r\n@Status char(1),\r\n@ObjType nvarchar(20),\r\n@BaseAmnt numeric (19,6),\r\n@BaseAmntSC numeric (19,6),\r\n@BaseAmntFC numeric (19,6)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO PCH5 (AbsEntry,WTCode,Rate,TaxbleAmnt,TaxbleAmntFC,TaxbleAmntSC,WTAmnt,WTAmntFC,WTAmntSC,Category,Account,Type, BaseType,LineNum, Status, ObjType,BaseAmnt, BaseAmntFC,BaseAmntSC) VALUES(@AbsEntry,@WTCode,@Rate,@TaxbleAmnt,@TaxbleAmntFC,@TaxbleAmntSC,@WTAmnt,@WTAmntFC,@WTAmntSC,@Category,@Account,@Type, @BaseType,@LineNum, @Status, @ObjType,@BaseAmnt, @BaseAmntFC,@BaseAmntSC)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindTaxAccountOPCH]\r\n\r\n@TaxCode nvarchar(8)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT PurchTax FROM OSTA WHERE Code=@TaxCode\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateDebitCreditAccountBusinessPartner]\r\n\r\n@CardCode nvarchar(15),\r\n@Balance numeric(19,6),\r\n@BalanceSys numeric(19,6),\r\n@BalanceFC numeric(19,6)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE OCRD SET Balance=(Balance+@Balance), BalanceSys=(BalanceSys+@BalanceSys), BalanceFC=(BalanceFC+@BalanceFC) WHERE CardCode=@CardCode\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateDebitItem]\r\n\r\n@ItemCode nvarchar(50),\r\n@StockValue numeric(19,6),\r\n@StockValueFC numeric(19,6),\r\n@StockValueSC numeric(19,6),\r\n@Quantity numeric(19,6)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE OITM SET StockValue=(StockValue+@StockValue), StockValueFC=(StockValueFC+@StockValueFC), StockValueSC=(StockValueSC+@StockValueSC), OnHand=(OnHand+@Quantity) WHERE ItemCode=@ItemCode\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[NextPurchaseInvoice]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result int\r\n\r\nSET @Result=(SELECT Siguiente\r\nFROM\r\n    (Select DocNum,LEAD(DocNum) over (order by DocNum) Siguiente\r\n      from OPCH WHERE DocSubType='--') AS NextQueryPurchaseInvoice\r\n Where DocNum=@DocNum)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM OPCH WHERE DocNum=@Result AND DocSubType='--'\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM OPCH ORDER BY DocNum\r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindPurchaseInvoiceLines]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT DocEntry,ItemCode,Dscription,Quantity,Price,Currency,LineTotal,TotalSumSy,TotalFrgn,DocDate,VatGroup,VatPrcnt,WtLiable,AcctCode, VatSum, VatSumSy, VatSumFrgn, GTotal, GTotalFC, GTotalSC, DataSource, UomCode,UomEntry,NumPerMsr, UomCode2, UomEntry2, NumPerMsr2, unitMsr, unitMsr2 FROM PCH1 WHERE DocEntry=@DocEntry\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GetCurrencyName]\r\n\r\n@CurrCode nvarchar(20)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT CurrName FROM OCRN WHERE CurrCode=@CurrCode\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindRetencionImpuesto]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT WTCode,Rate,TaxbleAmnt,TaxbleAmntSC,TaxbleAmntFC,WTAmnt,WTAmntSC,WTAmntFC,Category,Account,Type,BaseType,LineNum,BaseAmnt, BaseAmntSC, BaseAmntFC FROM PCH5 WHERE AbsEntry=@DocEntry ORDER BY LineNum\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindWTName]\r\n\r\n@WTCode nvarchar(4)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT WTName FROM OWHT WHERE WTCode=@WTCode\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[PreviousPurchaseInvoice]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result int\r\n\r\nSET @Result=(SELECT Previous\r\nFROM\r\n    (Select DocNum,LAG(DocNum) over (order by DocNum) Previous\r\n      from OPCH WHERE DocSubType='--') AS PreviousQueryPurchase\r\n Where DocNum=@DocNum)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM OPCH WHERE DocNum=@Result\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM OPCH ORDER BY DocNum DESC\r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FirstPurchaseInvoice]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM OPCH WHERE DocSubType='--' ORDER BY DocNum\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\n\r\nCREATE PROC [dbo].[LastPurchaseInvoice]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM OPCH WHERE DocSubType='--' ORDER BY DocNum DESC\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindPurchase]\r\n\r\n@DocNum int,\r\n@DocDate datetime, \r\n@TaxDate datetime,\r\n@DocDueDate datetime,\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar(100),\r\n@NumAtCard nvarchar(100),\r\n@NumControl nvarchar(100),\r\n@TipoTrans nvarchar(10),\r\n@Comments nvarchar(254)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT * FROM OPCH WHERE DocSubType='DM' AND DocNum LIKE CAST(@DocNum AS nvarchar)+ '%' OR DocDate LIKE CAST(@DocDate AS nvarchar) + '%' OR TaxDate LIKE CAST(@TaxDate AS nvarchar)+ '%' OR DocDueDate LIKE CAST(@DocDueDate AS NVARCHAR) + '%' OR CardCode LIKE @CardCode + '%' OR CardName LIKE @CardName + '%' OR NumAtCard LIKE @NumAtCard + '%' OR U_IDA_NumControl LIKE @NumControl + '%' OR U_IDA_TipoTrans LIKE @TipoTrans + '%' OR Comments LIKE @Comments + '%'\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdatePurchase]\r\n\r\n@DocNum int,\r\n@DocEntry datetime, \r\n@TaxDate datetime,\r\n@DocDueDate nvarchar(50),\r\n@NumAtCard nvarchar(100),\r\n@NumControl nvarchar(20),\r\n@TipoTrans nvarchar(10),\r\n@Comments nvarchar(254),\r\n@JrnlMemo nvarchar(50),\r\n@LicTradNum nvarchar(32),\r\n@UserSign smallint,\r\n@UpdateDate datetime,\r\n@DocSubType nvarchar(2)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE OPCH SET TaxDate=@TaxDate, DocDueDate=@DocDueDate, NumAtCard=@NumAtCard, U_IDA_NumControl=@NumControl, U_IDA_TipoTrans=@TipoTrans, Comments=@Comments, JrnlMemo=@JrnlMemo, LicTradNum=@LicTradNum, UserSign2=@UserSign, UpdateDate=@UpdateDate WHERE DocEntry=@DocEntry AND DocSubType=@DocSubType\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdatePurchaseCreditNote]\r\n\r\n@DocNum int,\r\n@DocEntry datetime, \r\n@TaxDate datetime,\r\n@DocDueDate nvarchar(50),\r\n@NumAtCard nvarchar(100),\r\n@NumControl nvarchar(20),\r\n@TipoTrans nvarchar(10),\r\n@Comments nvarchar(254),\r\n@JrnlMemo nvarchar(50),\r\n@LicTradNum nvarchar(32),\r\n@UserSign smallint,\r\n@UpdateDate datetime\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE ORPC SET TaxDate=@TaxDate, DocDueDate=@DocDueDate, NumAtCard=@NumAtCard, U_IDA_NumControl=@NumControl, U_IDA_TipoTrans=@TipoTrans, Comments=@Comments, JrnlMemo=@JrnlMemo, LicTradNum=@LicTradNum, UserSign2=@UserSign, UpdateDate=@UpdateDate WHERE DocEntry=@DocEntry\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[SelectDocNumORPC]\r\n\r\nAS\r\n\r\nDECLARE @DocNum int\r\n\r\nBEGIN\r\n\r\nSET @DocNum =(SELECT (SELECT DISTINCT TOP 1 DocNum FROM ORPC ORDER BY DocNum DESC) + 1 AS DocNum)\r\n\r\nIF(@DocNum IS NULL)\r\nBEGIN \r\nSELECT 1 AS DocNum\r\nEND\r\nELSE\r\nBEGIN\r\nSELECT @DocNum AS DocNum\r\nEND\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindPurchaseCreditNote]\r\n\r\n@DocNum int,\r\n@DocDate datetime, \r\n@TaxDate datetime,\r\n@DocDueDate datetime,\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar(100),\r\n@NumAtCard nvarchar(100),\r\n@NumControl nvarchar(100),\r\n@TipoTrans nvarchar(10),\r\n@Comments nvarchar(254),\r\n@Fafe nvarchar(30)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT * FROM ORPC WHERE DocNum LIKE CAST(@DocNum AS nvarchar)+ '%' OR DocDate LIKE CAST(@DocDate AS nvarchar) + '%' OR TaxDate LIKE CAST(@TaxDate AS nvarchar)+ '%' OR DocDueDate LIKE CAST(@DocDueDate AS NVARCHAR) + '%' OR CardCode LIKE @CardCode + '%' OR CardName LIKE @CardName + '%' OR NumAtCard LIKE @NumAtCard + '%' OR U_IDA_NumControl LIKE @NumControl + '%' OR U_IDA_TipoTrans LIKE @TipoTrans + '%' OR Comments LIKE @Comments + '%' OR U_IDA_Fafe LIKE @Fafe + '%'\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FirstPurchaseCreditNote]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM ORPC ORDER BY DocNum\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\n\r\nCREATE PROC [dbo].[LastPurchaseCreditNote]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM ORPC ORDER BY DocNum DESC\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[PreviousPurchaseCreditNote]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result int\r\n\r\nSET @Result=(SELECT Previous\r\nFROM\r\n    (Select DocNum,LAG(DocNum) over (order by DocNum) Previous\r\n      from ORPC) AS PreviousQueryPurchaseCreditLine\r\n Where DocNum=@DocNum)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM ORPC WHERE DocNum=@Result\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM ORPC ORDER BY DocNum DESC\r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[NextPurchaseCreditNote]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result int\r\n\r\nSET @Result=(SELECT Siguiente\r\nFROM\r\n    (Select DocNum,LEAD(DocNum) over (order by DocNum) Siguiente\r\n      from ORPC) AS NextQueryPurchaseCreditNote\r\n Where DocNum=@DocNum)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM ORPC WHERE DocNum=@Result\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM ORPC ORDER BY DocNum\r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindRetencionImpuestoORPC]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT WTCode,Rate,TaxbleAmnt,TaxbleAmntSC,TaxbleAmntFC,WTAmnt,WTAmntSC,WTAmntFC,Category,Account,Type,BaseType,LineNum,BaseAmnt, BaseAmntSC, BaseAmntFC FROM RPC5 WHERE AbsEntry=@DocEntry ORDER BY LineNum\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertTaxHoldingORPC]\r\n\r\n@AbsEntry int,\r\n@WTCode nvarchar(4),\r\n@Rate numeric (19,6),\r\n@TaxbleAmnt numeric (19,6),\r\n@TaxbleAmntSC numeric (19,6),\r\n@TaxbleAmntFC numeric (19,6),\r\n@WTAmnt numeric (19,6),\r\n@WTAmntSC numeric (19,6),\r\n@WTAmntFC numeric (19,6),\r\n@Category char(1),\r\n@Account nvarchar(15),\r\n@Type char(1),\r\n@BaseType char(1),\r\n@LineNum int,\r\n@Status char(1),\r\n@ObjType nvarchar(20),\r\n@BaseAmnt numeric (19,6),\r\n@BaseAmntSC numeric (19,6),\r\n@BaseAmntFC numeric (19,6)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO RPC5 (AbsEntry,WTCode,Rate,TaxbleAmnt,TaxbleAmntFC,TaxbleAmntSC,WTAmnt,WTAmntFC,WTAmntSC,Category,Account,Type, BaseType,LineNum, Status, ObjType,BaseAmnt, BaseAmntFC,BaseAmntSC) VALUES(@AbsEntry,@WTCode,@Rate,@TaxbleAmnt,@TaxbleAmntFC,@TaxbleAmntSC,@WTAmnt,@WTAmntFC,@WTAmntSC,@Category,@Account,@Type, @BaseType,@LineNum, @Status, @ObjType,@BaseAmnt, @BaseAmntFC,@BaseAmntSC)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindPurchaseCreditNoteLines]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT DocEntry,ItemCode,Dscription,Quantity,Price,Currency,LineTotal,TotalSumSy,TotalFrgn,DocDate,VatGroup,VatPrcnt,WtLiable,AcctCode, VatSum, VatSumSy, VatSumFrgn, GTotal, GTotalFC, GTotalSC, DataSource,UomCode,UomEntry,NumPerMsr, UomCode2, UomEntry2, NumPerMsr2, unitMsr, unitMsr2 FROM RPC1 WHERE DocEntry=@DocEntry\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertPurchaseCreditNote]\r\n\r\n@DocNum int,\r\n@DocType char(1),\r\n@Canceled char(1),\r\n@DocStatus char(1),\r\n@InvntSttus char(1),\r\n@DocDate datetime,\r\n@DocDueDate datetime,\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar(100),\r\n@Address2 nvarchar(254),\r\n@TaxDate datetime,\r\n@Comments nvarchar(254),\r\n@JrnlMemo nvarchar(50),\r\n@VatSum numeric (19,6),\r\n@VatSumFC numeric (19,6),\r\n@VatSumSy numeric (19,6),\r\n@UserSign int,\r\n@UpdateDate datetime,\r\n@FinncPriod int,\r\n@DocCurr nvarchar(3),\r\n@DocTotal numeric (19,6),\r\n@DocTotalFC numeric (19,6),\r\n@DocTotalSy numeric (19,6),\r\n@ObjType nvarchar(20),\r\n@LicTradNum nvarchar(32),\r\n@TransId int,\r\n@VatPaid numeric (19,6),\r\n@VatPaidFC numeric (19,6),\r\n@VatPaidSys numeric (19,6),\r\n@PaidToDate numeric (19,6),\r\n@PaidSum numeric (19,6),\r\n@PaidSumFc numeric (19,6),\r\n@PaidSumSc numeric (19,6),\r\n@WtApplied numeric (19,6),\r\n@WtAppliedF numeric (19,6),\r\n@WtAppliedS numeric (19,6),\r\n@WtSum numeric (19,6),\r\n@WtSumFC numeric (19,6),\r\n@WtSumSC numeric (19,6),\r\n@SysRate numeric (19,6),\r\n@DocRate numeric (19,6),\r\n@CtlAccount nvarchar(15),\r\n@BaseAmnt numeric (19,6),\r\n@BaseAmntFC numeric (19,6),\r\n@BaseAmntSC numeric (19,6),\r\n@DocSubType nvarchar(2),\r\n@NumAtCard nvarchar(100),\r\n@NumControl nvarchar(20),\r\n@TipoTrans nvarchar(10),\r\n@Max1099 numeric (19,6),\r\n@Fafe nvarchar(30)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO ORPC (DocNum,DocType,CANCELED,DocStatus,InvntSttus,DocDate,DocDueDate,CardCode,CardName, Address2, TaxDate, Comments, JrnlMemo, VatSum, VatSumFC,VatSumSy, UserSign, FinncPriod, DocCur, DocTotal, DocTotalFC, DocTotalSy, ObjType, LicTradNum, TransId, VatPaid, VatPaidFC, VatPaidSys, PaidToDate, PaidSum,PaidSumSc, PaidSumFc, WTApplied, WTAppliedF, WTAppliedS, WTSum, WTSumFC, WTSumSC, SysRate, DocRate, CtlAccount, BaseAmnt, BaseAmntFC, BaseAmntSC, DocSubType, NumAtCard, U_IDA_NumControl, U_IDA_TipoTrans, UpdateDate, Max1099, U_IDA_Fafe) VALUES(@DocNum,@DocType,@Canceled,@DocStatus,@InvntSttus,@DocDate,@DocDueDate,@CardCode,@CardName, @Address2, @TaxDate, @Comments, @JrnlMemo, @VatSum, @VatSumFC,@VatSumSy, @UserSign, @FinncPriod, @DocCurr, @DocTotal, @DocTotalFC, @DocTotalSy, @ObjType, @LicTradNum, @TransId, @VatPaid, @VatPaidFC, @VatPaidSys, @PaidToDate, @PaidSum,@PaidSumSc, @PaidSumFc, @WtApplied, @WtAppliedF, @WtAppliedS, @WtSum, @WtSumFC, @WtSumSC, @SysRate, @DocRate, @CtlAccount, @BaseAmnt, @BaseAmntFC, @BaseAmntSC, @DocSubType, @NumAtCard, @NumControl, @TipoTrans, @UpdateDate, @Max1099, @Fafe)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertPurchaseCreditNoteLines]\r\n\r\n@DocEntry int,\r\n@LineNum int,\r\n@LineStatus char(1),\r\n@ItemCode nvarchar(50),\r\n@Dscription nvarchar(100),\r\n@Quantity numeric (19,6),\r\n@OpenQty numeric (19,6),\r\n@InvQty numeric (19,6),\r\n@OpenInvQty numeric (19,6),\r\n@Price numeric (19,6),\r\n@Currency nvarchar(3),\r\n@LineTotal numeric (19,6),\r\n@AcctCode nvarchar(15),\r\n@DocDate datetime,\r\n@BaseCard nvarchar(15),\r\n@TotalSumSy numeric (19,6),\r\n@TotalFrgn numeric (19,6),\r\n@VatSum numeric (19,6),\r\n@VatSumFrgn numeric (19,6),\r\n@VatSumSy numeric (19,6),\r\n@VatGroup nvarchar(8),\r\n@VatPrcnt numeric (19,6),\r\n@FinncPriod int,\r\n@ObjType nvarchar(20),\r\n@Address nvarchar(254),\r\n@GTotal numeric (19,6),\r\n@GTotalFC numeric (19,6),\r\n@GTotalSC numeric (19,6),\r\n@StockSum numeric (19,6),\r\n@StockSumFc numeric (19,6),\r\n@StockSumSc numeric (19,6),\r\n@InvntSttus char(1),\r\n@WtLiable char(1),\r\n@DataSource char(1),\r\n@NumPerMsr numeric (19,6),\r\n@NumPerMsr2 numeric (19,6),\r\n@UomCode nvarchar(20),\r\n@UomCode2 nvarchar(20),\r\n@UomEntry int,\r\n@UomEntry2 int,\r\n@unitMsr nvarchar(100),\r\n@unitMsr2 nvarchar(100),\r\n@StartValue char(1),\r\n@IsTax char(1)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO RPC1 (DocEntry,LineNum,LineStatus,ItemCode,Dscription,Quantity,OpenQty,InvQty,OpenInvQty,Price,Currency, LineTotal, TotalSumSy, TotalFrgn, VatSum, VatSumFrgn,VatSumSy, VatGroup,VatPrcnt, FinncPriod, ObjType, Address, GTotal, GTotalFC, GTotalSC, StockSum,StockSumFc,StockSumSc, InvntSttus, WtLiable, AcctCode, DocDate, BaseCard, DataSource, NumPerMsr,NumPerMsr2,UomCode,UomCode2, UomEntry, UomEntry2, unitMsr, unitMsr2, IsTax, StartValue) VALUES(@DocEntry,@LineNum,@LineStatus,@ItemCode,@Dscription,@Quantity,@OpenQty,@InvQty,@OpenInvQty,@Price,@Currency, @LineTotal, @TotalSumSy, @TotalFrgn, @VatSum, @VatSumFrgn,@VatSumSy, @VatGroup,@VatPrcnt, @FinncPriod, @ObjType, @Address, @GTotal, @GTotalFC, @GTotalSC, @StockSum,@StockSumFc,@StockSumSc, @InvntSttus, @WtLiable,  @AcctCode, @DocDate, @BaseCard, @DataSource, @NumPerMsr,@NumPerMsr2,@UomCode,@UomCode2, @UomEntry, @UomEntry2, @unitMsr, @unitMsr2, @IsTax, @StartValue)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateCreditItem]\r\n\r\n@ItemCode nvarchar(50),\r\n@StockValue numeric(19,6),\r\n@StockValueFC numeric(19,6),\r\n@StockValueSC numeric(19,6),\r\n@Quantity numeric(19,6)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE OITM SET StockValue=(StockValue-@StockValue), StockValueFC=(StockValueFC-@StockValueFC), StockValueSC=(StockValueSC-@StockValueSC), OnHand=(OnHand-@Quantity) WHERE ItemCode=@ItemCode\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[SelectDocNumOPCHND]\r\n\r\nAS\r\n\r\nDECLARE @DocNum int\r\n\r\nBEGIN\r\n\r\nSET @DocNum =(SELECT (SELECT DISTINCT TOP 1 DocNum FROM OPCH WHERE DocSubType='DM' ORDER BY DocNum DESC) + 1 AS DocNum)\r\n\r\nIF(@DocNum IS NULL)\r\nBEGIN \r\nSELECT 1 AS DocNum\r\nEND\r\nELSE\r\nBEGIN\r\nSELECT @DocNum AS DocNum\r\nEND\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindPurchaseND]\r\n\r\n@DocNum int,\r\n@DocDate datetime, \r\n@TaxDate datetime,\r\n@DocDueDate datetime,\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar(100),\r\n@NumAtCard nvarchar(100),\r\n@NumControl nvarchar(100),\r\n@TipoTrans nvarchar(10),\r\n@Comments nvarchar(254)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT * FROM OPCH WHERE (DocNum LIKE CAST(@DocNum AS nvarchar)+ '%' OR DocDate LIKE CAST(@DocDate AS nvarchar) + '%' OR TaxDate LIKE CAST(@TaxDate AS nvarchar)+ '%' OR DocDueDate LIKE CAST(@DocDueDate AS NVARCHAR) + '%' OR CardCode LIKE @CardCode + '%' OR CardName LIKE @CardName + '%' OR NumAtCard LIKE @NumAtCard + '%' OR U_IDA_NumControl LIKE @NumControl + '%' OR U_IDA_TipoTrans LIKE @TipoTrans + '%' OR Comments LIKE @Comments + '%') AND DocSubType='DM'\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[PreviousPurchaseInvoiceND]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result int\r\n\r\nSET @Result=(SELECT Previous\r\nFROM\r\n    (Select DocNum, LAG(DocNum) over (order by DocNum) Previous\r\n      from OPCH WHERE DocSubType='DM') AS PreviousQueryPurchase\r\n Where DocNum=@DocNum)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM OPCH WHERE DocNum=@Result AND DocSubType='DM'\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM OPCH WHERE DocSubType='DM' ORDER BY DocNum DESC\r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FirstPurchaseInvoiceND]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM OPCH WHERE DocSubType='DM' ORDER BY DocNum\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\n\r\nCREATE PROC [dbo].[LastPurchaseInvoiceND]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM OPCH WHERE DocSubType='DM' ORDER BY DocNum DESC\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[NextPurchaseInvoiceND]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result int\r\n\r\nSET @Result=(SELECT Siguiente\r\nFROM\r\n    (Select DocNum,LEAD(DocNum) over (order by DocNum) Siguiente\r\n      from OPCH WHERE DocSubType='DM') AS NextQueryPurchaseInvoice\r\n Where DocNum=@DocNum)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM OPCH WHERE DocNum=@Result AND DocSubType='DM'\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM OPCH WHERE DocSubType='DM' ORDER BY DocNum\r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindDocEntryOPCHND]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT DocEntry FROM OPCH WHERE DocNum=@DocNum AND DocSubType='DM'\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[SelectDocNumOPDN]\r\n\r\nAS\r\n\r\nDECLARE @DocNum int\r\n\r\nBEGIN\r\n\r\nSET @DocNum =(SELECT (SELECT DISTINCT TOP 1 DocNum FROM OPDN ORDER BY DocNum DESC) + 1 AS DocNum)\r\n\r\nIF(@DocNum IS NULL)\r\nBEGIN \r\nSELECT 1 AS DocNum\r\nEND\r\nELSE\r\nBEGIN\r\nSELECT @DocNum AS DocNum\r\nEND\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[PreviousEntradaMercancia]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result int\r\n\r\nSET @Result=(SELECT Previous\r\nFROM\r\n    (Select DocNum, LAG(DocNum) over (order by DocNum) Previous\r\n      from OPDN) AS PreviousQueryEntradaMercancia\r\n Where DocNum=@DocNum)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM OPDN WHERE DocNum=@Result \r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM OPDN ORDER BY DocNum DESC\r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FirstEntradaMercancia]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM OPDN ORDER BY DocNum\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\n\r\nCREATE PROC [dbo].[LastEntradaMercancia]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM OPDN ORDER BY DocNum DESC\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[NextEntradaMercancia]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result int\r\n\r\nSET @Result=(SELECT Siguiente\r\nFROM\r\n    (Select DocNum,LEAD(DocNum) over (order by DocNum) Siguiente\r\n      from OPDN) AS NextQueryEntradaMercancia\r\n Where DocNum=@DocNum)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM OPDN WHERE DocNum=@Result\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM OPDN ORDER BY DocNum\r\n END\r\n\r\nEND\r\n\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[PreviousEntregaMercancia]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result int\r\n\r\nSET @Result=(SELECT Previous\r\nFROM\r\n    (Select DocNum, LAG(DocNum) over (order by DocNum) Previous\r\n      from ODLN) AS PreviousQueryEntradaMercancia\r\n Where DocNum=@DocNum)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM ODLN WHERE DocNum=@Result \r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM ODLN ORDER BY DocNum DESC\r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FirstEntregaMercancia]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM ODLN ORDER BY DocNum\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\n\r\nCREATE PROC [dbo].[LastEntregaMercancia]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM ODLN ORDER BY DocNum DESC\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[NextEntregaMercancia]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result int\r\n\r\nSET @Result=(SELECT Siguiente\r\nFROM\r\n    (Select DocNum,LEAD(DocNum) over (order by DocNum) Siguiente\r\n      from ODLN) AS NextQueryEntradaMercancia\r\n Where DocNum=@DocNum)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM ODLN WHERE DocNum=@Result\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM ODLN ORDER BY DocNum\r\n END\r\n\r\nEND\r\n\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertEntradaMercanciaLines]\r\n\r\n@DocEntry int,\r\n@LineNum int,\r\n@LineStatus char(1),\r\n@ItemCode nvarchar(50),\r\n@Dscription nvarchar(100),\r\n@Quantity numeric (19,6),\r\n@OpenQty numeric (19,6),\r\n@InvQty numeric (19,6),\r\n@OpenInvQty numeric (19,6),\r\n@Price numeric (19,6),\r\n@Currency nvarchar(3),\r\n@LineTotal numeric (19,6),\r\n@AcctCode nvarchar(15),\r\n@DocDate datetime,\r\n@BaseCard nvarchar(15),\r\n@TotalSumSy numeric (19,6),\r\n@TotalFrgn numeric (19,6),\r\n@VatSum numeric (19,6),\r\n@VatSumFrgn numeric (19,6),\r\n@VatSumSy numeric (19,6),\r\n@VatGroup nvarchar(8),\r\n@VatPrcnt numeric (19,6),\r\n@FinncPriod int,\r\n@ObjType nvarchar(20),\r\n@Address nvarchar(254),\r\n@GTotal numeric (19,6),\r\n@GTotalFC numeric (19,6),\r\n@GTotalSC numeric (19,6),\r\n@StockSum numeric (19,6),\r\n@StockSumFc numeric (19,6),\r\n@StockSumSc numeric (19,6),\r\n@InvntSttus char(1),\r\n@WtLiable char(1),\r\n@DataSource char(1),\r\n@NumPerMsr numeric (19,6),\r\n@NumPerMsr2 numeric (19,6),\r\n@UomCode nvarchar(20),\r\n@UomCode2 nvarchar(20),\r\n@UomEntry int,\r\n@UomEntry2 int,\r\n@unitMsr nvarchar(100),\r\n@unitMsr2 nvarchar(100),\r\n@IsTax char(1),\r\n@StartValue char(1)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO PDN1 (DocEntry,LineNum,LineStatus,ItemCode,Dscription,Quantity,OpenQty,InvQty,OpenInvQty,Price,Currency, LineTotal, TotalSumSy, TotalFrgn, VatSum, VatSumFrgn,VatSumSy, VatGroup,VatPrcnt, FinncPriod, ObjType, Address, GTotal, GTotalFC, GTotalSC, StockSum,StockSumFc,StockSumSc, InvntSttus, WtLiable, AcctCode, DocDate, BaseCard, DataSource, NumPerMsr,NumPerMsr2,UomCode,UomCode2, UomEntry, UomEntry2, unitMsr, unitMsr2, IsTax,StartValue) VALUES(@DocEntry,@LineNum,@LineStatus,@ItemCode,@Dscription,@Quantity,@OpenQty,@InvQty,@OpenInvQty,@Price,@Currency, @LineTotal, @TotalSumSy, @TotalFrgn, @VatSum, @VatSumFrgn,@VatSumSy, @VatGroup,@VatPrcnt, @FinncPriod, @ObjType, @Address, @GTotal, @GTotalFC, @GTotalSC, @StockSum,@StockSumFc,@StockSumSc, @InvntSttus, @WtLiable,  @AcctCode, @DocDate, @BaseCard, @DataSource,@NumPerMsr,@NumPerMsr2,@UomCode,@UomCode2,@UomEntry, @UomEntry2, @unitMsr, @unitMsr2,@IsTax,@StartValue)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertEntregaMercanciaLines]\r\n\r\n@DocEntry int,\r\n@LineNum int,\r\n@LineStatus char(1),\r\n@ItemCode nvarchar(50),\r\n@Dscription nvarchar(100),\r\n@Quantity numeric (19,6),\r\n@OpenQty numeric (19,6),\r\n@InvQty numeric (19,6),\r\n@OpenInvQty numeric (19,6),\r\n@Price numeric (19,6),\r\n@Currency nvarchar(3),\r\n@LineTotal numeric (19,6),\r\n@AcctCode nvarchar(15),\r\n@DocDate datetime,\r\n@BaseCard nvarchar(15),\r\n@TotalSumSy numeric (19,6),\r\n@TotalFrgn numeric (19,6),\r\n@VatSum numeric (19,6),\r\n@VatSumFrgn numeric (19,6),\r\n@VatSumSy numeric (19,6),\r\n@VatGroup nvarchar(8),\r\n@VatPrcnt numeric (19,6),\r\n@FinncPriod int,\r\n@ObjType nvarchar(20),\r\n@Address nvarchar(254),\r\n@GTotal numeric (19,6),\r\n@GTotalFC numeric (19,6),\r\n@GTotalSC numeric (19,6),\r\n@StockSum numeric (19,6),\r\n@StockSumFc numeric (19,6),\r\n@StockSumSc numeric (19,6),\r\n@InvntSttus char(1),\r\n@WtLiable char(1),\r\n@DataSource char(1),\r\n@NumPerMsr numeric (19,6),\r\n@NumPerMsr2 numeric (19,6),\r\n@UomCode nvarchar(20),\r\n@UomCode2 nvarchar(20),\r\n@UomEntry int,\r\n@UomEntry2 int,\r\n@unitMsr nvarchar(100),\r\n@unitMsr2 nvarchar(100),\r\n@IsTax char(1),\r\n@StartValue char(1)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO DLN1 (DocEntry,LineNum,LineStatus,ItemCode,Dscription,Quantity,OpenQty,InvQty,OpenInvQty,Price,Currency, LineTotal, TotalSumSy, TotalFrgn, VatSum, VatSumFrgn,VatSumSy, VatGroup,VatPrcnt, FinncPriod, ObjType, Address, GTotal, GTotalFC, GTotalSC, StockSum,StockSumFc,StockSumSc, InvntSttus, WtLiable, AcctCode, DocDate, BaseCard, DataSource,NumPerMsr,NumPerMsr2,UomCode,UomCode2, UomEntry, UomEntry2, unitMsr, unitMsr2, IsTax, StartValue) VALUES(@DocEntry,@LineNum,@LineStatus,@ItemCode,@Dscription,@Quantity,@OpenQty,@InvQty,@OpenInvQty,@Price,@Currency, @LineTotal, @TotalSumSy, @TotalFrgn, @VatSum, @VatSumFrgn,@VatSumSy, @VatGroup,@VatPrcnt, @FinncPriod, @ObjType, @Address, @GTotal, @GTotalFC, @GTotalSC, @StockSum,@StockSumFc,@StockSumSc, @InvntSttus, @WtLiable,  @AcctCode, @DocDate, @BaseCard, @DataSource,@NumPerMsr,@NumPerMsr2,@UomCode,@UomCode2,@UomEntry,@UomEntry2,@unitMsr, @unitMsr2,@IsTax, @StartValue)\r\n\r\nEND\r\n\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertEntregaMercancia]\r\n\r\n@DocNum int,\r\n@DocType char(1),\r\n@Canceled char(1),\r\n@DocStatus char(1),\r\n@InvntSttus char(1),\r\n@DocDate datetime,\r\n@DocDueDate datetime,\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar(100),\r\n@Address2 nvarchar(254),\r\n@TaxDate datetime,\r\n@Comments nvarchar(254),\r\n@JrnlMemo nvarchar(50),\r\n@VatSum numeric (19,6),\r\n@VatSumFC numeric (19,6),\r\n@VatSumSy numeric (19,6),\r\n@UserSign int,\r\n@UpdateDate datetime,\r\n@FinncPriod int,\r\n@DocCurr nvarchar(3),\r\n@DocTotal numeric (19,6),\r\n@DocTotalFC numeric (19,6),\r\n@DocTotalSy numeric (19,6),\r\n@ObjType nvarchar(20),\r\n@LicTradNum nvarchar(32),\r\n@TransId int,\r\n@VatPaid numeric (19,6),\r\n@VatPaidFC numeric (19,6),\r\n@VatPaidSys numeric (19,6),\r\n@PaidToDate numeric (19,6),\r\n@PaidSum numeric (19,6),\r\n@PaidSumFc numeric (19,6),\r\n@PaidSumSc numeric (19,6),\r\n@WtApplied numeric (19,6),\r\n@WtAppliedF numeric (19,6),\r\n@WtAppliedS numeric (19,6),\r\n@WtSum numeric (19,6),\r\n@WtSumFC numeric (19,6),\r\n@WtSumSC numeric (19,6),\r\n@SysRate numeric (19,6),\r\n@DocRate numeric (19,6),\r\n@CtlAccount nvarchar(15),\r\n@BaseAmnt numeric (19,6),\r\n@BaseAmntFC numeric (19,6),\r\n@BaseAmntSC numeric (19,6),\r\n@NumAtCard nvarchar(100),\r\n@Max1099 numeric (19,6)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO ODLN(DocNum,DocType,CANCELED,DocStatus,InvntSttus,DocDate,DocDueDate,CardCode,CardName, Address2, TaxDate, Comments, JrnlMemo, VatSum, VatSumFC,VatSumSy, UserSign, FinncPriod, DocCur, DocTotal, DocTotalFC, DocTotalSy, ObjType, LicTradNum, TransId, VatPaid, VatPaidFC, VatPaidSys, PaidToDate, PaidSum,PaidSumSc, PaidSumFc, WTApplied, WTAppliedF, WTAppliedS, WTSum, WTSumFC, WTSumSC, SysRate, DocRate, CtlAccount, BaseAmnt, BaseAmntFC, BaseAmntSC, NumAtCard, UpdateDate,Max1099) VALUES(@DocNum,@DocType,@Canceled,@DocStatus,@InvntSttus,@DocDate,@DocDueDate,@CardCode,@CardName, @Address2, @TaxDate, @Comments, @JrnlMemo, @VatSum, @VatSumFC,@VatSumSy, @UserSign, @FinncPriod, @DocCurr, @DocTotal, @DocTotalFC, @DocTotalSy, @ObjType, @LicTradNum, @TransId, @VatPaid, @VatPaidFC, @VatPaidSys, @PaidToDate, @PaidSum,@PaidSumSc, @PaidSumFc, @WtApplied, @WtAppliedF, @WtAppliedS, @WtSum, @WtSumFC, @WtSumSC, @SysRate, @DocRate, @CtlAccount, @BaseAmnt, @BaseAmntFC, @BaseAmntSC, @NumAtCard, @UpdateDate,@Max1099)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertEntradaMercancia]\r\n\r\n@DocNum int,\r\n@DocType char(1),\r\n@Canceled char(1),\r\n@DocStatus char(1),\r\n@InvntSttus char(1),\r\n@DocDate datetime,\r\n@DocDueDate datetime,\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar(100),\r\n@Address2 nvarchar(254),\r\n@TaxDate datetime,\r\n@Comments nvarchar(254),\r\n@JrnlMemo nvarchar(50),\r\n@VatSum numeric (19,6),\r\n@VatSumFC numeric (19,6),\r\n@VatSumSy numeric (19,6),\r\n@UserSign int,\r\n@UpdateDate datetime,\r\n@FinncPriod int,\r\n@DocCurr nvarchar(3),\r\n@DocTotal numeric (19,6),\r\n@DocTotalFC numeric (19,6),\r\n@DocTotalSy numeric (19,6),\r\n@ObjType nvarchar(20),\r\n@LicTradNum nvarchar(32),\r\n@TransId int,\r\n@VatPaid numeric (19,6),\r\n@VatPaidFC numeric (19,6),\r\n@VatPaidSys numeric (19,6),\r\n@PaidToDate numeric (19,6),\r\n@PaidSum numeric (19,6),\r\n@PaidSumFc numeric (19,6),\r\n@PaidSumSc numeric (19,6),\r\n@WtApplied numeric (19,6),\r\n@WtAppliedF numeric (19,6),\r\n@WtAppliedS numeric (19,6),\r\n@WtSum numeric (19,6),\r\n@WtSumFC numeric (19,6),\r\n@WtSumSC numeric (19,6),\r\n@SysRate numeric (19,6),\r\n@DocRate numeric (19,6),\r\n@CtlAccount nvarchar(15),\r\n@BaseAmnt numeric (19,6),\r\n@BaseAmntFC numeric (19,6),\r\n@BaseAmntSC numeric (19,6),\r\n@NumAtCard nvarchar(100),\r\n@Max1099 numeric (19,6)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO OPDN(DocNum,DocType,CANCELED,DocStatus,InvntSttus,DocDate,DocDueDate,CardCode,CardName, Address2, TaxDate, Comments, JrnlMemo, VatSum, VatSumFC,VatSumSy, UserSign, FinncPriod, DocCur, DocTotal, DocTotalFC, DocTotalSy, ObjType, LicTradNum, TransId, VatPaid, VatPaidFC, VatPaidSys, PaidToDate, PaidSum,PaidSumSc, PaidSumFc, WTApplied, WTAppliedF, WTAppliedS, WTSum, WTSumFC, WTSumSC, SysRate, DocRate, CtlAccount, BaseAmnt, BaseAmntFC, BaseAmntSC, NumAtCard, UpdateDate,Max1099) VALUES(@DocNum,@DocType,@Canceled,@DocStatus,@InvntSttus,@DocDate,@DocDueDate,@CardCode,@CardName, @Address2, @TaxDate, @Comments, @JrnlMemo, @VatSum, @VatSumFC,@VatSumSy, @UserSign, @FinncPriod, @DocCurr, @DocTotal, @DocTotalFC, @DocTotalSy, @ObjType, @LicTradNum, @TransId, @VatPaid, @VatPaidFC, @VatPaidSys, @PaidToDate, @PaidSum,@PaidSumSc, @PaidSumFc, @WtApplied, @WtAppliedF, @WtAppliedS, @WtSum, @WtSumFC, @WtSumSC, @SysRate, @DocRate, @CtlAccount, @BaseAmnt, @BaseAmntFC, @BaseAmntSC, @NumAtCard, @UpdateDate,@Max1099)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateEntradaMercancia]\r\n\r\n@DocNum int,\r\n@DocEntry datetime, \r\n@TaxDate datetime,\r\n@DocDueDate nvarchar(50),\r\n@NumAtCard nvarchar(100),\r\n@Comments nvarchar(254),\r\n@JrnlMemo nvarchar(50),\r\n@UserSign smallint,\r\n@UpdateDate datetime\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE OPDN SET TaxDate=@TaxDate, DocDueDate=@DocDueDate, NumAtCard=@NumAtCard, Comments=@Comments, JrnlMemo=@JrnlMemo, UserSign2=@UserSign, UpdateDate=@UpdateDate WHERE DocEntry=@DocEntry\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateEntregaMercancia]\r\n\r\n@DocNum int,\r\n@DocEntry datetime, \r\n@TaxDate datetime,\r\n@DocDueDate nvarchar(50),\r\n@NumAtCard nvarchar(100),\r\n@Comments nvarchar(254),\r\n@JrnlMemo nvarchar(50),\r\n@LicTradNum nvarchar(32),\r\n@UserSign smallint,\r\n@UpdateDate datetime\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE ODLN SET TaxDate=@TaxDate, DocDueDate=@DocDueDate, NumAtCard=@NumAtCard, Comments=@Comments, JrnlMemo=@JrnlMemo, LicTradNum=@LicTradNum, UserSign2=@UserSign, UpdateDate=@UpdateDate WHERE DocEntry=@DocEntry\r\n\r\nEND\r\n\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindDocEntryOPDN]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT DocEntry FROM OPDN WHERE DocNum=@DocNum\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindDocEntryODLN]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT DocEntry FROM ODLN WHERE DocNum=@DocNum\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[SelectDocNumOINV]\r\n\r\nAS\r\n\r\nDECLARE @DocNum int\r\n\r\nBEGIN\r\n\r\nSET @DocNum =(SELECT (SELECT DISTINCT TOP 1 DocNum FROM OINV ORDER BY DocNum DESC) + 1 AS DocNum)\r\n\r\nIF(@DocNum IS NULL)\r\nBEGIN \r\nSELECT 1 AS DocNum\r\nEND\r\nELSE\r\nBEGIN\r\nSELECT @DocNum AS DocNum\r\nEND\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindSalesInvoiceLines]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT DocEntry,ItemCode,Dscription,Quantity,Price,Currency,LineTotal,TotalSumSy,TotalFrgn,DocDate,VatGroup,VatPrcnt,WtLiable,AcctCode, VatSum, VatSumSy, VatSumFrgn, GTotal, GTotalFC, GTotalSC, DataSource,UomCode,UomEntry,NumPerMsr, UomCode2, UomEntry2, NumPerMsr2, unitMsr, unitMsr2, IsTax, StartValue FROM INV1 WHERE DocEntry=@DocEntry\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindSales]\r\n\r\n@DocNum int,\r\n@DocDate datetime, \r\n@TaxDate datetime,\r\n@DocDueDate datetime,\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar(100),\r\n@NumAtCard nvarchar(100),\r\n@NumControl nvarchar(100),\r\n@TipoTrans nvarchar(10),\r\n@Comments nvarchar(254)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT * FROM OINV WHERE DocNum LIKE CAST(@DocNum AS nvarchar)+ '%' OR DocDate LIKE CAST(@DocDate AS nvarchar) + '%' OR TaxDate LIKE CAST(@TaxDate AS nvarchar)+ '%' OR DocDueDate LIKE CAST(@DocDueDate AS NVARCHAR) + '%' OR CardCode LIKE @CardCode + '%' OR CardName LIKE @CardName + '%' OR NumAtCard LIKE @NumAtCard + '%' OR U_IDA_NumControl LIKE @NumControl + '%' OR U_IDA_TipoTrans LIKE @TipoTrans + '%' OR Comments LIKE @Comments + '%'\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertSalesInvoice]\r\n\r\n@DocNum int,\r\n@DocType char(1),\r\n@Canceled char(1),\r\n@DocStatus char(1),\r\n@InvntSttus char(1),\r\n@DocDate datetime,\r\n@DocDueDate datetime,\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar(100),\r\n@Address2 nvarchar(254),\r\n@TaxDate datetime,\r\n@Comments nvarchar(254),\r\n@JrnlMemo nvarchar(50),\r\n@VatSum numeric (19,6),\r\n@VatSumFC numeric (19,6),\r\n@VatSumSy numeric (19,6),\r\n@UserSign int,\r\n@UpdateDate datetime,\r\n@FinncPriod int,\r\n@DocCurr nvarchar(3),\r\n@DocTotal numeric (19,6),\r\n@DocTotalFC numeric (19,6),\r\n@DocTotalSy numeric (19,6),\r\n@ObjType nvarchar(20),\r\n@LicTradNum nvarchar(32),\r\n@TransId int,\r\n@VatPaid numeric (19,6),\r\n@VatPaidFC numeric (19,6),\r\n@VatPaidSys numeric (19,6),\r\n@PaidToDate numeric (19,6),\r\n@PaidSum numeric (19,6),\r\n@PaidSumFc numeric (19,6),\r\n@PaidSumSc numeric (19,6),\r\n@WtApplied numeric (19,6),\r\n@WtAppliedF numeric (19,6),\r\n@WtAppliedS numeric (19,6),\r\n@WtSum numeric (19,6),\r\n@WtSumFC numeric (19,6),\r\n@WtSumSC numeric (19,6),\r\n@SysRate numeric (19,6),\r\n@DocRate numeric (19,6),\r\n@CtlAccount nvarchar(15),\r\n@BaseAmnt numeric (19,6),\r\n@BaseAmntFC numeric (19,6),\r\n@BaseAmntSC numeric (19,6),\r\n@DocSubType nvarchar(2),\r\n@NumAtCard nvarchar(100),\r\n@NumControl nvarchar(20),\r\n@TipoTrans nvarchar(10),\r\n@Max1099 numeric (19,6)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO OINV (DocNum,DocType,CANCELED,DocStatus,InvntSttus,DocDate,DocDueDate,CardCode,CardName, Address2, TaxDate, Comments, JrnlMemo, VatSum, VatSumFC,VatSumSy, UserSign, FinncPriod, DocCur, DocTotal, DocTotalFC, DocTotalSy, ObjType, LicTradNum, TransId, VatPaid, VatPaidFC, VatPaidSys, PaidToDate, PaidSum,PaidSumSc, PaidSumFc, WTApplied, WTAppliedF, WTAppliedS, WTSum, WTSumFC, WTSumSC, SysRate, DocRate, CtlAccount, BaseAmnt, BaseAmntFC, BaseAmntSC, DocSubType, NumAtCard, U_IDA_NumControl, U_IDA_TipoTrans, UpdateDate,Max1099) VALUES(@DocNum,@DocType,@Canceled,@DocStatus,@InvntSttus,@DocDate,@DocDueDate,@CardCode,@CardName, @Address2, @TaxDate, @Comments, @JrnlMemo, @VatSum, @VatSumFC,@VatSumSy, @UserSign, @FinncPriod, @DocCurr, @DocTotal, @DocTotalFC, @DocTotalSy, @ObjType, @LicTradNum, @TransId, @VatPaid, @VatPaidFC, @VatPaidSys, @PaidToDate, @PaidSum,@PaidSumSc, @PaidSumFc, @WtApplied, @WtAppliedF, @WtAppliedS, @WtSum, @WtSumFC, @WtSumSC, @SysRate, @DocRate, @CtlAccount, @BaseAmnt, @BaseAmntFC, @BaseAmntSC, @DocSubType, @NumAtCard, @NumControl, @TipoTrans, @UpdateDate,@Max1099)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FirstSalesInvoice]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM OINV WHERE DocSubType='--' ORDER BY DocNum\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\n\r\nCREATE PROC [dbo].[LastSalesInvoice]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM OINV WHERE DocSubType='--' ORDER BY DocNum DESC\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[PreviousSalesInvoice]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result int\r\n\r\nSET @Result=(SELECT Previous\r\nFROM\r\n    (Select DocNum, LAG(DocNum) over (order by DocNum) Previous\r\n      from OINV WHERE DocSubType='--') AS PreviousQueryOINV\r\n Where DocNum=@DocNum)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM OINV WHERE DocNum=@Result AND DocSubType='--'\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM OINV ORDER BY DocNum DESC\r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[NextSalesInvoice]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result int\r\n\r\nSET @Result=(SELECT Siguiente\r\nFROM\r\n    (Select DocNum,LEAD(DocNum) over (order by DocNum) Siguiente\r\n      from OINV WHERE DocSubType='--') AS NextQueryOINV\r\n Where DocNum=@DocNum)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM OINV WHERE DocNum=@Result AND DocSubType='--'\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM OINV ORDER BY DocNum\r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindRetencionImpuestoSales]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT WTCode,Rate,TaxbleAmnt,TaxbleAmntSC,TaxbleAmntFC,WTAmnt,WTAmntSC,WTAmntFC,Category,Account,Type,BaseType,LineNum,BaseAmnt, BaseAmntSC, BaseAmntFC FROM INV5 WHERE AbsEntry=@DocEntry ORDER BY LineNum\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertSalesInvoiceLines]\r\n\r\n@DocEntry int,\r\n@LineNum int,\r\n@LineStatus char(1),\r\n@ItemCode nvarchar(50),\r\n@Dscription nvarchar(100),\r\n@Quantity numeric (19,6),\r\n@OpenQty numeric (19,6),\r\n@InvQty numeric (19,6),\r\n@OpenInvQty numeric (19,6),\r\n@Price numeric (19,6),\r\n@Currency nvarchar(3),\r\n@LineTotal numeric (19,6),\r\n@AcctCode nvarchar(15),\r\n@DocDate datetime,\r\n@BaseCard nvarchar(15),\r\n@TotalSumSy numeric (19,6),\r\n@TotalFrgn numeric (19,6),\r\n@VatSum numeric (19,6),\r\n@VatSumFrgn numeric (19,6),\r\n@VatSumSy numeric (19,6),\r\n@VatGroup nvarchar(8),\r\n@VatPrcnt numeric (19,6),\r\n@FinncPriod int,\r\n@ObjType nvarchar(20),\r\n@Address nvarchar(254),\r\n@GTotal numeric (19,6),\r\n@GTotalFC numeric (19,6),\r\n@GTotalSC numeric (19,6),\r\n@StockSum numeric (19,6),\r\n@StockSumFc numeric (19,6),\r\n@StockSumSc numeric (19,6),\r\n@InvntSttus char(1),\r\n@WtLiable char(1),\r\n@DataSource char(1),\r\n@NumPerMsr numeric (19,6),\r\n@NumPerMsr2 numeric (19,6),\r\n@UomCode nvarchar(20),\r\n@UomCode2 nvarchar(20),\r\n@UomEntry int,\r\n@UomEntry2 int,\r\n@unitMsr nvarchar(100),\r\n@unitMsr2 nvarchar(100),\r\n@IsTax char(1),\r\n@StartValue char(1)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO INV1 (DocEntry,LineNum,LineStatus,ItemCode,Dscription,Quantity,OpenQty,InvQty,OpenInvQty,Price,Currency, LineTotal, TotalSumSy, TotalFrgn, VatSum, VatSumFrgn,VatSumSy, VatGroup,VatPrcnt, FinncPriod, ObjType, Address, GTotal, GTotalFC, GTotalSC, StockSum,StockSumFc,StockSumSc, InvntSttus, WtLiable, AcctCode, DocDate, BaseCard, DataSource, NumPerMsr,NumPerMsr2,UomCode,UomCode2, UomEntry, UomEntry2, unitMsr, unitMsr2, IsTax, StartValue) VALUES(@DocEntry,@LineNum,@LineStatus,@ItemCode,@Dscription,@Quantity,@OpenQty,@InvQty,@OpenInvQty,@Price,@Currency, @LineTotal, @TotalSumSy, @TotalFrgn, @VatSum, @VatSumFrgn,@VatSumSy, @VatGroup,@VatPrcnt, @FinncPriod, @ObjType, @Address, @GTotal, @GTotalFC, @GTotalSC, @StockSum,@StockSumFc,@StockSumSc, @InvntSttus, @WtLiable,  @AcctCode, @DocDate, @BaseCard, @DataSource, @NumPerMsr,@NumPerMsr2,@UomCode,@UomCode2, @UomEntry, @UomEntry2, @unitMsr, @unitMsr2, @IsTax, @StartValue)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertTaxHoldingOINV]\r\n\r\n@AbsEntry int,\r\n@WTCode nvarchar(4),\r\n@Rate numeric (19,6),\r\n@TaxbleAmnt numeric (19,6),\r\n@TaxbleAmntSC numeric (19,6),\r\n@TaxbleAmntFC numeric (19,6),\r\n@WTAmnt numeric (19,6),\r\n@WTAmntSC numeric (19,6),\r\n@WTAmntFC numeric (19,6),\r\n@Category char(1),\r\n@Account nvarchar(15),\r\n@Type char(1),\r\n@BaseType char(1),\r\n@LineNum int,\r\n@Status char(1),\r\n@ObjType nvarchar(20),\r\n@BaseAmnt numeric (19,6),\r\n@BaseAmntSC numeric (19,6),\r\n@BaseAmntFC numeric (19,6)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO INV5 (AbsEntry,WTCode,Rate,TaxbleAmnt,TaxbleAmntFC,TaxbleAmntSC,WTAmnt,WTAmntFC,WTAmntSC,Category,Account,Type, BaseType,LineNum, Status, ObjType,BaseAmnt, BaseAmntFC,BaseAmntSC) VALUES(@AbsEntry,@WTCode,@Rate,@TaxbleAmnt,@TaxbleAmntFC,@TaxbleAmntSC,@WTAmnt,@WTAmntFC,@WTAmntSC,@Category,@Account,@Type, @BaseType,@LineNum, @Status, @ObjType,@BaseAmnt, @BaseAmntFC,@BaseAmntSC)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindDocEntryOINV]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT DocEntry FROM OINV WHERE DocNum=@DocNum AND DocSubType='--'\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateSales]\r\n\r\n@DocNum int,\r\n@DocEntry datetime, \r\n@TaxDate datetime,\r\n@DocDueDate nvarchar(50),\r\n@NumAtCard nvarchar(100),\r\n@NumControl nvarchar(20),\r\n@TipoTrans nvarchar(10),\r\n@Comments nvarchar(254),\r\n@JrnlMemo nvarchar(50),\r\n@LicTradNum nvarchar(32),\r\n@UserSign smallint,\r\n@UpdateDate datetime,\r\n@DocSubType nvarchar(2)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE OINV SET TaxDate=@TaxDate, DocDueDate=@DocDueDate, NumAtCard=@NumAtCard, U_IDA_NumControl=@NumControl, U_IDA_TipoTrans=@TipoTrans, Comments=@Comments, JrnlMemo=@JrnlMemo, LicTradNum=@LicTradNum, UserSign2=@UserSign, UpdateDate=@UpdateDate WHERE DocEntry=@DocEntry AND DocSubType=@DocSubType\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[SelectDocNumOINVND]\r\n\r\nAS\r\n\r\nDECLARE @DocNum int\r\n\r\nBEGIN\r\n\r\nSET @DocNum =(SELECT (SELECT DISTINCT TOP 1 DocNum FROM OINV WHERE DocSubType='DM' ORDER BY DocNum DESC) + 1 AS DocNum)\r\n\r\nIF(@DocNum IS NULL)\r\nBEGIN \r\nSELECT 1 AS DocNum\r\nEND\r\nELSE\r\nBEGIN\r\nSELECT @DocNum AS DocNum\r\nEND\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindSalesND]\r\n\r\n@DocNum int,\r\n@DocDate datetime, \r\n@TaxDate datetime,\r\n@DocDueDate datetime,\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar(100),\r\n@NumAtCard nvarchar(100),\r\n@NumControl nvarchar(100),\r\n@TipoTrans nvarchar(10),\r\n@Comments nvarchar(254)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT * FROM OINV WHERE (DocNum LIKE CAST(@DocNum AS nvarchar)+ '%' OR DocDate LIKE CAST(@DocDate AS nvarchar) + '%' OR TaxDate LIKE CAST(@TaxDate AS nvarchar)+ '%' OR DocDueDate LIKE CAST(@DocDueDate AS NVARCHAR) + '%' OR CardCode LIKE @CardCode + '%' OR CardName LIKE @CardName + '%' OR NumAtCard LIKE @NumAtCard + '%' OR U_IDA_NumControl LIKE @NumControl + '%' OR U_IDA_TipoTrans LIKE @TipoTrans + '%' OR Comments LIKE @Comments + '%') AND DocSubType='DM'\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[PreviousSalesInvoiceND]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result int\r\n\r\nSET @Result=(SELECT Previous\r\nFROM\r\n    (Select DocNum, LAG(DocNum) over (order by DocNum) Previous\r\n      from OINV WHERE DocSubType='DM') AS PreviousQuerySales\r\n Where DocNum=@DocNum)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM OINV WHERE DocNum=@Result AND DocSubType='DM'\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM OINV WHERE DocSubType='DM' ORDER BY DocNum DESC\r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FirstSalesInvoiceND]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM OINV WHERE DocSubType='DM' ORDER BY DocNum\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\n\r\nCREATE PROC [dbo].[LastSalesInvoiceND]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM OINV WHERE DocSubType='DM' ORDER BY DocNum DESC\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[NextSalesInvoiceND]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result int\r\n\r\nSET @Result=(SELECT Siguiente\r\nFROM\r\n    (Select DocNum,LEAD(DocNum) over (order by DocNum) Siguiente\r\n      from OINV WHERE DocSubType='DM') AS NextQuerySalesInvoice\r\n Where DocNum=@DocNum)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM OINV WHERE DocNum=@Result AND DocSubType='DM'\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM OINV WHERE DocSubType='DM' ORDER BY DocNum\r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindDocEntryOINVND]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT DocEntry FROM OINV WHERE DocNum=@DocNum AND DocSubType='DM'\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindCustomer]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT * FROM OCRD WHERE CardType='C'\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[SelectDocNumORIN]\r\n\r\nAS\r\n\r\nDECLARE @DocNum int\r\n\r\nBEGIN\r\n\r\nSET @DocNum =(SELECT (SELECT DISTINCT TOP 1 DocNum FROM ORIN ORDER BY DocNum DESC) + 1 AS DocNum)\r\n\r\nIF(@DocNum IS NULL)\r\nBEGIN \r\nSELECT 1 AS DocNum\r\nEND\r\nELSE\r\nBEGIN\r\nSELECT @DocNum AS DocNum\r\nEND\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindSalesCreditNoteLines]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT DocEntry,ItemCode,Dscription,Quantity,Price,Currency,LineTotal,TotalSumSy,TotalFrgn,DocDate,VatGroup,VatPrcnt,WtLiable,AcctCode, VatSum, VatSumSy, VatSumFrgn, GTotal, GTotalFC, GTotalSC, DataSource,UomCode,UomEntry,NumPerMsr, UomCode2, UomEntry2, NumPerMsr2, unitMsr, unitMsr2 FROM RIN1 WHERE DocEntry=@DocEntry\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindSalesCreditNote]\r\n\r\n@DocNum int,\r\n@DocDate datetime, \r\n@TaxDate datetime,\r\n@DocDueDate datetime,\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar(100),\r\n@NumAtCard nvarchar(100),\r\n@NumControl nvarchar(100),\r\n@TipoTrans nvarchar(10),\r\n@Comments nvarchar(254),\r\n@Fafe nvarchar(30)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT * FROM ORIN WHERE DocNum LIKE CAST(@DocNum AS nvarchar)+ '%' OR DocDate LIKE CAST(@DocDate AS nvarchar) + '%' OR TaxDate LIKE CAST(@TaxDate AS nvarchar)+ '%' OR DocDueDate LIKE CAST(@DocDueDate AS NVARCHAR) + '%' OR CardCode LIKE @CardCode + '%' OR CardName LIKE @CardName + '%' OR NumAtCard LIKE @NumAtCard + '%' OR U_IDA_NumControl LIKE @NumControl + '%' OR U_IDA_TipoTrans LIKE @TipoTrans + '%' OR Comments LIKE @Comments + '%' OR U_IDA_Fafe LIKE @Fafe + '%'\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertSalesCreditNote]\r\n\r\n@DocNum int,\r\n@DocType char(1),\r\n@Canceled char(1),\r\n@DocStatus char(1),\r\n@InvntSttus char(1),\r\n@DocDate datetime,\r\n@DocDueDate datetime,\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar(100),\r\n@Address2 nvarchar(254),\r\n@TaxDate datetime,\r\n@Comments nvarchar(254),\r\n@JrnlMemo nvarchar(50),\r\n@VatSum numeric (19,6),\r\n@VatSumFC numeric (19,6),\r\n@VatSumSy numeric (19,6),\r\n@UserSign int,\r\n@UpdateDate datetime,\r\n@FinncPriod int,\r\n@DocCurr nvarchar(3),\r\n@DocTotal numeric (19,6),\r\n@DocTotalFC numeric (19,6),\r\n@DocTotalSy numeric (19,6),\r\n@ObjType nvarchar(20),\r\n@LicTradNum nvarchar(32),\r\n@TransId int,\r\n@VatPaid numeric (19,6),\r\n@VatPaidFC numeric (19,6),\r\n@VatPaidSys numeric (19,6),\r\n@PaidToDate numeric (19,6),\r\n@PaidSum numeric (19,6),\r\n@PaidSumFc numeric (19,6),\r\n@PaidSumSc numeric (19,6),\r\n@WtApplied numeric (19,6),\r\n@WtAppliedF numeric (19,6),\r\n@WtAppliedS numeric (19,6),\r\n@WtSum numeric (19,6),\r\n@WtSumFC numeric (19,6),\r\n@WtSumSC numeric (19,6),\r\n@SysRate numeric (19,6),\r\n@DocRate numeric (19,6),\r\n@CtlAccount nvarchar(15),\r\n@BaseAmnt numeric (19,6),\r\n@BaseAmntFC numeric (19,6),\r\n@BaseAmntSC numeric (19,6),\r\n@DocSubType nvarchar(2),\r\n@NumAtCard nvarchar(100),\r\n@NumControl nvarchar(20),\r\n@TipoTrans nvarchar(10),\r\n@Max1099 numeric(19,6),\r\n@Fafe nvarchar(30)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO ORIN(DocNum,DocType,CANCELED,DocStatus,InvntSttus,DocDate,DocDueDate,CardCode,CardName, Address2, TaxDate, Comments, JrnlMemo, VatSum, VatSumFC,VatSumSy, UserSign, FinncPriod, DocCur, DocTotal, DocTotalFC, DocTotalSy, ObjType, LicTradNum, TransId, VatPaid, VatPaidFC, VatPaidSys, PaidToDate, PaidSum,PaidSumSc, PaidSumFc, WTApplied, WTAppliedF, WTAppliedS, WTSum, WTSumFC, WTSumSC, SysRate, DocRate, CtlAccount, BaseAmnt, BaseAmntFC, BaseAmntSC, DocSubType, NumAtCard, U_IDA_NumControl, U_IDA_TipoTrans, UpdateDate,Max1099, U_IDA_Fafe) VALUES(@DocNum,@DocType,@Canceled,@DocStatus,@InvntSttus,@DocDate,@DocDueDate,@CardCode,@CardName, @Address2, @TaxDate, @Comments, @JrnlMemo, @VatSum, @VatSumFC,@VatSumSy, @UserSign, @FinncPriod, @DocCurr, @DocTotal, @DocTotalFC, @DocTotalSy, @ObjType, @LicTradNum, @TransId, @VatPaid, @VatPaidFC, @VatPaidSys, @PaidToDate, @PaidSum,@PaidSumSc, @PaidSumFc, @WtApplied, @WtAppliedF, @WtAppliedS, @WtSum, @WtSumFC, @WtSumSC, @SysRate, @DocRate, @CtlAccount, @BaseAmnt, @BaseAmntFC, @BaseAmntSC, @DocSubType, @NumAtCard, @NumControl, @TipoTrans, @UpdateDate,@Max1099, @Fafe)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\n\r\nCREATE PROC [dbo].[LastSalesCreditNote]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM ORIN ORDER BY DocNum DESC\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateSalesCreditNote]\r\n\r\n@DocNum int,\r\n@DocEntry datetime, \r\n@TaxDate datetime,\r\n@DocDueDate nvarchar(50),\r\n@NumAtCard nvarchar(100),\r\n@NumControl nvarchar(20),\r\n@TipoTrans nvarchar(10),\r\n@Comments nvarchar(254),\r\n@JrnlMemo nvarchar(50),\r\n@LicTradNum nvarchar(32),\r\n@UserSign smallint,\r\n@UpdateDate datetime\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE ORIN SET TaxDate=@TaxDate, DocDueDate=@DocDueDate, NumAtCard=@NumAtCard, U_IDA_NumControl=@NumControl, U_IDA_TipoTrans=@TipoTrans, Comments=@Comments, JrnlMemo=@JrnlMemo, LicTradNum=@LicTradNum, UserSign2=@UserSign, UpdateDate=@UpdateDate WHERE DocEntry=@DocEntry\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindRetencionImpuestoORIN]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT WTCode,Rate,TaxbleAmnt,TaxbleAmntSC,TaxbleAmntFC,WTAmnt,WTAmntSC,WTAmntFC,Category,Account,Type,BaseType,LineNum,BaseAmnt, BaseAmntSC, BaseAmntFC FROM RIN5 WHERE AbsEntry=@DocEntry ORDER BY LineNum\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[NextSalesCreditNote]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result int\r\n\r\nSET @Result=(SELECT Siguiente\r\nFROM\r\n    (Select DocNum,LEAD(DocNum) over (order by DocNum) Siguiente\r\n      from ORIN) AS NextQuerySalesCreditNote\r\n Where DocNum=@DocNum)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM ORIN WHERE DocNum=@Result\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM ORIN ORDER BY DocNum\r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FirstSalesCreditNote]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 * FROM ORIN ORDER BY DocNum\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[PreviousSalesCreditNote]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result int\r\n\r\nSET @Result=(SELECT Previous\r\nFROM\r\n    (Select DocNum,LAG(DocNum) over (order by DocNum) Previous\r\n      from ORIN) AS PreviousQuerySalesCreditLine\r\n Where DocNum=@DocNum)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM ORIN WHERE DocNum=@Result\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM ORIN ORDER BY DocNum DESC\r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertSalesCreditNoteLines]\r\n\r\n@DocEntry int,\r\n@LineNum int,\r\n@LineStatus char(1),\r\n@ItemCode nvarchar(50),\r\n@Dscription nvarchar(100),\r\n@Quantity numeric (19,6),\r\n@OpenQty numeric (19,6),\r\n@InvQty numeric (19,6),\r\n@OpenInvQty numeric (19,6),\r\n@Price numeric (19,6),\r\n@Currency nvarchar(3),\r\n@LineTotal numeric (19,6),\r\n@AcctCode nvarchar(15),\r\n@DocDate datetime,\r\n@BaseCard nvarchar(15),\r\n@TotalSumSy numeric (19,6),\r\n@TotalFrgn numeric (19,6),\r\n@VatSum numeric (19,6),\r\n@VatSumFrgn numeric (19,6),\r\n@VatSumSy numeric (19,6),\r\n@VatGroup nvarchar(8),\r\n@VatPrcnt numeric (19,6),\r\n@FinncPriod int,\r\n@ObjType nvarchar(20),\r\n@Address nvarchar(254),\r\n@GTotal numeric (19,6),\r\n@GTotalFC numeric (19,6),\r\n@GTotalSC numeric (19,6),\r\n@StockSum numeric (19,6),\r\n@StockSumFc numeric (19,6),\r\n@StockSumSc numeric (19,6),\r\n@InvntSttus char(1),\r\n@WtLiable char(1),\r\n@DataSource char(1),\r\n@NumPerMsr numeric (19,6),\r\n@NumPerMsr2 numeric (19,6),\r\n@UomCode nvarchar(20),\r\n@UomCode2 nvarchar(20),\r\n@UomEntry int,\r\n@UomEntry2 int,\r\n@unitMsr nvarchar(100),\r\n@unitMsr2 nvarchar(100),\r\n@IsTax char(1),\r\n@StartValue char(1)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO RIN1 (DocEntry,LineNum,LineStatus,ItemCode,Dscription,Quantity,OpenQty,InvQty,OpenInvQty,Price,Currency, LineTotal, TotalSumSy, TotalFrgn, VatSum, VatSumFrgn,VatSumSy, VatGroup,VatPrcnt, FinncPriod, ObjType, Address, GTotal, GTotalFC, GTotalSC, StockSum,StockSumFc,StockSumSc, InvntSttus, WtLiable, AcctCode, DocDate, BaseCard, DataSource,NumPerMsr,NumPerMsr2,UomCode,UomCode2, UomEntry, UomEntry2, unitMsr, unitMsr2, IsTax,StartValue) VALUES(@DocEntry,@LineNum,@LineStatus,@ItemCode,@Dscription,@Quantity,@OpenQty,@InvQty,@OpenInvQty,@Price,@Currency, @LineTotal, @TotalSumSy, @TotalFrgn, @VatSum, @VatSumFrgn,@VatSumSy, @VatGroup,@VatPrcnt, @FinncPriod, @ObjType, @Address, @GTotal, @GTotalFC, @GTotalSC, @StockSum,@StockSumFc,@StockSumSc, @InvntSttus, @WtLiable,  @AcctCode, @DocDate, @BaseCard, @DataSource,@NumPerMsr,@NumPerMsr2,@UomCode,@UomCode2, @UomEntry, @UomEntry2, @unitMsr, @unitMsr2,@IsTax,@StartValue)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertTaxHoldingORIN]\r\n\r\n@AbsEntry int,\r\n@WTCode nvarchar(4),\r\n@Rate numeric (19,6),\r\n@TaxbleAmnt numeric (19,6),\r\n@TaxbleAmntSC numeric (19,6),\r\n@TaxbleAmntFC numeric (19,6),\r\n@WTAmnt numeric (19,6),\r\n@WTAmntSC numeric (19,6),\r\n@WTAmntFC numeric (19,6),\r\n@Category char(1),\r\n@Account nvarchar(15),\r\n@Type char(1),\r\n@BaseType char(1),\r\n@LineNum int,\r\n@Status char(1),\r\n@ObjType nvarchar(20),\r\n@BaseAmnt numeric (19,6),\r\n@BaseAmntSC numeric (19,6),\r\n@BaseAmntFC numeric (19,6)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO RIN5 (AbsEntry,WTCode,Rate,TaxbleAmnt,TaxbleAmntFC,TaxbleAmntSC,WTAmnt,WTAmntFC,WTAmntSC,Category,Account,Type, BaseType,LineNum, Status, ObjType,BaseAmnt, BaseAmntFC,BaseAmntSC) VALUES(@AbsEntry,@WTCode,@Rate,@TaxbleAmnt,@TaxbleAmntFC,@TaxbleAmntSC,@WTAmnt,@WTAmntFC,@WTAmntSC,@Category,@Account,@Type, @BaseType,@LineNum, @Status, @ObjType,@BaseAmnt, @BaseAmntFC,@BaseAmntSC)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindDocEntryORIN]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT DocEntry FROM ORIN WHERE DocNum=@DocNum\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindDocEntryORPC]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT DocEntry FROM ORPC WHERE DocNum=@DocNum\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[SelectDocNumODLN]\r\n\r\nAS\r\n\r\nDECLARE @DocNum int\r\n\r\nBEGIN\r\n\r\nSET @DocNum =(SELECT (SELECT DISTINCT TOP 1 DocNum FROM ODLN ORDER BY DocNum DESC) + 1 AS DocNum)\r\n\r\nIF(@DocNum IS NULL)\r\nBEGIN \r\nSELECT 1 AS DocNum\r\nEND\r\nELSE\r\nBEGIN\r\nSELECT @DocNum AS DocNum\r\nEND\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeleteAccount]\r\n@AcctCode nvarchar(15)\r\nAS\r\n\r\nBEGIN\r\n\r\n\r\nDECLARE @AcctCodePCH1 int\r\nDECLARE @AcctCodePCH5 int\r\nDECLARE @AcctCodeINV1 int\r\nDECLARE @AcctCodeINV5 int\r\nDECLARE @AcctCodeDLN1 int\r\nDECLARE @AcctCodeDLN5 int\r\nDECLARE @AcctCodeRPC1 int\r\nDECLARE @AcctCodeRPC5 int\r\nDECLARE @AcctCodePDN1 int\r\nDECLARE @AcctCodePDN5 int\r\nDECLARE @AcctCodeRIN1 int\r\nDECLARE @AcctCodeRIN5 int\r\nDECLARE @AcctCodeOCRD int\r\nDECLARE @AcctCodeOWHT int\r\nDECLARE @AcctCodeJDT1 int\r\nDECLARE @AcctCodeOSTASales int\r\nDECLARE @AcctCodeOSTAPurchase int\r\nDECLARE @Result int\r\n\r\nSET @AcctCodePCH1 = (SELECT COUNT(AcctCode) FROM PCH1 WHERE AcctCode=@AcctCode)\r\nSET @AcctCodePCH5 = (SELECT COUNT(Account) FROM PCH5 WHERE Account=@AcctCode)\r\nSET @AcctCodeINV1 = (SELECT COUNT(AcctCode) FROM INV1 WHERE AcctCode=@AcctCode)\r\nSET @AcctCodeINV5 = (SELECT COUNT(Account) FROM INV5 WHERE Account=@AcctCode)\r\nSET @AcctCodeDLN1 = (SELECT COUNT(AcctCode) FROM DLN1 WHERE AcctCode=@AcctCode)\r\nSET @AcctCodeDLN5 = (SELECT COUNT(Account) FROM DLN5 WHERE Account=@AcctCode)\r\nSET @AcctCodeRPC1 = (SELECT COUNT(AcctCode) FROM RPC1 WHERE AcctCode=@AcctCode)\r\nSET @AcctCodeRPC5 = (SELECT COUNT(Account) FROM RPC5 WHERE Account=@AcctCode)\r\nSET @AcctCodePDN1 = (SELECT COUNT(AcctCode) FROM PDN1 WHERE AcctCode=@AcctCode)\r\nSET @AcctCodePDN5 = (SELECT COUNT(Account) FROM PDN5 WHERE Account=@AcctCode)\r\nSET @AcctCodeRIN1 = (SELECT COUNT(AcctCode) FROM RIN1 WHERE AcctCode=@AcctCode)\r\nSET @AcctCodeRIN5 = (SELECT COUNT(Account) FROM RIN5 WHERE Account=@AcctCode)\r\nSET @AcctCodeOCRD = (SELECT COUNT(DebPayAcct) FROM OCRD WHERE DebPayAcct=@AcctCode)\r\nSET @AcctCodeOWHT = (SELECT COUNT(Account) FROM OWHT WHERE Account=@AcctCode)\r\nSET @AcctCodeJDT1 = (SELECT COUNT(Account) FROM JDT1 WHERE Account=@AcctCode)\r\nSET @AcctCodeOSTASales = (SELECT COUNT(PurchTax) FROM OSTA WHERE SalesTax=@AcctCode)\r\nSET @AcctCodeOSTAPurchase = (SELECT COUNT(PurchTax) FROM OSTA WHERE PurchTax=@AcctCode)\r\n\r\nSET @Result=@AcctCodeDLN1+@AcctCodeDLN5+@AcctCodeINV1+@AcctCodeINV5+@AcctCodeJDT1+@AcctCodeOCRD+@AcctCodeOSTAPurchase+@AcctCodeOSTASales+@AcctCodeOWHT+@AcctCodePCH1+@AcctCodePCH5+@AcctCodePDN1+@AcctCodePDN5+@AcctCodeRIN1+@AcctCodeRIN5+@AcctCodeRPC1+@AcctCodeRPC5\r\n\r\nIF (@Result=0)\r\nBEGIN\r\nDELETE FROM OACT WHERE AcctCode=@AcctCode\r\nEND\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[PreviousPaymentMade]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result int\r\n\r\nSET @Result=(SELECT Previous\r\nFROM\r\n    (Select DocNum,LAG(DocNum) over (order by DocNum) Previous\r\n      from OVPM) AS PreviousPaymentMade\r\n Where DocNum=@DocNum)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM OVPM WHERE DocNum=@Result\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM OVPM ORDER BY DocNum DESC\r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[NextPaymentMade]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result int\r\n\r\nSET @Result=(SELECT Siguiente\r\nFROM\r\n    (Select DocNum,LEAD(DocNum) over (order by DocNum) Siguiente\r\n      from OVPM) AS NextQueryPaymentMade\r\n Where DocNum=@DocNum)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM OVPM WHERE DocNum=@Result\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM OVPM ORDER BY DocNum\r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FirstPaymentMade]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Query int\r\n\r\nSET @Query=(SELECT COUNT(*) FROM OVPM)\r\n\r\nIF(@Query>0)\r\nBEGIN\r\nSELECT TOP 1 * FROM OVPM ORDER BY DocNum\r\nEND\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[LastPaymentMade]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Query int\r\n\r\nSET @Query=(SELECT COUNT(*) FROM OVPM)\r\n\r\nIF(@Query>0)\r\nBEGIN\r\nSELECT TOP 1 * FROM OVPM ORDER BY DocNum DESC\r\nEND\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindPurchaseInvoiceBusinessPartner]\r\n\r\n@CardCode nvarchar(15)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\n;WITH jdt1 AS \r\n(\r\n   SELECT \r\nT0.[TransId] AS 'DocEntry',\r\nT0.[Line_ID] AS 'Line_ID',\r\nT0.[TransId] AS 'DocNum',\r\nT0.[TransType] AS 'TransType',\r\nT0.[Account] AS 'CtlAccount',\r\nCAST(CONVERT(nvarchar,T0.RefDate,103)AS nvarchar) AS 'DocDate',\r\nT1.[TransCurr] 'DocCur',\r\nT0.[SYSCred]-T0.[SYSDeb] AS 'DocTotalSy',\r\nT0.[BalScCred]-T0.[BalScDeb] AS 'PaidSys',\r\n\r\nCASE \r\n\t\t\tWHEN T1.[TransCurr]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[Credit] AS decimal (19,2))-CAST(T0.[Debit] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[FCCredit] AS decimal (19,2))-CAST(T0.[FCDebit] AS decimal (19,2))\r\n\t\t\tEND AS 'DocTotal',\r\nCASE \r\n\t\t\tWHEN T1.[TransCurr]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[FCCredit] AS decimal (19,2))-CAST(T0.[FCDebit] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[Credit] AS decimal (19,2))-CAST(T0.[Debit] AS decimal (19,2))\r\n\t\t\tEND AS 'DocTotalFrgn',\t\r\n\t\t\t\r\nCASE \r\n\t\t\tWHEN T1.[TransCurr]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[BalDueDeb] AS decimal (19,2))-CAST(T0.[BalDueCred] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[BalFcDeb] AS decimal (19,2))-CAST(T0.[BalFcCred] AS decimal (19,2))\r\n\t\t\tEND AS 'Paid',\r\nCASE \r\n\t\t\tWHEN T1.[TransCurr]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[BalFcDeb] AS decimal (19,2))-CAST(T0.[BalFcCred] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[BalDueDeb] AS decimal (19,2))-CAST(T0.[BalDueCred] AS decimal (19,2))\r\n\t\t\tEND AS 'PaidFC',\r\n\r\n\r\n'--' AS 'DocSubType',\r\nT0.[LineMemo] AS 'LineMemo',\r\n\r\nCASE \r\n\t\t\tWHEN T1.[FcTotal]=0 THEN CAST(0 AS decimal (19,2))\r\n\t\t\tELSE CAST(T1.[LocTotal]/T1.[FcTotal] AS decimal (19,2))\r\n\t\t\tEND AS 'DocRate',\r\n\r\nCAST(T1.[LocTotal]/T1.[SysTotal] AS decimal (19,2)) AS 'SysRate',\r\nT0.[TransId] AS 'TransId',\r\nT0.[WTSum]  AS 'WTSum',\r\nT0.[WTSumFC]  AS 'WTSumFC',\r\nT0.[WTSumSC]  AS 'WTSumSC',\r\n0 AS 'VatSum',\r\n0  AS 'VatSumFC',\r\n0 AS 'VatSumSy',\r\n0 AS 'WTImporte',\r\n0 AS 'WTImporteFC',\r\n0 AS 'WTImporteSC',\r\n'N' AS 'IsDocument'\r\n\r\nFROM  [dbo].[JDT1] T0  INNER  JOIN [dbo].[OJDT] T1  ON  T0.[TransId] = T1.[TransId]   INNER  JOIN [dbo].[OCRD] T2\r\n\r\nON  T0.[ShortName] = T2.[CardCode]   WHERE\r\n\r\n((T0.[TransType] <> ('18')  AND  T0.[TransType] <> ('204')  AND  ((T0.[TransType] <> ('46')  AND  T0.[TransType] <> ('-5') ) OR  (T0.[TransType] <> ('46')) OR  (T0.[TransType] = ('-5'))) AND  T0.[TransType] <> ('165')  AND  T0.[TransType] <> ('166')  AND  T0.[TransType] <> ('163')  AND  T0.[TransType] <> ('164')  AND  T0.[TransType] <> ('19')  AND  T0.[TransType] <> ('182') )) AND  T0.[ShortName] = (@CardCode) AND  (T0.[BalDueCred] <> (0)  OR  T0.[BalDueDeb] <> (0) ) AND  (T0.[TransType] <> ('-2') AND T0.[TransType] <> ('-3')) \r\n\r\n\r\n)\r\n\r\nSELECT\r\nDocEntry,\r\nLine_ID,\r\nDocNum,\r\nTransType,\r\nCtlAccount,\r\nDocDate,\r\nDocCur,\r\nDocTotalSy,\r\n(DocTotalSy-PaidSys) AS 'PaidSys',\r\nDocTotal,\r\nDocTotalFrgn,\t\t\t\t\r\n(DocTotal-Paid) AS 'Paid',\r\n(DocTotalFrgn-PaidFC) AS 'PaidFC',\r\nDocSubType,\r\nLineMemo,\r\nDocRate,\r\nSysRate,\r\nTransId,\r\nWTSum,\r\nWTSumFC,\r\nWTSumSC,\r\nVatSum,\r\nVatSumFC,\r\nVatSumSy,\r\nWTImporte,\r\nWTImporteFC,\r\nWTImporteSC,\r\nIsDocument\r\n\r\nFROM \r\n\r\njdt1\r\n\r\nUNION\r\n\r\nSELECT \r\nT0.DocEntry AS 'DocEntry',\r\n0 AS 'Line_ID',\r\nT0.DocNum AS 'DocNum',\r\nT0.ObjType AS 'TransType',\r\nT0.CtlAccount AS 'CtlAccount',\r\nCAST(CONVERT(nvarchar,T0.DocDate,103)AS nvarchar) AS 'DocDate',\r\nT0.DocCur AS 'DocCur',\r\nCAST(T0.DocTotalSy AS decimal (19,2)) AS 'DocTotalSy',\r\nCAST(T0.PaidSys AS decimal (19,2)) AS 'PaidSys',\r\nCASE \r\n\t\t\tWHEN T0.DocCur=(SELECT MainCurncy FROM OADM) THEN CAST(T0.DocTotal AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.DocTotalFC AS decimal (19,2))\r\n\t\t\tEND AS 'DocTotal',\r\nCASE \r\n\t\t\tWHEN T0.DocCur=(SELECT MainCurncy FROM OADM) THEN CAST(T0.DocTotalFC AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.DocTotal AS decimal (19,2))\r\n\t\t\tEND AS 'DocTotalFrgn',\t\r\n\t\t\t\r\nCASE \r\n\t\t\tWHEN T0.DocCur=(SELECT MainCurncy FROM OADM) THEN CAST(T0.PaidToDate AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.PaidFC AS decimal (19,2))\r\n\t\t\tEND AS 'Paid',\r\nCASE \r\n\t\t\tWHEN T0.DocCur=(SELECT MainCurncy FROM OADM) THEN CAST(T0.PaidFC AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.PaidToDate AS decimal (19,2))\r\n\t\t\tEND AS 'PaidFC',\r\n\r\n\r\nT0.[DocSubType] AS 'DocSubType',\r\nT0.[Comments] AS 'LineMemo',\r\nT0.[DocRate] AS 'DocRate', \r\nT0.[SysRate]  AS 'SysRate',\r\nT0.[TransId]  AS 'TransId',\r\nT0.[WTSum]  AS 'WTSum',\r\nT0.[WTSumFC]  AS 'WTSumFC',\r\nT0.[WTSumSC]  AS 'WTSumSC',\r\nT0.[VatSum]  AS 'VatSum',\r\nT0.[VatSumFC]  AS 'VatSumFC',\r\nT0.[VatSumSy]  AS 'VatSumSy',\r\nCASE \r\n\t\t\tWHEN T0.DocCur=(SELECT MainCurncy FROM OADM) THEN ISNULL((SELECT SUM(TaxbleAmnt) FROM PCH5 WHERE AbsEntry=T0.[DocEntry] AND Category='P'),0)\r\n\t\t\tELSE ISNULL((SELECT SUM(TaxbleAmntFC) FROM PCH5 WHERE AbsEntry=T0.[DocEntry] AND Category='P'),0)\r\n\t\t\tEND AS 'WTImporte',\r\nCASE \r\n\t\t\tWHEN T0.DocCur=(SELECT MainCurncy FROM OADM) THEN ISNULL((SELECT SUM(TaxbleAmntFC) FROM PCH5 WHERE AbsEntry=T0.[DocEntry] AND Category='P'),0)\r\n\t\t\tELSE ISNULL((SELECT SUM(TaxbleAmnt) FROM PCH5 WHERE AbsEntry=T0.[DocEntry] AND Category='P'),0)\r\n\t\t\tEND AS 'WTImporteFC',\r\n\r\nISNULL((SELECT SUM(TaxbleAmntSC) FROM PCH5 WHERE AbsEntry=T0.[DocEntry] AND Category='P'),0) AS 'WTImporteSC',\r\n'Y' AS 'IsDocument'\r\n\r\nFROM [OPCH] T0  INNER  JOIN [dbo].[PCH1] T1  ON  T1.[DocEntry] = T0.[DocEntry] \r\n INNER  JOIN [dbo].[JDT1] T2  ON  T2.[TransId] = T0.[TransId]\r\nWHERE T0.[CardCode] = (@CardCode) AND  T0.[DocStatus] = ('O') \r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[SelectDocNumOVPM]\r\n\r\nAS\r\n\r\nDECLARE @DocNum int\r\n\r\nBEGIN\r\n\r\nSET @DocNum =(SELECT (SELECT DISTINCT TOP 1 DocNum FROM OVPM ORDER BY DocNum DESC) + 1 AS DocNum)\r\n\r\nIF(@DocNum IS NULL)\r\nBEGIN \r\nSELECT 1 AS DocNum\r\nEND\r\nELSE\r\nBEGIN\r\nSELECT @DocNum AS DocNum\r\nEND\r\n \r\nEND\r\n\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindPayment]\r\n\r\n@DocNum int,\r\n@DocDate datetime, \r\n@TaxDate datetime,\r\n@DocDueDate datetime,\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar(100),\r\n@Address nvarchar(254),\r\n@CounterRef nvarchar(8),\r\n@JrnlMemo nvarchar(50),\r\n@TransId int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\n\r\nSELECT * FROM OVPM WHERE DocNum LIKE CAST(@DocNum AS nvarchar)+ '%' OR DocDate LIKE CAST(@DocDate AS nvarchar) + '%' OR TaxDate LIKE CAST(@TaxDate AS nvarchar)+ '%' OR DocDueDate LIKE CAST(@DocDueDate AS NVARCHAR) + '%' OR CardCode LIKE @CardCode + '%' OR CardName LIKE @CardName + '%' OR Address LIKE @Address + '%' OR CounterRef LIKE @CounterRef + '%' OR JrnlMemo LIKE @JrnlMemo + '%' OR TransId LIKE CAST(@TransId AS nvarchar) + '%'\r\n\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindPaymentMadeLines]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT DocNum, InvType FROM VPM2 WHERE DocNum=@DocEntry\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GetDocumentAccount]\r\n\r\n@DocEntry int,\r\n@TransType nvarchar(20)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result nvarchar(15)\r\n\r\nSET @Result= (SELECT CtlAccount FROM OPCH WHERE DocEntry=@DocEntry AND ObjType=@TransType)\r\n\r\nIF(@Result <> '')\r\nBEGIN\r\nSELECT @Result AS 'CtlAccount'\r\nEND\r\nELSE\r\nBEGIN\r\nSET @Result= (SELECT TOP 1 Account FROM JDT1 WHERE TransId=@DocEntry AND TransType=@TransType)\r\nSELECT @Result AS 'CtlAccount'\r\nEND\r\n\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertPaymentMade]\r\n\r\n@DocNum int,\r\n@DocDate datetime,\r\n@TaxDate datetime,\r\n@DocDueDate datetime,\r\n@Comments nvarchar(254),\r\n@DocType char(1),\r\n@Canceled char(1),\r\n@UserSign int,\r\n@UpdateDate datetime,\r\n@FinncPriod int,\r\n@Address nvarchar(254),\r\n@ObjType nvarchar(20),\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar(100),\r\n@JrnlMemo nvarchar(50),\r\n@DocCurr nvarchar(3),\r\n@DocTotal numeric (19,6),\r\n@DocTotalFC numeric (19,6),\r\n@DocTotalSy numeric (19,6),\r\n@TransId int,\r\n@SysRate numeric (19,6),\r\n@DocRate numeric (19,6),\r\n@BpAct nvarchar(15),\r\n@CashAcct nvarchar(15),\r\n@CashSum numeric (19,6),\r\n@CashSumFC numeric (19,6),\r\n@CashSumSy numeric (19,6),\r\n@TrsfrAcct nvarchar(15),\r\n@TrsfrSum numeric (19,6),\r\n@TrsfrSumFC numeric (19,6),\r\n@TrsfrSumSy numeric (19,6),\r\n@TrsfrDate datetime,\r\n@TrsfrRef nvarchar(27),\r\n@CheckAcct nvarchar (15),\r\n@CheckSum numeric (19,6),\r\n@CheckSumFC numeric (19,6),\r\n@CheckSumSy numeric (19,6),\r\n@PayNoDoc char(1),\r\n@NoDocSum numeric (19,6),\r\n@NoDocSumFC numeric (19,6),\r\n@NoDocSumSy numeric (19,6),\r\n@CounterRef nvarchar(8)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO OVPM (DocNum,DocDate,TaxDate,DocDueDate,Comments,DocType,Canceled,UserSign,UpdateDate, FinncPriod,Address, ObjType, CardCode,CardName,JrnlMemo, DocCurr, DocTotal, DocTotalFC,DocTotalSy,TransId,SysRate,DocRate,BpAct,CashAcct,CashSum,CashSumFC,CashSumSy,TrsfrAcct,TrsfrSum,TrsfrSumFC,TrsfrSumSy,TrsfrDate,TrsfrRef,CheckAcct,CheckSum,CheckSumSy,CheckSumFC,PayNoDoc,NoDocSum,NoDocSumFC,NoDocSumSy,CounterRef ) VALUES(@DocNum,@DocDate,@TaxDate,@DocDueDate,@Comments,@DocType,@Canceled,@UserSign,@UpdateDate, @FinncPriod,@Address, @ObjType, @CardCode,@CardName,@JrnlMemo, @DocCurr, @DocTotal, @DocTotalFC,@DocTotalSy,@TransId,@SysRate,@DocRate,@BpAct,@CashAcct,@CashSum,@CashSumFC,@CashSumSy,@TrsfrAcct,@TrsfrSum,@TrsfrSumFC,@TrsfrSumSy,@TrsfrDate,@TrsfrRef,@CheckAcct,@CheckSum,@CheckSumSy,@CheckSumFC,@PayNoDoc,@NoDocSum,@NoDocSumFC,@NoDocSumSy,@CounterRef) \r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertPaymentMadeLines]\r\n\r\n@DocNum int,\r\n@InvoiceId int,\r\n@DocEntry int,\r\n@SumApplied numeric (19,6),\r\n@AppliedFC numeric (19,6),\r\n@AppliedSys numeric (19,6),\r\n@VatApplied numeric (19,6),\r\n@VatAppldFC numeric (19,6),\r\n@VatAppldSy numeric (19,6),\r\n@WtInvCatS numeric (19,6),\r\n@WtInvCatSF numeric (19,6),\r\n@WtInvCatSS numeric (19,6),\r\n@InvType nvarchar(20),\r\n@ObjType nvarchar(20),\r\n@DocSubType nvarchar(2),\r\n@DocTransId int,\r\n@DocRate numeric (19,6),\r\n@U_IDA_CompIVA nvarchar(20),\r\n@U_IDA_FechaComp datetime,\r\n@U_IDA_MontoCompIVA numeric (19,6),\r\n@U_IDA_CompISLR nvarchar(20),\r\n@U_IDA_DateCompISLR datetime\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO VPM2 (DocNum,InvoiceId,DocEntry,SumApplied,AppliedFC,AppliedSys,vatApplied,vatAppldFC,vatAppldSy, WtInvCatS,WtInvCatSF,WtInvCatSS,InvType,ObjType,DocSubType,DocTransId,DocRate,U_IDA_CompIVA,U_IDA_FechaComp,U_IDA_MontoCompIVA,U_IDA_CompISLR,U_IDA_DateCompISLR) VALUES(@DocNum,@InvoiceId,@DocEntry,@SumApplied,@AppliedFC,@AppliedSys,@vatApplied,@vatAppldFC,@vatAppldSy, @WtInvCatS,@WtInvCatSF,@WtInvCatSS,@InvType,@ObjType,@DocSubType,@DocTransId,@DocRate,@U_IDA_CompIVA,@U_IDA_FechaComp,@U_IDA_MontoCompIVA,@U_IDA_CompISLR,@U_IDA_DateCompISLR) \r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindPurchaseSpecific]\r\n\r\n@DocEntry int,\r\n@TransType nvarchar(20)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT * FROM OPCH WHERE DocNum=@DocEntry\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeletePaymentMade]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @CON INT\r\n\r\nSET @CON=@DocNum-1\r\n\r\nDELETE FROM OVPM WHERE DocNum=@DocNum\r\n\r\nDBCC CHECKIDENT ('OVPM', RESEED, @CON)\r\nDBCC CHECKIDENT ('OVPM', RESEED, @CON)\r\n \r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdatePaymentMadePurchase]\r\n\r\n@DocEntry int,\r\n@PaidToDate numeric (19,6),\r\n@PaidFC numeric (19,6),\r\n@PaidSys numeric (19,6),\r\n@PaidSum numeric (19,6),\r\n@PaidSumFc numeric (19,6),\r\n@PaidSumSc numeric (19,6)\r\n\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE OPCH SET PaidToDate=(PaidToDate+@PaidToDate), PaidFC=(PaidFC+@PaidFC), PaidSys=(PaidSys+@PaidSys), PaidSum=(PaidSum+@PaidSum), PaidSumFc=PaidSumFc+@PaidSumFc, PaidSumSc=(PaidSumSc+@PaidSumSc) WHERE DocEntry=@DocEntry\r\n\r\nDECLARE @PaidSumResult numeric(19,6)\r\n\r\nDECLARE @DocTotal numeric(19,6)\r\n\r\nSET @PaidSumResult=(SELECT PaidSum FROM OPCH WHERE DocEntry=@DocEntry)\r\n\r\nSET @DocTotal=(SELECT PaidSum FROM OPCH WHERE DocEntry=@DocEntry)\r\n\r\nIF(@PaidSumResult=@DocTotal)\r\nBEGIN\r\nUPDATE OPCH SET DocStatus='C' WHERE DocEntry=@DocEntry\r\nEND\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindPurchaseInvoiceBusinessPartnerSpecific]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nselect\tT0.[DocNum],\r\n\t\tT0.[DocDate],\r\n\t\tT0.[ObjType], \r\n\t\tT0.[DocCur], \r\n\t\tT0.[DocTotalSy],\r\n\t\tT0.[PaidSys],\r\n\t\tT1.[U_IDA_CompIVA],\r\n\t\tT1.[U_IDA_FechaComp],\r\n\t\tT1.[U_IDA_MontoCompIVA],\r\n\t\tT1.[U_IDA_DateCompISLR],\r\n\t\tT1.[U_IDA_CompISLR],\r\n\t\tCASE \r\n\t\t\tWHEN T0.[DocCur]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[DocTotal] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[DocTotalFC] AS decimal (19,2))\r\n\t\t\tEND AS 'DocTotal',\r\nCASE \r\n\t\t\tWHEN T0.[DocCur]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[DocTotalFC] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[DocTotal] AS decimal (19,2))\r\n\t\t\tEND AS 'DocTotalFrgn',\t\r\nCASE \r\n\t\t\tWHEN T0.[DocCur]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[PaidToDate] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[PaidFC] AS decimal (19,2))\r\n\t\t\tEND AS 'Paid',\r\nCASE \r\n\t\t\tWHEN T0.[DocCur]=(SELECT MainCurncy FROM OADM) THEN CAST([PaidFC] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[PaidToDate] AS decimal (19,2))\r\n\t\t\tEND AS 'PaidFC'\r\n\t\tfrom [OPCH] T0\r\n\t    INNER JOIN [VPM2] T1 ON T1.[DocEntry]=T0.[DocEntry]\r\n\t\tWHERE T0.[DocEntry]=@DocEntry\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindPurchaseInvoiceSupplierSpecific]\r\n\r\n@DocEntry int,\r\n@TransType nvarchar(20)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nselect\t\r\n\t\tT0.[DocEntry] AS 'DocEntry',\r\n\t\t0 AS 'Line_ID',\r\n\t\tT0.[DocNum] AS 'DocNum',\t\t\r\n\t\tT0.[ObjType] AS 'TransType',\r\n\t\tT0.[CtlAccount] AS 'CtlAccount',\r\n\t\tCAST(CONVERT(nvarchar,T0.DocDate,103)AS nvarchar) AS 'DocDate',\r\n\t\tT0.DocCur AS 'DocCur',\r\n\t\tCAST(T0.DocTotalSy AS decimal (19,2)) AS 'DocTotalSy',\r\n\t\tCAST(T0.PaidSys AS decimal (19,2)) AS 'PaidSys',\r\n\t\t\r\n\t\tCASE \r\n\t\t\tWHEN T0.[DocCur]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[DocTotal] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[DocTotalFC] AS decimal (19,2))\r\n\t\t\tEND AS 'DocTotal',\r\nCASE \r\n\t\t\tWHEN T0.[DocCur]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[DocTotalFC] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[DocTotal] AS decimal (19,2))\r\n\t\t\tEND AS 'DocTotalFrgn',\t\r\nCASE \r\n\t\t\tWHEN T0.[DocCur]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[PaidToDate] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[PaidFC] AS decimal (19,2))\r\n\t\t\tEND AS 'Paid',\r\nCASE \r\n\t\t\tWHEN T0.[DocCur]=(SELECT MainCurncy FROM OADM) THEN CAST([PaidFC] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[PaidToDate] AS decimal (19,2))\r\n\t\t\tEND AS 'PaidFC',\r\n\r\n\t\t\tT0.[DocSubType] AS 'DocSubType',\r\n\t\t\tT0.[Comments] AS 'LineMemo',\r\n\t\t\tT0.[DocRate] AS 'DocRate', \r\n\t\t\tT0.[SysRate]  AS 'SysRate',\r\n\t\t\tT0.[TransId]  AS 'TransId',\r\n\t\t\tT0.[WTSum]  AS 'WTSum',\r\n\t\t\tT0.[WTSumFC]  AS 'WTSumFC',\r\n\t\t\tT0.[WTSumSC]  AS 'WTSumSC',\r\n\t\t\tT0.[VatSum]  AS 'VatSum',\r\n\t\t\tT0.[VatSumFC]  AS 'VatSumFC',\r\n\t\t\tT0.[VatSumSy]  AS 'VatSumSy',\r\n\r\nCASE \r\n\t\t\tWHEN T0.DocCur=(SELECT MainCurncy FROM OADM) THEN ISNULL((SELECT SUM(TaxbleAmnt) FROM PCH5 WHERE AbsEntry=T0.[DocEntry] AND Category='P'),0)\r\n\t\t\tELSE ISNULL((SELECT SUM(TaxbleAmntFC) FROM PCH5 WHERE AbsEntry=T0.[DocEntry] AND Category='P'),0)\r\n\t\t\tEND AS 'WTImporte',\r\nCASE \r\n\t\t\tWHEN T0.DocCur=(SELECT MainCurncy FROM OADM) THEN ISNULL((SELECT SUM(TaxbleAmntFC) FROM PCH5 WHERE AbsEntry=T0.[DocEntry] AND Category='P'),0)\r\n\t\t\tELSE ISNULL((SELECT SUM(TaxbleAmnt) FROM PCH5 WHERE AbsEntry=T0.[DocEntry] AND Category='P'),0)\r\n\t\t\tEND AS 'WTImporteFC',\r\n\r\nISNULL((SELECT SUM(TaxbleAmntSC) FROM PCH5 WHERE AbsEntry=T0.[DocEntry] AND Category='P'),0) AS 'WTImporteSC',\r\n\r\n\t\t\t\r\n\t\tT1.[U_IDA_CompIVA],\r\n\t\tT1.[U_IDA_FechaComp],\r\n\t\tT1.[U_IDA_MontoCompIVA],\r\n\t\tT1.[U_IDA_DateCompISLR],\r\n\t\tT1.[U_IDA_CompISLR],\r\n\t\t'Y' AS 'IsDocument'\r\n\r\n\t\tfrom [OPCH] T0\r\n\t    INNER JOIN [VPM2] T1 ON T1.[DocEntry]=T0.[DocEntry]\r\n\t\tWHERE T1.[DocNum]=@DocEntry AND T1.InvType=@TransType\r\n\r\n\t\tUNION \r\n\r\n\t\tSELECT \r\nT0.[TransId] AS 'DocEntry',\r\nT0.[Line_ID] AS 'Line_ID',\r\nT0.[TransId] AS 'DocNum',\r\nT0.[TransType] AS 'TransType',\r\nT0.[Account] AS 'CtlAccount',\r\nCAST(CONVERT(nvarchar,T0.RefDate,103)AS nvarchar) AS 'DocDate',\r\nT1.[TransCurr] 'DocCur',\r\nT0.[SYSCred]-T0.[SYSDeb] AS 'DocTotalSy',\r\nT0.[BalScCred]-T0.[BalScDeb] AS 'PaidSys',\r\n\r\nCASE \r\n\t\t\tWHEN T1.[TransCurr]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[Credit] AS decimal (19,2))-CAST(T0.[Debit] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[FCCredit] AS decimal (19,2))-CAST(T0.[FCDebit] AS decimal (19,2))\r\n\t\t\tEND AS 'DocTotal',\r\nCASE \r\n\t\t\tWHEN T1.[TransCurr]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[FCCredit] AS decimal (19,2))-CAST(T0.[FCDebit] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[Credit] AS decimal (19,2))-CAST(T0.[Debit] AS decimal (19,2))\r\n\t\t\tEND AS 'DocTotalFrgn',\t\r\n\t\t\t\r\nCASE \r\n\t\t\tWHEN T1.[TransCurr]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[BalDueDeb] AS decimal (19,2))-CAST(T0.[BalDueCred] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[BalFcCred] AS decimal (19,2))-CAST(T0.[BalFcDeb] AS decimal (19,2))\r\n\t\t\tEND AS 'Paid',\r\nCASE \r\n\t\t\tWHEN T1.[TransCurr]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[BalFcCred] AS decimal (19,2))-CAST(T0.[BalFcDeb] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[BalDueCred] AS decimal (19,2))-CAST(T0.[BalDueDeb] AS decimal (19,2))\r\n\t\t\tEND AS 'PaidFC',\r\n\r\n\r\n'--' AS 'DocSubType',\r\nT0.[LineMemo] AS 'LineMemo',\r\n\r\nCASE \r\n\t\t\tWHEN T1.[FcTotal]=0 THEN CAST(0 AS decimal (19,2))\r\n\t\t\tELSE CAST(T1.[LocTotal]/T1.[FcTotal] AS decimal (19,2))\r\n\t\t\tEND AS 'DocRate',\r\n\r\nCAST(T1.[LocTotal]/T1.[SysTotal] AS decimal (19,2)) AS 'SysRate',\r\nT0.[TransId] AS 'TransId',\r\nT0.[WTSum]  AS 'WTSum',\r\nT0.[WTSumFC]  AS 'WTSumFC',\r\nT0.[WTSumSC]  AS 'WTSumSC',\r\n0 AS 'VatSum',\r\n0  AS 'VatSumFC',\r\n0 AS 'VatSumSy',\r\n0 AS 'WTImporte',\r\n0 AS 'WTImporteFC',\r\n0 AS 'WTImporteSC',\r\nT3.[U_IDA_CompIVA],\r\n\t\tT3.[U_IDA_FechaComp],\r\n\t\tT3.[U_IDA_MontoCompIVA],\r\n\t\tT3.[U_IDA_DateCompISLR],\r\n\t\tT3.[U_IDA_CompISLR],\r\n\t\t'N' AS 'IsDocument'\r\n\r\n\r\nFROM  [dbo].[JDT1] T0  INNER  JOIN [dbo].[OJDT] T1  ON  T0.[TransId] = T1.[TransId]   INNER  JOIN [dbo].[OCRD] T2\r\n\r\nON  T0.[ShortName] = T2.[CardCode] \r\n\r\nINNER JOIN [VPM2] T3 ON T1.[TransId]=T3.[DocTransId]\r\n\t\tWHERE \r\n\r\nT3.[DocNum]=@DocEntry AND T3.InvType=@TransType AND ((T0.[TransType] <> ('18')  AND  T0.[TransType] <> ('204')  AND  ((T0.[TransType] <> ('46')  AND  T0.[TransType] <> ('-5') ) OR  (T0.[TransType] <> ('46')) OR  (T0.[TransType] = ('-5'))) AND  T0.[TransType] <> ('165')  AND  T0.[TransType] <> ('166')  AND  T0.[TransType] <> ('163')  AND  T0.[TransType] <> ('164')  AND  T0.[TransType] <> ('19')  AND  T0.[TransType] <> ('182') )) AND (T0.[TransType] <> ('-2') AND T0.[TransType] <> ('-3')) \r\n\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindAllAccount]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT AcctCode,AcctName FROM OACT ORDER BY  GroupMask, Levels, AcctCode \r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindAccountBalance]\r\n\r\n@AcctCode nvarchar(15),\r\n@F_RefDate datetime,\r\n@T_RefDate datetime\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Date datetime\r\n\r\nSET @Date=(SELECT TOP 1 CONVERT(nvarchar,RefDate,23)AS nvarchar FROM JDT1 Order BY RefDate)\r\n\r\nIF(@F_RefDate IS NULL)\r\nBEGIN\r\n\r\nSELECT T1.[AcctCode],\r\nT1.[AcctName], \r\nSUM(T0.[Debit]) AS 'Debit',\r\nSUM(T0.[Credit]) AS 'Credit',\r\nSUM(T0.Debit - T0.Credit) AS 'Saldo',\r\nSUM(T0.[SYSDeb]) AS 'SYSDeb',\r\nSUM(T0.[SYSCred]) AS 'SYSCred',\r\nSUM(T0.SYSDeb - T0.SYSCred) AS 'SaldoSYS',\r\nSUM(T0.[FCDebit]) AS 'FCDebit',\r\nSUM(T0.[FCCredit]) AS 'FCCredit', \r\nSUM(T0.FCDebit-T0.FCCredit) AS 'FCSaldo',\r\nCASE \r\n\t\t\tWHEN (SELECT COUNT(DISTINCT FCCurrency) FROM JDT1 WHERE FCCurrency<>(SELECT MainCurncy FROM OADM))=1\r\n\t\t\tTHEN (SELECT DISTINCT TOP 1 FCCurrency FROM JDT1 WHERE FCCurrency<>(SELECT MainCurncy FROM OADM))\r\n\t\t\tELSE (SELECT '****')\r\n\t\t\tEND AS 'FCCurrency'\r\nFROM JDT1 T0 INNER JOIN OACT T1 ON T0.[Account] = T1.[AcctCode]\r\nWHERE T0.[Account] = @AcctCode AND CAST(CONVERT(nvarchar,T0.[RefDate],23)AS nvarchar)>=@Date AND CAST(CONVERT(nvarchar,T0.[RefDate],23)AS nvarchar) <= @T_RefDate\r\nGROUP BY T1.[AcctCode], T1.[AcctName]\r\nEND\r\nELSE\r\nBEGIN\r\n\r\nSELECT T1.[AcctCode],\r\nT1.[AcctName], \r\nSUM(T0.[Debit]) AS 'Debit', \r\nSUM(T0.[Credit]) AS 'Credit', \r\nSUM(T0.Debit - T0.Credit) AS 'Saldo',\r\nSUM(T0.[SYSDeb]) AS 'SYSDeb', \r\nSUM(T0.[SYSCred]) AS 'SYSCred',  \r\nSUM(T0.SYSDeb - T0.SYSCred) AS 'SaldoSYS',\r\nSUM(T0.[FCDebit]) AS 'FCDebit',\r\nSUM(T0.[FCCredit]) AS 'FCCredit',\r\nSUM(T0.FCDebit-T0.FCCredit) AS 'FCSaldo',\r\nCASE \r\n\t\t\tWHEN (SELECT COUNT(DISTINCT FCCurrency) FROM JDT1 WHERE FCCurrency<>(SELECT MainCurncy FROM OADM))=1\r\n\t\t\tTHEN (SELECT DISTINCT TOP 1 FCCurrency FROM JDT1 WHERE FCCurrency<>(SELECT MainCurncy FROM OADM))\r\n\t\t\tELSE (SELECT '****')\r\n\t\t\tEND AS 'FCCurrency'\r\nFROM JDT1 T0 INNER JOIN OACT T1 ON T0.[Account] = T1.[AcctCode]\r\nWHERE T0.[Account] = @AcctCode AND CAST(CONVERT(nvarchar,T0.[RefDate],23)AS nvarchar)>=@F_RefDate AND CAST(CONVERT(nvarchar,T0.[RefDate],23)AS nvarchar) <= @T_RefDate\r\nGROUP BY T1.[AcctCode], T1.[AcctName]\r\nEND\r\n\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindAccountLibroMayor]\r\n\r\n@AcctCode nvarchar(15),\r\n@F_RefDate datetime,\r\n@T_RefDate datetime\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Date datetime\r\n\r\nSET @Date=(SELECT TOP 1 CONVERT(nvarchar,RefDate,23)AS nvarchar FROM JDT1 Order BY RefDate)\r\n\r\nIF(@F_RefDate IS NULL)\r\n\r\nBEGIN\r\nSELECT\r\n\r\nCAST(CONVERT(nvarchar,T0.[RefDate],103)AS nvarchar) AS 'RefDate',CAST(CONVERT(nvarchar,T0.[DueDate],103)AS nvarchar) AS 'DueDate',CAST(CONVERT(nvarchar,T0.[TaxDate],103)AS nvarchar) AS 'TaxDate',T0.BaseRef,T1.TransType,T0.TransId ,T0.Memo,\r\nContraAct=(CASE WHEN T2.AcctName IS NULL THEN t3.CardCode else  T2.AcctCode  end ),\r\nAcctName=(CASE WHEN T2.AcctName IS NULL THEN t3.CardName else  T2.AcctName  end ),\r\n\r\nT1.Debit, T1.Credit, T1.Debit-T1.Credit AS 'Saldo', T1.SYSDeb, T1.SYSCred, T1.SYSDeb-T1.SYSCred AS 'SaldoSYS', T1.FCDebit,T1.FCCredit, T1.FCDebit-T1.FCCredit AS 'FCSaldo',T1.FCCurrency\r\nfrom OJDT T0\r\ninner join JDT1 T1 on T0.TransId =T1.TransId\r\nleft outer Join OACT T2 ON T2.AcctCode=T1.ContraAct\r\nleft outer join OCRD t3 on t3.CardCode=T1.ContraAct\r\nWhere CAST(CONVERT(nvarchar,T0.[RefDate],23)AS nvarchar)>=@Date and CAST(CONVERT(nvarchar,T0.[RefDate],23)AS nvarchar)<=@T_RefDate AND T1.[Account]=@AcctCode\r\n\r\norder by T0.TransId ,t1.Line_ID\r\nEND\r\nELSE\r\nBEGIN\r\nSELECT\r\n\r\nCAST(CONVERT(nvarchar,T0.[RefDate],103)AS nvarchar) AS 'RefDate',CAST(CONVERT(nvarchar,T0.[DueDate],103)AS nvarchar) AS 'DueDate',CAST(CONVERT(nvarchar,T0.[TaxDate],103)AS nvarchar) AS 'TaxDate',T0.BaseRef,T1.TransType,T0.TransId ,T0.Memo,\r\nContraAct=(CASE WHEN T2.AcctName IS NULL THEN t3.CardCode else  T2.AcctCode  end ),\r\nAcctName=(CASE WHEN T2.AcctName IS NULL THEN t3.CardName else  T2.AcctName  end ),\r\n\r\nT1.Debit, T1.Credit, T1.Debit-T1.Credit AS 'Saldo', T1.SYSDeb, T1.SYSCred, T1.SYSDeb-T1.SYSCred AS 'SaldoSYS', T1.FCDebit,T1.FCCredit, T1.FCDebit-T1.FCCredit AS 'FCSaldo',T1.FCCurrency\r\nfrom OJDT T0\r\ninner join JDT1 T1 on T0.TransId =T1.TransId\r\nleft outer Join OACT T2 ON T2.AcctCode=T1.ContraAct\r\nleft outer join OCRD t3 on t3.CardCode=T1.ContraAct\r\nWhere CAST(CONVERT(nvarchar,T0.[RefDate],23)AS nvarchar)>=@F_RefDate and CAST(CONVERT(nvarchar,T0.[RefDate],23)AS nvarchar)<=@T_RefDate AND T1.[Account]=@AcctCode\r\n\r\norder by T0.TransId ,t1.Line_ID\r\nEND\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindTransIdLD]\r\n\r\n@AcctCode nvarchar(15),\r\n@F_RefDate datetime,\r\n@T_RefDate datetime\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Date datetime\r\n\r\nSET @Date=(SELECT TOP 1 CONVERT(nvarchar,RefDate,23)AS nvarchar FROM JDT1 Order BY RefDate)\r\n\r\nIF(@F_RefDate IS NULL)\r\nBEGIN\r\n\r\nSELECT\r\n\r\nT0.TransId ,CAST(CONVERT(nvarchar,T0.[RefDate],103)AS nvarchar) AS 'RefDate',T0.BaseRef,T0.TransType,T0.Memo\r\n\r\nfrom OJDT T0\r\ninner join JDT1 T1 on T0.TransId =T1.TransId\r\n\r\nWhere CAST(CONVERT(nvarchar,T0.[RefDate],23)AS nvarchar)>=@Date and CAST(CONVERT(nvarchar,T0.[RefDate],23)AS nvarchar)<=@T_RefDate AND T1.[Account]=@AcctCode\r\n\r\norder by T0.TransId ,t1.Line_ID\r\n\r\nEND\r\nELSE\r\nBEGIN\r\n\r\nSELECT\r\n\r\nT0.TransId ,CAST(CONVERT(nvarchar,T0.[RefDate],103)AS nvarchar) AS 'RefDate',T0.BaseRef,T0.TransType,T0.Memo\r\n\r\nfrom OJDT T0\r\ninner join JDT1 T1 on T0.TransId =T1.TransId\r\n\r\nWhere CAST(CONVERT(nvarchar,T0.[RefDate],23)AS nvarchar)>=@F_RefDate and CAST(CONVERT(nvarchar,T0.[RefDate],23)AS nvarchar)<=@T_RefDate AND T1.[Account]=@AcctCode\r\n\r\norder by T0.TransId ,t1.Line_ID\r\n\r\nEND\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindLibroDiario]\r\n\r\n@TransId int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT\r\n\r\nCAST(CONVERT(nvarchar,T1.[RefDate],103)AS nvarchar) AS 'RefDate',\r\nT1.LineMemo,\r\nT1.ShortName,\r\nT1.Account,\r\nAcctName=(CASE WHEN T2.AcctName IS NULL THEN t3.CardName else T2.AcctName end),\r\nT1.Debit, T1.Credit, T1.Debit-T1.Credit AS 'Saldo', T1.SYSDeb, T1.SYSCred, T1.SYSDeb-T1.SYSCred AS 'SaldoSYS', T1.FCDebit,T1.FCCredit, T1.FCDebit-T1.FCCredit AS 'FCSaldo', T1.FCCurrency\r\nfrom OJDT T0\r\ninner join JDT1 T1 on T0.TransId =T1.TransId\r\nleft outer Join OACT T2 ON T2.AcctCode=T1.ShortName\r\nleft outer join OCRD t3 on t3.CardCode=T1.ShortName\r\nWhere T1.[TransId]=@TransId\r\n\r\nORDER BY T1.TransId ,t1.Line_ID\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindAllItems]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT ItemCode,ItemName FROM OITM ORDER BY ItemCode \r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[CalculateBalanceItemE]\r\n\r\n@ItemCode nvarchar(50)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT SUM(TransValue) AS 'Value' FROM OINM WHERE ItemCode=@ItemCode AND Type='E';\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertOINM]\r\n\r\n@TransType int,\r\n@CreatedBy int,\r\n@BASE_REF nvarchar(11),\r\n@DocLineNum int,\r\n@DocDate datetime,\r\n@DocDueDate datetime, \r\n@TaxDate datetime,\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar(100),\r\n@Comments nvarchar(254),\r\n@JrnlMemo nvarchar(50),\r\n@ItemCode nvarchar(50),\r\n@Dscription nvarchar(100),\r\n@InQty numeric(19,6),\r\n@OutQty numeric(19,6),\r\n@Price numeric(19,6),\r\n@Currency nvarchar(3),\r\n@Rate numeric(19,6),\r\n@Type char(1),\r\n@UserSign smallint,\r\n@CalcPrice numeric(19,6),\r\n@OpenQty numeric(19,6),\r\n@CreateDate datetime,\r\n@CostMethod char(1),\r\n@TransValue numeric(19,6),\r\n@OpenValue numeric(19,6),\r\n@InvntAct nvarchar(15),\r\n@Balance numeric(19,6),\r\n@SysRate numeric(19,6)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO OINM (TransType,CreatedBy,BASE_REF,DocLineNum,DocDate,DocDueDate,TaxDate, CardCode, CardName, Comments,JrnlMemo, ItemCode, Dscription, InQty,OutQty,Price, Currency,Rate,Type, UserSign,CalcPrice, OpenQty, CreateDate, CostMethod, TransValue,OpenValue, InvntAct, Balance, SysRate) VALUES (@TransType,@CreatedBy,@BASE_REF,@DocLineNum,@DocDate,@DocDueDate,@TaxDate, @CardCode, @CardName, @Comments,@JrnlMemo, @ItemCode, @Dscription, @InQty,@OutQty,@Price, @Currency,@Rate,@Type, @UserSign,@CalcPrice, @OpenQty, @CreateDate, @CostMethod, @TransValue,@OpenValue, @InvntAct, @Balance, @SysRate)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindQuantityItem]\r\n\r\n@ItemCode nvarchar(50)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT (SUM(InQty)-SUM(OutQty)) AS 'Quantity' FROM OINM WHERE ItemCode=@ItemCode\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindFirstItemTransaccion]\r\n\r\n@ItemCode nvarchar(50)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSelect Top 1 \r\n*\r\nFrom\r\nOINM T0\r\nINNER JOIN\r\nOITM T1 on\r\nT0.Itemcode = T1.Itemcode\r\nWhere T0.Type ='E' AND \r\nT0.Openqty > 0  AND T0.ItemCode=@ItemCode\r\nOrder by\r\nT0.TransSeq \r\n\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateOINMRes]\r\n\r\n@TransSeq int,\r\n@Quantity decimal (19,6),\r\n@OpenValue decimal (19,6)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE OINM SET OpenQty=(OpenQty-@Quantity), OpenValue=(OpenValue-@OpenValue) WHERE TransSeq=@TransSeq\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateOINMSum]\r\n\r\n@TransSeq int,\r\n@Quantity decimal (19,6),\r\n@OpenValue decimal (19,6)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE OINM SET OpenQty=(OpenQty+@Quantity), OpenValue=(OpenValue+@OpenValue) WHERE TransSeq=@TransSeq\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindTaxAccountSales]\r\n\r\n@TaxCode nvarchar(8)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT SalesTax FROM OSTA WHERE Code=@TaxCode\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeleteSalesInvoice]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @CON INT\r\n\r\nSET @CON=@DocEntry\r\n\r\nSET @CON=@CON-1\r\n\r\nDELETE FROM OINV WHERE DocEntry=@DocEntry\r\n\r\nDBCC CHECKIDENT ('OINV', RESEED, @CON)\r\nDBCC CHECKIDENT ('OINV', RESEED, @CON)\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeletePurchaseInvoice]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @CON INT\r\n\r\nSET @CON=@DocEntry\r\n\r\nSET @CON=@CON-1\r\n\r\nDELETE FROM OPCH WHERE DocEntry=@DocEntry\r\n\r\nDBCC CHECKIDENT ('OPCH', RESEED, @CON)\r\nDBCC CHECKIDENT ('OPCH', RESEED, @CON)\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeletePurchaseCreditNote]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @CON INT\r\n\r\nSET @CON=@DocEntry\r\n\r\nSET @CON=@CON-1\r\n\r\nDELETE FROM ORPC WHERE DocEntry=@DocEntry\r\n\r\nDBCC CHECKIDENT ('ORPC', RESEED, @CON)\r\nDBCC CHECKIDENT ('ORPC', RESEED, @CON)\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeleteSalesCreditNote]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @CON INT\r\n\r\nSET @CON=@DocEntry\r\n\r\nSET @CON=@CON-1\r\n\r\nDELETE FROM OINV WHERE DocEntry=@DocEntry\r\n\r\nDBCC CHECKIDENT ('ORIN', RESEED, @CON)\r\nDBCC CHECKIDENT ('ORIN', RESEED, @CON)\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeleteSalesInvoiceLines]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDELETE FROM INV1 WHERE DocEntry=@DocEntry\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeletePurchaseInvoiceLines]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDELETE FROM PCH1 WHERE DocEntry=@DocEntry\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeletePurchaseCreditNoteLines]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDELETE FROM RPC1 WHERE DocEntry=@DocEntry\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeleteSalesCreditNoteLines]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDELETE FROM RIN1 WHERE DocEntry=@DocEntry\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeleteSalesInvoiceRetenciones]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDELETE FROM INV5 WHERE AbsEntry=@DocEntry\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeletePurchaseInvoiceRetenciones]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDELETE FROM PCH5 WHERE AbsEntry=@DocEntry\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeletePurchaseCreditNoteRetenciones]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDELETE FROM RPC5 WHERE AbsEntry=@DocEntry\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeleteSalesCreditNoteRetenciones]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDELETE FROM RIN5 WHERE AbsEntry=@DocEntry\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeleteJournalEntry]\r\n\r\n@TransId int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @CON INT\r\n\r\nSET @CON=@TransId-1\r\n\r\nDELETE FROM OJDT WHERE TransId=@TransId\r\n\r\nDBCC CHECKIDENT ('OJDT', RESEED, @CON)\r\nDBCC CHECKIDENT ('OJDT', RESEED, @CON)\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeleteJournalEntryLines]\r\n\r\n@TransId int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDELETE FROM JDT1 WHERE TransId=@TransId\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeleteOINM]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDELETE FROM OINM WHERE CreatedBy=@DocEntry\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeleteOldRecord]\r\n\r\n@TransSeq int,\r\n@TransType int, \r\n@CreatedBy int,\r\n@BASE_REF nvarchar(11),\r\n@DocLineNum int,\r\n@DocDate datetime, \r\n@DocDueDate datetime, \r\n@CardCode nvarchar(15),\r\n@CardName nvarchar(100),\r\n@Comments nvarchar(254),\r\n@JrnlMemo nvarchar(50),\r\n@ItemCode nvarchar(50),\r\n@Dscription nvarchar(100),\r\n@InQty numeric(19,6),\r\n@OutQty numeric(19,6),\r\n@Price numeric(19,6),\r\n@Currency nvarchar(3),\r\n@Rate numeric(19,6),\r\n@TaxDate datetime,\r\n@UserSign smallint,\r\n@CalcPrice numeric(19,6),\r\n@OpenQty numeric(19,6),\r\n@CreateDate datetime,\r\n@Balance numeric(19,6),\r\n@TransValue numeric(19,6),\r\n@InvntAct nvarchar(15),\r\n@OpenValue numeric(19,6),\r\n@CostMethod char(1),\r\n@Type char(1),\r\n@SysRate numeric(19,6)\r\n\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @CON INT\r\n\r\nSET @CON=@TransSeq-1\r\n\r\nDELETE FROM OINM WHERE TransSeq=@TransSeq\r\n\r\nDBCC CHECKIDENT ('OINM', RESEED, @CON)\r\nDBCC CHECKIDENT ('OINM', RESEED, @CON)\r\n\r\nINSERT INTO OINM (TransType,CreatedBy,BASE_REF,DocLineNum,DocDate,DocDueDate,CardCode,CardName, Comments,JrnlMemo,ItemCode,Dscription, InQty,OutQty,Price,Currency,Rate, TaxDate,UserSign,CalcPrice,OpenQty,CreateDate,Balance,TransValue, InvntAct,OpenValue,CostMethod,Type,SysRate) VALUES(@TransType,@CreatedBy,@BASE_REF,@DocLineNum,@DocDate,@DocDueDate,@CardCode,@CardName, @Comments,@JrnlMemo,@ItemCode,@Dscription, @InQty,@OutQty,@Price,@Currency,@Rate, @TaxDate,@UserSign,@CalcPrice,@OpenQty,@CreateDate,@Balance,@TransValue, @InvntAct,@OpenValue,@CostMethod,@Type,@SysRate)\r\n \r\nSET @CON=(SELECT COUNT(*) FROM OINM)\r\n\r\nDBCC CHECKIDENT ('OINM', RESEED, @CON)\r\nDBCC CHECKIDENT ('OINM', RESEED, @CON)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindSalesCostAct]\r\n\r\n@ItemCode nvarchar(50)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT SaleCostAc FROM OITM WHERE ItemCode=@ItemCode\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindStockAudit]\r\n\r\n@ItemCode nvarchar(50),\r\n@F_RefDate datetime,\r\n@T_RefDate datetime,\r\n@Ventas char(1),\r\n@Compras char(1)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Date datetime\r\n\r\nSET @Date=(SELECT TOP 1 CONVERT(nvarchar,DocDate,23)AS nvarchar FROM OINM Order BY DocDate)\r\n\r\nIF(@F_RefDate IS NULL)\r\nBEGIN\r\n\r\nIF(@Compras='Y' AND @Ventas='Y')\r\nBEGIN\r\nSELECT * FROM \r\n(\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[BASE_REF],\r\nT0.[CreatedBy],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\nT0.[TransValue] AS 'InValue',\r\n0 AS 'OutValue',\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n(SELECT SUM(LineTotal) FROM PCH1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'SaldoInicial',\r\n(SELECT SUM(Quantity*NumPerMsr) FROM PCH1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'CantidadInicial',\r\nT0.TransSeq\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN PCH1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@Date and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='18' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\nUNION\r\n\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[CreatedBy],\r\nT0.[BASE_REF],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\nT0.[TransValue] AS 'InValue',\r\n0 AS 'OutValue' ,\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n(SELECT SUM(LineTotal) FROM RIN1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'SaldoInicial',\r\n(SELECT SUM(Quantity*NumPerMsr) FROM RIN1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'CantidadInicial',\r\n\r\nT0.TransSeq\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN RIN1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@Date and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='14' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\nUNION\r\n\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[CreatedBy],\r\nT0.[BASE_REF],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\nT0.[TransValue] AS 'InValue',\r\n0 AS 'OutValue' ,\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n(SELECT SUM(LineTotal) FROM PDN1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'SaldoInicial',\r\n(SELECT SUM(Quantity*NumPerMsr) FROM PDN1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'CantidadInicial',\r\nT0.TransSeq\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN PDN1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@Date and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='20' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\nUNION\r\n\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[CreatedBy],\r\nT0.[BASE_REF],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\n0 AS 'InValue',\r\nT0.[TransValue] AS 'OutValue' ,\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n0 AS 'SaldoInicial',\r\n0 AS 'CantidadInicial',\r\nT0.TransSeq\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN INV1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@Date and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='13' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\nUNION\r\n\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[CreatedBy],\r\nT0.[BASE_REF],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\n0 AS 'InValue',\r\nT0.[TransValue] AS 'OutValue' ,\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n0 AS 'SaldoInicial',\r\n0 AS 'CantidadInicial',\r\nT0.TransSeq\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN RPC1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@Date and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='19' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\nUNION\r\n\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[CreatedBy],\r\nT0.[BASE_REF],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\n0 AS 'InValue',\r\nT0.[TransValue] AS 'OutValue' ,\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n0 AS 'SaldoInicial',\r\n0 AS 'CantidadInicial',\r\nT0.TransSeq\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN DLN1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@Date and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='15' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\n) t\r\n\r\nORDER BY t.DocDate, t.TransSeq\r\nEND\r\n\r\n\r\nELSE IF(@Compras='Y' AND @Ventas='N')\r\nBEGIN\r\nSELECT * FROM \r\n(\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[BASE_REF],\r\nT0.[CreatedBy],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\nT0.[TransValue]  AS 'InValue',\r\n0 AS 'OutValue' ,\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n(SELECT SUM(LineTotal) FROM PCH1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'SaldoInicial',\r\n(SELECT SUM(Quantity*NumPerMsr) FROM PCH1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'CantidadInicial',\r\nT0.TransSeq\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN PCH1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@Date and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='18' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\nUNION\r\n\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[CreatedBy],\r\nT0.[BASE_REF],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\nT0.[TransValue]  AS 'InValue',\r\n0 AS 'OutValue' ,\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n(SELECT SUM(LineTotal) FROM RIN1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'SaldoInicial',\r\n(SELECT SUM(Quantity*NumPerMsr) FROM RIN1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'CantidadInicial',\r\nT0.TransSeq\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN RIN1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@Date and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='14' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\nUNION\r\n\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[CreatedBy],\r\nT0.[BASE_REF],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\nT0.[TransValue]  AS 'InValue',\r\n0 AS 'OutValue' ,\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n(SELECT SUM(LineTotal) FROM PDN1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'SaldoInicial',\r\n(SELECT SUM(Quantity*NumPerMsr) FROM PDN1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'CantidadInicial',\r\nT0.TransSeq\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN PDN1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@Date and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='20' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\n\r\n) t\r\n\r\nORDER BY t.DocDate, t.TransSeq\r\nEND\r\n\r\nELSE IF(@Compras='N' AND @Ventas='Y')\r\nBEGIN\r\nSELECT * FROM \r\n(\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[CreatedBy],\r\nT0.[BASE_REF],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\n0 AS 'InValue',\r\nT0.[TransValue] AS 'OutValue' ,\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n0 AS 'SaldoInicial',\r\n0 AS 'CantidadInicial',\r\nT0.TransSeq\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN INV1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@Date and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='13' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\nUNION\r\n\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[CreatedBy],\r\nT0.[BASE_REF],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\n0 AS 'InValue',\r\nT0.[TransValue] AS 'OutValue' ,\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n0 AS 'SaldoInicial',\r\n0 AS 'CantidadInicial',\r\nT0.TransSeq\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN RPC1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@Date and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='19' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\nUNION\r\n\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[CreatedBy],\r\nT0.[BASE_REF],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\n0 AS 'InValue',\r\nT0.[TransValue] AS 'OutValue' ,\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n0 AS 'SaldoInicial',\r\n0 AS 'CantidadInicial',\r\nT0.TransSeq\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN DLN1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@Date and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='15' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\n) t\r\n\r\nORDER BY t.DocDate, t.TransSeq\r\n\r\nEND\r\nEND\r\nELSE\r\nBEGIN\r\n\r\nIF(@Compras='Y' AND @Ventas='Y')\r\nBEGIN\r\nSELECT * FROM \r\n(\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[CreatedBy],\r\nT0.[BASE_REF],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\nT0.[TransValue] AS 'InValue',\r\n0 AS 'OutValue' ,\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n(SELECT SUM(LineTotal) FROM PCH1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'SaldoInicial',\r\n(SELECT SUM(Quantity*NumPerMsr) FROM PCH1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'CantidadInicial',\r\nT0.TransSeq\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN PCH1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@F_RefDate and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='18' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\nUNION\r\n\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[CreatedBy],\r\nT0.[BASE_REF],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\nT0.[TransValue] AS 'InValue',\r\n0 AS 'OutValue' ,\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n(SELECT SUM(LineTotal) FROM RIN1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'SaldoInicial',\r\n(SELECT SUM(Quantity*NumPerMsr) FROM RIN1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'CantidadInicial',\r\nT0.TransSeq\r\n\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN RIN1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@F_RefDate and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='14' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\nUNION\r\n\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[CreatedBy],\r\nT0.[BASE_REF],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\nT0.[TransValue] AS 'InValue',\r\n0 AS 'OutValue' ,\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n(SELECT SUM(LineTotal) FROM PDN1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'SaldoInicial',\r\n(SELECT SUM(Quantity*NumPerMsr) FROM PDN1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'CantidadInicial',\r\nT0.TransSeq\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN PDN1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@F_RefDate and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='20' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\nUNION\r\n\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[CreatedBy],\r\nT0.[BASE_REF],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\n0 AS 'InValue',\r\nT0.[TransValue] AS 'OutValue' ,\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n0 AS 'SaldoInicial',\r\n0 AS 'CantidadInicial',\r\nT0.TransSeq\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN INV1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@F_RefDate and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='13' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\nUNION\r\n\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[CreatedBy],\r\nT0.[BASE_REF],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\n0 AS 'InValue',\r\nT0.[TransValue] AS 'OutValue' ,\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n0 AS 'SaldoInicial',\r\n0 AS 'CantidadInicial',\r\nT0.TransSeq\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN RPC1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@F_RefDate and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='19' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\nUNION\r\n\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[CreatedBy],\r\nT0.[BASE_REF],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\n0 AS 'InValue',\r\nT0.[TransValue] AS 'OutValue' ,\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n0 AS 'SaldoInicial',\r\n0 AS 'CantidadInicial',\r\nT0.TransSeq\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN DLN1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@F_RefDate and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='15' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\n) t\r\n\r\nORDER BY t.DocDate, t.TransSeq\r\nEND\r\n\r\nELSE IF(@Compras='Y' AND @Ventas='N')\r\nBEGIN\r\nSELECT * FROM \r\n(\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[CreatedBy],\r\nT0.[BASE_REF],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\nT0.[TransValue] AS 'InValue',\r\n0 AS 'OutValue' ,\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n(SELECT SUM(LineTotal) FROM PCH1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'SaldoInicial',\r\n(SELECT SUM(Quantity*NumPerMsr) FROM PCH1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'CantidadInicial',\r\nT0.TransSeq\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN PCH1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@F_RefDate and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='18' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\nUNION\r\n\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[CreatedBy],\r\nT0.[BASE_REF],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\nT0.[TransValue] AS 'InValue',\r\n0 AS 'OutValue' ,\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n(SELECT SUM(LineTotal) FROM RIN1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'SaldoInicial',\r\n(SELECT SUM(Quantity*NumPerMsr) FROM RIN1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'CantidadInicial',\r\nT0.TransSeq\r\n\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN RIN1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@F_RefDate and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='14' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\nUNION\r\n\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[CreatedBy],\r\nT0.[BASE_REF],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\nT0.[TransValue] AS 'InValue',\r\n0 AS 'OutValue' ,\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n(SELECT SUM(LineTotal) FROM PDN1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'SaldoInicial',\r\n(SELECT SUM(Quantity*NumPerMsr) FROM PDN1 WHERE ItemCode=@ItemCode AND StartValue='Y') AS 'CantidadInicial',\r\nT0.TransSeq\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN PDN1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@F_RefDate and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='20' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\n) t\r\n\r\nORDER BY t.DocDate, t.TransSeq\r\nEND\r\n\r\nELSE IF(@Compras='N' AND @Ventas='Y')\r\nBEGIN\r\nSELECT * FROM \r\n(\r\n\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[CreatedBy],\r\nT0.[BASE_REF],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\n0 AS 'InValue',\r\nT0.[TransValue] AS 'OutValue' ,\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n0 AS 'SaldoInicial',\r\n0 AS 'CantidadInicial',\r\nT0.TransSeq\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN INV1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@F_RefDate and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='13' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\nUNION\r\n\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[CreatedBy],\r\nT0.[BASE_REF],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\n0 AS 'InValue',\r\nT0.[TransValue] AS 'OutValue' ,\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n0 AS 'SaldoInicial',\r\n0 AS 'CantidadInicial',\r\nT0.TransSeq\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN RPC1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@F_RefDate and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='19' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\nUNION\r\n\r\nSELECT \r\nT0.[ItemCode],\r\nT0.[Dscription],\r\nCAST(CONVERT(nvarchar,T0.[DocDate],103)AS nvarchar) AS 'DocDate',\r\nT0.[CreatedBy],\r\nT0.[BASE_REF],\r\nT0.[TransType],\r\n(T0.[InQty]-T0.[OutQty]) 'Quantity',\r\nT0.[InQty],\r\nT0.[OutQty],\r\nT0.[TransValue],\r\n0 AS 'InValue',\r\nT0.[TransValue] AS 'OutValue',\r\nT0.[CalcPrice],\r\nT0.[Balance],\r\nT1.[InvntryUomCode],\r\nT1.[InvntryUomEntry],\r\nT1.UgpEntry,\r\nT2.UomCode,\r\nT2.UomCode2,\r\n0 AS 'SaldoInicial',\r\n0 AS 'CantidadInicial',\r\nT0.TransSeq\r\nFROM OINM T0 \r\nINNER JOIN OITM T1 ON T0.[ItemCode] = T1.[ItemCode] \r\nINNER JOIN DLN1 T2 ON T2.ObjType=T0.TransType AND T0.CreatedBy=T2.DocEntry\r\nWHERE CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)>=@F_RefDate and CAST(CONVERT(nvarchar,T0.[DocDate],23)AS nvarchar)<=@T_RefDate AND T0.[ItemCode]=@ItemCode AND T2.ObjType='15' AND (T2.StartValue IS NULL OR T2.StartValue='Y')\r\n\r\n) t\r\n\r\nORDER BY t.DocDate, t.TransSeq\r\nEND\r\n\r\nEND\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertLogo]\r\n\r\n@imgByte image,\r\n@Name nvarchar(max)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE OADM SET Name=@Name,Image=@imgByte \r\n\r\nEND\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[BindImage]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 Name,Image FROM OADM \r\n\r\nEND\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[O_IDA5] \r\n(\t\r\n)\r\nRETURNS TABLE \r\n\r\n\r\nAS\r\nRETURN \r\n(\r\n\r\n\t\t\tSELECT  * FROM PCH5 K2 (NOLOCK) --WHERE K2.DocEntry=@DocEntry AND ObjType=@ObjType \r\n\t\t\t\tUNION ALL\r\n\t\t\tSELECT  * FROM RPC5 K2 (NOLOCK) --WHERE K2.DocEntry=@DocEntry AND ObjType=@ObjType\r\n)\r\nGO\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[IDA_ImpuestoNoDeducible]\r\n(\r\n\t@ObjType AS VARCHAR(20),\r\n    @DocEntry AS BIGINT,\r\n    @TaxCode AS VARCHAR(20),\r\n    @Type AS VARCHAR(1)\r\n)\r\nRETURNS DECIMAL(19,6)\r\n\r\nAS\r\nBEGIN\r\n\t-- Declare the return variable here\r\n\tDECLARE @ResultVar AS DECIMAL(19,6)\r\n\r\n\r\nIF (@Type='C')\r\nBEGIN\r\n\tSELECT @ResultVar=ISNULL(SUM(K2.X),0)\r\n\tFROM \r\n\t(\r\n\t\tSELECT  VatSum AS 'X' FROM \r\n\t\t(\r\n\t\t\tSELECT DocEntry, ObjType,      VatSum FROM PCH1 K1 (NOLOCK) WHERE  K1.DocEntry=@DocEntry AND ObjType=@ObjType  AND VatGroup=@TaxCode\r\n\t\t\t\tUNION ALL\r\n\t\t\tSELECT DocEntry, ObjType, (-1)*VatSum FROM RPC1 K1 (NOLOCK) WHERE  K1.DocEntry=@DocEntry AND ObjType=@ObjType  AND VatGroup=@TaxCode\r\n\t\t\t\tUNION ALL\r\n\t\t\tSELECT DocEntry, ObjType,      VatSum FROM PCH3 K1 (NOLOCK) WHERE  K1.DocEntry=@DocEntry AND ObjType=@ObjType  AND VatGroup=@TaxCode\r\n\t\t\t\tUNION ALL\r\n\t\t\tSELECT DocEntry, ObjType, (-1)* VatSum FROM RPC3 K1 (NOLOCK) WHERE  K1.DocEntry=@DocEntry AND ObjType=@ObjType AND VatGroup=@TaxCode\r\n\t\r\n\t\t) K1\r\n\t\t,\r\n\t\t\r\n\t\t(\r\n\t\t\tSELECT DocEntry, ObjType  FROM OPCH K2 (NOLOCK) WHERE K2.DocEntry=@DocEntry AND ObjType=@ObjType \r\n\t\t\t\tUNION ALL\r\n\t\t\tSELECT  DocEntry, ObjType  FROM ORPC K2 (NOLOCK) WHERE K2.DocEntry=@DocEntry AND ObjType=@ObjType\r\n\t\t) K2\r\n\t\t\r\n\t\tWHERE\r\n\t\tK1.DocEntry=K2.DocEntry AND K1.ObjType=K2.ObjType\r\n\t) K2\r\n\r\nEND\r\n\r\n\tELSE\r\n\t\tBEGIN\r\n\t\tSELECT @ResultVar=ISNULL(SUM(K2.X),0)\r\n\t\t\t\tFROM \r\n\t\t(\r\n\t\tSELECT  VatSum AS 'X' FROM \r\n\t\t(\r\n\t\t\tSELECT DocEntry, ObjType,      VatSum FROM INV1 K1 (NOLOCK) WHERE  K1.DocEntry=@DocEntry AND ObjType=@ObjType AND  VatGroup=@TaxCode\r\n\t\t\t\tUNION ALL\r\n\t\t\tSELECT DocEntry, ObjType, (-1)*VatSum FROM RIN1 K1 (NOLOCK) WHERE  K1.DocEntry=@DocEntry AND ObjType=@ObjType AND VatGroup=@TaxCode\r\n\t\t\t\tUNION ALL\r\n\t\t\tSELECT DocEntry, ObjType,      VatSum FROM INV3 K1 (NOLOCK) WHERE  K1.DocEntry=@DocEntry AND ObjType=@ObjType AND VatGroup=@TaxCode\r\n\t\t\t\tUNION ALL\r\n\t\t\tSELECT DocEntry, ObjType, (-1)* VatSum FROM RIN3 K1 (NOLOCK) WHERE  K1.DocEntry=@DocEntry AND ObjType=@ObjType AND VatGroup=@TaxCode\r\n\t\r\n\t\t) K1\r\n\t\t,\r\n\t\t\r\n\t\t(\r\n\t\t\tSELECT DocEntry, ObjType FROM OINV K2 (NOLOCK) WHERE K2.DocEntry=@DocEntry AND ObjType=@ObjType \r\n\t\t\t\tUNION ALL\r\n\t\t\tSELECT  DocEntry, ObjType FROM ORIN K2 (NOLOCK) WHERE K2.DocEntry=@DocEntry AND ObjType=@ObjType\r\n\t\t) K2\r\n\t\t\r\n\t\tWHERE\r\n\t\tK1.DocEntry=K2.DocEntry AND K1.ObjType=K2.ObjType\r\n\t) K2\r\n\t\tEND\r\n\r\n\r\n\r\n\r\n\r\n\t-- Return the result of the function\r\n\tRETURN @ResultVar\r\n\r\nEND\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[O_IDA] \r\n(\t\r\n  @Periodo AS VARCHAR(10)\r\n)\r\n\r\nRETURNS TABLE\r\nWITH ENCRYPTION \r\nAS\r\nRETURN \r\n(\r\n\r\n\t\t\tSELECT \r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE1',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE1',\r\n\r\n\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE2',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE2',\r\n\r\n\r\n\t\t\t\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GASTO') -- Rate=12  )-- U_IDA_Alicuota='GASTO') \r\n AS 'AlicuotaGasto'\r\n\t\t\t,\r\n\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GASTO') -- Rate=12  )-- U_IDA_Alicuota='GASTO') \r\n AS 'CodigoAlicuotaGasto'\r\n\t\t\t,\r\n\t\t\t\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GENERAL') -- Rate=12  )-- U_IDA_Alicuota='GENERAL') \r\n AS 'AlicuotaGeneral'\r\n\t\t\t,\r\n\t\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GENERAL') -- Rate=12  )-- U_IDA_Alicuota='GENERAL') \r\n AS 'CodigoAlicuotaGeneral'\r\n\t\t\t,\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='REDUCIDA')-- Rate = 8 )--U_IDA_Alicuota='REDUCIDA') \r\n AS 'AlicuotaReducida'\r\n\t\t\t,\r\n\t\t\t\r\n\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='REDUCIDA')-- Rate = 8 )--U_IDA_Alicuota='REDUCIDA') \r\n AS 'CodigoAlicuotaReducida'\r\n\t\t\t,\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='ADICIONAL')--Rate=20 )--U_IDA_Alicuota='ADICIONAL') \r\n AS 'AlicuotaAdicional'\r\n\t\t\t,\r\n\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='ADICIONAL')--Rate=20 )--U_IDA_Alicuota='ADICIONAL') \r\n AS 'CodigoAlicuotaAdicional'\r\n\t\t\t,\r\n\t\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='EXENTO')--Rate=20 )--U_IDA_Alicuota='ADICIONAL') \r\n AS 'CodigoAlicuotaExento'\r\n\t\t\t,\r\n\t\t\tH2.U_IDA_TipoPersona AS 'TipoPersona',\r\n\t\t\tISNULL(CASE WHEN DocSubType='--' THEN NumAtCard END,'') AS 'NF', \r\n\t\t\tISNULL(CASE WHEN DocSubType<>'--' THEN NumAtCard END,'') AS 'ND', \r\n\t\t\t'' AS 'NC',\r\n\t\t\t'' AS 'FAFE',ISNULL(K2.U_IDA_Serie,'') + ISNULL(K2.U_IDA_NumControl,'') AS 'NroControl',K2.U_IDA_TipoTrans AS 'TipoTran',\r\n\t\t\tISNULL(K2.U_IDA_CompIVA,'') AS 'NroComprobante',ISNULL(K2.DocDate,'') AS 'FechaComp' ,\r\n\t\t\tISNULL(K2.U_IDA_NumImport,'') AS 'NroImportacion', ISNULL(K2.U_IDA_NumFile,'') AS 'ExpedienteImp',\r\n\t\t\tISNULL(U_IDA_RetenTercero,'N') AS 'RetencionTercero',\r\n\t\t\tISNULL(U_IDA_Tercero,'') AS 'Tercero',\r\n\t\t\tISNULL(U_IDA_TipoRet,'') AS 'TipoRet',\r\n\t\t\tISNULL(U_IDA_IsPlanilla,'') AS 'IsPlanilla',\r\n\t\t\tK2.[DocEntry]\r\n      ,K2.[DocNum]\r\n      ,K2.[Max1099]\r\n      ,K2.[DocType]\r\n      ,K2.[CANCELED]\r\n      ,K2.[DocStatus]\r\n      ,K2.[InvntSttus]\r\n      ,K2.[DocDate]\r\n      ,K2.[DocDueDate]\r\n      ,K2.[CardCode]\r\n      ,K2.[CardName]\r\n      ,K2.[Address]\r\n      ,K2.[Address2]\r\n      ,K2.[ObjType]\r\n      ,K2.[NumAtCard]\r\n      ,K2.[VatSum]\r\n      ,K2.[VatSumFC]\r\n      ,K2.[DocCur]\r\n      ,K2.[DocTotal]\r\n      ,K2.[DocTotalFC]\r\n      ,K2.[PaidToDate]\r\n      ,K2.[PaidFC]\r\n      ,K2.[Ref1]\r\n      ,K2.[Comments]\r\n      ,K2.[JrnlMemo]\r\n      ,K2.[TransId]\r\n      ,K2.[DocRate]\r\n      ,K2.[SysRate]\r\n      ,K2.[VatSumSy]\r\n      ,K2.[DocTotalSy]\r\n      ,K2.[PaidSys]\r\n      ,K2.[UpdateDate]\r\n      ,K2.[CreateDate]\r\n      ,K2.[TaxDate]\r\n      ,K2.[FinncPriod]\r\n      ,K2.[UserSign]\r\n      ,K2.[VatPaid]\r\n      ,K2.[VatPaidFC]\r\n      ,K2.[VatPaidSys]\r\n      ,K2.[UserSign2]\r\n      ,K2.[LicTradNum]\r\n      ,K2.[WTSum]\r\n      ,K2.[WTSumFC]\r\n      ,K2.[WTSumSC]\r\n      ,K2.[WTApplied]\r\n      ,K2.[WTAppliedF]\r\n      ,K2.[WTAppliedS]\r\n      ,K2.[CtlAccount]\r\n      ,K2.[BaseVtAt]\r\n      ,K2.[BaseVtAtSC]\r\n      ,K2.[BaseVtAtFC]\r\n      ,K2.[NnSbVAt]\r\n      ,K2.[NnSbVAtSC]\r\n      ,K2.[NbSbVAtFC]\r\n      ,K2.[PaidSum]\r\n      ,K2.[PaidSumFc]\r\n      ,K2.[PaidSumSc]\r\n      ,K2.[NnSbAmnt]\r\n      ,K2.[NnSbAmntSC]\r\n      ,K2.[NbSbAmntFC]\r\n      ,K2.[BaseAmnt]\r\n      ,K2.[BaseAmntSC]\r\n      ,K2.[BaseAmntFC]\r\n      ,K2.[U_IDA_NumControl]\r\n      ,K2.[U_IDA_TipoTrans]\r\n      ,K2.[U_IDA_CompIVA]\r\n      ,K2.[U_IDA_FechaComp]\r\n      ,K2.[U_IDA_FechaContComp]\r\n      ,K2.[U_IDA_MontoCompIVA]\r\n      ,K2.[U_IDA_RetenTercero]\r\n      ,K2.[U_IDA_TipoRet]\r\n      ,K2.[U_IDA_Tercero]\r\n      ,K2.[U_IDA_CompISLR]\r\n      ,K2.[U_IDA_DateCompISLR]\r\n      ,K2.[U_IDA_DateContISLR]\r\n      ,K2.[U_IDA_CodSerie]\r\n      ,K2.[U_IDA_Serie]\r\n      ,K2.[U_IDA_Fafe]\r\n      ,K2.[U_IDA_NumExport]\r\n      ,K2.[U_IDA_TipoDoc]\r\n      ,K2.[U_IDA_NumFile]\r\n      ,K2.[U_IDA_NumImport]\r\n      ,K2.[U_IDA_MontoFafe]\r\n      ,K2.[U_IDA_FechaFafe]\r\n      ,K2.[U_IDA_IsPlanilla]\r\n      ,K2.[U_IDA_PagoElectronic]\r\n      ,K2.[U_IDA_Alicuota]\r\n      ,K2.[U_IDA_CompMunicipal]\r\n      ,K2.[U_IDA_DateCompMun]\r\n      ,K2.[U_IDA_CorteZ]\r\n      ,K2.[U_IDA_SerialImpre]\r\n      ,K2.[U_IDA_DocAnulado]\r\n      ,K2.[DocSubType]\r\n      ,K2.[DiscPrcnt]\r\n      ,K2.[DiscSum]\r\n      ,K2.[DiscSumFC]\r\n      ,K2.[DiscSumSy]\r\n      ,K2.[DocTime] FROM OPCH K2 (NOLOCK) ,OFPR H1 (NOLOCK)  , OCRD H2 (NOLOCK)  WHERE H1.Name=@Periodo\r\n\t\t\tAND  K2.DocDate >= H1.F_RefDate AND K2.DocDate <= H1.T_RefDate \r\n\t\t\tAND K2.CardCode=H2.CardCode AND H2.U_IDA_TipoPersona<>'PJND' AND  H2.U_IDA_TipoPersona<>'PNNR' AND K2.U_IDA_TipoTrans<>'05'\r\n\t\t\t --, [@BKV_RECEIPT] K3 WHERE K2.DocEntry= --K2.DocEntry=@DocEntry AND ObjType=@ObjType \r\n\t\t\t\t\r\n\t\t\t\tUNION ALL\r\n\t\t\t\t\r\n\t\t\tSELECT\t\t\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE1',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE1',\r\n\r\n\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE2',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE2',\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GASTO') -- Rate=12  )-- U_IDA_Alicuota='GASTO') \r\n AS 'AlicuotaGasto'\r\n\t\t\t,\r\n\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GASTO') -- Rate=12  )-- U_IDA_Alicuota='GASTO') \r\n AS 'CodigoAlicuotaGasto'\r\n\t\t\t,\r\n\t\t\t\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GENERAL') -- Rate=12  )-- U_IDA_Alicuota='GENERAL') \r\n AS 'AlicuotaGeneral'\r\n\t\t\t,\r\n\t\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GENERAL') -- Rate=12  )-- U_IDA_Alicuota='GENERAL') \r\n AS 'CodigoAlicuotaGeneral'\r\n\t\t\t,\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='REDUCIDA')-- Rate = 8 )--U_IDA_Alicuota='REDUCIDA') \r\n AS 'AlicuotaReducida'\r\n\t\t\t,\r\n\t\t\t\r\n\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='REDUCIDA')-- Rate = 8 )--U_IDA_Alicuota='REDUCIDA') \r\n AS 'CodigoAlicuotaReducida'\r\n\t\t\t,\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='ADICIONAL')--Rate=20 )--U_IDA_Alicuota='ADICIONAL') \r\n AS 'AlicuotaAdicional'\r\n\t\t\t,\r\n\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='ADICIONAL')--Rate=20 )--U_IDA_Alicuota='ADICIONAL') \r\n AS 'CodigoAlicuotaAdicional'\r\n\t\t\t,\r\n\t\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='EXENTO')--Rate=20 )--U_IDA_Alicuota='ADICIONAL') \r\n AS 'CodigoAlicuotaExento'\r\n\t\t\t,\r\n\t\t\tH2.U_IDA_TipoPersona AS 'TipoPersona',\r\n\t\t\t'' AS 'NF', '' AS 'ND',  NumAtCard AS 'NC',K2.U_IDA_Fafe AS 'FAFE',\r\n\t\t\tISNULL(K2.U_IDA_Serie,'') + ISNULL(K2.U_IDA_NumControl,'') AS 'NroControl', U_IDA_TipoTrans  AS 'TipoTran', \r\n\t\t\tISNULL(K2.U_IDA_CompIVA,'') AS 'NroComprobante',ISNULL(K2.DocDate,'') \r\n\t\t\tAS 'FechaComp' ,\r\n\t\t\tISNULL(K2.U_IDA_NumImport,'') AS 'NroImportacion', ISNULL(K2.U_IDA_NumFile,'') AS 'ExpedienteImp',\r\n\t\t\tISNULL(U_IDA_RetenTercero,'N') AS 'RetencionTercero',\r\n\t\t\tISNULL(U_IDA_Tercero,'') AS 'Tercero',\r\n\t\t\tISNULL(U_IDA_TipoRet,'') AS 'TipoRet',\r\n\t\t\tISNULL(U_IDA_IsPlanilla,'') AS 'IsPlanilla',\r\n\t\t\tK2.[DocEntry]\r\n      ,K2.[DocNum]\r\n      ,K2.[Max1099]\r\n      ,K2.[DocType]\r\n      ,K2.[CANCELED]\r\n      ,K2.[DocStatus]\r\n      ,K2.[InvntSttus]\r\n      ,K2.[DocDate]\r\n      ,K2.[DocDueDate]\r\n      ,K2.[CardCode]\r\n      ,K2.[CardName]\r\n      ,K2.[Address]\r\n      ,K2.[Address2]\r\n      ,K2.[ObjType]\r\n      ,K2.[NumAtCard]\r\n      ,K2.[VatSum]\r\n      ,K2.[VatSumFC]\r\n      ,K2.[DocCur]\r\n      ,K2.[DocTotal]\r\n      ,K2.[DocTotalFC]\r\n      ,K2.[PaidToDate]\r\n      ,K2.[PaidFC]\r\n      ,K2.[Ref1]\r\n      ,K2.[Comments]\r\n      ,K2.[JrnlMemo]\r\n      ,K2.[TransId]\r\n      ,K2.[DocRate]\r\n      ,K2.[SysRate]\r\n      ,K2.[VatSumSy]\r\n      ,K2.[DocTotalSy]\r\n      ,K2.[PaidSys]\r\n      ,K2.[UpdateDate]\r\n      ,K2.[CreateDate]\r\n      ,K2.[TaxDate]\r\n      ,K2.[FinncPriod]\r\n      ,K2.[UserSign]\r\n      ,K2.[VatPaid]\r\n      ,K2.[VatPaidFC]\r\n      ,K2.[VatPaidSys]\r\n      ,K2.[UserSign2]\r\n      ,K2.[LicTradNum]\r\n      ,K2.[WTSum]\r\n      ,K2.[WTSumFC]\r\n      ,K2.[WTSumSC]\r\n      ,K2.[WTApplied]\r\n      ,K2.[WTAppliedF]\r\n      ,K2.[WTAppliedS]\r\n      ,K2.[CtlAccount]\r\n      ,K2.[BaseVtAt]\r\n      ,K2.[BaseVtAtSC]\r\n      ,K2.[BaseVtAtFC]\r\n      ,K2.[NnSbVAt]\r\n      ,K2.[NnSbVAtSC]\r\n      ,K2.[NbSbVAtFC]\r\n      ,K2.[PaidSum]\r\n      ,K2.[PaidSumFc]\r\n      ,K2.[PaidSumSc]\r\n      ,K2.[NnSbAmnt]\r\n      ,K2.[NnSbAmntSC]\r\n      ,K2.[NbSbAmntFC]\r\n      ,K2.[BaseAmnt]\r\n      ,K2.[BaseAmntSC]\r\n      ,K2.[BaseAmntFC]\r\n      ,K2.[U_IDA_NumControl]\r\n      ,K2.[U_IDA_TipoTrans]\r\n      ,K2.[U_IDA_CompIVA]\r\n      ,K2.[U_IDA_FechaComp]\r\n      ,K2.[U_IDA_FechaContComp]\r\n      ,K2.[U_IDA_MontoCompIVA]\r\n      ,K2.[U_IDA_RetenTercero]\r\n      ,K2.[U_IDA_TipoRet]\r\n      ,K2.[U_IDA_Tercero]\r\n      ,K2.[U_IDA_CompISLR]\r\n      ,K2.[U_IDA_DateCompISLR]\r\n      ,K2.[U_IDA_DateContISLR]\r\n      ,K2.[U_IDA_CodSerie]\r\n      ,K2.[U_IDA_Serie]\r\n      ,K2.[U_IDA_Fafe]\r\n      ,K2.[U_IDA_NumExport]\r\n      ,K2.[U_IDA_TipoDoc]\r\n      ,K2.[U_IDA_NumFile]\r\n      ,K2.[U_IDA_NumImport]\r\n      ,K2.[U_IDA_MontoFafe]\r\n      ,K2.[U_IDA_FechaFafe]\r\n      ,K2.[U_IDA_IsPlanilla]\r\n      ,K2.[U_IDA_PagoElectronic]\r\n      ,K2.[U_IDA_Alicuota]\r\n      ,K2.[U_IDA_CompMunicipal]\r\n      ,K2.[U_IDA_DateCompMun]\r\n      ,K2.[U_IDA_CorteZ]\r\n      ,K2.[U_IDA_SerialImpre]\r\n      ,K2.[U_IDA_DocAnulado]\r\n      ,K2.[DocSubType]\r\n      ,K2.[DiscPrcnt]\r\n      ,K2.[DiscSum]\r\n      ,K2.[DiscSumFC]\r\n      ,K2.[DiscSumSy]\r\n      ,K2.[DocTime] FROM ORPC K2 (NOLOCK),OFPR H1 (NOLOCK) , OCRD H2 (NOLOCK) WHERE H1.Name=@Periodo \r\n\t\t\tAND K2.DocDate >= H1.F_RefDate AND K2.DocDate <= H1.T_RefDate AND K2.CardCode=H2.CardCode AND H2.U_IDA_TipoPersona<>'PJND' AND  H2.U_IDA_TipoPersona<>'PNNR'\r\n\t\t\tAND K2.U_IDA_TipoTrans<>'05' --WHERE H1.Name=@Periodo\r\n\t\t\t--WHERE K2.DocEntry=@DocEntry AND ObjType=@ObjType\r\n\r\n\r\n)\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[IDA_BaseImponible]\r\n(\r\n\t@ObjType AS VARCHAR(20),\r\n    @DocEntry AS BIGINT,\r\n    @VatPrcnt AS FLOAT,\r\n    @TaxCode AS VARCHAR(20),\r\n    @Type AS VARCHAR(1)\r\n)\r\nRETURNS DECIMAL(19,6)\r\nWITH ENCRYPTION\r\nAS\r\nBEGIN\r\n\t-- Declare the return variable here\r\n\tDECLARE @ResultVar AS DECIMAL(19,6)\r\n\r\n\r\nIF (@Type='C')\r\nBEGIN\r\n\tSELECT @ResultVar=ISNULL(SUM(K2.X),0)\r\n\tFROM \r\n\t(\r\n\t\tSELECT  LineTotal  - (LineTotal * (ISNULL(K2.DiscPrcnt,0))/100) AS 'X' FROM \r\n\t\t(\r\n\t\t\tSELECT DocEntry, ObjType,      LineTotal FROM PCH1 K1 (NOLOCK) WHERE  K1.DocEntry=@DocEntry AND ObjType=@ObjType AND VatPrcnt=@VatPrcnt AND VatGroup=@TaxCode\r\n\t\t\t\tUNION ALL\r\n\t\t\tSELECT DocEntry, ObjType, (-1)*LineTotal FROM RPC1 K1 (NOLOCK) WHERE  K1.DocEntry=@DocEntry AND ObjType=@ObjType AND VatPrcnt=@VatPrcnt AND VatGroup=@TaxCode\r\n\t\t\t\tUNION ALL\r\n\t\t\tSELECT DocEntry, ObjType,      LineTotal FROM PCH3 K1 (NOLOCK) WHERE  K1.DocEntry=@DocEntry AND ObjType=@ObjType AND VatPrcnt=@VatPrcnt AND VatGroup=@TaxCode\r\n\t\t\t\tUNION ALL\r\n\t\t\tSELECT DocEntry, ObjType, (-1)* LineTotal FROM RPC3 K1 (NOLOCK) WHERE  K1.DocEntry=@DocEntry AND ObjType=@ObjType AND VatPrcnt=@VatPrcnt AND VatGroup=@TaxCode\r\n\t\r\n\t\t) K1\r\n\t\t,\r\n\t\t\r\n\t\t(\r\n\t\t\tSELECT DocEntry, ObjType , K2.DiscPrcnt FROM OPCH K2 (NOLOCK) WHERE K2.DocEntry=@DocEntry AND ObjType=@ObjType \r\n\t\t\t\tUNION ALL\r\n\t\t\tSELECT  DocEntry, ObjType , K2.DiscPrcnt FROM ORPC K2 (NOLOCK) WHERE K2.DocEntry=@DocEntry AND ObjType=@ObjType\r\n\t\t) K2\r\n\t\t\r\n\t\tWHERE\r\n\t\tK1.DocEntry=K2.DocEntry AND K1.ObjType=K2.ObjType\r\n\t) K2\r\n\r\nEND\r\n\r\n\tELSE\r\n\t\tBEGIN\r\n\t\tSELECT @ResultVar=ISNULL(SUM(K2.X),0)\r\n\t\t\t\tFROM \r\n\t\t(\r\n\t\tSELECT  LineTotal - (LineTotal * (ISNULL(K2.DiscPrcnt,0))/100) AS 'X' FROM \r\n\t\t(\r\n\t\t\tSELECT DocEntry, ObjType,      LineTotal FROM INV1 K1 (NOLOCK) WHERE  K1.DocEntry=@DocEntry AND ObjType=@ObjType AND VatPrcnt=@VatPrcnt AND VatGroup=@TaxCode\r\n\t\t\t\tUNION ALL\r\n\t\t\tSELECT DocEntry, ObjType, (-1)*LineTotal FROM RIN1 K1 (NOLOCK) WHERE  K1.DocEntry=@DocEntry AND ObjType=@ObjType AND VatPrcnt=@VatPrcnt AND VatGroup=@TaxCode\r\n\t\t\t\tUNION ALL\r\n\t\t\tSELECT DocEntry, ObjType,      LineTotal FROM INV3 K1 (NOLOCK) WHERE  K1.DocEntry=@DocEntry AND ObjType=@ObjType AND VatPrcnt=@VatPrcnt AND VatGroup=@TaxCode\r\n\t\t\t\tUNION ALL\r\n\t\t\tSELECT DocEntry, ObjType, (-1)* LineTotal FROM RIN3 K1 (NOLOCK) WHERE  K1.DocEntry=@DocEntry AND ObjType=@ObjType AND VatPrcnt=@VatPrcnt AND VatGroup=@TaxCode\r\n\t\r\n\t\t) K1\r\n\t\t,\r\n\t\t\r\n\t\t(\r\n\t\t\tSELECT DocEntry, ObjType, K2.DiscPrcnt FROM OINV K2 (NOLOCK) WHERE K2.DocEntry=@DocEntry AND ObjType=@ObjType \r\n\t\t\t\tUNION ALL\r\n\t\t\tSELECT  DocEntry, ObjType, K2.DiscPrcnt FROM ORIN K2 (NOLOCK) WHERE K2.DocEntry=@DocEntry AND ObjType=@ObjType\r\n\t\t) K2\r\n\t\t\r\n\t\tWHERE\r\n\t\tK1.DocEntry=K2.DocEntry AND K1.ObjType=K2.ObjType\r\n\t) K2\r\n\t\tEND\r\n\r\n\r\n\r\n\r\n\r\n\t-- Return the result of the function\r\n\tRETURN @ResultVar\r\n\r\nEND\r\nGO\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[IDA_LIBRO_COMPRAS]\r\n(\t\r\n    @Periodo AS VARCHAR(100)\r\n)\r\nRETURNS TABLE \r\n\r\n\r\nAS\r\nRETURN \r\n(\r\nSELECT  \r\nT0.ObjType,\r\nT0.DocEntry AS 'DocEntry',\r\nT5.CompnyName as 'Agente', \r\nT5.TaxIdNum AS 'RIF Agente',\r\nT5.CompnyAddr AS 'Direccion Agente',\r\nT0.TaxDate  AS 'Fecha',\r\nISNULL(T0.FAFE,'') as 'Nro. de Factura Afectada',\r\n--T0.CardName  as 'Nombre o Razon Social'\r\nCASE WHEN T0.RetencionTercero='Y' THEN CASE WHEN T0.TipoRet='IVA' THEN T0.Tercero  WHEN T0.TipoRet='Todas' THEN T0.Tercero ELSE T0.CardName END ELSE T0.CardName END \r\nas 'Nombre o Razon Social',\r\nCASE WHEN T0.LicTradNum='J-999999999' THEN 'ND' ELSE (CASE WHEN T0.RetencionTercero='Y' THEN CASE WHEN T0.TipoRet='IVA' THEN (SELECT TOP 1 LicTradNum FROM OCRD WHERE CardName=T0.Tercero AND CardType = 'S') WHEN T0.TipoRet='Todas' THEN (SELECT TOP 1 LicTradNum FROM OCRD WHERE CardName=T0.Tercero AND CardType = 'S') ELSE T0.LicTradNum  END  ELSE T0.LicTradNum  END) END as 'RIF',\r\n\r\n--CASE WHEN T0.LicTradNum='J-999999999' THEN 'ND' ELSE T0.LicTradNum END as 'RIF',\r\n CASE \r\n                                WHEN T0.TipoTran='01' THEN '01-Reg' \r\n                                WHEN T0.TipoTran='02' THEN '02-Comp'\r\n                                WHEN T0.TipoTran='03' THEN '03-Anu' \r\n                                WHEN T0.TipoTran='04' THEN '04-Aju'\r\n                                END AS 'Tipo Transaccion',\r\nT0.NroComprobante AS 'Nro. Comprobante de IVA',\r\ncase T0.NroComprobante when '' then null else T0.FechaComp end AS 'Fecha Comprobante',\r\nT0.NroImportacion AS 'Planilla de importacion',\r\nT0.ExpedienteImp AS 'Expediente de importacion',\r\nT0.NF AS 'Nro. de Factura',\r\nCASE WHEN T0.IsPlanilla='Y' THEN '' ELSE T0.NroControl END AS 'Nro. de Contol',\r\nT0.ND as 'Nro. de Debito' ,\r\nT0.NC as 'Nro. de Credito',\r\nCASE WHEN T0.IsPlanilla='Y' THEN dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneral,T0.CodigoAlicuotaGeneral,'C') +dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,0,T0.CodigoAlicuotaExento,'C') +T0.VatSum ELSE\r\n(CASE WHEN T0.ObjType='18' THEN 1 WHEN T0.ObjType='19' THEN (-1) END)* T0.Max1099 END AS 'Total',\r\nCASE WHEN T0.IsPlanilla='Y' THEN 0 ELSE dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneral,T0.CodigoAlicuotaGeneral,'C') end  AS 'Base Imponible (GENERAL)',\r\nT0.AlicuotaGeneral AS 'Alicuota (GENERAL)', --12\r\nCASE WHEN T0.IsPlanilla='Y' THEN 0 ELSE \r\n\t((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,\t\r\n\t\tT0.AlicuotaGeneral,T0.CodigoAlicuotaGeneral,\r\n\t\t\t\t\t\t'C') *T0.AlicuotaGeneral)/100) end AS 'IVA (GENERAL)',\r\n\r\n\r\n\t\t\t\t\t\tCASE WHEN T0.IsPlanilla='Y' THEN 0 ELSE dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneralE1,T0.CodigoAlicuotaGeneralE1,'C') end  AS 'Base Imponible (GENERAL E1)',\r\nT0.AlicuotaGeneralE1 AS 'Alicuota (GENERAL E1)', --12\r\nCASE WHEN T0.IsPlanilla='Y' THEN 0 ELSE \r\n\t((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,\t\r\n\t\tT0.AlicuotaGeneralE1,T0.CodigoAlicuotaGeneralE1,\r\n\t\t\t\t\t\t'C') *T0.AlicuotaGeneralE1)/100) end AS 'IVA (GENERAL E1)',\r\n\r\n\r\n\tCASE WHEN T0.IsPlanilla='Y' THEN 0 ELSE dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneralE2,T0.CodigoAlicuotaGeneralE2,'C') end  AS 'Base Imponible (GENERAL E2)',\r\nT0.AlicuotaGeneralE2 AS 'Alicuota (GENERAL E2)', --12\r\nCASE WHEN T0.IsPlanilla='Y' THEN 0 ELSE \r\n\t((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,\t\r\n\t\tT0.AlicuotaGeneralE2,T0.CodigoAlicuotaGeneralE2,\r\n\t\t\t\t\t\t'C') *T0.AlicuotaGeneralE2)/100) end AS 'IVA (GENERAL E2)',\r\n\r\n\r\ndbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T0.AlicuotaReducida,T0.CodigoAlicuotaReducida,'C') AS 'Base Imponible (REDUCIDA)',\r\n\r\n T0.AlicuotaReducida AS 'Alicuota (REDUCIDA)', --8\r\n\r\nCASE WHEN T0.IsPlanilla='Y' THEN 0 ELSE ((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T0.AlicuotaReducida,T0.CodigoAlicuotaReducida,'C') *T0.AlicuotaReducida)/100) end AS 'IVA (REDUCIDA)',\r\n\r\n--CASE WHEN T0.IsPlanilla='Y' THEN CASE WHEN T0.VatSum=0 THEN dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, 0,'C')  ELSE 0 END ELSE \r\ndbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, 0,T0.CodigoAlicuotaExento,'C') +  \r\n-- se agrego esta funcionalidad para las compras sin derecho a credito fiscal\r\ndbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T0.AlicuotaGasto,T0.CodigoAlicuotaGasto,'C') \r\n--END \r\n+ dbo.IDA_ImpuestoNoDeducible(T0.ObjType,T0.DocEntry,T0.CodigoAlicuotaGasto,'C')\r\nAS 'Base Imponible (EXENTA)',\r\n\r\n0 AS 'Alicuota (EXENTA)',\r\n((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, 0,T0.CodigoAlicuotaExento,'C') *0)/100) AS 'EXENTO, NO SUJETO',\r\n\r\ndbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T0.AlicuotaAdicional,T0.CodigoAlicuotaAdicional,'C') AS 'Base Imponible (ADICIONAL)',\r\nT0.AlicuotaAdicional AS 'Alicuota (ADICIONAL)', --20\r\n\r\n((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, t0.AlicuotaAdicional,T0.CodigoAlicuotaAdicional,'C') *t0.AlicuotaAdicional)/100) AS 'IVA (ADICIONAL)',\r\n\r\n\r\nCASE WHEN T0.IsPlanilla='Y' THEN 0 ELSE dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGasto,T0.CodigoAlicuotaGasto,'C') end  AS 'Base Imponible (GASTO)',\r\nT0.AlicuotaGasto AS 'Alicuota (GASTO)', --12\r\n\r\n(CASE WHEN T0.ObjType='18' THEN 1 WHEN T0.ObjType='19' THEN (-1) END)* ISNULL(T2.WTAmnt,0)  'Retencion',\r\nCASE WHEN T0.U_IDA_RetenTercero='Y' THEN (CASE WHEN T0.ObjType='18' THEN 1 WHEN T0.ObjType='19' THEN (-1) END)* ISNULL(T2.WTAmnt,0) ELSE 0 END  'RetencionTercero',\r\n\r\n(SELECT VatStatus FROM OCRD WHERE CardCode=T0.CardCode) AS 'VatStatus'\r\n, T0.DocDate as 'Fecha Contable' \r\n, T0.TipoPersona\r\n,CASE WHEN T0.IsPlanilla='Y' THEN dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneral,T0.CodigoAlicuotaGeneral,'C') --T0.U_BASE_IMP \r\nELSE 0 END AS 'Base Imponible Importacion'\r\n,CASE WHEN T0.IsPlanilla='Y' THEN \r\n\t\t\t\t\tT0.VatSum\t\r\n\t\t\t\tELSE 0 END AS 'IVA Importacion'\r\n, 12 as '% Alicuota IMP'\r\nFROM \r\ndbo.O_IDA(@Periodo) T0 LEFT OUTER JOIN \r\n--dbo.O_IDA1() T1, \r\ndbo.O_IDA5() T2  ON T0.DocEntry=T2.AbsEntry  AND T2.BaseType='V' \r\nAND T0.ObjType = T2.ObjType  LEFT OUTER JOIN  OWHT T4 (NOLOCK) ON T2.WTCode =T4.WTCode\r\n , \r\nOADM T5 (NOLOCK) ,  OFPR T6 (NOLOCK)\r\n\r\nWHERE T6.Name=@Periodo--@Periodo \r\n--T0.DocEntry=T1.DocEntry  AND  \r\n--T0.DocNum=17089 --and\r\n \r\n \r\n\r\n)\r\n\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[IDA_ComprobanteARCV] \r\n(\t\r\n  @CardName AS VARCHAR(100),\r\n  @Year AS VARCHAR(100)\r\n)\r\n\r\nRETURNS TABLE\r\nWITH ENCRYPTION \r\nAS\r\nRETURN \r\n(\r\n\r\nSELECT * FROM (\r\nSELECT\r\n             DISTINCT  \r\n                T1.Address ,T1.CardName,T1.DocDate as 'Fecha',replace (T1.LicTradNum,'-','') RifRetenido,\r\n                CASE WHEN LEN(T1.NumAtCard)>10 THEN SUBSTRING(REPLACE(T1.NumAtCard,'-',''),\r\n                (LEN(T1.NumAtCard)-9), LEN(T1.NumAtCard)) ELSE REPLACE(T1.NumAtCard,'-','') END AS 'Numero Factura',\r\n                ISNULL(T1.U_IDA_Serie,'') + ISNULL(T1.U_IDA_NumControl,'NA') NumeroControl,\r\n                T1.BaseAmnt + t1.vatsum AS 'Monto Documento',T3.Offclcode AS 'Codigo Concepto',  T3.WTName as 'Concepto de I.S.L.R',              \r\n               ((T2.WTAmnt + ISNULL(T3.U_IDA_Sustraendo,0)) /(T3.PrctBsAmnt/100)) --AS NUMERIC (10,2)),',','.') \r\n              \r\n             -- (( t2.TaxbleAmnt) /(T3.PrctBsAmnt/100)) AS 'Cantidad Objeto retencion', \r\n                --  (( t2.TaxbleAmnt) ) \r\n\t\t\t\t  AS 'Cantidad Objeto retencion', \r\n                \r\n                T2.WTAmnt AS 'Impuesto Retenido menos sustraendo',\r\n                --(((T2.WTAmnt + ISNULL(T3.U_IDA_Sustraendo,0)) /(T3.PrctBsAmnt/100))) * T3.PrctBsAmnt/100 AS 'Impuesto Retenido menos sustraendo',\r\n                REPLACE(CAST(T3.PrctBsAmnt AS NUMERIC (10,2)),',','.') as 'Tarifa %', \r\n                T9.CompnyName,T9.CompnyAddr,T9.TaxIdNum\r\n                ,CONVERT(VARCHAR,YEAR(T1.DocDate)) AS 'Year'\r\n\t\t\t\t, (SELECT COUNT(*) FROM RPC1 WHERE BaseEntry=T1.DocEntry) AS 'NC'\r\n               \r\n              \r\n                FROM\r\n                OPCH T1, PCH5 T2, OWHT T3, OFPR T4, OADM T9\r\n                WHERE\r\n                T1.DocEntry=T2.AbsEntry AND\r\n                T2.WTCode = T3.WTCode AND\r\n                T3.U_IDA_TipoRetencion= 'ISLR' \r\n                AND T1.CardCode=@CardName--(SELECT CardCode FROM OCRD WHERE CardName=@CardName AND CardType='S')\r\n                AND YEAR(T1.DocDate)=@Year and t1.U_IDA_TipoTrans<>'05'\r\n) T WHERE T.NC=0\r\n)\r\n\r\n\r\nGO\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[O_IDAV] \r\n(\r\n   @Periodo AS VARCHAR(10)\t\r\n)\r\nRETURNS TABLE \r\nWITH ENCRYPTION \r\n\r\nAS\r\nRETURN \r\n(\r\n\r\n\t\t\tSELECT \r\n\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE1',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE1',\r\n\r\n\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE2',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE2',\r\n\t\t\t\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGasto',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGasto',\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneral',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneral',\r\n\r\n\t\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL_OP'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralOP',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL_OP'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralOP',\r\n\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='REDUCIDA' --Rate=8\t--U_IDA_Alicuota='REDUCIDA'\r\n\t\t\t\t\t)  AS 'AlicuotaReducida',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='REDUCIDA' --Rate=8\t--U_IDA_Alicuota='REDUCIDA'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaReducida',\r\n\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='ADICIONAL'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'AlicuotaAdicional',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='ADICIONAL'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaAdicional',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='EXENTO'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaExento',\r\n\t\t\t\t'NO' AS 'COMPROBANTE',\r\n\t\t\t\tISNULL(CASE WHEN DocSubType='--' THEN NumAtCard END,'') AS 'NF', \r\n\t\t\t\tISNULL(CASE WHEN DocSubType<>'--' THEN NumAtCard END,'') AS 'ND', \r\n\t\t\t\t'' AS 'NC',\r\n\t\t\t\tK2.U_IDA_Fafe AS 'FAFE',\r\n\t\t\t\tISNULL(K2.U_IDA_Serie,'00')+'-'+ISNULL(ISNULL(K2.U_IDA_NumControl,K2.U_IDA_NumControl),'') AS 'NroControl',\r\n\t\t\t\tU_IDA_TipoTrans AS 'TipoTran', \r\n\t\t\t\r\n\t\t\t\tISNULL(K2.U_IDA_CompIVA,'') AS 'NroComprobante',\r\n\t\t\t\r\n\t\t\t\tK2.U_IDA_FechaComp AS 'FechaComp',\r\n\t\t\t\tK2.U_IDA_MontoCompIVA AS 'Retencion',\r\n\t\t\t\t1 AS 'Signo',\r\n\t\t\t\tK2.U_IDA_FechaContComp AS 'FechaContComp' ,\r\n\t\t\t\tISNULL(K2.U_IDA_NumExport,'') as 'NroExport', \r\n\t\t\t\tK2.U_IDA_NumFile AS 'ExpedienteExport' ,K2.[DocEntry]\r\n      ,K2.[DocNum]\r\n      ,K2.[Max1099]\r\n      ,K2.[DocType]\r\n      ,K2.[CANCELED]\r\n      ,K2.[DocStatus]\r\n      ,K2.[InvntSttus]\r\n      ,K2.[DocDate]\r\n      ,K2.[DocDueDate]\r\n      ,K2.[CardCode]\r\n      ,K2.[CardName]\r\n      ,K2.[Address]\r\n      ,K2.[Address2]\r\n      ,K2.[ObjType]\r\n      ,K2.[NumAtCard]\r\n      ,K2.[VatSum]\r\n      ,K2.[VatSumFC]\r\n      ,K2.[DocCur]\r\n      ,K2.[DocTotal]\r\n      ,K2.[DocTotalFC]\r\n      ,K2.[PaidToDate]\r\n      ,K2.[PaidFC]\r\n      ,K2.[Ref1]\r\n      ,K2.[Comments]\r\n      ,K2.[JrnlMemo]\r\n      ,K2.[TransId]\r\n      ,K2.[DocRate]\r\n      ,K2.[SysRate]\r\n      ,K2.[VatSumSy]\r\n      ,K2.[DocTotalSy]\r\n      ,K2.[PaidSys]\r\n      ,K2.[UpdateDate]\r\n      ,K2.[CreateDate]\r\n      ,K2.[TaxDate]\r\n      ,K2.[FinncPriod]\r\n      ,K2.[UserSign]\r\n      ,K2.[VatPaid]\r\n      ,K2.[VatPaidFC]\r\n      ,K2.[VatPaidSys]\r\n      ,K2.[UserSign2]\r\n      ,K2.[LicTradNum]\r\n      ,K2.[WTSum]\r\n      ,K2.[WTSumFC]\r\n      ,K2.[WTSumSC]\r\n      ,K2.[WTApplied]\r\n      ,K2.[WTAppliedF]\r\n      ,K2.[WTAppliedS]\r\n      ,K2.[CtlAccount]\r\n      ,K2.[BaseVtAt]\r\n      ,K2.[BaseVtAtSC]\r\n      ,K2.[BaseVtAtFC]\r\n      ,K2.[NnSbVAt]\r\n      ,K2.[NnSbVAtSC]\r\n      ,K2.[NbSbVAtFC]\r\n      ,K2.[PaidSum]\r\n      ,K2.[PaidSumFc]\r\n      ,K2.[PaidSumSc]\r\n      ,K2.[NnSbAmnt]\r\n      ,K2.[NnSbAmntSC]\r\n      ,K2.[NbSbAmntFC]\r\n      ,K2.[BaseAmnt]\r\n      ,K2.[BaseAmntSC]\r\n      ,K2.[BaseAmntFC]\r\n      ,K2.[U_IDA_NumControl]\r\n      ,K2.[U_IDA_TipoTrans]\r\n      ,K2.[U_IDA_CompIVA]\r\n      ,K2.[U_IDA_FechaComp]\r\n      ,K2.[U_IDA_FechaContComp]\r\n      ,K2.[U_IDA_MontoCompIVA]\r\n      ,K2.[U_IDA_RetenTercero]\r\n      ,K2.[U_IDA_TipoRet]\r\n      ,K2.[U_IDA_Tercero]\r\n      ,K2.[U_IDA_CompISLR]\r\n      ,K2.[U_IDA_DateCompISLR]\r\n      ,K2.[U_IDA_DateContISLR]\r\n      ,K2.[U_IDA_CodSerie]\r\n      ,K2.[U_IDA_Serie]\r\n      ,K2.[U_IDA_Fafe]\r\n      ,K2.[U_IDA_NumExport]\r\n      ,K2.[U_IDA_TipoDoc]\r\n      ,K2.[U_IDA_NumFile]\r\n      ,K2.[U_IDA_NumImport]\r\n      ,K2.[U_IDA_MontoFafe]\r\n      ,K2.[U_IDA_FechaFafe]\r\n      ,K2.[U_IDA_IsPlanilla]\r\n      ,K2.[U_IDA_PagoElectronic]\r\n      ,K2.[U_IDA_Alicuota]\r\n      ,K2.[U_IDA_CompMunicipal]\r\n      ,K2.[U_IDA_DateCompMun]\r\n      ,K2.[U_IDA_CorteZ]\r\n      ,K2.[U_IDA_SerialImpre]\r\n      ,K2.[U_IDA_DocAnulado]\r\n      ,K2.[DocSubType]\r\n      ,K2.[DiscPrcnt]\r\n      ,K2.[DiscSum]\r\n      ,K2.[DiscSumFC]\r\n      ,K2.[DiscSumSy]\r\n      ,K2.[DocTime] \r\n\t\t\tFROM OINV K2 (NOLOCK), OFPR H1 (NOLOCK)\r\n\t\t\tWHERE \r\n\t\t\t\tH1.Name=@Periodo AND \r\n\t\t\t\tK2.DocDate >= H1.F_RefDate AND \r\n\t\t\t\tK2.DocDate <= H1.T_RefDate\r\n\t\t\t\tAND K2.U_IDA_TipoTrans<>'05'\r\n\t\t\t \r\n\t\t\tUNION ALL\r\n\t\t\tSELECT \r\n\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE1',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE1',\r\n\r\n\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE2',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE2',\r\n\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGasto',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGasto',\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneral',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneral',\r\n\t\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL_OP'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralOP',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL_OP'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralOP',\r\n\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='REDUCIDA' --Rate=8\t--U_IDA_Alicuota='REDUCIDA'\r\n\t\t\t\t\t)  AS 'AlicuotaReducida',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='REDUCIDA' --Rate=8\t--U_IDA_Alicuota='REDUCIDA'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaReducida',\r\n\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='ADICIONAL'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'AlicuotaAdicional',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='ADICIONAL'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaAdicional',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='EXENTO'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaExento',\r\n\t\t\t\t'NO' AS 'COMPROBANTE',\r\n\t\t\t\t'' AS 'NF', '' AS 'ND',  \r\n\t\t\t\tK2.NumAtCard AS 'NC',\r\n\t\t\t\tK2.U_IDA_Fafe AS 'FAFE',\r\n--\t\t\t\tISNULL(K2.U_IDA_ControlNumber,'') AS 'NroControl', \r\n\t\t\t\tISNULL(K2.U_IDA_Serie,'00')+'-'+ISNULL(ISNULL(K2.U_IDA_NumControl,K2.U_IDA_NumControl),'') AS 'NroControl',\r\n\t\t\t\tU_IDA_TipoTrans AS 'TipoTran',\r\n\t\t\t\tISNULL(K2.U_IDA_CompIVA,'') AS 'NroComprobante',\r\n\t\t\t\tK2.U_IDA_FechaComp AS 'FechaComp',\r\n\t\t\t\tK2.U_IDA_MontoCompIVA AS 'Retencion',\r\n\t\t\t\t-1 AS 'Signo',\r\n\t\t\t\tK2.U_IDA_FechaContComp AS 'FechaContComp' ,\r\n\t\t\t\tISNULL(K2.U_IDA_NumExport,'') as 'NroExport', \r\n\t\t\t\tK2.U_IDA_NumFile AS 'ExpedienteExport', K2.[DocEntry]\r\n      ,K2.[DocNum]\r\n      ,K2.[Max1099]\r\n      ,K2.[DocType]\r\n      ,K2.[CANCELED]\r\n      ,K2.[DocStatus]\r\n      ,K2.[InvntSttus]\r\n      ,K2.[DocDate]\r\n      ,K2.[DocDueDate]\r\n      ,K2.[CardCode]\r\n      ,K2.[CardName]\r\n      ,K2.[Address]\r\n      ,K2.[Address2]\r\n      ,K2.[ObjType]\r\n      ,K2.[NumAtCard]\r\n      ,K2.[VatSum]\r\n      ,K2.[VatSumFC]\r\n      ,K2.[DocCur]\r\n      ,K2.[DocTotal]\r\n      ,K2.[DocTotalFC]\r\n      ,K2.[PaidToDate]\r\n      ,K2.[PaidFC]\r\n      ,K2.[Ref1]\r\n      ,K2.[Comments]\r\n      ,K2.[JrnlMemo]\r\n      ,K2.[TransId]\r\n      ,K2.[DocRate]\r\n      ,K2.[SysRate]\r\n      ,K2.[VatSumSy]\r\n      ,K2.[DocTotalSy]\r\n      ,K2.[PaidSys]\r\n      ,K2.[UpdateDate]\r\n      ,K2.[CreateDate]\r\n      ,K2.[TaxDate]\r\n      ,K2.[FinncPriod]\r\n      ,K2.[UserSign]\r\n      ,K2.[VatPaid]\r\n      ,K2.[VatPaidFC]\r\n      ,K2.[VatPaidSys]\r\n      ,K2.[UserSign2]\r\n      ,K2.[LicTradNum]\r\n      ,K2.[WTSum]\r\n      ,K2.[WTSumFC]\r\n      ,K2.[WTSumSC]\r\n      ,K2.[WTApplied]\r\n      ,K2.[WTAppliedF]\r\n      ,K2.[WTAppliedS]\r\n      ,K2.[CtlAccount]\r\n      ,K2.[BaseVtAt]\r\n      ,K2.[BaseVtAtSC]\r\n      ,K2.[BaseVtAtFC]\r\n      ,K2.[NnSbVAt]\r\n      ,K2.[NnSbVAtSC]\r\n      ,K2.[NbSbVAtFC]\r\n      ,K2.[PaidSum]\r\n      ,K2.[PaidSumFc]\r\n      ,K2.[PaidSumSc]\r\n      ,K2.[NnSbAmnt]\r\n      ,K2.[NnSbAmntSC]\r\n      ,K2.[NbSbAmntFC]\r\n      ,K2.[BaseAmnt]\r\n      ,K2.[BaseAmntSC]\r\n      ,K2.[BaseAmntFC]\r\n      ,K2.[U_IDA_NumControl]\r\n      ,K2.[U_IDA_TipoTrans]\r\n      ,K2.[U_IDA_CompIVA]\r\n      ,K2.[U_IDA_FechaComp]\r\n      ,K2.[U_IDA_FechaContComp]\r\n      ,K2.[U_IDA_MontoCompIVA]\r\n      ,K2.[U_IDA_RetenTercero]\r\n      ,K2.[U_IDA_TipoRet]\r\n      ,K2.[U_IDA_Tercero]\r\n      ,K2.[U_IDA_CompISLR]\r\n      ,K2.[U_IDA_DateCompISLR]\r\n      ,K2.[U_IDA_DateContISLR]\r\n      ,K2.[U_IDA_CodSerie]\r\n      ,K2.[U_IDA_Serie]\r\n      ,K2.[U_IDA_Fafe]\r\n      ,K2.[U_IDA_NumExport]\r\n      ,K2.[U_IDA_TipoDoc]\r\n      ,K2.[U_IDA_NumFile]\r\n      ,K2.[U_IDA_NumImport]\r\n      ,K2.[U_IDA_MontoFafe]\r\n      ,K2.[U_IDA_FechaFafe]\r\n      ,K2.[U_IDA_IsPlanilla]\r\n      ,K2.[U_IDA_PagoElectronic]\r\n      ,K2.[U_IDA_Alicuota]\r\n      ,K2.[U_IDA_CompMunicipal]\r\n      ,K2.[U_IDA_DateCompMun]\r\n      ,K2.[U_IDA_CorteZ]\r\n      ,K2.[U_IDA_SerialImpre]\r\n      ,K2.[U_IDA_DocAnulado]\r\n      ,K2.[DocSubType]\r\n      ,K2.[DiscPrcnt]\r\n      ,K2.[DiscSum]\r\n      ,K2.[DiscSumFC]\r\n      ,K2.[DiscSumSy]\r\n      ,K2.[DocTime] \r\n\t\t\tFROM ORIN K2 (NOLOCK), OFPR H1 (NOLOCK)\r\n\t\t\tWHERE \r\n\t\t\t\tH1.Name=@Periodo AND \r\n\t\t\t\tK2.DocDate >= H1.F_RefDate AND \r\n\t\t\t\tK2.DocDate <= H1.T_RefDate\r\n\t\t\t\tAND K2.U_IDA_TipoTrans<>'05'\r\n\t\t\tUNION ALL\r\n\t\t\tSELECT \r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE1',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE1',\r\n\r\n\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE2',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE2',\r\n\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGasto',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGasto',\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneral',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneral',\r\n\t\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL_OP'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralOP',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL_OP'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralOP',\r\n\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='REDUCIDA' --Rate=8\t--U_IDA_Alicuota='REDUCIDA'\r\n\t\t\t\t\t)  AS 'AlicuotaReducida',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='REDUCIDA' --Rate=8\t--U_IDA_Alicuota='REDUCIDA'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaReducida',\r\n\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='ADICIONAL'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'AlicuotaAdicional',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='ADICIONAL'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaAdicional',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='EXENTO'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaExento',\r\n\t\t\t\t'SI' AS 'COMPROBANTE',\r\n\t\t\t\t'' AS 'NF', \r\n\t\t\t\t'' AS 'ND', \r\n\t\t\t\t'' AS 'NC',\r\n\r\n\t\t\t\tK2.U_IDA_Fafe AS 'FAFE', \r\n\t\t\t\t'' AS 'NroControl',\r\n\t\t\t\tU_IDA_TipoTrans AS 'TipoTran', \r\n\t\t\t\tISNULL(K2.U_IDA_CompIVA,'') AS 'NroComprobante',\r\n\t\t\t\tK2.U_IDA_FechaComp AS 'FechaComp',\r\n\t\t\t\tK2.U_IDA_MontoCompIVA AS 'Retencion',\r\n\t\t\t\t1 AS 'Signo',\r\n\t\t\t\tK2.U_IDA_FechaContComp AS 'FechaContComp', \r\n\t\t\t\t'' as 'NroExport', \r\n\t\t\t\t'' AS 'ExpedienteExport', K2.[DocEntry]\r\n      ,K2.[DocNum]\r\n      ,K2.[Max1099]\r\n      ,K2.[DocType]\r\n      ,K2.[CANCELED]\r\n      ,K2.[DocStatus]\r\n      ,K2.[InvntSttus]\r\n      ,K2.[DocDate]\r\n      ,K2.[DocDueDate]\r\n      ,K2.[CardCode]\r\n      ,K2.[CardName]\r\n      ,K2.[Address]\r\n      ,K2.[Address2]\r\n      ,K2.[ObjType]\r\n      ,K2.[NumAtCard]\r\n      ,K2.[VatSum]\r\n      ,K2.[VatSumFC]\r\n      ,K2.[DocCur]\r\n      ,K2.[DocTotal]\r\n      ,K2.[DocTotalFC]\r\n      ,K2.[PaidToDate]\r\n      ,K2.[PaidFC]\r\n      ,K2.[Ref1]\r\n      ,K2.[Comments]\r\n      ,K2.[JrnlMemo]\r\n      ,K2.[TransId]\r\n      ,K2.[DocRate]\r\n      ,K2.[SysRate]\r\n      ,K2.[VatSumSy]\r\n      ,K2.[DocTotalSy]\r\n      ,K2.[PaidSys]\r\n      ,K2.[UpdateDate]\r\n      ,K2.[CreateDate]\r\n      ,K2.[TaxDate]\r\n      ,K2.[FinncPriod]\r\n      ,K2.[UserSign]\r\n      ,K2.[VatPaid]\r\n      ,K2.[VatPaidFC]\r\n      ,K2.[VatPaidSys]\r\n      ,K2.[UserSign2]\r\n      ,K2.[LicTradNum]\r\n      ,K2.[WTSum]\r\n      ,K2.[WTSumFC]\r\n      ,K2.[WTSumSC]\r\n      ,K2.[WTApplied]\r\n      ,K2.[WTAppliedF]\r\n      ,K2.[WTAppliedS]\r\n      ,K2.[CtlAccount]\r\n      ,K2.[BaseVtAt]\r\n      ,K2.[BaseVtAtSC]\r\n      ,K2.[BaseVtAtFC]\r\n      ,K2.[NnSbVAt]\r\n      ,K2.[NnSbVAtSC]\r\n      ,K2.[NbSbVAtFC]\r\n      ,K2.[PaidSum]\r\n      ,K2.[PaidSumFc]\r\n      ,K2.[PaidSumSc]\r\n      ,K2.[NnSbAmnt]\r\n      ,K2.[NnSbAmntSC]\r\n      ,K2.[NbSbAmntFC]\r\n      ,K2.[BaseAmnt]\r\n      ,K2.[BaseAmntSC]\r\n      ,K2.[BaseAmntFC]\r\n      ,K2.[U_IDA_NumControl]\r\n      ,K2.[U_IDA_TipoTrans]\r\n      ,K2.[U_IDA_CompIVA]\r\n      ,K2.[U_IDA_FechaComp]\r\n      ,K2.[U_IDA_FechaContComp]\r\n      ,K2.[U_IDA_MontoCompIVA]\r\n      ,K2.[U_IDA_RetenTercero]\r\n      ,K2.[U_IDA_TipoRet]\r\n      ,K2.[U_IDA_Tercero]\r\n      ,K2.[U_IDA_CompISLR]\r\n      ,K2.[U_IDA_DateCompISLR]\r\n      ,K2.[U_IDA_DateContISLR]\r\n      ,K2.[U_IDA_CodSerie]\r\n      ,K2.[U_IDA_Serie]\r\n      ,K2.[U_IDA_Fafe]\r\n      ,K2.[U_IDA_NumExport]\r\n      ,K2.[U_IDA_TipoDoc]\r\n      ,K2.[U_IDA_NumFile]\r\n      ,K2.[U_IDA_NumImport]\r\n      ,K2.[U_IDA_MontoFafe]\r\n      ,K2.[U_IDA_FechaFafe]\r\n      ,K2.[U_IDA_IsPlanilla]\r\n      ,K2.[U_IDA_PagoElectronic]\r\n      ,K2.[U_IDA_Alicuota]\r\n      ,K2.[U_IDA_CompMunicipal]\r\n      ,K2.[U_IDA_DateCompMun]\r\n      ,K2.[U_IDA_CorteZ]\r\n      ,K2.[U_IDA_SerialImpre]\r\n      ,K2.[U_IDA_DocAnulado]\r\n      ,K2.[DocSubType]\r\n      ,K2.[DiscPrcnt]\r\n      ,K2.[DiscSum]\r\n      ,K2.[DiscSumFC]\r\n      ,K2.[DiscSumSy]\r\n      ,K2.[DocTime] \r\n\t\t\t\r\n\t\t\tFROM OINV K2 (NOLOCK), OFPR H1 (NOLOCK)\r\n--\t\t\tWHERE H1.Name=@Periodo AND K2.U_IDA_FechaContComp >= H1.F_RefDate AND K2.U_IDA_FechaContComp <= H1.T_RefDate AND \r\n\t\t\tWHERE \r\n\t\t\t\tH1.Name=@Periodo AND \r\n\t\t\t\tK2.U_IDA_FechaContComp >= H1.F_RefDate AND \r\n\t\t\t\tK2.U_IDA_FechaContComp <= H1.T_RefDate AND \r\n\t\t\t\tNOT (K2.DocDate >= H1.F_RefDate AND K2.DocDate <= H1.T_RefDate)\r\n\t\t\t        AND K2.U_IDA_TipoTrans<>'05' AND K2.U_IDA_CompIVA<>'' AND K2.U_IDA_CompIVA IS NOT NULL\r\n\t\t\tUNION ALL\r\n\r\n\r\n\t\t\tSELECT \r\n\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE1',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE1',\r\n\r\n\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE2',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE2',\r\n\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGasto',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGasto',\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneral',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneral',\r\n\t\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL_OP'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralOP',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL_OP'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralOP',\r\n\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='REDUCIDA' --Rate=8\t--U_IDA_Alicuota='REDUCIDA'\r\n\t\t\t\t\t)  AS 'AlicuotaReducida',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='REDUCIDA' --Rate=8\t--U_IDA_Alicuota='REDUCIDA'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaReducida',\r\n\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='ADICIONAL'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'AlicuotaAdicional',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='ADICIONAL'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaAdicional',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='EXENTO'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaExento',\r\n\t\t\t\t'SI' AS 'COMPROBANTE',\r\n\t\t\t\t'' AS 'NF', \r\n\t\t\t\t'' AS 'ND', \r\n\t\t\t\t'' AS 'NC',\r\n\t\t\t\tK2.U_IDA_Fafe AS 'FAFE', \r\n\t\t\t\t'' AS 'NroControl',\r\n\t\t\t\tU_IDA_TipoTrans AS 'TipoTran', \r\n\t\t\t\tISNULL(K2.U_IDA_CompIVA,'') AS 'NroComprobante',\r\n\t\t\t\tK2.U_IDA_FechaComp AS 'FechaComp',\r\n\t\t\t\tK2.U_IDA_MontoCompIVA AS 'Retencion',\r\n\t\t\t\t-1 AS 'Signo',\r\n\t\t\t\tK2.U_IDA_FechaContComp AS 'FechaContComp', \r\n\t\t\t\t'' as 'NroExport', '' AS 'ExpedienteExport', K2.[DocEntry]\r\n      ,K2.[DocNum]\r\n      ,K2.[Max1099]\r\n      ,K2.[DocType]\r\n      ,K2.[CANCELED]\r\n      ,K2.[DocStatus]\r\n      ,K2.[InvntSttus]\r\n      ,K2.[DocDate]\r\n      ,K2.[DocDueDate]\r\n      ,K2.[CardCode]\r\n      ,K2.[CardName]\r\n      ,K2.[Address]\r\n      ,K2.[Address2]\r\n      ,K2.[ObjType]\r\n      ,K2.[NumAtCard]\r\n      ,K2.[VatSum]\r\n      ,K2.[VatSumFC]\r\n      ,K2.[DocCur]\r\n      ,K2.[DocTotal]\r\n      ,K2.[DocTotalFC]\r\n      ,K2.[PaidToDate]\r\n      ,K2.[PaidFC]\r\n      ,K2.[Ref1]\r\n      ,K2.[Comments]\r\n      ,K2.[JrnlMemo]\r\n      ,K2.[TransId]\r\n      ,K2.[DocRate]\r\n      ,K2.[SysRate]\r\n      ,K2.[VatSumSy]\r\n      ,K2.[DocTotalSy]\r\n      ,K2.[PaidSys]\r\n      ,K2.[UpdateDate]\r\n      ,K2.[CreateDate]\r\n      ,K2.[TaxDate]\r\n      ,K2.[FinncPriod]\r\n      ,K2.[UserSign]\r\n      ,K2.[VatPaid]\r\n      ,K2.[VatPaidFC]\r\n      ,K2.[VatPaidSys]\r\n      ,K2.[UserSign2]\r\n      ,K2.[LicTradNum]\r\n      ,K2.[WTSum]\r\n      ,K2.[WTSumFC]\r\n      ,K2.[WTSumSC]\r\n      ,K2.[WTApplied]\r\n      ,K2.[WTAppliedF]\r\n      ,K2.[WTAppliedS]\r\n      ,K2.[CtlAccount]\r\n      ,K2.[BaseVtAt]\r\n      ,K2.[BaseVtAtSC]\r\n      ,K2.[BaseVtAtFC]\r\n      ,K2.[NnSbVAt]\r\n      ,K2.[NnSbVAtSC]\r\n      ,K2.[NbSbVAtFC]\r\n      ,K2.[PaidSum]\r\n      ,K2.[PaidSumFc]\r\n      ,K2.[PaidSumSc]\r\n      ,K2.[NnSbAmnt]\r\n      ,K2.[NnSbAmntSC]\r\n      ,K2.[NbSbAmntFC]\r\n      ,K2.[BaseAmnt]\r\n      ,K2.[BaseAmntSC]\r\n      ,K2.[BaseAmntFC]\r\n      ,K2.[U_IDA_NumControl]\r\n      ,K2.[U_IDA_TipoTrans]\r\n      ,K2.[U_IDA_CompIVA]\r\n      ,K2.[U_IDA_FechaComp]\r\n      ,K2.[U_IDA_FechaContComp]\r\n      ,K2.[U_IDA_MontoCompIVA]\r\n      ,K2.[U_IDA_RetenTercero]\r\n      ,K2.[U_IDA_TipoRet]\r\n      ,K2.[U_IDA_Tercero]\r\n      ,K2.[U_IDA_CompISLR]\r\n      ,K2.[U_IDA_DateCompISLR]\r\n      ,K2.[U_IDA_DateContISLR]\r\n      ,K2.[U_IDA_CodSerie]\r\n      ,K2.[U_IDA_Serie]\r\n      ,K2.[U_IDA_Fafe]\r\n      ,K2.[U_IDA_NumExport]\r\n      ,K2.[U_IDA_TipoDoc]\r\n      ,K2.[U_IDA_NumFile]\r\n      ,K2.[U_IDA_NumImport]\r\n      ,K2.[U_IDA_MontoFafe]\r\n      ,K2.[U_IDA_FechaFafe]\r\n      ,K2.[U_IDA_IsPlanilla]\r\n      ,K2.[U_IDA_PagoElectronic]\r\n      ,K2.[U_IDA_Alicuota]\r\n      ,K2.[U_IDA_CompMunicipal]\r\n      ,K2.[U_IDA_DateCompMun]\r\n      ,K2.[U_IDA_CorteZ]\r\n      ,K2.[U_IDA_SerialImpre]\r\n      ,K2.[U_IDA_DocAnulado]\r\n      ,K2.[DocSubType]\r\n      ,K2.[DiscPrcnt]\r\n      ,K2.[DiscSum]\r\n      ,K2.[DiscSumFC]\r\n      ,K2.[DiscSumSy]\r\n      ,K2.[DocTime] \r\n\t\t\t\r\n\t\t\tFROM ORIN K2 (NOLOCK), OFPR H1 (NOLOCK)\r\n--\t\t\tWHERE H1.Name=@Periodo AND K2.U_IDA_FechaContComp >= H1.F_RefDate AND K2.U_IDA_FechaContComp <= H1.T_RefDate AND \r\n\t\t\tWHERE \r\n\t\t\t\tH1.Name=@Periodo AND \r\n\t\t\t\tK2.U_IDA_FechaContComp >= H1.F_RefDate AND \r\n\t\t\t\tK2.U_IDA_FechaContComp <= H1.T_RefDate AND \r\n\t\t\t\tNOT (K2.DocDate >= H1.F_RefDate AND K2.DocDate <= H1.T_RefDate)\r\n                                AND K2.U_IDA_TipoTrans<>'05'\r\n                                AND K2.U_IDA_CompIVA<>'' AND K2.U_IDA_CompIVA IS NOT NULL\r\n)\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[IDA_LIBRO_VENTAS]\r\n(\t\r\n    @Periodo AS VARCHAR(100)\r\n)\r\nRETURNS TABLE \r\nWITH ENCRYPTION \r\n\r\nAS\r\nRETURN \r\n(\r\n\r\nSELECT  \r\nT0.DocEntry AS 'DocEntry',\r\nT5.CompnyName as 'Agente', \r\nT5.TaxIdNum AS 'RIF Agente',\r\nT5.CompnyAddr AS 'Direccion Agente',\r\n--CASE WHEN T0.COMPROBANTE='SI' THEN T0.FechaComp ELSE T0.DocDate END AS 'Fecha',\r\n--EML 20130605 SE CAMBIO NUEVAMENTE DESPUES DE REVISAR EL LIBRO DE VENTAS DE YG OJO EML\r\n--T0.DocDate AS 'Fecha',\r\nCASE WHEN T0.COMPROBANTE='SI' THEN T0.FechaContComp ELSE T0.DocDate END AS 'Fecha',\r\n--ISNULL(T0.FAFE,'') as 'Nro. de Factura Afectada',\r\n--CASE (len(ISNULL(T0.FAFE,''))-9) when '0' then convert(int,substring(CONVERT(char(9),ISNULL(T0.FAFE,'')),2,8)) else ISNULL(T0.FAFE,'') end  AS 'Nro. de Factura Afectada',\r\nCASE (len(ISNULL(T0.FAFE,''))-9) when '0' then convert(VARCHAR,substring(CONVERT(char(9),ISNULL(T0.FAFE,'')),2,8)) else ISNULL(T0.FAFE,'') end  AS 'Nro. de Factura Afectada',\r\n\r\nT0.CardName as 'Nombre o Razon Social',\r\nCASE WHEN T0.LicTradNum='J-999999999' THEN 'ND' ELSE T0.LicTradNum END as 'RIF',\r\nCASE WHEN  T0.FechaContComp>=F_RefDate AND T0.FechaContComp<=T_RefDate THEN T0.NroComprobante END AS 'Nro. Comprobante de IVA',\r\nCASE WHEN  T0.FechaContComp>=F_RefDate AND T0.FechaContComp<=T_RefDate THEN CONVERT(DATETIME,T0.FechaComp,112)  END AS 'Fecha Comprobante',\r\nT0.NroExport AS 'Planilla de importacion',\r\nT0.NroExport AS 'Expediente de importacion',\r\n CASE WHEN T0.U_IDA_DocAnulado='02' THEN 'ANULADO' ELSE CASE \r\n                                WHEN T0.TipoTran='01' THEN '01-Reg' \r\n                                WHEN T0.TipoTran='02' THEN '02-Comp'\r\n                                WHEN T0.TipoTran='03' THEN '03-Anu' \r\n                                WHEN T0.TipoTran='04' THEN '04-Aju'\r\n                                END END AS 'Tipo Transaccion',\r\nT0.NF AS 'Nro. de Factura',\r\nT0.NroControl AS 'Nro. de Contol',\r\nT0.ND as 'Nro. de Debito' ,\r\nT0.NC as 'Nro. de Credito',\r\nT0.FAFE as 'Factura Afectada',\r\n--CASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN \r\n--CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.ObjType='14' THEN (-1)*T0.DocTotal ELSE T0.DocTotal end  end \r\n--ELSE 0 END  END AS 'Total',\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN \r\nCASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.ObjType='14' THEN (-1)*T0.Max1099 ELSE T0.Max1099 end  end \r\nELSE 0 END  END AS 'Total',\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN T0.NroExport <>'' THEN CASE WHEN T0.ObjType='14' THEN (-1)*T0.Max1099 ELSE T0.Max1099 end  ELSE 0 END END AS 'Total EXTERNO', --T0.DocTotal\r\n\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneral,T0.CodigoAlicuotaGeneral,'V') ELSE 0 END END END AS 'Base Imponible (GENERAL)',\r\nT0.AlicuotaGeneral AS 'Alicuota (GENERAL)', --12\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN ((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneral,T0.CodigoAlicuotaGeneral,'V') * T0.AlicuotaGeneral)/100)  ELSE 0 END END END AS 'IVA (GENERAL)',\r\n\r\n\r\n\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneralE1,T0.CodigoAlicuotaGeneralE1,'V') ELSE 0 END END END AS 'Base Imponible (GENERAL E1)',\r\nT0.AlicuotaGeneralE1 AS 'Alicuota (GENERAL E1)', --12\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN ((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneralE1,T0.CodigoAlicuotaGeneralE1,'V') * T0.AlicuotaGeneralE1)/100)  ELSE 0 END END END AS 'IVA (GENERAL E1)',\r\n\r\n\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneralE2,T0.CodigoAlicuotaGeneralE2,'V') ELSE 0 END END END AS 'Base Imponible (GENERAL E2)',\r\nT0.AlicuotaGeneralE2 AS 'Alicuota (GENERAL E2)', --12\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN ((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneralE2,T0.CodigoAlicuotaGeneralE2,'V') * T0.AlicuotaGeneralE2)/100)  ELSE 0 END END END AS 'IVA (GENERAL E2)',\r\n\r\n\r\n\r\n\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneral,T0.CodigoAlicuotaGeneralOP,'V') ELSE 0 END END END AS 'Base Imponible (GENERAL OP)',\r\nT0.AlicuotaGeneralOP AS 'Alicuota (GENERAL OP)', --12\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN ((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneral,T0.CodigoAlicuotaGeneral,'V') * T0.AlicuotaGeneralOP)/100)  ELSE 0 END END END AS 'IVA (GENERAL OP)',\r\n\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T0.AlicuotaReducida,T0.CodigoAlicuotaReducida,'V') ELSE 0 END END END AS 'Base Imponible (REDUCIDA)',\r\nT0.AlicuotaReducida AS 'Alicuota (REDUCIDA)', -- 8\r\n\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN ((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T0.AlicuotaReducida,T0.CodigoAlicuotaReducida,'V') * T0.AlicuotaReducida)/100) ELSE 0 END END END AS 'IVA (REDUCIDA)',\r\n\r\n--dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, 0,'V') AS 'Base Imponible (EXENTA)',\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN \r\nCASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, 0,T0.CodigoAlicuotaExento,'V') end \r\nELSE 0 END END AS 'Base Imponible (EXENTA)',\r\n0 AS 'Alicuota (EXENTA)',\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE ((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, 0,T0.CodigoAlicuotaExento,'V') *0)/100) END AS 'EXENTO, NO SUJETO',\r\n\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T0.AlicuotaAdicional,T0.CodigoAlicuotaAdicional,'V') END END AS 'Base Imponible (ADICIONAL)',\r\nT0.AlicuotaAdicional AS 'Alicuota (ADICIONAL)', --20\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE ((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T0.AlicuotaAdicional,T0.CodigoAlicuotaAdicional,'V') * T0.AlicuotaAdicional)/100) END END AS 'IVA (ADICIONAL)'\r\n,\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.FechaContComp>=F_RefDate AND T0.FechaContComp<=T_RefDate THEN CASE WHEN T0.ObjType='14' THEN CASE WHEN T0.U_IDA_MontoCompIVA>0 THEN (-1)* T0.U_IDA_MontoCompIVA ELSE  T0.U_IDA_MontoCompIVA END  ELSE T0.U_IDA_MontoCompIVA  END ELSE 0.00 END  END AS 'Retencion IVA',\r\nT0.DocTime,\r\n\r\n--CASE WHEN T0.COMPROBANTE='SI' THEN 'COMPROBANTES OTROS MESES' ELSE CASE \r\n--WHEN T0.TipoTran='04' THEN 'AJUSTES' ELSE '_'END  END AS 'ID',\r\n--eml 20130605 ojo esto es para agrupar libro de ventas ojo\r\n\r\n'_' AS 'ID',\r\nT0.U_IDA_Serie AS 'Serie'\r\n\r\nFROM \r\ndbo.O_IDAV(@Periodo) T0,\r\n--dbo.O_IDAV('2013-01') T0,\r\n--dbo.O_IDA1() T1, \r\n--dbo.O_IDA5() T2, \r\n--OWHT T4, \r\nOADM T5 (NOLOCK), OFPR T6\r\n\r\nWHERE \r\n\tT6.Name=@Periodo\r\n--\tName='2013-01'\r\n\t\r\n--ORDER BY T0.DocDate, T0.DocTime, T0.U_IDA_NroControl  \r\n\r\n)\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[O_IDAV_SEMANAL] \r\n(\r\n   @Desde AS DATE\t,\r\n   @Hasta AS DATE\t\r\n)\r\nRETURNS TABLE \r\nWITH ENCRYPTION \r\n\r\nAS\r\nRETURN \r\n(\r\n\r\n\t\t\tSELECT \r\n\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE1',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE1',\r\n\r\n\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE2',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE2',\r\n\t\t\t\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGasto',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGasto',\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneral',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneral',\r\n\r\n\t\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL_OP'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralOP',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL_OP'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralOP',\r\n\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='REDUCIDA' --Rate=8\t--U_IDA_Alicuota='REDUCIDA'\r\n\t\t\t\t\t)  AS 'AlicuotaReducida',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='REDUCIDA' --Rate=8\t--U_IDA_Alicuota='REDUCIDA'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaReducida',\r\n\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='ADICIONAL'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'AlicuotaAdicional',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='ADICIONAL'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaAdicional',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='EXENTO'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaExento',\r\n\t\t\t\t'NO' AS 'COMPROBANTE',\r\n\t\t\t\tISNULL(CASE WHEN DocSubType='--' THEN NumAtCard END,'') AS 'NF', \r\n\t\t\t\tISNULL(CASE WHEN DocSubType<>'--' THEN NumAtCard END,'') AS 'ND', \r\n\t\t\t\t'' AS 'NC',\r\n\t\t\t\tK2.U_IDA_Fafe AS 'FAFE',\r\n\t\t\t\tISNULL(K2.U_IDA_Serie,'00')+'-'+ISNULL(ISNULL(K2.U_IDA_NumControl,K2.U_IDA_NumControl),'') AS 'NroControl',\r\n\t\t\t\tU_IDA_TipoTrans AS 'TipoTran', \r\n\t\t\t\r\n\t\t\t\tISNULL(K2.U_IDA_CompIVA,'') AS 'NroComprobante',\r\n\t\t\t\r\n\t\t\t\tK2.U_IDA_FechaComp AS 'FechaComp',\r\n\t\t\t\tK2.U_IDA_MontoCompIVA AS 'Retencion',\r\n\t\t\t\t1 AS 'Signo',\r\n\t\t\t\tK2.U_IDA_FechaContComp AS 'FechaContComp' ,\r\n\t\t\t\tISNULL(K2.U_IDA_NumExport,'') as 'NroExport', \r\n\t\t\t\tK2.U_IDA_NumFile AS 'ExpedienteExport' ,K2.[DocEntry]\r\n      ,K2.[DocNum]\r\n      ,K2.[Max1099]\r\n      ,K2.[DocType]\r\n      ,K2.[CANCELED]\r\n      ,K2.[DocStatus]\r\n      ,K2.[InvntSttus]\r\n      ,K2.[DocDate]\r\n      ,K2.[DocDueDate]\r\n      ,K2.[CardCode]\r\n      ,K2.[CardName]\r\n      ,K2.[Address]\r\n      ,K2.[Address2]\r\n      ,K2.[ObjType]\r\n      ,K2.[NumAtCard]\r\n      ,K2.[VatSum]\r\n      ,K2.[VatSumFC]\r\n      ,K2.[DocCur]\r\n      ,K2.[DocTotal]\r\n      ,K2.[DocTotalFC]\r\n      ,K2.[PaidToDate]\r\n      ,K2.[PaidFC]\r\n      ,K2.[Ref1]\r\n      ,K2.[Comments]\r\n      ,K2.[JrnlMemo]\r\n      ,K2.[TransId]\r\n      ,K2.[DocRate]\r\n      ,K2.[SysRate]\r\n      ,K2.[VatSumSy]\r\n      ,K2.[DocTotalSy]\r\n      ,K2.[PaidSys]\r\n      ,K2.[UpdateDate]\r\n      ,K2.[CreateDate]\r\n      ,K2.[TaxDate]\r\n      ,K2.[FinncPriod]\r\n      ,K2.[UserSign]\r\n      ,K2.[VatPaid]\r\n      ,K2.[VatPaidFC]\r\n      ,K2.[VatPaidSys]\r\n      ,K2.[UserSign2]\r\n      ,K2.[LicTradNum]\r\n      ,K2.[WTSum]\r\n      ,K2.[WTSumFC]\r\n      ,K2.[WTSumSC]\r\n      ,K2.[WTApplied]\r\n      ,K2.[WTAppliedF]\r\n      ,K2.[WTAppliedS]\r\n      ,K2.[CtlAccount]\r\n      ,K2.[BaseVtAt]\r\n      ,K2.[BaseVtAtSC]\r\n      ,K2.[BaseVtAtFC]\r\n      ,K2.[NnSbVAt]\r\n      ,K2.[NnSbVAtSC]\r\n      ,K2.[NbSbVAtFC]\r\n      ,K2.[PaidSum]\r\n      ,K2.[PaidSumFc]\r\n      ,K2.[PaidSumSc]\r\n      ,K2.[NnSbAmnt]\r\n      ,K2.[NnSbAmntSC]\r\n      ,K2.[NbSbAmntFC]\r\n      ,K2.[BaseAmnt]\r\n      ,K2.[BaseAmntSC]\r\n      ,K2.[BaseAmntFC]\r\n      ,K2.[U_IDA_NumControl]\r\n      ,K2.[U_IDA_TipoTrans]\r\n      ,K2.[U_IDA_CompIVA]\r\n      ,K2.[U_IDA_FechaComp]\r\n      ,K2.[U_IDA_FechaContComp]\r\n      ,K2.[U_IDA_MontoCompIVA]\r\n      ,K2.[U_IDA_RetenTercero]\r\n      ,K2.[U_IDA_TipoRet]\r\n      ,K2.[U_IDA_Tercero]\r\n      ,K2.[U_IDA_CompISLR]\r\n      ,K2.[U_IDA_DateCompISLR]\r\n      ,K2.[U_IDA_DateContISLR]\r\n      ,K2.[U_IDA_CodSerie]\r\n      ,K2.[U_IDA_Serie]\r\n      ,K2.[U_IDA_Fafe]\r\n      ,K2.[U_IDA_NumExport]\r\n      ,K2.[U_IDA_TipoDoc]\r\n      ,K2.[U_IDA_NumFile]\r\n      ,K2.[U_IDA_NumImport]\r\n      ,K2.[U_IDA_MontoFafe]\r\n      ,K2.[U_IDA_FechaFafe]\r\n      ,K2.[U_IDA_IsPlanilla]\r\n      ,K2.[U_IDA_PagoElectronic]\r\n      ,K2.[U_IDA_Alicuota]\r\n      ,K2.[U_IDA_CompMunicipal]\r\n      ,K2.[U_IDA_DateCompMun]\r\n      ,K2.[U_IDA_CorteZ]\r\n      ,K2.[U_IDA_SerialImpre]\r\n      ,K2.[U_IDA_DocAnulado]\r\n      ,K2.[DocSubType]\r\n      ,K2.[DiscPrcnt]\r\n      ,K2.[DiscSum]\r\n      ,K2.[DiscSumFC]\r\n      ,K2.[DiscSumSy]\r\n      ,K2.[DocTime] \r\n\t\t\tFROM OINV K2 (NOLOCK) --, OFPR H1 (NOLOCK)\r\n\t\t\tWHERE \r\n\t\t\t\t--H1.Name=@Periodo AND \r\n\t\t\t\tK2.DocDate >= @Desde AND --H1.F_RefDate AND \r\n\t\t\t\tK2.DocDate <= @Hasta --H1.T_RefDate\r\n\t\t\t\tAND K2.U_IDA_TipoTrans<>'05'\r\n\t\t\t \r\n\t\t\tUNION ALL\r\n\t\t\tSELECT \r\n\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE1',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE1',\r\n\r\n\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE2',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE2',\r\n\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGasto',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGasto',\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneral',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneral',\r\n\t\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL_OP'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralOP',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL_OP'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralOP',\r\n\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='REDUCIDA' --Rate=8\t--U_IDA_Alicuota='REDUCIDA'\r\n\t\t\t\t\t)  AS 'AlicuotaReducida',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='REDUCIDA' --Rate=8\t--U_IDA_Alicuota='REDUCIDA'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaReducida',\r\n\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='ADICIONAL'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'AlicuotaAdicional',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='ADICIONAL'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaAdicional',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='EXENTO'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaExento',\r\n\t\t\t\t'NO' AS 'COMPROBANTE',\r\n\t\t\t\t'' AS 'NF', '' AS 'ND',  \r\n\t\t\t\tK2.NumAtCard AS 'NC',\r\n\t\t\t\tK2.U_IDA_Fafe AS 'FAFE',\r\n--\t\t\t\tISNULL(K2.U_IDA_ControlNumber,'') AS 'NroControl', \r\n\t\t\t\tISNULL(K2.U_IDA_Serie,'00')+'-'+ISNULL(ISNULL(K2.U_IDA_NumControl,K2.U_IDA_NumControl),'') AS 'NroControl',\r\n\t\t\t\tU_IDA_TipoTrans AS 'TipoTran',\r\n\t\t\t\tISNULL(K2.U_IDA_CompIVA,'') AS 'NroComprobante',\r\n\t\t\t\tK2.U_IDA_FechaComp AS 'FechaComp',\r\n\t\t\t\tK2.U_IDA_MontoCompIVA AS 'Retencion',\r\n\t\t\t\t-1 AS 'Signo',\r\n\t\t\t\tK2.U_IDA_FechaContComp AS 'FechaContComp' ,\r\n\t\t\t\tISNULL(K2.U_IDA_NumExport,'') as 'NroExport', \r\n\t\t\t\tK2.U_IDA_NumFile AS 'ExpedienteExport', K2.[DocEntry]\r\n      ,K2.[DocNum]\r\n      ,K2.[Max1099]\r\n      ,K2.[DocType]\r\n      ,K2.[CANCELED]\r\n      ,K2.[DocStatus]\r\n      ,K2.[InvntSttus]\r\n      ,K2.[DocDate]\r\n      ,K2.[DocDueDate]\r\n      ,K2.[CardCode]\r\n      ,K2.[CardName]\r\n      ,K2.[Address]\r\n      ,K2.[Address2]\r\n      ,K2.[ObjType]\r\n      ,K2.[NumAtCard]\r\n      ,K2.[VatSum]\r\n      ,K2.[VatSumFC]\r\n      ,K2.[DocCur]\r\n      ,K2.[DocTotal]\r\n      ,K2.[DocTotalFC]\r\n      ,K2.[PaidToDate]\r\n      ,K2.[PaidFC]\r\n      ,K2.[Ref1]\r\n      ,K2.[Comments]\r\n      ,K2.[JrnlMemo]\r\n      ,K2.[TransId]\r\n      ,K2.[DocRate]\r\n      ,K2.[SysRate]\r\n      ,K2.[VatSumSy]\r\n      ,K2.[DocTotalSy]\r\n      ,K2.[PaidSys]\r\n      ,K2.[UpdateDate]\r\n      ,K2.[CreateDate]\r\n      ,K2.[TaxDate]\r\n      ,K2.[FinncPriod]\r\n      ,K2.[UserSign]\r\n      ,K2.[VatPaid]\r\n      ,K2.[VatPaidFC]\r\n      ,K2.[VatPaidSys]\r\n      ,K2.[UserSign2]\r\n      ,K2.[LicTradNum]\r\n      ,K2.[WTSum]\r\n      ,K2.[WTSumFC]\r\n      ,K2.[WTSumSC]\r\n      ,K2.[WTApplied]\r\n      ,K2.[WTAppliedF]\r\n      ,K2.[WTAppliedS]\r\n      ,K2.[CtlAccount]\r\n      ,K2.[BaseVtAt]\r\n      ,K2.[BaseVtAtSC]\r\n      ,K2.[BaseVtAtFC]\r\n      ,K2.[NnSbVAt]\r\n      ,K2.[NnSbVAtSC]\r\n      ,K2.[NbSbVAtFC]\r\n      ,K2.[PaidSum]\r\n      ,K2.[PaidSumFc]\r\n      ,K2.[PaidSumSc]\r\n      ,K2.[NnSbAmnt]\r\n      ,K2.[NnSbAmntSC]\r\n      ,K2.[NbSbAmntFC]\r\n      ,K2.[BaseAmnt]\r\n      ,K2.[BaseAmntSC]\r\n      ,K2.[BaseAmntFC]\r\n      ,K2.[U_IDA_NumControl]\r\n      ,K2.[U_IDA_TipoTrans]\r\n      ,K2.[U_IDA_CompIVA]\r\n      ,K2.[U_IDA_FechaComp]\r\n      ,K2.[U_IDA_FechaContComp]\r\n      ,K2.[U_IDA_MontoCompIVA]\r\n      ,K2.[U_IDA_RetenTercero]\r\n      ,K2.[U_IDA_TipoRet]\r\n      ,K2.[U_IDA_Tercero]\r\n      ,K2.[U_IDA_CompISLR]\r\n      ,K2.[U_IDA_DateCompISLR]\r\n      ,K2.[U_IDA_DateContISLR]\r\n      ,K2.[U_IDA_CodSerie]\r\n      ,K2.[U_IDA_Serie]\r\n      ,K2.[U_IDA_Fafe]\r\n      ,K2.[U_IDA_NumExport]\r\n      ,K2.[U_IDA_TipoDoc]\r\n      ,K2.[U_IDA_NumFile]\r\n      ,K2.[U_IDA_NumImport]\r\n      ,K2.[U_IDA_MontoFafe]\r\n      ,K2.[U_IDA_FechaFafe]\r\n      ,K2.[U_IDA_IsPlanilla]\r\n      ,K2.[U_IDA_PagoElectronic]\r\n      ,K2.[U_IDA_Alicuota]\r\n      ,K2.[U_IDA_CompMunicipal]\r\n      ,K2.[U_IDA_DateCompMun]\r\n      ,K2.[U_IDA_CorteZ]\r\n      ,K2.[U_IDA_SerialImpre]\r\n      ,K2.[U_IDA_DocAnulado]\r\n      ,K2.[DocSubType]\r\n      ,K2.[DiscPrcnt]\r\n      ,K2.[DiscSum]\r\n      ,K2.[DiscSumFC]\r\n      ,K2.[DiscSumSy]\r\n      ,K2.[DocTime] \r\n\t\t\tFROM ORIN K2 (NOLOCK)--, OFPR H1 (NOLOCK)\r\n\t\t\tWHERE \r\n\t\t\t\t--H1.Name=@Periodo AND \r\n\t\t\t\tK2.DocDate >= @Desde AND --H1.F_RefDate AND \r\n\t\t\t\tK2.DocDate <= @Hasta --H1.T_RefDate\r\n\t\t\t\tAND K2.U_IDA_TipoTrans<>'05'\r\n\t\t\tUNION ALL\r\n\t\t\tSELECT \r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE1',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE1',\r\n\r\n\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE2',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE2',\r\n\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGasto',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGasto',\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneral',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneral',\r\n\t\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL_OP'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralOP',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL_OP'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralOP',\r\n\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='REDUCIDA' --Rate=8\t--U_IDA_Alicuota='REDUCIDA'\r\n\t\t\t\t\t)  AS 'AlicuotaReducida',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='REDUCIDA' --Rate=8\t--U_IDA_Alicuota='REDUCIDA'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaReducida',\r\n\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='ADICIONAL'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'AlicuotaAdicional',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='ADICIONAL'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaAdicional',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='EXENTO'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaExento',\r\n\t\t\t\t'SI' AS 'COMPROBANTE',\r\n\t\t\t\t'' AS 'NF', \r\n\t\t\t\t'' AS 'ND', \r\n\t\t\t\t'' AS 'NC',\r\n\r\n\t\t\t\tK2.U_IDA_Fafe AS 'FAFE', \r\n\t\t\t\t'' AS 'NroControl',\r\n\t\t\t\tU_IDA_TipoTrans AS 'TipoTran', \r\n\t\t\t\tISNULL(K2.U_IDA_CompIVA,'') AS 'NroComprobante',\r\n\t\t\t\tK2.U_IDA_FechaComp AS 'FechaComp',\r\n\t\t\t\tK2.U_IDA_MontoCompIVA AS 'Retencion',\r\n\t\t\t\t1 AS 'Signo',\r\n\t\t\t\tK2.U_IDA_FechaContComp AS 'FechaContComp', \r\n\t\t\t\t'' as 'NroExport', \r\n\t\t\t\t'' AS 'ExpedienteExport', K2.[DocEntry]\r\n      ,K2.[DocNum]\r\n      ,K2.[Max1099]\r\n      ,K2.[DocType]\r\n      ,K2.[CANCELED]\r\n      ,K2.[DocStatus]\r\n      ,K2.[InvntSttus]\r\n      ,K2.[DocDate]\r\n      ,K2.[DocDueDate]\r\n      ,K2.[CardCode]\r\n      ,K2.[CardName]\r\n      ,K2.[Address]\r\n      ,K2.[Address2]\r\n      ,K2.[ObjType]\r\n      ,K2.[NumAtCard]\r\n      ,K2.[VatSum]\r\n      ,K2.[VatSumFC]\r\n      ,K2.[DocCur]\r\n      ,K2.[DocTotal]\r\n      ,K2.[DocTotalFC]\r\n      ,K2.[PaidToDate]\r\n      ,K2.[PaidFC]\r\n      ,K2.[Ref1]\r\n      ,K2.[Comments]\r\n      ,K2.[JrnlMemo]\r\n      ,K2.[TransId]\r\n      ,K2.[DocRate]\r\n      ,K2.[SysRate]\r\n      ,K2.[VatSumSy]\r\n      ,K2.[DocTotalSy]\r\n      ,K2.[PaidSys]\r\n      ,K2.[UpdateDate]\r\n      ,K2.[CreateDate]\r\n      ,K2.[TaxDate]\r\n      ,K2.[FinncPriod]\r\n      ,K2.[UserSign]\r\n      ,K2.[VatPaid]\r\n      ,K2.[VatPaidFC]\r\n      ,K2.[VatPaidSys]\r\n      ,K2.[UserSign2]\r\n      ,K2.[LicTradNum]\r\n      ,K2.[WTSum]\r\n      ,K2.[WTSumFC]\r\n      ,K2.[WTSumSC]\r\n      ,K2.[WTApplied]\r\n      ,K2.[WTAppliedF]\r\n      ,K2.[WTAppliedS]\r\n      ,K2.[CtlAccount]\r\n      ,K2.[BaseVtAt]\r\n      ,K2.[BaseVtAtSC]\r\n      ,K2.[BaseVtAtFC]\r\n      ,K2.[NnSbVAt]\r\n      ,K2.[NnSbVAtSC]\r\n      ,K2.[NbSbVAtFC]\r\n      ,K2.[PaidSum]\r\n      ,K2.[PaidSumFc]\r\n      ,K2.[PaidSumSc]\r\n      ,K2.[NnSbAmnt]\r\n      ,K2.[NnSbAmntSC]\r\n      ,K2.[NbSbAmntFC]\r\n      ,K2.[BaseAmnt]\r\n      ,K2.[BaseAmntSC]\r\n      ,K2.[BaseAmntFC]\r\n      ,K2.[U_IDA_NumControl]\r\n      ,K2.[U_IDA_TipoTrans]\r\n      ,K2.[U_IDA_CompIVA]\r\n      ,K2.[U_IDA_FechaComp]\r\n      ,K2.[U_IDA_FechaContComp]\r\n      ,K2.[U_IDA_MontoCompIVA]\r\n      ,K2.[U_IDA_RetenTercero]\r\n      ,K2.[U_IDA_TipoRet]\r\n      ,K2.[U_IDA_Tercero]\r\n      ,K2.[U_IDA_CompISLR]\r\n      ,K2.[U_IDA_DateCompISLR]\r\n      ,K2.[U_IDA_DateContISLR]\r\n      ,K2.[U_IDA_CodSerie]\r\n      ,K2.[U_IDA_Serie]\r\n      ,K2.[U_IDA_Fafe]\r\n      ,K2.[U_IDA_NumExport]\r\n      ,K2.[U_IDA_TipoDoc]\r\n      ,K2.[U_IDA_NumFile]\r\n      ,K2.[U_IDA_NumImport]\r\n      ,K2.[U_IDA_MontoFafe]\r\n      ,K2.[U_IDA_FechaFafe]\r\n      ,K2.[U_IDA_IsPlanilla]\r\n      ,K2.[U_IDA_PagoElectronic]\r\n      ,K2.[U_IDA_Alicuota]\r\n      ,K2.[U_IDA_CompMunicipal]\r\n      ,K2.[U_IDA_DateCompMun]\r\n      ,K2.[U_IDA_CorteZ]\r\n      ,K2.[U_IDA_SerialImpre]\r\n      ,K2.[U_IDA_DocAnulado]\r\n      ,K2.[DocSubType]\r\n      ,K2.[DiscPrcnt]\r\n      ,K2.[DiscSum]\r\n      ,K2.[DiscSumFC]\r\n      ,K2.[DiscSumSy]\r\n      ,K2.[DocTime]\r\n\t\t\t\r\n\t\t\tFROM OINV K2 (NOLOCK)--, OFPR H1 (NOLOCK)\r\n--\t\t\tWHERE H1.Name=@Periodo AND K2.U_IDA_FechaContComp >= H1.F_RefDate AND K2.U_IDA_FechaContComp <= H1.T_RefDate AND \r\n\t\t\tWHERE \r\n\t\t\t\t--H1.Name=@Periodo AND \r\n\t\t\t\tK2.U_IDA_FechaContComp >= @Desde and-- H1.F_RefDate AND \r\n\t\t\t\tK2.U_IDA_FechaContComp <= @hasta--H1.T_RefDate\r\n\t\t\t\t AND NOT (K2.DocDate >= @Desde -- H1.F_RefDate \r\n\t\t\t\tAND K2.DocDate <=@Hasta)-- H1.T_RefDate)\r\n\t\t\t        AND K2.U_IDA_TipoTrans<>'05' AND K2.U_IDA_CompIVA<>'' AND K2.U_IDA_CompIVA IS NOT NULL\r\n\t\t\tUNION ALL\r\n\r\n\r\n\t\t\tSELECT \r\n\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE1',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE1',\r\n\r\n\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE2',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE2',\r\n\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGasto',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGasto',\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneral',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneral',\r\n\t\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL_OP'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralOP',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\tU_IDA_Alicuota='GENERAL_OP'--Rate=12--U_IDA_Alicuota='GENERAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralOP',\r\n\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='REDUCIDA' --Rate=8\t--U_IDA_Alicuota='REDUCIDA'\r\n\t\t\t\t\t)  AS 'AlicuotaReducida',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='REDUCIDA' --Rate=8\t--U_IDA_Alicuota='REDUCIDA'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaReducida',\r\n\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='ADICIONAL'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'AlicuotaAdicional',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='ADICIONAL'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaAdicional',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAR] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\tU_IDA_Alicuota='EXENTO'--Rate=20\t--U_IDA_Alicuota='ADICIONAL'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaExento',\r\n\t\t\t\t'SI' AS 'COMPROBANTE',\r\n\t\t\t\t'' AS 'NF', \r\n\t\t\t\t'' AS 'ND', \r\n\t\t\t\t'' AS 'NC',\r\n\t\t\t\tK2.U_IDA_Fafe AS 'FAFE', \r\n\t\t\t\t'' AS 'NroControl',\r\n\t\t\t\tU_IDA_TipoTrans AS 'TipoTran', \r\n\t\t\t\tISNULL(K2.U_IDA_CompIVA,'') AS 'NroComprobante',\r\n\t\t\t\tK2.U_IDA_FechaComp AS 'FechaComp',\r\n\t\t\t\tK2.U_IDA_MontoCompIVA AS 'Retencion',\r\n\t\t\t\t-1 AS 'Signo',\r\n\t\t\t\tK2.U_IDA_FechaContComp AS 'FechaContComp', \r\n\t\t\t\t'' as 'NroExport', '' AS 'ExpedienteExport',K2.[DocEntry]\r\n      ,K2.[DocNum]\r\n      ,K2.[Max1099]\r\n      ,K2.[DocType]\r\n      ,K2.[CANCELED]\r\n      ,K2.[DocStatus]\r\n      ,K2.[InvntSttus]\r\n      ,K2.[DocDate]\r\n      ,K2.[DocDueDate]\r\n      ,K2.[CardCode]\r\n      ,K2.[CardName]\r\n      ,K2.[Address]\r\n      ,K2.[Address2]\r\n      ,K2.[ObjType]\r\n      ,K2.[NumAtCard]\r\n      ,K2.[VatSum]\r\n      ,K2.[VatSumFC]\r\n      ,K2.[DocCur]\r\n      ,K2.[DocTotal]\r\n      ,K2.[DocTotalFC]\r\n      ,K2.[PaidToDate]\r\n      ,K2.[PaidFC]\r\n      ,K2.[Ref1]\r\n      ,K2.[Comments]\r\n      ,K2.[JrnlMemo]\r\n      ,K2.[TransId]\r\n      ,K2.[DocRate]\r\n      ,K2.[SysRate]\r\n      ,K2.[VatSumSy]\r\n      ,K2.[DocTotalSy]\r\n      ,K2.[PaidSys]\r\n      ,K2.[UpdateDate]\r\n      ,K2.[CreateDate]\r\n      ,K2.[TaxDate]\r\n      ,K2.[FinncPriod]\r\n      ,K2.[UserSign]\r\n      ,K2.[VatPaid]\r\n      ,K2.[VatPaidFC]\r\n      ,K2.[VatPaidSys]\r\n      ,K2.[UserSign2]\r\n      ,K2.[LicTradNum]\r\n      ,K2.[WTSum]\r\n      ,K2.[WTSumFC]\r\n      ,K2.[WTSumSC]\r\n      ,K2.[WTApplied]\r\n      ,K2.[WTAppliedF]\r\n      ,K2.[WTAppliedS]\r\n      ,K2.[CtlAccount]\r\n      ,K2.[BaseVtAt]\r\n      ,K2.[BaseVtAtSC]\r\n      ,K2.[BaseVtAtFC]\r\n      ,K2.[NnSbVAt]\r\n      ,K2.[NnSbVAtSC]\r\n      ,K2.[NbSbVAtFC]\r\n      ,K2.[PaidSum]\r\n      ,K2.[PaidSumFc]\r\n      ,K2.[PaidSumSc]\r\n      ,K2.[NnSbAmnt]\r\n      ,K2.[NnSbAmntSC]\r\n      ,K2.[NbSbAmntFC]\r\n      ,K2.[BaseAmnt]\r\n      ,K2.[BaseAmntSC]\r\n      ,K2.[BaseAmntFC]\r\n      ,K2.[U_IDA_NumControl]\r\n      ,K2.[U_IDA_TipoTrans]\r\n      ,K2.[U_IDA_CompIVA]\r\n      ,K2.[U_IDA_FechaComp]\r\n      ,K2.[U_IDA_FechaContComp]\r\n      ,K2.[U_IDA_MontoCompIVA]\r\n      ,K2.[U_IDA_RetenTercero]\r\n      ,K2.[U_IDA_TipoRet]\r\n      ,K2.[U_IDA_Tercero]\r\n      ,K2.[U_IDA_CompISLR]\r\n      ,K2.[U_IDA_DateCompISLR]\r\n      ,K2.[U_IDA_DateContISLR]\r\n      ,K2.[U_IDA_CodSerie]\r\n      ,K2.[U_IDA_Serie]\r\n      ,K2.[U_IDA_Fafe]\r\n      ,K2.[U_IDA_NumExport]\r\n      ,K2.[U_IDA_TipoDoc]\r\n      ,K2.[U_IDA_NumFile]\r\n      ,K2.[U_IDA_NumImport]\r\n      ,K2.[U_IDA_MontoFafe]\r\n      ,K2.[U_IDA_FechaFafe]\r\n      ,K2.[U_IDA_IsPlanilla]\r\n      ,K2.[U_IDA_PagoElectronic]\r\n      ,K2.[U_IDA_Alicuota]\r\n      ,K2.[U_IDA_CompMunicipal]\r\n      ,K2.[U_IDA_DateCompMun]\r\n      ,K2.[U_IDA_CorteZ]\r\n      ,K2.[U_IDA_SerialImpre]\r\n      ,K2.[U_IDA_DocAnulado]\r\n      ,K2.[DocSubType]\r\n      ,K2.[DiscPrcnt]\r\n      ,K2.[DiscSum]\r\n      ,K2.[DiscSumFC]\r\n      ,K2.[DiscSumSy]\r\n      ,K2.[DocTime] \r\n\t\t\t\r\n\t\t\tFROM ORIN K2 (NOLOCK)--, OFPR H1 (NOLOCK)\r\n--\t\t\tWHERE H1.Name=@Periodo AND K2.U_IDA_FechaContComp >= H1.F_RefDate AND K2.U_IDA_FechaContComp <= H1.T_RefDate AND \r\n\t\t\tWHERE \r\n\t\t\t--\tH1.Name=@Periodo AND \r\n\t\t\t\tK2.U_IDA_FechaContComp >= @Desde and --H1.F_RefDate AND \r\n\t\t\t\tK2.U_IDA_FechaContComp <= @Hasta and --H1.T_RefDate AND \r\n\t\t\t\tNOT (K2.DocDate >= @desde --H1.F_RefDate\r\n\t\t\t\t AND K2.DocDate <= @Hasta) --H1.T_RefDate)\r\n                                AND K2.U_IDA_TipoTrans<>'05'\r\n                                AND K2.U_IDA_CompIVA<>'' AND K2.U_IDA_CompIVA IS NOT NULL\r\n)\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[IDA_LIBRO_VENTAS_SEMANAL]\r\n(\t\r\n    @Desde AS DATE,\r\n\t@Hasta AS DATE\r\n)\r\nRETURNS TABLE \r\nWITH ENCRYPTION \r\n\r\nAS\r\nRETURN \r\n(\r\n\r\nSELECT  \r\nT0.DocEntry AS 'DocEntry',\r\nT5.CompnyName as 'Agente', \r\nT5.TaxIdNum AS 'RIF Agente',\r\nT5.CompnyAddr AS 'Direccion Agente',\r\n--CASE WHEN T0.COMPROBANTE='SI' THEN T0.FechaComp ELSE T0.DocDate END AS 'Fecha',\r\n--EML 20130605 SE CAMBIO NUEVAMENTE DESPUES DE REVISAR EL LIBRO DE VENTAS DE YG OJO EML\r\n--T0.DocDate AS 'Fecha',\r\nCASE WHEN T0.COMPROBANTE='SI' THEN T0.FechaContComp ELSE T0.DocDate END AS 'Fecha',\r\n--ISNULL(T0.FAFE,'') as 'Nro. de Factura Afectada',\r\n--CASE (len(ISNULL(T0.FAFE,''))-9) when '0' then convert(int,substring(CONVERT(char(9),ISNULL(T0.FAFE,'')),2,8)) else ISNULL(T0.FAFE,'') end  AS 'Nro. de Factura Afectada',\r\nCASE (len(ISNULL(T0.FAFE,''))-9) when '0' then convert(VARCHAR,substring(CONVERT(char(9),ISNULL(T0.FAFE,'')),2,8)) else ISNULL(T0.FAFE,'') end  AS 'Nro. de Factura Afectada',\r\n\r\nT0.CardName as 'Nombre o Razon Social',\r\nCASE WHEN T0.LicTradNum='J-999999999' THEN 'ND' ELSE T0.LicTradNum END as 'RIF',\r\nCASE WHEN  T0.FechaContComp>=@Desde AND T0.FechaContComp<=@Hasta \r\nTHEN T0.NroComprobante END AS 'Nro. Comprobante de IVA',\r\nCASE WHEN  T0.FechaContComp>=@Desde AND T0.FechaContComp<=@Hasta \r\nTHEN CONVERT(DATETIME,T0.FechaComp,112)  END AS 'Fecha Comprobante',\r\nT0.NroExport AS 'Planilla de importacion',\r\nT0.NroExport AS 'Expediente de importacion',\r\n CASE WHEN T0.U_IDA_DocAnulado='02' THEN 'ANULADO' ELSE CASE \r\n                                WHEN T0.TipoTran='01' THEN '01-Reg' \r\n                                WHEN T0.TipoTran='02' THEN '02-Comp'\r\n                                WHEN T0.TipoTran='03' THEN '03-Anu' \r\n                                WHEN T0.TipoTran='04' THEN '04-Aju'\r\n                                END END AS 'Tipo Transaccion',\r\nT0.NF AS 'Nro. de Factura',\r\nT0.NroControl AS 'Nro. de Contol',\r\nT0.ND as 'Nro. de Debito' ,\r\nT0.NC as 'Nro. de Credito',\r\nT0.FAFE as 'Factura Afectada',\r\n--CASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN \r\n--CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.ObjType='14' THEN (-1)*T0.DocTotal ELSE T0.DocTotal end  end \r\n--ELSE 0 END  END AS 'Total',\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN \r\nCASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.ObjType='14' THEN (-1)*T0.Max1099 ELSE T0.Max1099 end  end \r\nELSE 0 END  END AS 'Total',\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN T0.NroExport <>'' THEN CASE WHEN T0.ObjType='14' THEN (-1)*T0.Max1099 ELSE T0.Max1099 end  ELSE 0 END END AS 'Total EXTERNO', --T0.DocTotal\r\n\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneral,T0.CodigoAlicuotaGeneral,'V') ELSE 0 END END END AS 'Base Imponible (GENERAL)',\r\nT0.AlicuotaGeneral AS 'Alicuota (GENERAL)', --12\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN ((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneral,T0.CodigoAlicuotaGeneral,'V') * T0.AlicuotaGeneral)/100)  ELSE 0 END END END AS 'IVA (GENERAL)',\r\n\r\n\r\n\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneralE1,T0.CodigoAlicuotaGeneralE1,'V') ELSE 0 END END END AS 'Base Imponible (GENERAL E1)',\r\nT0.AlicuotaGeneralE1 AS 'Alicuota (GENERAL E1)', --12\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN ((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneralE1,T0.CodigoAlicuotaGeneralE1,'V') * T0.AlicuotaGeneralE1)/100)  ELSE 0 END END END AS 'IVA (GENERAL E1)',\r\n\r\n\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneralE2,T0.CodigoAlicuotaGeneralE2,'V') ELSE 0 END END END AS 'Base Imponible (GENERAL E2)',\r\nT0.AlicuotaGeneralE2 AS 'Alicuota (GENERAL E2)', --12\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN ((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneralE2,T0.CodigoAlicuotaGeneralE2,'V') * T0.AlicuotaGeneralE2)/100)  ELSE 0 END END END AS 'IVA (GENERAL E2)',\r\n\r\n\r\n\r\n\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneral,T0.CodigoAlicuotaGeneralOP,'V') ELSE 0 END END END AS 'Base Imponible (GENERAL OP)',\r\nT0.AlicuotaGeneralOP AS 'Alicuota (GENERAL OP)', --12\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN ((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneral,T0.CodigoAlicuotaGeneral,'V') * T0.AlicuotaGeneralOP)/100)  ELSE 0 END END END AS 'IVA (GENERAL OP)',\r\n\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T0.AlicuotaReducida,T0.CodigoAlicuotaReducida,'V') ELSE 0 END END END AS 'Base Imponible (REDUCIDA)',\r\nT0.AlicuotaReducida AS 'Alicuota (REDUCIDA)', -- 8\r\n\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN ((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T0.AlicuotaReducida,T0.CodigoAlicuotaReducida,'V') * T0.AlicuotaReducida)/100) ELSE 0 END END END AS 'IVA (REDUCIDA)',\r\n\r\n--dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, 0,'V') AS 'Base Imponible (EXENTA)',\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN T0.NroExport ='' THEN \r\nCASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, 0,T0.CodigoAlicuotaExento,'V') end \r\nELSE 0 END END AS 'Base Imponible (EXENTA)',\r\n0 AS 'Alicuota (EXENTA)',\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE ((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, 0,T0.CodigoAlicuotaExento,'V') *0)/100) END AS 'EXENTO, NO SUJETO',\r\n\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T0.AlicuotaAdicional,T0.CodigoAlicuotaAdicional,'V') END END AS 'Base Imponible (ADICIONAL)',\r\nT0.AlicuotaAdicional AS 'Alicuota (ADICIONAL)', --20\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.COMPROBANTE='SI' THEN 0 ELSE ((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T0.AlicuotaAdicional,T0.CodigoAlicuotaAdicional,'V') * T0.AlicuotaAdicional)/100) END END AS 'IVA (ADICIONAL)'\r\n,\r\nCASE WHEN T0.U_IDA_DocAnulado='02' THEN 0 ELSE CASE WHEN  T0.FechaContComp>=@Desde AND T0.FechaContComp<=@Hasta THEN CASE WHEN T0.ObjType='14' THEN CASE WHEN T0.U_IDA_MontoCompIVA>0 THEN (-1)* T0.U_IDA_MontoCompIVA ELSE  T0.U_IDA_MontoCompIVA END  ELSE T0.U_IDA_MontoCompIVA  END ELSE 0.00 END  END AS 'Retencion IVA',\r\nT0.DocTime,\r\n\r\n--CASE WHEN T0.COMPROBANTE='SI' THEN 'COMPROBANTES OTROS MESES' ELSE CASE \r\n--WHEN T0.TipoTran='04' THEN 'AJUSTES' ELSE '_'END  END AS 'ID',\r\n--eml 20130605 ojo esto es para agrupar libro de ventas ojo\r\n\r\n'_' AS 'ID',\r\nT0.U_IDA_Serie AS 'Serie'\r\n\r\nFROM \r\ndbo.O_IDAV_SEMANAL(@Desde,@Hasta) T0,\r\n--dbo.O_IDAV('2013-01') T0,\r\n--dbo.O_IDA1() T1, \r\n--dbo.O_IDA5() T2, \r\n--OWHT T4, \r\nOADM T5 (NOLOCK)--, OFPR \r\n\r\n--WHERE \r\n\t--Name=@Periodo\r\n--\tName='2013-01'\r\n\t\r\n--ORDER BY T0.DocDate, T0.DocTime, T0.U_IDA_NroControl  \r\n\r\n)\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[O_IDA_SEMANAL] \r\n(\t\r\n  @Desde AS DATE,\r\n  @Hasta AS DATE\r\n)\r\n\r\nRETURNS TABLE\r\nWITH ENCRYPTION \r\nAS\r\nRETURN \r\n(\r\n\r\n\t\t\tSELECT \r\n\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGastoE1',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGastoE1',\r\n\r\n\r\n\t\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGastoE2',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGastoE2',\r\n\r\n\r\n\r\n\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE1',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE1',\r\n\r\n\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE2',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE2',\r\n\r\n\r\n\t\t\t\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GASTO') -- Rate=12  )-- U_IDA_Alicuota='GASTO') \r\n AS 'AlicuotaGasto'\r\n\t\t\t,\r\n\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GASTO') -- Rate=12  )-- U_IDA_Alicuota='GASTO') \r\n AS 'CodigoAlicuotaGasto'\r\n\t\t\t,\r\n\t\t\t\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GENERAL') -- Rate=12  )-- U_IDA_Alicuota='GENERAL') \r\n AS 'AlicuotaGeneral'\r\n\t\t\t,\r\n\t\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GENERAL') -- Rate=12  )-- U_IDA_Alicuota='GENERAL') \r\n AS 'CodigoAlicuotaGeneral'\r\n\t\t\t,\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='REDUCIDA')-- Rate = 8 )--U_IDA_Alicuota='REDUCIDA') \r\n AS 'AlicuotaReducida'\r\n\t\t\t,\r\n\t\t\t\r\n\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='REDUCIDA')-- Rate = 8 )--U_IDA_Alicuota='REDUCIDA') \r\n AS 'CodigoAlicuotaReducida'\r\n\t\t\t,\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='ADICIONAL')--Rate=20 )--U_IDA_Alicuota='ADICIONAL') \r\n AS 'AlicuotaAdicional'\r\n\t\t\t,\r\n\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='ADICIONAL')--Rate=20 )--U_IDA_Alicuota='ADICIONAL') \r\n AS 'CodigoAlicuotaAdicional'\r\n\t\t\t,\r\n\t\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='EXENTO')--Rate=20 )--U_IDA_Alicuota='ADICIONAL') \r\n AS 'CodigoAlicuotaExento'\r\n\t\t\t,\r\n\t\t\tH2.U_IDA_TipoPersona AS 'TipoPersona',\r\n\t\t\tISNULL(CASE WHEN DocSubType='--' THEN NumAtCard END,'') AS 'NF', \r\n\t\t\tISNULL(CASE WHEN DocSubType<>'--' THEN NumAtCard END,'') AS 'ND', \r\n\t\t\t'' AS 'NC',\r\n\t\t\t'' AS 'FAFE',ISNULL(K2.U_IDA_Serie,'') + ISNULL(K2.U_IDA_NumControl,'') AS 'NroControl',K2.U_IDA_TipoTrans AS 'TipoTran',\r\n\t\t\tISNULL(K2.U_IDA_CompIVA,'') AS 'NroComprobante',ISNULL(K2.DocDate,'') AS 'FechaComp' ,\r\n\t\t\tISNULL(K2.U_IDA_NumImport,'') AS 'NroImportacion', ISNULL(K2.U_IDA_NumFile,'') AS 'ExpedienteImp',\r\n\t\t\tISNULL(U_IDA_RetenTercero,'N') AS 'RetencionTercero',\r\n\t\t\tISNULL(U_IDA_Tercero,'') AS 'Tercero',\r\n\t\t\tISNULL(U_IDA_TipoRet,'') AS 'TipoRet',\r\n\t\t\tISNULL(U_IDA_IsPlanilla,'') AS 'IsPlanilla',\r\n\t\t\tK2.[DocEntry]\r\n      ,K2.[DocNum]\r\n      ,K2.[Max1099]\r\n      ,K2.[DocType]\r\n      ,K2.[CANCELED]\r\n      ,K2.[DocStatus]\r\n      ,K2.[InvntSttus]\r\n      ,K2.[DocDate]\r\n      ,K2.[DocDueDate]\r\n      ,K2.[CardCode]\r\n      ,K2.[CardName]\r\n      ,K2.[Address]\r\n      ,K2.[Address2]\r\n      ,K2.[ObjType]\r\n      ,K2.[NumAtCard]\r\n      ,K2.[VatSum]\r\n      ,K2.[VatSumFC]\r\n      ,K2.[DocCur]\r\n      ,K2.[DocTotal]\r\n      ,K2.[DocTotalFC]\r\n      ,K2.[PaidToDate]\r\n      ,K2.[PaidFC]\r\n      ,K2.[Ref1]\r\n      ,K2.[Comments]\r\n      ,K2.[JrnlMemo]\r\n      ,K2.[TransId]\r\n      ,K2.[DocRate]\r\n      ,K2.[SysRate]\r\n      ,K2.[VatSumSy]\r\n      ,K2.[DocTotalSy]\r\n      ,K2.[PaidSys]\r\n      ,K2.[UpdateDate]\r\n      ,K2.[CreateDate]\r\n      ,K2.[TaxDate]\r\n      ,K2.[FinncPriod]\r\n      ,K2.[UserSign]\r\n      ,K2.[VatPaid]\r\n      ,K2.[VatPaidFC]\r\n      ,K2.[VatPaidSys]\r\n      ,K2.[UserSign2]\r\n      ,K2.[LicTradNum]\r\n      ,K2.[WTSum]\r\n      ,K2.[WTSumFC]\r\n      ,K2.[WTSumSC]\r\n      ,K2.[WTApplied]\r\n      ,K2.[WTAppliedF]\r\n      ,K2.[WTAppliedS]\r\n      ,K2.[CtlAccount]\r\n      ,K2.[BaseVtAt]\r\n      ,K2.[BaseVtAtSC]\r\n      ,K2.[BaseVtAtFC]\r\n      ,K2.[NnSbVAt]\r\n      ,K2.[NnSbVAtSC]\r\n      ,K2.[NbSbVAtFC]\r\n      ,K2.[PaidSum]\r\n      ,K2.[PaidSumFc]\r\n      ,K2.[PaidSumSc]\r\n      ,K2.[NnSbAmnt]\r\n      ,K2.[NnSbAmntSC]\r\n      ,K2.[NbSbAmntFC]\r\n      ,K2.[BaseAmnt]\r\n      ,K2.[BaseAmntSC]\r\n      ,K2.[BaseAmntFC]\r\n      ,K2.[U_IDA_NumControl]\r\n      ,K2.[U_IDA_TipoTrans]\r\n      ,K2.[U_IDA_CompIVA]\r\n      ,K2.[U_IDA_FechaComp]\r\n      ,K2.[U_IDA_FechaContComp]\r\n      ,K2.[U_IDA_MontoCompIVA]\r\n      ,K2.[U_IDA_RetenTercero]\r\n      ,K2.[U_IDA_TipoRet]\r\n      ,K2.[U_IDA_Tercero]\r\n      ,K2.[U_IDA_CompISLR]\r\n      ,K2.[U_IDA_DateCompISLR]\r\n      ,K2.[U_IDA_DateContISLR]\r\n      ,K2.[U_IDA_CodSerie]\r\n      ,K2.[U_IDA_Serie]\r\n      ,K2.[U_IDA_Fafe]\r\n      ,K2.[U_IDA_NumExport]\r\n      ,K2.[U_IDA_TipoDoc]\r\n      ,K2.[U_IDA_NumFile]\r\n      ,K2.[U_IDA_NumImport]\r\n      ,K2.[U_IDA_MontoFafe]\r\n      ,K2.[U_IDA_FechaFafe]\r\n      ,K2.[U_IDA_IsPlanilla]\r\n      ,K2.[U_IDA_PagoElectronic]\r\n      ,K2.[U_IDA_Alicuota]\r\n      ,K2.[U_IDA_CompMunicipal]\r\n      ,K2.[U_IDA_DateCompMun]\r\n      ,K2.[U_IDA_CorteZ]\r\n      ,K2.[U_IDA_SerialImpre]\r\n      ,K2.[U_IDA_DocAnulado]\r\n      ,K2.[DocSubType]\r\n      ,K2.[DiscPrcnt]\r\n      ,K2.[DiscSum]\r\n      ,K2.[DiscSumFC]\r\n      ,K2.[DiscSumSy]\r\n      ,K2.[DocTime] FROM OPCH K2 (NOLOCK) --,OFPR H1 (NOLOCK)  \r\n\t\t\t, OCRD H2 (NOLOCK)  WHERE --H1.Name=@Periodo AND\r\n\t\t\t  K2.DocDate >= @desde --H1.F_RefDate \r\n\t\t\tAND K2.DocDate <= @hasta --H1.T_RefDate \r\n\t\t\tAND K2.CardCode=H2.CardCode AND H2.U_IDA_TipoPersona<>'PJND'\r\n\t\t\t AND  H2.U_IDA_TipoPersona<>'PNNR' AND K2.U_IDA_TipoTrans<>'05'\r\n\t\t\t --, [@BKV_RECEIPT] K3 WHERE K2.DocEntry= --K2.DocEntry=@DocEntry AND ObjType=@ObjType \r\n\t\t\t\t\r\n\t\t\t\tUNION ALL\r\n\t\t\t\t\r\n\t\t\tSELECT\t\r\n\t\t\t\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGastoE1',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGastoE1',\r\n\r\n\r\n\t\t\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGastoE2',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GASTO_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGastoE2',\t\r\n\t\t\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE1',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E1' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE1',\r\n\r\n\t(SELECT Rate \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'AlicuotaGeneralE2',\r\n\t\t\t\t\t(SELECT Code \r\n\t\t\t\tFROM OSTC (NOLOCK) \r\n\t\t\t\tWHERE \r\n\t\t\t\t\t[ValidForAP] = 'Y' and [Lock] = 'N' AND \r\n\t\t\t\t\t\r\n\t\t\t\tU_IDA_Alicuota='GENERAL_E2' --Rate=12\t--U_IDA_Alicuota='GASTO'\r\n\t\t\t\t\t)  AS 'CodigoAlicuotaGeneralE2',\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GASTO') -- Rate=12  )-- U_IDA_Alicuota='GASTO') \r\n AS 'AlicuotaGasto'\r\n\t\t\t,\r\n\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GASTO') -- Rate=12  )-- U_IDA_Alicuota='GASTO') \r\n AS 'CodigoAlicuotaGasto'\r\n\t\t\t,\r\n\t\t\t\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GENERAL') -- Rate=12  )-- U_IDA_Alicuota='GENERAL') \r\n AS 'AlicuotaGeneral'\r\n\t\t\t,\r\n\t\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GENERAL') -- Rate=12  )-- U_IDA_Alicuota='GENERAL') \r\n AS 'CodigoAlicuotaGeneral'\r\n\t\t\t,\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='REDUCIDA')-- Rate = 8 )--U_IDA_Alicuota='REDUCIDA') \r\n AS 'AlicuotaReducida'\r\n\t\t\t,\r\n\t\t\t\r\n\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='REDUCIDA')-- Rate = 8 )--U_IDA_Alicuota='REDUCIDA') \r\n AS 'CodigoAlicuotaReducida'\r\n\t\t\t,\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='ADICIONAL')--Rate=20 )--U_IDA_Alicuota='ADICIONAL') \r\n AS 'AlicuotaAdicional'\r\n\t\t\t,\r\n\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='ADICIONAL')--Rate=20 )--U_IDA_Alicuota='ADICIONAL') \r\n AS 'CodigoAlicuotaAdicional'\r\n\t\t\t,\r\n\t\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='EXENTO')--Rate=20 )--U_IDA_Alicuota='ADICIONAL') \r\n AS 'CodigoAlicuotaExento'\r\n\t\t\t,\r\n\t\t\tH2.U_IDA_TipoPersona AS 'TipoPersona',\r\n\t\t\t'' AS 'NF', '' AS 'ND',  NumAtCard AS 'NC',K2.U_IDA_Fafe AS 'FAFE',\r\n\t\t\tISNULL(K2.U_IDA_Serie,'') + ISNULL(K2.U_IDA_NumControl,'') AS 'NroControl', U_IDA_TipoTrans  AS 'TipoTran', \r\n\t\t\tISNULL(K2.U_IDA_CompIVA,'') AS 'NroComprobante',ISNULL(K2.DocDate,'') \r\n\t\t\tAS 'FechaComp' ,\r\n\t\t\tISNULL(K2.U_IDA_NumImport,'') AS 'NroImportacion', ISNULL(K2.U_IDA_NumFile,'') AS 'ExpedienteImp',\r\n\t\t\tISNULL(U_IDA_RetenTercero,'N') AS 'RetencionTercero',\r\n\t\t\tISNULL(U_IDA_Tercero,'') AS 'Tercero',\r\n\t\t\tISNULL(U_IDA_TipoRet,'') AS 'TipoRet',\r\n\t\t\tISNULL(U_IDA_IsPlanilla,'') AS 'IsPlanilla',\r\n\t\t\tK2.[DocEntry]\r\n      ,K2.[DocNum]\r\n      ,K2.[Max1099]\r\n      ,K2.[DocType]\r\n      ,K2.[CANCELED]\r\n      ,K2.[DocStatus]\r\n      ,K2.[InvntSttus]\r\n      ,K2.[DocDate]\r\n      ,K2.[DocDueDate]\r\n      ,K2.[CardCode]\r\n      ,K2.[CardName]\r\n      ,K2.[Address]\r\n      ,K2.[Address2]\r\n      ,K2.[ObjType]\r\n      ,K2.[NumAtCard]\r\n      ,K2.[VatSum]\r\n      ,K2.[VatSumFC]\r\n      ,K2.[DocCur]\r\n      ,K2.[DocTotal]\r\n      ,K2.[DocTotalFC]\r\n      ,K2.[PaidToDate]\r\n      ,K2.[PaidFC]\r\n      ,K2.[Ref1]\r\n      ,K2.[Comments]\r\n      ,K2.[JrnlMemo]\r\n      ,K2.[TransId]\r\n      ,K2.[DocRate]\r\n      ,K2.[SysRate]\r\n      ,K2.[VatSumSy]\r\n      ,K2.[DocTotalSy]\r\n      ,K2.[PaidSys]\r\n      ,K2.[UpdateDate]\r\n      ,K2.[CreateDate]\r\n      ,K2.[TaxDate]\r\n      ,K2.[FinncPriod]\r\n      ,K2.[UserSign]\r\n      ,K2.[VatPaid]\r\n      ,K2.[VatPaidFC]\r\n      ,K2.[VatPaidSys]\r\n      ,K2.[UserSign2]\r\n      ,K2.[LicTradNum]\r\n      ,K2.[WTSum]\r\n      ,K2.[WTSumFC]\r\n      ,K2.[WTSumSC]\r\n      ,K2.[WTApplied]\r\n      ,K2.[WTAppliedF]\r\n      ,K2.[WTAppliedS]\r\n      ,K2.[CtlAccount]\r\n      ,K2.[BaseVtAt]\r\n      ,K2.[BaseVtAtSC]\r\n      ,K2.[BaseVtAtFC]\r\n      ,K2.[NnSbVAt]\r\n      ,K2.[NnSbVAtSC]\r\n      ,K2.[NbSbVAtFC]\r\n      ,K2.[PaidSum]\r\n      ,K2.[PaidSumFc]\r\n      ,K2.[PaidSumSc]\r\n      ,K2.[NnSbAmnt]\r\n      ,K2.[NnSbAmntSC]\r\n      ,K2.[NbSbAmntFC]\r\n      ,K2.[BaseAmnt]\r\n      ,K2.[BaseAmntSC]\r\n      ,K2.[BaseAmntFC]\r\n      ,K2.[U_IDA_NumControl]\r\n      ,K2.[U_IDA_TipoTrans]\r\n      ,K2.[U_IDA_CompIVA]\r\n      ,K2.[U_IDA_FechaComp]\r\n      ,K2.[U_IDA_FechaContComp]\r\n      ,K2.[U_IDA_MontoCompIVA]\r\n      ,K2.[U_IDA_RetenTercero]\r\n      ,K2.[U_IDA_TipoRet]\r\n      ,K2.[U_IDA_Tercero]\r\n      ,K2.[U_IDA_CompISLR]\r\n      ,K2.[U_IDA_DateCompISLR]\r\n      ,K2.[U_IDA_DateContISLR]\r\n      ,K2.[U_IDA_CodSerie]\r\n      ,K2.[U_IDA_Serie]\r\n      ,K2.[U_IDA_Fafe]\r\n      ,K2.[U_IDA_NumExport]\r\n      ,K2.[U_IDA_TipoDoc]\r\n      ,K2.[U_IDA_NumFile]\r\n      ,K2.[U_IDA_NumImport]\r\n      ,K2.[U_IDA_MontoFafe]\r\n      ,K2.[U_IDA_FechaFafe]\r\n      ,K2.[U_IDA_IsPlanilla]\r\n      ,K2.[U_IDA_PagoElectronic]\r\n      ,K2.[U_IDA_Alicuota]\r\n      ,K2.[U_IDA_CompMunicipal]\r\n      ,K2.[U_IDA_DateCompMun]\r\n      ,K2.[U_IDA_CorteZ]\r\n      ,K2.[U_IDA_SerialImpre]\r\n      ,K2.[U_IDA_DocAnulado]\r\n      ,K2.[DocSubType]\r\n      ,K2.[DiscPrcnt]\r\n      ,K2.[DiscSum]\r\n      ,K2.[DiscSumFC]\r\n      ,K2.[DiscSumSy]\r\n      ,K2.[DocTime] FROM ORPC K2 (NOLOCK) --,OFPR H1 (NOLOCK)\r\n\t\t\t , OCRD H2 (NOLOCK)\r\n\t\t\t WHERE -- H1.Name=@Periodo AND \r\n\t\t\t K2.DocDate >= @Desde\r\n\t\t\t-- H1.F_RefDate \r\n\t\t\t AND K2.DocDate <= @Hasta--H1.T_RefDate\r\n\t\t\t  AND K2.CardCode=H2.CardCode AND H2.U_IDA_TipoPersona<>'PJND' AND  H2.U_IDA_TipoPersona<>'PNNR'\r\n\t\t\tAND K2.U_IDA_TipoTrans<>'05' --WHERE H1.Name=@Periodo\r\n\t\t\t--WHERE K2.DocEntry=@DocEntry AND ObjType=@ObjType\r\n\r\n\r\n)\r\n\r\n\r\nGO\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[IDA_LIBRO_COMPRAS_SEMANAL]\r\n(\t\r\n    @Desde  AS DATE,--AS VARCHAR(100)\r\n\t@Hasta AS DATE\r\n)\r\nRETURNS TABLE \r\nWITH ENCRYPTION \r\n\r\nAS\r\nRETURN \r\n(\r\nSELECT  \r\nT0.ObjType,\r\nT0.DocEntry AS 'DocEntry',\r\nT5.CompnyName as 'Agente', \r\nT5.TaxIdNum AS 'RIF Agente',\r\nT5.CompnyAddr AS 'Direccion Agente',\r\nT0.TaxDate  AS 'Fecha',\r\nISNULL(T0.FAFE,'') as 'Nro. de Factura Afectada',\r\n--T0.CardName  as 'Nombre o Razon Social'\r\nCASE WHEN T0.RetencionTercero='Y' THEN CASE WHEN T0.TipoRet='IVA' THEN T0.Tercero  WHEN T0.TipoRet='Todas' THEN T0.Tercero ELSE T0.CardName END ELSE T0.CardName END \r\nas 'Nombre o Razon Social',\r\nCASE WHEN T0.LicTradNum='J-999999999' THEN 'ND' ELSE (CASE WHEN T0.RetencionTercero='Y' THEN CASE WHEN T0.TipoRet='IVA' THEN (SELECT TOP 1 LicTradNum FROM OCRD WHERE CardName=T0.Tercero AND CardType = 'S') WHEN T0.TipoRet='Todas' THEN (SELECT TOP 1 LicTradNum FROM OCRD WHERE CardName=T0.Tercero AND CardType = 'S') ELSE T0.LicTradNum  END  ELSE T0.LicTradNum  END) END as 'RIF',\r\n\r\n--CASE WHEN T0.LicTradNum='J-999999999' THEN 'ND' ELSE T0.LicTradNum END as 'RIF',\r\n CASE \r\n                                WHEN T0.TipoTran='01' THEN '01-Reg' \r\n                                WHEN T0.TipoTran='02' THEN '02-Comp'\r\n                                WHEN T0.TipoTran='03' THEN '03-Anu' \r\n                                WHEN T0.TipoTran='04' THEN '04-Aju'\r\n                                END AS 'Tipo Transaccion',\r\nT0.NroComprobante AS 'Nro. Comprobante de IVA',\r\ncase T0.NroComprobante when '' then null else T0.FechaComp end AS 'Fecha Comprobante',\r\nT0.NroImportacion AS 'Planilla de importacion',\r\nT0.ExpedienteImp AS 'Expediente de importacion',\r\nT0.NF AS 'Nro. de Factura',\r\nCASE WHEN T0.IsPlanilla='Y' THEN '' ELSE T0.NroControl END AS 'Nro. de Contol',\r\nT0.ND as 'Nro. de Debito' ,\r\nT0.NC as 'Nro. de Credito',\r\nCASE WHEN T0.IsPlanilla='Y' THEN dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneral,T0.CodigoAlicuotaGeneral,'C') +dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,0,T0.CodigoAlicuotaExento,'C') +T0.VatSum ELSE\r\n(CASE WHEN T0.ObjType='18' THEN 1 WHEN T0.ObjType='19' THEN (-1) END)* T0.Max1099 END AS 'Total',\r\nCASE WHEN T0.IsPlanilla='Y' THEN 0 ELSE dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneral,T0.CodigoAlicuotaGeneral,'C') end  AS 'Base Imponible (GENERAL)',\r\nT0.AlicuotaGeneral AS 'Alicuota (GENERAL)', --12\r\nCASE WHEN T0.IsPlanilla='Y' THEN 0 ELSE \r\n\t((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,\t\r\n\t\tT0.AlicuotaGeneral,T0.CodigoAlicuotaGeneral,\r\n\t\t\t\t\t\t'C') *T0.AlicuotaGeneral)/100) end AS 'IVA (GENERAL)',\r\n\r\n\r\n\t\t\t\t\t\tCASE WHEN T0.IsPlanilla='Y' THEN 0 ELSE dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneralE1,T0.CodigoAlicuotaGeneralE1,'C') end  AS 'Base Imponible (GENERAL E1)',\r\nT0.AlicuotaGeneralE1 AS 'Alicuota (GENERAL E1)', --12\r\nCASE WHEN T0.IsPlanilla='Y' THEN 0 ELSE \r\n\t((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,\t\r\n\t\tT0.AlicuotaGeneralE1,T0.CodigoAlicuotaGeneralE1,\r\n\t\t\t\t\t\t'C') *T0.AlicuotaGeneralE1)/100) end AS 'IVA (GENERAL E1)',\r\n\r\n\r\n\tCASE WHEN T0.IsPlanilla='Y' THEN 0 ELSE dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneralE2,T0.CodigoAlicuotaGeneralE2,'C') end  AS 'Base Imponible (GENERAL E2)',\r\nT0.AlicuotaGeneralE2 AS 'Alicuota (GENERAL E2)', --12\r\nCASE WHEN T0.IsPlanilla='Y' THEN 0 ELSE \r\n\t((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,\t\r\n\t\tT0.AlicuotaGeneralE2,T0.CodigoAlicuotaGeneralE2,\r\n\t\t\t\t\t\t'C') *T0.AlicuotaGeneralE2)/100) end AS 'IVA (GENERAL E2)',\r\n\r\n\r\ndbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T0.AlicuotaReducida,T0.CodigoAlicuotaReducida,'C') AS 'Base Imponible (REDUCIDA)',\r\n\r\n T0.AlicuotaReducida AS 'Alicuota (REDUCIDA)', --8\r\n\r\nCASE WHEN T0.IsPlanilla='Y' THEN 0 ELSE ((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T0.AlicuotaReducida,T0.CodigoAlicuotaReducida,'C') *T0.AlicuotaReducida)/100) end AS 'IVA (REDUCIDA)',\r\n\r\n--CASE WHEN T0.IsPlanilla='Y' THEN CASE WHEN T0.VatSum=0 THEN dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, 0,'C')  ELSE 0 END ELSE \r\ndbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, 0,T0.CodigoAlicuotaExento,'C') +  \r\n-- se agrego esta funcionalidad para las compras sin derecho a credito fiscal\r\ndbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T0.AlicuotaGasto,T0.CodigoAlicuotaGasto,'C') \r\n--END \r\n+ dbo.IDA_ImpuestoNoDeducible(T0.ObjType,T0.DocEntry,T0.CodigoAlicuotaGasto,'C')\r\n\r\n-- OJO ESTO ES POR LA NUEVA ALICUOTA ELECTRONICA \r\n+ dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T0.AlicuotaGastoE1,T0.CodigoAlicuotaGastoE1,'C')   \r\n+ dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T0.AlicuotaGastoE2,T0.CodigoAlicuotaGastoE2,'C') \r\n+ dbo.IDA_ImpuestoNoDeducible(T0.ObjType,T0.DocEntry,T0.CodigoAlicuotaGastoE1,'C')\r\n+ dbo.IDA_ImpuestoNoDeducible(T0.ObjType,T0.DocEntry,T0.CodigoAlicuotaGastoE2,'C')\r\n-- OJO ESTO ES POR LA NUEVA ALICUOTA ELECTRONICA \r\nAS 'Base Imponible (EXENTA)',\r\n\r\n0 AS 'Alicuota (EXENTA)',\r\n((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, 0,T0.CodigoAlicuotaExento,'C') *0)/100) AS 'EXENTO, NO SUJETO',\r\n\r\ndbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T0.AlicuotaAdicional,T0.CodigoAlicuotaAdicional,'C') AS 'Base Imponible (ADICIONAL)',\r\nT0.AlicuotaAdicional AS 'Alicuota (ADICIONAL)', --20\r\n\r\n((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, t0.AlicuotaAdicional,T0.CodigoAlicuotaAdicional,'C') *t0.AlicuotaAdicional)/100) AS 'IVA (ADICIONAL)',\r\n\r\n\r\nCASE WHEN T0.IsPlanilla='Y' THEN 0 ELSE dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGasto,T0.CodigoAlicuotaGasto,'C') end  AS 'Base Imponible (GASTO)',\r\nT0.AlicuotaGasto AS 'Alicuota (GASTO)', --12\r\n\r\n(CASE WHEN T0.ObjType='18' THEN 1 WHEN T0.ObjType='19' THEN (-1) END)* ISNULL(T2.WTAmnt,0)  'Retencion',\r\nCASE WHEN T0.U_IDA_RetenTercero='Y' THEN (CASE WHEN T0.ObjType='18' THEN 1 WHEN T0.ObjType='19' THEN (-1) END)* ISNULL(T2.WTAmnt,0) ELSE 0 END  'RetencionTercero',\r\nT0.DocTime AS 'DocTime',\r\n(SELECT VatStatus FROM OCRD WHERE CardCode=T0.CardCode) AS 'VatStatus'\r\n, T0.DocDate as 'Fecha Contable' \r\n, T0.TipoPersona\r\n,CASE WHEN T0.IsPlanilla='Y' THEN dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry,T0.AlicuotaGeneral,T0.CodigoAlicuotaGeneral,'C') --T0.U_BASE_IMP \r\nELSE 0 END AS 'Base Imponible Importacion'\r\n,CASE WHEN T0.IsPlanilla='Y' THEN \r\n\t\t\t\t\tT0.VatSum\t\r\n\t\t\t\tELSE 0 END AS 'IVA Importacion'\r\n, 12 as '% Alicuota IMP'\r\nFROM \r\ndbo.O_IDA_SEMANAL(@Desde,@Hasta) T0 LEFT OUTER JOIN \r\n--dbo.O_IDA1() T1, \r\ndbo.O_IDA5() T2  ON T0.DocEntry=T2.AbsEntry  AND T2.BaseType='V' \r\nAND T0.ObjType = T2.ObjType  LEFT OUTER JOIN  OWHT T4 (NOLOCK) ON T2.WTCode =T4.WTCode\r\n , \r\nOADM T5 (NOLOCK) --,  OFPR (NOLOCK)\r\n\r\n--WHERE Name=@Periodo--@Periodo \r\n--T0.DocEntry=T1.DocEntry  AND  \r\n--T0.DocNum=17089 --and\r\n \r\n)\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[IDA_ComprobantesIVA] \r\n(\t\r\n  @NroComp AS VARCHAR(MAX)\r\n \r\n)\r\n\r\nRETURNS TABLE\r\n\r\nAS\r\nRETURN \r\n(\r\n\r\n SELECT \r\nT0.U_IDA_NroComp AS 'COMP',\r\nT0.U_IDA_NroComp AS 'COMP2',\r\nT0.U_IDA_FechaFact AS 'FECHA',\r\nT0.U_IDA_FechaComp AS 'FECHACOMP',\r\nT0.U_IDA_Factura AS 'NroFactura',\r\nT0.U_IDA_NroControl AS 'NroControl',\r\nT0.U_IDA_Credito AS 'NroCredito',\r\nT0.U_IDA_Debito AS 'NroDebito',\r\nT0.U_IDA_TipoTran AS 'TipoTrans',\r\nT0.U_IDA_Total AS 'Total',\r\nCONVERT(DECIMAL(11,2),T0.U_IDA_Alicuota) AS 'Alicuota',\r\nCONVERT(VARCHAR,YEAR(T0.U_IDA_FechaComp)) AS 'Year',\r\nRIGHT('0'+CONVERT(VARCHAR,MONTH(T0.U_IDA_FechaComp)),2) AS 'Month',\r\n*\r\nFROM [@IDA_COMPROBANTES] T0 \r\n\r\n       WHERE T0.U_IDA_NroComp=@NroComp AND \r\n  T0.U_IDA_Status='01'\r\n\r\n)\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[IDA_ListadoComprobantesIVA] \r\n(\r\n@FechaD AS DATETIME,\r\n@FechaH AS DATETIME,\r\n@CardCodeD AS VARCHAR(MAX),\r\n@CardCodeH AS VARCHAR(MAX)\r\n)\r\n\r\nRETURNS TABLE \r\n\r\n\r\nAS\r\nRETURN \r\n(\r\n\r\n\tSELECT T0.*,T1.CompnyName FROM [dbo].[@IDA_COMPROBANTES] T0, \r\n\tOADM T1 WHERE T0.U_IDA_CardCode >= \r\n\t@CardCodeD--(SELECT CardName FROM OCRD WHERE CardCode=@CardCodeD) \r\n\tAND T0.U_IDA_CardCode <= @CardCodeH-- (SELECT CardName FROM OCRD WHERE CardCode=@CardCodeH) \r\nAND T0.U_IDA_FechaFact >= @FechaD\r\nAND  T0.U_IDA_FechaFact <= @FechaH\t\t\t\t\t\t\r\nAND T0.U_IDA_Status='01'\r\n)\r\n\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[IDA_ComprobanteISLR_Operacion] \r\n(\t\r\n  @CardCode AS VARCHAR(100),\r\n  @Tipo AS VARCHAR(100),\r\n  @DocNum AS VARCHAR(100)\r\n)\r\n\r\nRETURNS TABLE\r\n\r\nAS\r\nRETURN \r\n(\r\n \r\n         SELECT * FROM \r\n(\r\n\r\n SELECT \r\n'01' AS 'Tipo',\r\n OA.CompnyName AS Nombre_A_Retencion\r\n,OA.TaxIdNum AS RIF_A\r\n,ISNULL(OA.CompnyAddr,'') AS DIRECCION\r\n,CASE WHEN P0.U_IDA_RetenTercero='Y' THEN  CASE WHEN P0.U_IDA_TipoRet='ISLR' THEN P0.U_IDA_Tercero WHEN P0.U_IDA_TipoRet='Todas' THEN P0.U_IDA_Tercero  ELSE P0.CardName END ELSE P0.CardName END AS NOMBRE_PROVEEDOR\r\n\r\n,CASE WHEN P0.U_IDA_RetenTercero='Y' THEN  CASE WHEN P0.U_IDA_TipoRet='ISLR' THEN (SELECT TOP 1 LicTradNum FROM OCRD WHERE CardName = P0.U_IDA_Tercero AND CardType='S') WHEN P0.U_IDA_TipoRet='Todas' THEN (SELECT TOP 1 LicTradNum FROM OCRD WHERE CardName = P0.U_IDA_Tercero AND CardType='S')  ELSE P0.LicTradNum END ELSE P0.LicTradNum END AS RIF_P\r\n\r\n--,P0.LicTradNum AS RIF_P\r\n,ISNULL(P0.Address,'') AS DIRECCION_P\r\n,OC.Phone1 AS TELEFONO\r\n,OC.CardCode AS CARDCODE\r\n--,CONVERT(VARCHAR,DATEPART(YEAR,CONVERT(Varchar,P0.DocDate))) +'-' + CONVERT(VARCHAR,DATEPART(MONTH,CONVERT(Varchar,P0.DocDate)))AS PERIODO\r\n,CONVERT(VARCHAR,DATEPART(YEAR,CONVERT(Varchar,P0.DocDate))) AS ANNO\r\n,CONVERT(VARCHAR,DATEPART(MONTH,CONVERT(Varchar,P0.DocDate))) AS MES \r\n,W.WTCode AS INDICADOR_RETENCION\r\n,W.WTName AS DESCRIPCION\r\n,CASE WHEN P0.DocSubType = '--' THEN P0.NumAtCard END AS FACTURA\r\n,CASE WHEN P0.DocSubType <> '--' THEN P0.NumAtCard END AS ND\r\n, NULL AS NC\r\n,P0.DocDate AS FECHA_FAC --?\r\n,P0.TaxDate AS FECHA_PAGO--?\r\n--,P5.TaxbleAmnt AS BASE_RETENCION \r\n--,CAST( P5.Rate AS NUMERIC(19,6))  AS PORCENTAJE_RETENCION\r\n,((P5.WTAmnt + ISNULL(W.U_IDA_Sustraendo,0)) /(W.PrctBsAmnt/100)) AS BASE_RETENCION\r\n,CAST( W.PrctBsAmnt AS NUMERIC(19,6))  AS PORCENTAJE_RETENCION\r\n,CAST( ISNULL(W.U_IDA_Sustraendo,0)AS NUMERIC(19,6)) AS SUSTRAENDO\r\n,CAST(P5.WTAmnt AS NUMERIC(19,6)) AS VALOR_RETENCION\r\n,(isnull(P0.U_IDA_Serie,'00') +' '+ P0.U_IDA_NumControl) AS NUMEROCONTROL\r\n,CAST(P0.Max1099 AS NUMERIC(19,6)) AS 'Total'\r\n,P0.U_IDA_TipoTrans\r\n,(SELECT Code FROM OFPR WHERE AbsEntry = P0.FinncPriod) AS 'Periodo'\r\n,W.OffclCode AS 'OfficialCode'\r\n,\r\ndbo.IDA_BaseImponible(P0.ObjType,P0.DocEntry, 0,(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='EXENTO'),'C') AS 'Monto Exento'\r\nFROM OPCH P0 , PCH5 P5, OWHT W , OADM OA , OCRD OC\r\n\r\nWHERE \r\nP0.DocEntry=P5.AbsEntry\r\nAND P5.WTCode=W.WTCode\r\nAND W.U_IDA_TipoRetencion='ISLR'\r\nAND OC.CardCode= P0.CardCode\r\nAND\r\nP0.NumAtCard =@DocNum\r\n\r\nAND OC.CardCode =  @CardCode\r\nAND P0.U_IDA_TipoTrans<>'05'\r\nUNION ALL\r\n\r\n\r\n\r\nSELECT \r\n'02' AS 'Tipo',\r\n OA.CompnyName AS Nombre_A_Retencion\r\n,OA.TaxIdNum AS RIF_A\r\n,ISNULL(OA.CompnyAddr,'') AS DIRECCION\r\n,CASE WHEN P0.U_IDA_RetenTercero='Y' THEN  CASE WHEN P0.U_IDA_TipoRet='ISLR' THEN P0.U_IDA_Tercero WHEN P0.U_IDA_TipoRet='Todas' THEN P0.U_IDA_Tercero  ELSE P0.CardName END ELSE P0.CardName END AS NOMBRE_PROVEEDOR\r\n,CASE WHEN P0.U_IDA_RetenTercero='Y' THEN  CASE WHEN P0.U_IDA_TipoRet='ISLR' THEN (SELECT TOP 1 LicTradNum FROM OCRD WHERE CardName = P0.U_IDA_Tercero AND CardType='S') WHEN P0.U_IDA_TipoRet='Todas' THEN (SELECT TOP 1 LicTradNum FROM OCRD WHERE CardName = P0.U_IDA_Tercero AND CardType='S')  ELSE P0.LicTradNum END ELSE P0.LicTradNum END AS RIF_P\r\n--,P0.LicTradNum AS RIF_P\r\n,ISNULL(P0.Address,'') AS DIRECCION_P\r\n,OC.Phone1 AS TELEFONO\r\n,OC.CardCode AS CARDCODE\r\n--,CONVERT(VARCHAR,DATEPART(YEAR,CONVERT(Varchar,P0.DocDate))) +'-' + CONVERT(VARCHAR,DATEPART(MONTH,CONVERT(Varchar,P0.DocDate)))AS PERIODO\r\n,CONVERT(VARCHAR,DATEPART(YEAR,CONVERT(Varchar,P0.DocDate))) AS ANNO\r\n,CONVERT(VARCHAR,DATEPART(MONTH,CONVERT(Varchar,P0.DocDate))) AS MES \r\n,W.WTCode AS INDICADOR_RETENCION\r\n,W.WTName AS DESCRIPCION\r\n,NULL AS FACTURA\r\n,NULL AS ND\r\n,P0.NumAtCard  AS NC\r\n,P0.DocDate AS FECHA_FAC --?\r\n,P0.TaxDate AS FECHA_PAGO--?\r\n--,-P5.TaxbleAmnt  AS BASE_RETENCION \r\n--,CAST(P5.Rate AS NUMERIC(19,6)) AS PORCENTAJE_RETENCION\r\n,-1*((P5.WTAmnt + ISNULL(W.U_IDA_Sustraendo,0)) /(W.PrctBsAmnt/100)) AS BASE_RETENCION\r\n,CAST( W.PrctBsAmnt AS NUMERIC(19,6))  AS PORCENTAJE_RETENCION\r\n\r\n,CAST(ISNULL(W.U_IDA_Sustraendo,0)AS NUMERIC(19,6)) AS SUSTRAENDO\r\n,CAST(-P5.WTAmnt AS NUMERIC(19,6)) AS VALOR_RETENCION\r\n,(isnull(P0.U_IDA_Serie,'00') +' '+ P0.U_IDA_NumControl) AS NUMEROCONTROL\r\n,CAST(- P0.Max1099 AS NUMERIC(19,6)) AS 'Total'\r\n,P0.U_IDA_TipoTrans\r\n,(SELECT Code FROM OFPR WHERE AbsEntry = P0.FinncPriod) AS 'PERIODO',\r\nW.OffclCode AS 'OfficialCode',\r\n-1*dbo.IDA_BaseImponible(P0.ObjType,P0.DocEntry, 0,(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='EXENTO'),'C') AS 'Monto Exento'\r\nFROM ORPC P0 , RPC5 P5, OWHT W , OADM OA , OCRD OC\r\n\r\nWHERE \r\nP0.DocEntry=P5.AbsEntry\r\nAND P5.WTCode=W.WTCode\r\nAND W.U_IDA_TipoRetencion='ISLR'\r\nAND OC.CardCode= P0.CardCode AND\r\nP0.NumAtCard =@DocNum\r\n \r\nAND OC.CardCode = @CardCode\r\nAND P0.U_IDA_TipoTrans<>'05'\r\n)\r\nOO WHERE OO.Tipo =@Tipo\r\n\r\n)\r\n\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[IDA_ComprobanteISLR_Mensual] \r\n(\t\r\n  @CardCode AS VARCHAR(100),\r\n  @Periodo AS VARCHAR(100)\r\n)\r\n\r\nRETURNS TABLE\r\n\r\nAS\r\nRETURN \r\n(\r\n \r\n          (SELECT \r\n OA.CompnyName AS Nombre_A_Retencion\r\n,OA.TaxIdNum AS RIF_A\r\n,ISNULL(OA.CompnyAddr,'') AS DIRECCION\r\n,P0.CardName AS NOMBRE_PROVEEDOR\r\n,P0.LicTradNum AS RIF_P\r\n,ISNULL(P0.Address,'') AS DIRECCION_P\r\n,OC.Phone1 AS TELEFONO\r\n,OC.CardCode AS CARDCODE\r\n--,CONVERT(VARCHAR,DATEPART(YEAR,CONVERT(Varchar,P0.DocDate))) +'-' + CONVERT(VARCHAR,DATEPART(MONTH,CONVERT(Varchar,P0.DocDate)))AS PERIODO\r\n,CONVERT(VARCHAR,DATEPART(YEAR,CONVERT(Varchar,P0.DocDate))) AS ANNO\r\n,CONVERT(VARCHAR,DATEPART(MONTH,CONVERT(Varchar,P0.DocDate))) AS MES \r\n,W.WTCode AS INDICADOR_RETENCION\r\n,W.WTName AS DESCRIPCION\r\n,CASE WHEN P0.DocSubType = '--' THEN P0.NumAtCard END AS FACTURA\r\n,CASE WHEN P0.DocSubType <> '--' THEN P0.NumAtCard END AS ND\r\n, NULL AS NC\r\n,P0.DocDate AS FECHA_FAC --?\r\n,P0.TaxDate AS FECHA_PAGO--?\r\n--,P5.TaxbleAmnt AS BASE_RETENCION\r\n,((P5.WTAmnt + ISNULL(W.U_IDA_Sustraendo,0)) /(W.PrctBsAmnt/100)) AS BASE_RETENCION\r\n \r\n,CAST(W.PrctBsAmnt AS NUMERIC(19,6))  AS PORCENTAJE_RETENCION\r\n--,CAST(W.Rate AS NUMERIC(10,2))  AS PORCENTAJE_RETENCION\r\n,CAST( ISNULL(W.U_IDA_Sustraendo,0)AS NUMERIC(19,6)) AS SUSTRAENDO\r\n,CAST(P5.WTAmnt AS NUMERIC(19,6)) AS VALOR_RETENCION\r\n,(P0.U_IDA_Serie +' '+ P0.U_IDA_NumControl) AS NUMEROCONTROL\r\n,CAST(P0.Max1099 AS NUMERIC(19,6)) AS 'Total'\r\n,P0.U_IDA_TipoTrans\r\n,(SELECT Code FROM OFPR WHERE AbsEntry = P0.FinncPriod) AS 'Periodo'\r\n,W.OffclCode AS 'OfficialCode'\r\n,\r\ndbo.IDA_BaseImponible(P0.ObjType,P0.DocEntry, 0,(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='EXENTO'),'C') AS 'Monto Exento'\r\nFROM OPCH P0 , PCH5 P5, OWHT W , OADM OA , OCRD OC\r\n\r\nWHERE \r\nP0.DocEntry=P5.AbsEntry\r\nAND P5.WTCode=W.WTCode\r\nAND W.U_IDA_TipoRetencion='ISLR'\r\nAND OC.CardCode= P0.CardCode\r\nAND (SELECT Code FROM OFPR WHERE AbsEntry=P0.FinncPriod)=@Periodo\r\nAND OC.CardCode = @CardCode\r\nAND P0.U_IDA_TipoTrans<>'05'\r\n)\r\n\r\n\r\nUNION ALL\r\n\r\n(SELECT \r\n OA.CompnyName AS Nombre_A_Retencion\r\n,OA.TaxIdNum AS RIF_A\r\n,ISNULL(OA.CompnyAddr,'') AS DIRECCION\r\n,P0.CardName AS NOMBRE_PROVEEDOR\r\n,P0.LicTradNum AS RIF_P\r\n,ISNULL(P0.Address,'') AS DIRECCION_P\r\n,OC.Phone1 AS TELEFONO\r\n,OC.CardCode AS CARDCODE\r\n--,CONVERT(VARCHAR,DATEPART(YEAR,CONVERT(Varchar,P0.DocDate))) +'-' + CONVERT(VARCHAR,DATEPART(MONTH,CONVERT(Varchar,P0.DocDate)))AS PERIODO\r\n,CONVERT(VARCHAR,DATEPART(YEAR,CONVERT(Varchar,P0.DocDate))) AS ANNO\r\n,CONVERT(VARCHAR,DATEPART(MONTH,CONVERT(Varchar,P0.DocDate))) AS MES \r\n,W.WTCode AS INDICADOR_RETENCION\r\n,W.WTName AS DESCRIPCION\r\n,NULL AS FACTURA\r\n,NULL AS ND\r\n,P0.NumAtCard  AS NC\r\n,P0.DocDate AS FECHA_FAC --?\r\n,P0.TaxDate AS FECHA_PAGO--?\r\n--,-P5.TaxbleAmnt  AS BASE_RETENCION \r\n,-1*((P5.WTAmnt + ISNULL(W.U_IDA_Sustraendo,0)) /(W.PrctBsAmnt/100)) AS BASE_RETENCION\r\n\r\n,CAST(W.PrctBsAmnt AS NUMERIC(19,6))  AS PORCENTAJE_RETENCION\r\n--,CAST(W.Rate AS NUMERIC(10,2))  AS PORCENTAJE_RETENCION\r\n,CAST(ISNULL(W.U_IDA_Sustraendo,0)AS NUMERIC(19,6)) AS SUSTRAENDO\r\n,CAST(-P5.WTAmnt AS NUMERIC(19,6)) AS VALOR_RETENCION\r\n,(P0.U_IDA_Serie +' '+ P0.U_IDA_NumControl) AS NUMEROCONTROL\r\n,CAST(- P0.Max1099 AS NUMERIC(19,6)) AS 'Total'\r\n,P0.U_IDA_TipoTrans\r\n,(SELECT Code FROM OFPR WHERE AbsEntry = P0.FinncPriod) AS 'Periodo'\r\n,W.OffclCode AS 'OfficialCode',\r\n-1*dbo.IDA_BaseImponible(P0.ObjType,P0.DocEntry, 0,(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='EXENTO'),'C') AS 'Monto Exento'\r\nFROM ORPC P0 , RPC5 P5, OWHT W , OADM OA , OCRD OC\r\n\r\nWHERE \r\nP0.DocEntry=P5.AbsEntry\r\nAND P5.WTCode=W.WTCode\r\nAND W.U_IDA_TipoRetencion='ISLR'\r\nAND OC.CardCode= P0.CardCode\r\nAND (SELECT Code FROM OFPR WHERE AbsEntry=P0.FinncPriod)=@Periodo\r\nAND OC.CardCode = @CardCode\r\nAND P0.U_IDA_TipoTrans<>'05'\r\n)\r\n\r\n)\r\n\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[IDA_ComprobantesISLR] \r\n(\t\r\n  @NroComp AS VARCHAR(MAX)\r\n \r\n)\r\n\r\nRETURNS TABLE\r\nWITH ENCRYPTION \r\nAS\r\nRETURN \r\n(\r\n\r\n SELECT \r\nT0.U_IDA_NroComp AS 'COMP',\r\nT0.U_IDA_NroComp AS 'COMP2',\r\nT0.U_IDA_FechaDoc AS 'FECHA',\r\nT0.U_IDA_FechaComp AS 'FECHACOMP',\r\nT0.U_IDA_NroFactura AS 'NroFactura',\r\nT0.U_IDA_NroControl AS 'NroControl',\r\nT0.U_IDA_NroNC AS 'NroCredito',\r\nT0.U_IDA_NroND AS 'NroDebito',\r\nT0.U_IDA_TipoTrans AS 'TipoTrans',\r\nT0.U_IDA_DocTotal AS 'Total',\r\nCONVERT(VARCHAR,YEAR(T0.U_IDA_FechaComp)) AS 'Year',\r\nRIGHT('0'+CONVERT(VARCHAR,MONTH(T0.U_IDA_FechaComp)),2) AS 'Month',\r\n*\r\nFROM [@IDA_COMP_ISLR] T0 \r\n\r\n       WHERE T0.U_IDA_NroComp=@NroComp AND \r\n  T0.U_IDA_Status='01'\r\n\r\n)\r\n\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[IDA_RETENCION_TXT_IVA]\r\n(\t\r\n\t-- Add the parameters for the function here\r\n\t\r\n\t @Quincena AS VARCHAR(100),\r\n @Mes AS VARCHAR(100),\r\n @Ano AS VARCHAR(100)\r\n\r\n)\r\nRETURNS TABLE \r\n\r\n\r\nAS\r\nRETURN \r\n(\r\n\tSELECT Code,Name,\r\nU_IDA_NroControl ,\r\nREPLACE(CONVERT(VARCHAR,U_IDA_FechaFact,111),'/','-') AS 'U_IDA_FechaFact',\r\nU_IDA_ObjType,\r\nU_IDA_DocEntry,\r\n\r\nCONVERT(DECIMAL(11,2),U_IDA_Alicuota,2) AS 'U_IDA_Alicuota',\r\n\r\nCASE WHEN U_IDA_ObjType='19' THEN -1* \r\nCONVERT(DECIMAL(11,2),U_IDA_IVA,2) \r\nELSE CONVERT(DECIMAL(11,2),U_IDA_IVA,2) END AS 'U_IDA_IVA',\r\n\r\nCASE WHEN U_IDA_ObjType='19' THEN -1* \r\nCONVERT(DECIMAL(11,2),U_IDA_BaseImp,2) \r\nELSE CONVERT(DECIMAL(11,2),U_IDA_BaseImp,2)  END AS 'U_IDA_BaseImp',\r\n\r\nCASE WHEN U_IDA_ObjType='19' THEN -1*  \r\nCONVERT(DECIMAL(11,2),U_IDA_Retencion,2) \r\nELSE CONVERT(DECIMAL(11,2),U_IDA_Retencion,2) END AS 'U_IDA_Retencion',\r\n\r\nCASE WHEN U_IDA_ObjType='19' THEN -1*  CONVERT(DECIMAL(11,2),U_IDA_Total,2)\r\nELSE CONVERT(DECIMAL(11,2),U_IDA_Total,2) END AS 'U_IDA_Total',\r\n\r\nCASE WHEN U_IDA_ObjType='19' THEN -1*  CONVERT(DECIMAL(11,2),U_IDA_Exento,2) \r\nELSE CONVERT(DECIMAL(11,2),U_IDA_Exento,2)  END AS 'U_IDA_Exento',\r\n\r\nCASE WHEN REPLACE(U_IDA_Fafe,'-','')='' THEN '0' ELSE ISNULL(U_IDA_Fafe,'0') END AS 'U_IDA_Fafe',\r\nREPLACE(U_IDA_Factura,'-','') AS 'U_IDA_Factura',\r\nREPLACE(U_IDA_Credito,'-','') AS 'U_IDA_Credito',\r\nREPLACE(U_IDA_Debito,'-','') AS 'U_IDA_Debito',\r\nU_IDA_TipoTran,\r\nU_IDA_CardCode,\r\nU_IDA_CardName,\r\nU_IDA_Agente,\r\nU_IDA_NroComp,\r\nREPLACE(U_IDA_LicTradNum,'-','') as 'U_IDA_LicTradNum',\r\nREPLACE(U_IDA_TaxIdNo,'-','') as 'U_IDA_TaxIdNo',  \r\nREPLACE(CONVERT(VARCHAR,U_IDA_FechaComp),'/','-') AS 'U_IDA_FechaComp',\r\nU_IDA_Row,\r\nU_IDA_Status,\r\nU_IDA_PrcntRet,\r\nU_IDA_CompanyAddress,\r\nU_IDA_Address,\r\nU_IDA_DocSubtype,\r\nREPLACE(U_IDA_Periodo,'-','') as 'U_IDA_Periodo',\r\nCASE  \r\nWHEN U_IDA_ObjType='18' THEN \r\n\t( CASE WHEN U_IDA_DocSubType ='--' THEN U_IDA_Factura  ELSE U_IDA_Debito END ) ELSE U_IDA_Credito END AS 'U_IDA_NumAtCard', 'C' AS 'U_IDA_TipoOperacion' , \r\n\t'0' AS 'U_IDA_NroFile' \r\n\t,U_IDA_Quincena FROM [@IDA_COMPROBANTES]\r\n\tWHERE U_IDA_Periodo= (CONVERT(VARCHAR,@Ano)+'-' + CONVERT(VARCHAR,@Mes)) AND U_IDA_Quincena=@Quincena\r\n\tAND U_IDA_Status='01' \r\n)\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[IDA_RETENCION_TXT_IVA_SEMANAL]\r\n(\t\r\n\t-- Add the parameters for the function here\r\n\t\r\n\t @DateTo AS DATETIME\r\n\r\n)\r\nRETURNS TABLE \r\nWITH ENCRYPTION \r\n\r\nAS\r\nRETURN\r\n(\r\n\tSELECT Code,Name,\r\nU_IDA_NroControl ,\r\nREPLACE(CONVERT(VARCHAR,U_IDA_FechaFact,111),'/','-') AS 'U_IDA_FechaFact',\r\nU_IDA_ObjType,\r\nU_IDA_DocEntry,\r\n\r\nROUND(CONVERT(DECIMAL(19,2),U_IDA_Alicuota,2),2) AS 'U_IDA_Alicuota',\r\n\r\nCASE WHEN U_IDA_ObjType='19' THEN -1* \r\nROUND(CONVERT(DECIMAL(19,2),U_IDA_IVA,2),2) \r\nELSE ROUND(CONVERT(DECIMAL(19,2),U_IDA_IVA,2),2) END AS 'U_IDA_IVA',\r\n\r\nCASE WHEN U_IDA_ObjType='19' THEN -1* \r\nROUND(CONVERT(DECIMAL(19,2),U_IDA_BaseImp,2),2) \r\nELSE ROUND(CONVERT(DECIMAL(19,2),U_IDA_BaseImp,2),2)  END AS 'U_IDA_BaseImp',\r\n\r\nCASE WHEN U_IDA_ObjType='19' THEN -1*  \r\nROUND(CONVERT(DECIMAL(19,2),U_IDA_Retencion,2),2) \r\nELSE ROUND(CONVERT(DECIMAL(19,2),U_IDA_Retencion,2),2) END AS 'U_IDA_Retencion',\r\n\r\nCASE WHEN U_IDA_ObjType='19' THEN -1*  ROUND(CONVERT(DECIMAL(19,2),U_IDA_Total,2),2)\r\nELSE ROUND(CONVERT(DECIMAL(19,2),U_IDA_Total,2),2) END AS 'U_IDA_Total',\r\n\r\nCASE WHEN U_IDA_ObjType='19' THEN -1*  ROUND(CONVERT(DECIMAL(19,2),U_IDA_Exento,2),2) \r\nELSE ROUND(CONVERT(DECIMAL(19,2),U_IDA_Exento,2),2)  END AS 'U_IDA_Exento',\r\n\r\nCASE WHEN REPLACE(U_IDA_Fafe,'-','')='' THEN '0' ELSE ISNULL(U_IDA_Fafe,'0') END AS 'U_IDA_Fafe',\r\nREPLACE(U_IDA_Factura,'-','') AS 'U_IDA_Factura',\r\nREPLACE(U_IDA_Credito,'-','') AS 'U_IDA_Credito',\r\nREPLACE(U_IDA_Debito,'-','') AS 'U_IDA_Debito',\r\nU_IDA_TipoTran AS 'U_IDA_TipoTran',\r\nU_IDA_CardCode,\r\nU_IDA_CardName,\r\nU_IDA_Agente,\r\nU_IDA_NroComp,\r\nREPLACE(U_IDA_LicTradNum,'-','') as 'U_IDA_LicTradNum',\r\nREPLACE(U_IDA_TaxIdNo,'-','') as 'U_IDA_TaxIdNo',  \r\nREPLACE(CONVERT(VARCHAR,U_IDA_FechaComp),'/','-') AS 'U_IDA_FechaComp',\r\nU_IDA_Row,\r\nU_IDA_Status,\r\nU_IDA_PrcntRet,\r\nU_IDA_CompanyAddress,\r\nU_IDA_Address,\r\nU_IDA_DocSubtype,\r\nREPLACE(U_IDA_Periodo,'-','') as 'U_IDA_Periodo',\r\nCASE  \r\nWHEN U_IDA_ObjType='18' THEN \r\n\t( CASE WHEN U_IDA_DocSubType ='--' THEN U_IDA_Factura  ELSE U_IDA_Debito END ) ELSE U_IDA_Credito END AS 'U_IDA_NumAtCard', 'C' AS 'U_IDA_TipoOperacion' , \r\n\t'0' AS 'U_IDA_NroFile' \r\n\t,U_IDA_Quincena FROM [@IDA_COMPROBANTES]\r\n\tWHERE \r\n\tconvert(varchar,U_IDA_FechaComp,112)>=convert(varchar,DATEADD(day,-7, @DateTo) ,112)\r\n\tand\r\n\tconvert(varchar,U_IDA_FechaComp,112)<=convert(varchar,@DateTo,112)\r\n\t--U_IDA_Periodo= (CONVERT(VARCHAR,@Ano)+'-' + CONVERT(VARCHAR,@Mes)) AND U_IDA_Quincena=@Quincena\r\n\tAND U_IDA_Status='01' \r\n)\r\n\r\n\r\n\r\n \r\n\r\nGO\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[O_ISLR]\r\n(\t\r\n    @Periodo AS VARCHAR(100)\r\n)\r\nRETURNS TABLE \r\n\r\n\r\nAS\r\nRETURN \r\n(\r\n\r\nselect\r\nREPLACE(T9.TaxIdNum,'-','') AS 'RifAgente',  \r\nconvert(Varchar(6), T1.DocDate,112) AS 'Periodo', \r\nREPLACE(T1.LicTradNum,'-','') AS 'RifRetenido', \r\nREPLACE(T1.NumAtCard,'-','') AS 'NumeroFactura', \r\nT1.U_IDA_NumControl AS 'NumeroControl',\r\nREPLACE(CONVERT(VARCHAR,T1.DocDate,105),'-','/') AS 'FechaOperacion',\r\nT8.OffclCode AS 'CodigoConcepto', \r\nT7.TaxbleAmnt AS 'MontoOperacion1', \r\n--T1.BaseAmnt 'MontoOperacion',\r\n((T7.WTAmnt + ISNULL(T8.U_IDA_Sustraendo,0)) /(T8.PrctBsAmnt/100)) AS 'MontoOperacion',\r\nT7.WTAmnt AS 'Retencion', \r\nT8.PrctBsAmnt AS 'PorcentajeRetencion'\r\nfrom OPCH T1, PCH5 T7, OWHT T8, OADM T9, OFPR T0\r\nwhere\r\nT0.Code = @Periodo and --@Periodo\r\nT1.DocDate >= T0.F_RefDate and\r\nT1.DocDate <= T0.T_RefDate AND\r\nT7.AbsEntry = T1.DocEntry AND\r\nT8.WTCode = T7.WTCode\t\tAND\r\nT8.U_IDA_TipoRetencion = 'ISLR'\tAND\r\nT8.Category = 'I'\r\nAND T1.U_IDA_TipoTrans<>'05'\r\nUNION ALL\r\nselect\r\nREPLACE(T9.TaxIdNum,'-','') AS 'RifAgente',  \r\nconvert(Varchar(6), T1.DocDate,112) AS 'Periodo', \r\nREPLACE(T1.LicTradNum,'-','') AS 'RifRetenido', \r\nT1.NumAtCard AS 'NumeroFactura', \r\nT1.U_IDA_NumControl AS 'NumeroControl',\r\nREPLACE(CONVERT(VARCHAR,T1.DocDate,105),'-','/') AS 'FechaOperacion',\r\nT8.OffclCode AS 'CodigoConcepto', \r\n-T7.TaxbleAmnt AS 'MontoOperacion1', \r\n---T1.BaseAmnt 'MontoOperacion',\r\n-((T7.WTAmnt + ISNULL(T8.U_IDA_Sustraendo,0)) /(T8.PrctBsAmnt/100)) AS 'MontoOperacion',\r\n-T7.WTAmnt AS 'Retencion', \r\nT8.PrctBsAmnt AS 'PorcetajeRetencion'\r\nfrom ORPC T1 --, RPC1 T2\r\n, RPC5 T7, OWHT T8, OADM T9, OFPR T0\r\nwhere\r\nT0.Code = @Periodo and --@Periodo\r\nT1.DocDate >= T0.F_RefDate and\r\nT1.DocDate <= T0.T_RefDate AND\r\n--T2.DocEntry = T1.DocEntry AND\r\n--T7.AbsEntry = T2.BaseRef AND\r\nT7.AbsEntry =  T1.DocEntry AND\r\nT8.WTCode = T7.WTCode\t\tAND\r\nT8.U_IDA_TipoRetencion = 'ISLR'\tAND\r\nT8.Category = 'I'\r\nAND T1.U_IDA_TipoTrans<>'05'\r\n\r\n)\r\n\r\nGO\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\n\r\nCREATE FUNCTION [dbo].[IDA_RETENCION_XML_ISLR]\r\n(\t\r\n\t-- Add the parameters for the function here\r\n   @Periodo AS VARCHAR(100)\r\n)\r\nRETURNS TABLE \r\n\r\n\r\nAS\r\nRETURN \r\n(\r\n\tSELECT \r\nRifAgente,  \r\nREPLACE(Periodo,'-','') as 'Periodo', \r\nRifRetenido, \r\nNumeroFactura, \r\n\r\nNumeroControl,FechaOperacion\r\n,\r\nCodigoConcepto, \r\nREPLACE(CONVERT(VARCHAR,CONVERT(DECIMAL(12,2),(SUM(MontoOperacion)))),',','.') AS 'MontoOperacion', \r\nREPLACE(CONVERT(VARCHAR,CONVERT(DECIMAL(12,2),SUM(Retencion))),',','.') AS 'Retencion', \r\nREPLACE(CONVERT(VARCHAR,CONVERT(DECIMAL(12,2),PorcentajeRetencion)),',','.') 'PorcentajeRetencion'\r\nFROM dbo.[O_ISLR](@Periodo) T0\r\nGROUP BY\r\nRifAgente,  \r\nPeriodo, \r\nRifRetenido, \r\nNumeroFactura, \r\nNumeroControl,\r\nFechaOperacion,\r\nCodigoConcepto, \r\nPorcentajeRetencion\r\nHAVING \r\nSUM(Retencion) <> 0\r\n\r\n)\r\nGO\r\n\r\n\r\n\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GenerarTXTSemanal]\r\n\r\n@DateTo DateTime\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT U_IDA_TaxIdNo, U_IDA_Periodo, U_IDA_FechaFact, U_IDA_Factura, U_IDA_TipoOperacion, U_IDA_TipoTran,U_IDA_LicTradNum, U_IDA_NumAtCard, U_IDA_NroControl,U_IDA_Total,U_IDA_BaseImp, U_IDA_Retencion, U_IDA_Fafe,U_IDA_NroComp, U_IDA_Exento,U_IDA_Alicuota,U_IDA_NroFile FROM IDA_RETENCION_TXT_IVA_SEMANAL(convert(varchar,@DateTo,112));\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GenerarXMLMensual]\r\n\r\n@Periodo nvarchar(100)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT * FROM IDA_RETENCION_XML_ISLR(@Periodo)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GenerateClosePeriodAccount]\r\n\r\n@StarDate DateTime,\r\n@EndDate Datetime,\r\n@AcctCode nvarchar(15),\r\n@AcctCodeCierre nvarchar(15),\r\n@AcctCodeArrastre nvarchar(15)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT \r\n\r\nT0.[Account],\r\nT0.[ShortName],\r\nCAST(SUM(T0.[Debit])-SUM(T0.[Credit])AS decimal(19,2)) AS 'SaldoML',\r\n0.00 AS 'SaldoME',\r\nCAST(SUM(T0.[SYSDeb])- SUM(T0.[SYSCred])AS decimal(19,2)) AS 'SaldoMS',\r\nT2.[ActCurr],\r\nT2.[ActType],\r\nT2.[AcctName]\r\n\r\nFROM  [dbo].[JDT1] T0  \r\nINNER JOIN [dbo].[OACT] T2 ON T0.[Account]=T2.[AcctCode] \r\nWHERE T0.[RefDate] >= (@StarDate) AND T0.[RefDate] <= (@EndDate) AND T2.[LocManTran]='N' AND T0.[Account]=@AcctCode AND T0.[Account]<>@AcctCodeArrastre AND T0.[Account]<>@AcctCodeCierre\r\n\r\nGROUP BY T0.[Account], T0.[ShortName], T2.[ActCurr], T2.[ActType], T2.[AcctName]\r\nHAVING CAST(SUM(T0.[Debit])-SUM(T0.[Credit])AS decimal(19,2))<>0\r\nORDER BY T0.[Account], T0.[ShortName]\r\n\r\nEND\r\n\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GenerateClosePeriodBP]\r\n\r\n@StarDate DateTime,\r\n@EndDate Datetime,\r\n@StarBP nvarchar(15),\r\n@EndBP nvarchar(15),\r\n@AcctCodeCierre nvarchar(15),\r\n@AcctCodeArrastre nvarchar(15)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT \r\nT0.[Account],\r\nT0.[ShortName],\r\nCAST(SUM(T0.[Debit]) - SUM(T0.[Credit])AS decimal(19,2)) AS 'SaldoML',\r\n0.00 AS 'SaldoME',\r\nCAST(SUM(T0.[SYSDeb]) - SUM(T0.[SYSCred])AS decimal(19,2)) AS 'SaldoMS',\r\nT2.[ActCurr],\r\nT2.[ActType],\r\nT1.[CardName] AS 'AcctName'\r\n\r\nFROM  [dbo].[JDT1] T0  INNER  JOIN [dbo].[OCRD] T1  ON  T1.[CardCode] = T0.[ShortName]\r\nINNER  JOIN [dbo].[OACT] T2  ON  T2.[AcctCode] = T0.[Account]\r\nWHERE T0.[RefDate] >= (@StarDate) AND T0.[RefDate] <= (@EndDate) AND T0.[Account] <> T0.[ShortName] AND T0.[ShortName] >= (@StarBP) AND T0.[ShortName]<=(@EndBP) AND T2.[LocManTran]='Y' AND T0.[Account]<>@AcctCodeArrastre AND T0.[Account]<>@AcctCodeCierre\r\nGROUP BY T0.[ShortName], T0.[Account], T1.[CardCode], T1.[CardName], T2.[ActCurr], T2.[ActType]\r\n\r\nHAVING CAST(SUM(T0.[Debit])-SUM(T0.[Credit])AS decimal(19,2))<>0 ORDER BY T0.[ShortName],T0.[Account]\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindBP]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT * FROM OCRD\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GenerateExchangeRateDifferenceAccount]\r\n\r\n@AccountGanancia nvarchar(15),\r\n@AccountPerdida nvarchar(15),\r\n@RefDate datetime,\r\n@F_DueDate datetime,\r\n@T_DueDate datetime,\r\n@AcctCode nvarchar(15),\r\n@Currency nvarchar(3)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nIF(@Currency='##')\r\nBEGIN\r\nSELECT\r\nT0.[Account],\r\nT0.[ShortName],\r\nT2.[AcctName],\r\nCAST(SUM(T0.[BalFcCred]-T0.[BalFcDeb])AS decimal(19,2)) AS 'SaldoME',\r\nCAST(SUM(T0.[BalDueCred]-T0.[BalDueDeb]) AS decimal(19,2)) AS 'Saldo',\r\nCAST((SUM(T0.[BalFcCred]-T0.[BalFcDeb])*T3.[Rate])-SUM(T0.[BalFcCred]-T0.[BalFcDeb])AS decimal(19,2)) AS 'Diferencia',\r\nT0.[FCCurrency],\r\nT3.[Rate],\r\nISNULL(T4.[CardType],'N') AS 'Type'\r\nFROM  [dbo].[JDT1] T0  INNER  JOIN [dbo].[OJDT] T1  ON  T1.[TransId] = T0.[TransId]\r\nINNER  JOIN [dbo].[OACT] T2  ON  T2.[AcctCode] = T0.[Account]\r\nLEFT JOIN [dbo].[ORTT] T3 ON T3.[Currency]=T0.[FCCurrency]\r\nLEFT JOIN [dbo].[OCRD] T4 ON T4.[CardCode]=T0.[ShortName]\r\nWHERE T0.[ShortName] = (@AcctCode) AND  T0.[RefDate] <= (@RefDate) AND T3.[RateDate]=@RefDate  AND  T0.[DueDate] >= (@F_DueDate)  AND  T0.[DueDate] <= (@T_DueDate) AND T2.[ActType]='N' AND T0.[Account]<>@AccountGanancia AND T0.[Account]<>@AccountPerdida  GROUP BY T0.[Account], T0.[FCCurrency], T3.[Rate], T4.[CardType], T0.[ShortName], T2.[AcctName] HAVING CAST((SUM(T0.[BalFcCred]-T0.[BalFcDeb])*T3.[Rate])-SUM(T0.[BalDueCred]-T0.[BalDueDeb])AS decimal(19,2))<>0\r\n\r\nEND\r\nELSE\r\nBEGIN\r\nSELECT\r\nT0.[Account],\r\nT0.[ShortName],\r\nT2.[AcctName],\r\nCAST(SUM(T0.[BalFcCred]-T0.[BalFcDeb]) AS decimal(19,2)) AS 'SaldoME',\r\nCAST(SUM(T0.[BalDueCred]-T0.[BalDueDeb])AS decimal(19,2)) AS 'Saldo',\r\nCAST((SUM(T0.[BalFcCred]-T0.[BalFcDeb])*T3.[Rate])-SUM(T0.[BalDueCred]-T0.[BalDueDeb])AS decimal(19,2)) AS 'Diferencia',\r\nT0.[FCCurrency],\r\nT3.[Rate],\r\nISNULL(T4.[CardType],'N') AS 'Type'\r\nFROM  [dbo].[JDT1] T0  INNER  JOIN [dbo].[OJDT] T1  ON  T1.[TransId] = T0.[TransId]\r\nINNER  JOIN [dbo].[OACT] T2  ON  T2.[AcctCode] = T0.[Account]\r\nINNER JOIN [dbo].[ORTT] T3 ON T3.[Currency]=T0.[FCCurrency]\r\nLEFT JOIN [dbo].[OCRD] T4 ON T4.[CardCode]=T0.[ShortName]\r\nWHERE T0.[ShortName] = (@AcctCode) AND T3.[Currency]=@Currency AND T0.[RefDate] <= (@RefDate) AND T3.[RateDate]=@RefDate AND  T0.[DueDate] >= (@F_DueDate)  AND  T0.[DueDate] <= (@T_DueDate) AND T2.[ActType]='N' AND T0.[Account]<>@AccountGanancia AND T0.[Account]<>@AccountPerdida GROUP BY T0.[Account], T0.[FCCurrency], T3.Rate, T4.CardType, T0.ShortName, T2.AcctName HAVING CAST((SUM(T0.[BalFcCred]-T0.[BalFcDeb])*T3.[Rate])-SUM(T0.[BalDueCred]-T0.[BalDueDeb])AS decimal(19,2))<>0\r\nEND\r\n\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GenerateExchangeRateDifferenceBP]\r\n\r\n@SupplierGanancia nvarchar(15),\r\n@SupplierPerdida nvarchar(15),\r\n@CustomerGanancia nvarchar(15),\r\n@CustomerPerdida nvarchar(15),\r\n@RefDate datetime,\r\n@F_DueDate datetime,\r\n@T_DueDate datetime,\r\n@StarBP nvarchar(15),\r\n@EndBP nvarchar(15),\r\n@Currency nvarchar(3)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nIF(@Currency='##')\r\nBEGIN\r\nSELECT\r\nT0.[Account],\r\nT0.[ShortName],\r\nT2.[AcctName],\r\nCAST(SUM(T0.[BalFcCred]-T0.[BalFcDeb]) AS decimal(19,2)) AS 'SaldoME',\r\nCAST(SUM(T0.[BalDueCred]-T0.[BalDueDeb]) AS decimal(19,2)) AS 'Saldo',\r\nCAST((SUM(T0.[BalFcCred]-T0.[BalFcDeb])*T3.[Rate])-SUM(T0.[BalDueCred]-T0.[BalDueDeb]) AS decimal(19,2)) AS 'Diferencia',\r\nT0.[FCCurrency],\r\nT3.[Rate],\r\nISNULL(T4.[CardType],'N') AS 'Type'\r\nFROM  [dbo].[JDT1] T0  INNER  JOIN [dbo].[OJDT] T1  ON  T1.[TransId] = T0.[TransId]\r\nINNER  JOIN [dbo].[OACT] T2  ON  T2.[AcctCode] = T0.[Account]\r\nINNER JOIN [dbo].[ORTT] T3 ON T3.[Currency]=T0.[FCCurrency]\r\nLEFT JOIN [dbo].[OCRD] T4 ON T4.[CardCode]=T0.[ShortName]\r\nWHERE T0.[ShortName] >= (@StarBP) AND T0.[ShortName]<=(@EndBP) AND T0.[RefDate] <= (@RefDate) AND T3.[RateDate]=@RefDate  AND  T0.[DueDate] >= (@F_DueDate)  AND  T0.[DueDate] <= (@T_DueDate) AND T2.[ActType]='N' AND T0.[Account]<>@SupplierGanancia AND T0.[Account]<>@SupplierGanancia AND T0.[Account]<>@CustomerGanancia AND T0.[Account]<>@CustomerPerdida GROUP BY T0.[Account], T0.[FCCurrency], T3.Rate, T4.CardType, T0.ShortName, T2.AcctName HAVING CAST((SUM(T0.[BalFcCred]-T0.[BalFcDeb])*T3.[Rate])-SUM(T0.[BalScCred]-T0.[BalScDeb]) AS decimal(19,2))<>0\r\nORDER BY T0.[ShortName],T0.[Account]\r\n\r\nEND\r\nELSE\r\nBEGIN\r\nSELECT\r\nT0.[Account],\r\nT0.[ShortName],\r\nT2.[AcctName],\r\nCAST(SUM(T0.[BalFcCred]-T0.[BalFcDeb]) AS decimal(19,2)) AS 'SaldoME',\r\nCAST(SUM(T0.[BalDueCred]-T0.[BalDueDeb]) AS decimal(19,2)) AS 'Saldo',\r\nCAST((SUM(T0.[BalFcCred]-T0.[BalFcDeb])*T3.[Rate])-SUM(T0.[BalDueCred]-T0.[BalDueDeb]) AS decimal(19,2)) AS 'Diferencia',\r\nT0.[FCCurrency],\r\nT3.[Rate],\r\nISNULL(T4.[CardType],'N') AS 'Type'\r\nFROM  [dbo].[JDT1] T0  INNER  JOIN [dbo].[OJDT] T1  ON  T1.[TransId] = T0.[TransId]\r\nINNER  JOIN [dbo].[OACT] T2  ON  T2.[AcctCode] = T0.[Account]\r\nINNER JOIN [dbo].[ORTT] T3 ON T3.[Currency]=T0.[FCCurrency]\r\nLEFT JOIN [dbo].[OCRD] T4 ON T4.[CardCode]=T0.[ShortName]\r\nWHERE T0.[ShortName] >= (@StarBP) AND T0.[ShortName]<=(@EndBP) AND T0.[RefDate] <= (@RefDate) AND T3.[RateDate]=@RefDate AND T3.[Currency]=@Currency AND T0.[DueDate] >= (@F_DueDate)  AND  T0.[DueDate] <= (@T_DueDate) AND T2.[ActType]='N' AND T0.[Account]<>@SupplierGanancia AND T0.[Account]<>@SupplierGanancia AND T0.[Account]<>@CustomerGanancia AND T0.[Account]<>@CustomerPerdida GROUP BY T0.[Account], T0.[FCCurrency], T3.Rate, T4.CardType, T0.ShortName, T2.AcctName HAVING CAST((SUM(T0.[BalFcCred]-T0.[BalFcDeb])*T3.[Rate])-SUM(T0.[BalDueCred]-T0.[BalDueDeb])AS decimal(19,2))<>0\r\nORDER BY T0.[ShortName],T0.[Account]\r\n\r\nEND\r\nEND\r\n\r\nGO\r\nGO\r\n/****** Object:  StoredProcedure [dbo].[FindAllAccount]    Script Date: 26/6/2020 1:51:44 a. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindAllAccountReal]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT AcctCode,AcctName FROM OACT WHERE ActType='N' ORDER BY  GroupMask, Levels, AcctCode \r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GenerateExchangeConversionAccount]\r\n\r\n@RefDate datetime,\r\n@AcctCode nvarchar(15)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @SysCurrency nvarchar(3)\r\n\r\nSET @SysCurrency=(SELECT TOP 1 SysCurrncy from OADM)\r\n\r\nSELECT\r\nT0.[Account],\r\nT0.[ShortName],\r\nT2.[AcctName],\r\nCAST((SUM(T0.[SYSCred]-T0.[SYSDeb]))AS decimal(19,2)) AS 'SaldoMS',\r\nCAST((SUM(T0.[Credit]-T0.[Debit]))AS decimal(19,2)) AS 'Saldo',\r\nCAST((SUM(T0.[Credit]-T0.[Debit]))/(T3.Rate)AS decimal(19,2)) AS 'SaldoConvertido',\r\nCAST(((SUM(T0.[Credit]-T0.[Debit]))/(T3.Rate)-(SUM(T0.[SYSCred]-T0.[SYSDeb])))AS decimal(19,2)) AS 'Diferencia',\r\nISNULL(T4.[CardType],'N') AS 'Type'\r\nFROM  [dbo].[JDT1] T0  INNER  JOIN [dbo].[OJDT] T1  ON  T1.[TransId] = T0.[TransId]\r\nLEFT JOIN [dbo].[ORTT] T3 ON T3.[Currency]=@SysCurrency\r\nLEFT  JOIN [dbo].[OACT] T2  ON  T2.[AcctCode] = T0.[Account]\r\nLEFT JOIN [dbo].[OCRD] T4 ON T4.[CardCode]=T0.[ShortName]\r\nWHERE T0.[ShortName] =@AcctCode AND T3.RateDate=(@RefDate) AND  T0.[RefDate] <= (@RefDate) AND  T2.[ActType]='N' AND T2.LocManTran='N' GROUP BY T0.Account, T0.ShortName, T2.AcctName, T3.Rate, T4.CardType HAVING CAST(((SUM(T0.[Credit]-T0.[Debit]))/t3.Rate)-(SUM(T0.[SYSCred]-T0.[SYSDeb])) AS decimal(19,2))<>0\r\n\r\nEND\r\n\r\nGO\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GenerateExchangeConversionBP]\r\n\r\n@RefDate datetime,\r\n@StarBP nvarchar(15),\r\n@EndBP nvarchar(15)\r\n\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @SysCurrency nvarchar(3)\r\n\r\nSET @SysCurrency=(SELECT TOP 1 SysCurrncy from OADM)\r\n\r\nSELECT\r\nT0.[Account],\r\nT0.[ShortName],\r\nT2.[AcctName],\r\nCAST((SUM(T0.[BalScCred]-T0.[BalScDeb])) AS decimal(19,2)) AS 'SaldoMS',\r\nCAST((SUM(T0.[BalDueCred]-T0.[BalDueDeb])) AS decimal(19,2)) AS 'Saldo',\r\nCAST((SUM(T0.[BalDueCred]-T0.[BalDueDeb]))/(T3.Rate) AS decimal(19,2)) AS 'SaldoConvertido',\r\nCAST(((SUM(T0.[BalDueCred]-T0.[BalDueDeb]))/(T3.Rate)-(SUM(T0.[BalScCred]-T0.[BalScDeb]))) AS decimal(19,2)) AS 'Diferencia',\r\nT4.[CardType] AS 'Type'\r\nFROM  [dbo].[JDT1] T0  INNER  JOIN [dbo].[OJDT] T1  ON  T1.[TransId] = T0.[TransId]\r\nINNER  JOIN [dbo].[OACT] T2  ON  T2.[AcctCode] = T0.[Account]\r\nINNER JOIN [dbo].[ORTT] T3 ON T3.[Currency]=@SysCurrency\r\nLEFT JOIN [dbo].[OCRD] T4 ON T4.[CardCode]=T0.[ShortName]\r\nWHERE T0.[ShortName] >= (@StarBP) AND T0.[ShortName]<=(@EndBP) AND T0.[RefDate] <= (@RefDate) AND T3.[RateDate]=@RefDate AND T2.[ActType]='N' AND T2.LocManTran='Y' GROUP BY T0.[Account], T3.Rate, T4.CardType, T0.ShortName, T2.AcctName HAVING CAST(((SUM(T0.[BalDueCred]-T0.[BalDueDeb]))/(T3.Rate)-(SUM(T0.[BalScCred]-T0.[BalScDeb]))) AS decimal(19,2))<>0\r\nORDER BY T0.[ShortName],T0.[Account]\r\n\r\nEND\r\n\r\nGO\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GenerateInternalReconciliation]\t\r\n\r\n\r\n@SN nvarchar(15),\r\n@T_RefDate datetime,\r\n@F_RefDate datetime\r\nAS\r\n\r\nBEGIN\r\nSELECT T0.[TransId],\r\nT0.[Line_ID],\r\nT0.[TransType],\r\nCAST(CONVERT(nvarchar,T0.[RefDate],103)AS nvarchar) AS 'RefDate',\r\nCAST(SUM(T0.[Debit]-T0.[Credit]) AS decimal(19,2)) AS 'Importe',\r\nCAST(SUM(T0.[BalDueDeb]-T0.[BalDueCred]) AS decimal(19,2)) AS 'SaldoVencido',\r\nCAST(SUM(T0.[BalDueDeb]-T0.[BalDueCred]) AS decimal(19,2)) AS 'ImporteReconciliar',\r\nCAST(SUM(T0.BalFcDeb-T0.BalFcCred) AS decimal(19,2)) AS 'SaldoME',\r\nCAST(SUM(T0.BalScDeb-T0.BalScCred) AS decimal(19,2)) AS 'SaldoMS',\r\nT0.[LineMemo],\r\nT0.[Account],\r\nT0.[ShortName],\r\nT0.[FCCurrency],\r\nT0.[FinncPriod],\r\nT0.[WTSum],\r\nT0.[WTSumFC],\r\nT0.[WTSumSC],\r\nT1.[BaseRef]\r\nFROM  [dbo].[JDT1] T0  INNER  JOIN [dbo].[OJDT] T1  ON  T1.[TransId] = T0.[TransId]\t\t\t\t\t\r\nWHERE (T0.[ShortName] = @SN) AND CONVERT(varchar, T0.[RefDate], 23) >=@F_RefDate  AND CONVERT(varchar, T0.[RefDate], 23) <=@T_RefDate  \r\nGROUP BY T0.[TransId], T0.[TransType], T0.[RefDate], T0.[Account],T0.[FCCurrency], T0.[Line_ID], T0.[FinncPriod], T0.[ShortName], T0.[LineMemo], T1.[BaseRef],T0.[WTSum],T0.[WTSumFC],T0.[WTSumSC]\r\nHAVING (SUM(T0.[BalDueDeb]-T0.[BalDueCred])<>0) \r\nORDER BY T0.[RefDate],T0.[TransId]\r\n\r\nEND\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[SelectReconNum]\r\n\r\nAS\r\n\r\nDECLARE @ReconNum int\r\n\r\nBEGIN\r\n\r\nSET @ReconNum =(SELECT (SELECT DISTINCT TOP 1 ReconNum FROM OITR ORDER BY ReconNum DESC) + 1 AS ReconNum)\r\n\r\nIF(@ReconNum IS NULL)\r\nBEGIN \r\nSELECT 1 AS ReconNum\r\nEND\r\nELSE\r\nBEGIN\r\nSELECT @ReconNum AS ReconNum\r\nEND\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertReconciliationInternal]\r\n\r\n@IsCard char(1),\r\n@ReconType nvarchar(2),\r\n@ReconDate datetime,\r\n@Total numeric(19,6),\r\n@ReconCurr nvarchar(3),\r\n@CancelAbs int,\r\n@Canceled char(1),\r\n@IsSystem char(1),\r\n@InitObjTyp nvarchar(20),\r\n@InitObjAbs int,\r\n@CreateDate datetime,\r\n@UserSign smallint,\r\n@ReconJEId int,\r\n@ObjType nvarchar(20)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO OITR (IsCard,ReconType,ReconDate,Total,ReconCurr,CancelAbs,Canceled,IsSystem, InitObjTyp, InitObjAbs, CreateDate, UserSign, ReconJEId,ObjType) VALUES (@IsCard,@ReconType,@ReconDate,@Total,@ReconCurr,@CancelAbs,@Canceled,@IsSystem, @InitObjTyp, @InitObjAbs, @CreateDate, @UserSign, @ReconJEId,@ObjType)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertReconciliationInternalLines]\r\n\r\n@ReconNum int,\r\n@LineSeq int,\r\n@TransId int,\r\n@Account nvarchar(15),\r\n@ShortName nvarchar(15),\r\n@TransRowId int,\r\n@SrcObjTyp nvarchar(20),\r\n@SrcObjAbs int,\r\n@ReconSum numeric (19,6),\r\n@ReconSumFC numeric (19,6),\r\n@ReconSumSC numeric (19,6),\r\n@FrgnCurr nvarchar(3),\r\n@SumMthCurr numeric (19,6),\r\n@IsCredit char(1),\r\n@WTSum numeric (19,6),\r\n@WTSumFC numeric (19,6),\r\n@WTSumSC numeric (19,6),\r\n@ExpSum numeric (19,6),\r\n@ExpSumFC numeric (19,6),\r\n@ExpSumSC numeric (19,6)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO ITR1 (ReconNum,LineSeq,TransId,Account,ShortName,TransRowId,SrcObjTyp,SrcObjAbs,ReconSum, ReconSumFC, ReconSumSC, FrgnCurr, SumMthCurr, IsCredit , WTSum, WTSumFC, WTSumSC, ExpSum, ExpSumFC,ExpSumSC) VALUES(@ReconNum,@LineSeq,@TransId,@Account,@ShortName,@TransRowId,@SrcObjTyp,@SrcObjAbs,@ReconSum,@ReconSumFC, @ReconSumSC, @FrgnCurr, @SumMthCurr, @IsCredit , @WTSum, @WTSumFC, @WTSumSC, @ExpSum, @ExpSumFC,@ExpSumSC)\r\n\r\nEND\r\n\r\n\r\nGO\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[ReconciliationInternalDiference]\r\n(\t\r\n\t@ReconNum int\r\n)\r\nRETURNS TABLE \r\nAS\r\nRETURN\r\n(\r\n\r\nSELECT \r\nAccount,\r\nShortName,\r\n\r\nCASE \r\n\t\t\tWHEN IsCredit='D' THEN ReconSum\r\n\t\t\tWHEN IsCredit='C' THEN ReconSum*(-1)\r\n\t\t\tEND AS 'ReconSumTrans',\r\nCASE \r\n\t\t\tWHEN IsCredit='D' THEN ReconSumSC\r\n\t\t\tWHEN IsCredit='C' THEN ReconSumSC*(-1)\r\n\t\t\tEND AS 'ReconSumTransSC'\r\n\r\nFROM ITR1 WHERE ReconNum=@ReconNum\r\n)\r\n\r\nGO\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[ExecuteFuncionReconciliationInternalDiference]\r\n\r\n@ReconNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT SUM(ReconSumTransSC) AS 'ReconSumTransSC' FROM [dbo].[ReconciliationInternalDiference](@ReconNum) GROUP BY ShortName\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GetReconciliationInternalDiferenceLines]\r\n\r\n@ReconNum int\r\n\r\nAS\r\n\r\nBEGIN\r\nSELECT \r\n    Account, ShortName, SUM(ReconSumTrans) AS 'ReconSum', SUM(ReconSumTransSC) AS 'ReconSumSC'\r\nFROM \r\n   [dbo].[ReconciliationInternalDiference](@ReconNum) GROUP BY Account,ShortName\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateJournalEntryLinesReconciliation]\r\n\r\n@TransId int,\r\n@Account nvarchar(15),\r\n@ShortName nvarchar(15),\r\n@TransRowId int,\r\n@ReconSum numeric (19,6),\r\n@ReconSumFC numeric (19,6),\r\n@ReconSumSC numeric (19,6),\r\n@IsCredit char(1),\r\n@WTSum numeric (19,6),\r\n@WTSumFC numeric (19,6),\r\n@WTSumSC numeric (19,6)\r\n\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nIF(@IsCredit='D')\r\nBEGIN\r\nUPDATE JDT1 SET BalDueDeb=(BalDueDeb-@ReconSum), BalFcDeb=(BalFcDeb-@ReconSumFC), BalScDeb=(BalScDeb-@ReconSumSC) WHERE Line_ID=@TransRowId AND TransId=@TransId AND Account=@Account AND ShortName=@ShortName\r\nEND\r\n\r\nIF(@IsCredit='C')\r\nBEGIN\r\nUPDATE JDT1 SET BalDueCred=(BalDueCred-@ReconSum), BalFcCred=(BalFcCred-@ReconSumFC), BalScCred=(BalScCred-@ReconSumSC) WHERE Line_ID=@TransRowId AND TransId=@TransId AND Account=@Account AND ShortName=@ShortName\r\nEND\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GenerateReconciliacionesAnteriores]\r\n\r\n@DesdeSN nvarchar(15),\r\n@HastaSN nvarchar(15),\r\n@F_ReconDate datetime,\r\n@T_ReconDate datetime,\r\n@F_NroRecon int,\r\n@T_NroRecon int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\n\r\nSELECT\r\nT0.[ReconNum],\r\nT0.[IsCard],\r\nT0.[Canceled],\r\nT0.[IsSystem],\r\nT0.[InitObjAbs],\r\nT0.[InitObjTyp],\r\nT0.[ObjType],\r\nT0.[Total],\r\nT0.[ReconType],\r\nCAST(CONVERT(nvarchar,T0.[ReconDate],103)AS nvarchar) AS 'ReconDate',\r\nCAST(CONVERT(nvarchar,T0.[CreateDate],103)AS nvarchar) AS 'CreateDate',\r\nT0.[CancelAbs],\r\nT0.[ReconJEId],\r\nT0.[ReconCurr]\r\nFROM  [dbo].[OITR] T0\r\nWHERE T0.[ReconDate]>= (@F_ReconDate)  AND  T0.[ReconDate] <= (@T_ReconDate) AND T0.[ReconNum] IN (\r\nSELECT\r\nT0.[ReconNum]\r\n\r\nFROM  [dbo].[ITR1] T0\r\nWHERE T0.[ReconNum] >= (@F_NroRecon) AND T0.[ReconNum]<=(@T_NroRecon) AND T0.[ShortName] >= (@DesdeSN)  AND  T0.[ShortName] <= (@HastaSN)\r\nGROUP BY T0.[ReconNum]\r\n\r\n)\r\nORDER BY T0.[ReconNum]\r\n\r\n\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindReconciliacionesAnterioresLines]\r\n\r\n@ReconNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT \r\nT0.ReconNum,\r\nT0.LineSeq,\r\nT0.SrcObjTyp,\r\nT0.ShortName,\r\nT0.TransId,\r\nT0.TransRowId,\r\nT0.Account,\r\nT0.SrcObjAbs,\r\nT0.FrgnCurr,\r\nT1.ReconCurr,\r\nCASE \r\n\t\t\tWHEN T0.IsCredit='D' THEN T0.ReconSum\r\n\t\t\tWHEN T0.IsCredit='C' THEN T0.ReconSum*(-1)\r\n\t\t\tEND AS 'ReconSum',\r\nCASE \r\n\t\t\tWHEN T0.IsCredit='D' THEN T0.ReconSumSC\r\n\t\t\tWHEN T0.IsCredit='C' THEN T0.ReconSumSC*(-1)\r\n\t\t\tEND AS 'ReconSumSC',\t\t\r\nCASE \r\n\t\t\tWHEN T0.IsCredit='D' THEN T0.ReconSumFC\r\n\t\t\tWHEN T0.IsCredit='C' THEN T0.ReconSumFC*(-1)\r\n\t\t\tEND AS 'ReconSumFC',\r\nT0.WTSum,\r\nT0.WTSumFC,\r\nT0.WTSumSC\r\nFROM ITR1 T0 INNER JOIN OITR T1 \r\nON T0.[ReconNum]=T1.[ReconNum]\r\n\r\n\r\nWHERE T0.ReconNum=@ReconNum\r\n\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindJournalEntrySpecific]\r\n\r\n@TransId int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT * FROM OJDT WHERE TransId = @TransId\r\n \r\nEND\r\n\r\nGO\r\n/****** Object:  StoredProcedure [dbo].[UpdateItem]    Script Date: 8/7/2020 1:46:37 a. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateDeterminacionCuentasMayor]\r\n\r\n@LinkAct_1 nvarchar(15),\r\n@LinkAct_2 nvarchar(15),\r\n@LinkAct_3 nvarchar(15),\r\n@LinkAct_4 nvarchar(15),\r\n@LinkAct_5 nvarchar(15),\r\n@LinkAct_6 nvarchar(15),\r\n@LinkAct_7 nvarchar(15)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE ODCM SET LinkAct_1=@LinkAct_1, LinkAct_2=@LinkAct_2, LinkAct_3=@LinkAct_3, LinkAct_4=@LinkAct_4, LinkAct_5=@LinkAct_5, LinkAct_6=@LinkAct_6, LinkAct_7=@LinkAct_7\r\n\r\nEND\r\n\r\nGO\r\n/****** Object:  StoredProcedure [dbo].[UpdateItem]    Script Date: 8/7/2020 1:46:37 a. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindDeterminacionCuentasMayor]\r\n\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT * FROM ODCM \r\n\r\nEND\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[O_IDA1] \r\n(\t\r\n)\r\nRETURNS TABLE\r\n\r\n \r\nAS\r\nRETURN \r\n(\r\n\r\n\t\t\tSELECT  DocEntry, ObjType, VatPrcnt,VatGroup,WTLiable FROM PCH1 K2 (NOLOCK) --WHERE K2.DocEntry=@DocEntry AND ObjType=@ObjType \r\n\t\t\t\tUNION ALL\r\n\t\t\tSELECT  DocEntry, ObjType, VatPrcnt,VatGroup,WTLiable  FROM RPC1 K2 (NOLOCK)--WHERE K2.DocEntry=@DocEntry AND ObjType=@ObjType\r\n\t\t\t\tUNION ALL\r\n\t\t\tSELECT  DocEntry, ObjType, VatPrcnt,VatGroup,WTLiable  FROM PCH3 K2 (NOLOCK)\t\t\t\r\n\t\t\t\tUNION ALL\r\n\t\t\tSELECT  DocEntry, ObjType, VatPrcnt,VatGroup,WTLiable  FROM RPC3 K2 (NOLOCK)\r\n\t\t\t\r\n)\r\nGO\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[O_IDAR] \r\n(\t\r\n)\r\n\r\nRETURNS TABLE \r\n\r\n\r\nAS\r\nRETURN \r\n(\r\n\r\n\t\t\tSELECT \r\n\t\t\t\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GASTO') -- Rate=12  )-- U_IDA_Alicuota='GASTO') \r\n AS 'AlicuotaGasto'\r\n\t\t\t,\r\n\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GASTO') -- Rate=12  )-- U_IDA_Alicuota='GASTO') \r\n AS 'CodigoAlicuotaGasto'\r\n\t\t\t,\r\n\t\t\t\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GENERAL') -- Rate=12  )-- U_IDA_Alicuota='GENERAL') \r\n AS 'AlicuotaGeneral'\r\n\t\t\t,\r\n\t\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GENERAL') -- Rate=12  )-- U_IDA_Alicuota='GENERAL') \r\n AS 'CodigoAlicuotaGeneral'\r\n\t\t\t,\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='REDUCIDA')-- Rate = 8 )--U_IDA_Alicuota='REDUCIDA') \r\n AS 'AlicuotaReducida'\r\n\t\t\t,\r\n\t\t\t\r\n\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='REDUCIDA')-- Rate = 8 )--U_IDA_Alicuota='REDUCIDA') \r\n AS 'CodigoAlicuotaReducida'\r\n\t\t\t,\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='ADICIONAL')--Rate=20 )--U_IDA_Alicuota='ADICIONAL') \r\n AS 'AlicuotaAdicional'\r\n\t\t\t,\r\n\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='ADICIONAL')--Rate=20 )--U_IDA_Alicuota='ADICIONAL') \r\n AS 'CodigoAlicuotaAdicional'\r\n\t\t\t,\r\n\t\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='EXENTO')--Rate=20 )--U_IDA_Alicuota='ADICIONAL') \r\n AS 'CodigoAlicuotaExento'\r\n\t\t\t,\r\n\t\t\t\r\n\t\t\tH2.U_IDA_TipoPersona AS 'TipoPersona',\r\n\t\t\tISNULL(CASE WHEN DocSubType='--' THEN NumAtCard END,'') AS 'NF', \r\n\t\t\tISNULL(CASE WHEN DocSubType<>'--' THEN NumAtCard END,'') AS 'ND', \r\n\t\t\t'' AS 'NC',\r\n\t\t\t'' AS 'FAFE',ISNULL(K2.U_IDA_Serie,'') + ISNULL(K2.U_IDA_NumControl,'') AS 'NroControl',K2.U_IDA_TipoTrans AS 'TipoTran',\r\n\t\t\tISNULL(K2.U_IDA_CompIVA,'') AS 'NroComprobante',ISNULL(K2.DocDate,'') AS 'FechaComp' ,\r\n\t\t\tISNULL(K2.U_IDA_NumFile,'') AS 'NroImportacion', ISNULL(K2.U_IDA_NumFile,'') AS 'ExpedienteImp',\r\n\t\t\tISNULL(U_IDA_RetenTercero,'N') AS 'RetencionTercero',\r\n\t\t\tISNULL(U_IDA_Tercero,'') AS 'Tercero',\r\n\t\t\tISNULL(U_IDA_TipoRet,'') AS 'TipoRet',\r\n\t\t\tISNULL(K2.U_IDA_CompMunicipal,'') AS 'CompMunicipal',K2.[DocEntry]\r\n      ,K2.[DocNum]\r\n      ,K2.[Max1099]\r\n      ,K2.[DocType]\r\n      ,K2.[CANCELED]\r\n      ,K2.[DocStatus]\r\n      ,K2.[InvntSttus]\r\n      ,K2.[DocDate]\r\n      ,K2.[DocDueDate]\r\n      ,K2.[CardCode]\r\n      ,K2.[CardName]\r\n      ,K2.[Address]\r\n      ,K2.[Address2]\r\n      ,K2.[ObjType]\r\n      ,K2.[NumAtCard]\r\n      ,K2.[VatSum]\r\n      ,K2.[VatSumFC]\r\n      ,K2.[DocCur]\r\n      ,K2.[DocTotal]\r\n      ,K2.[DocTotalFC]\r\n      ,K2.[PaidToDate]\r\n      ,K2.[PaidFC]\r\n      ,K2.[Ref1]\r\n      ,K2.[Comments]\r\n      ,K2.[JrnlMemo]\r\n      ,K2.[TransId]\r\n      ,K2.[DocRate]\r\n      ,K2.[SysRate]\r\n      ,K2.[VatSumSy]\r\n      ,K2.[DocTotalSy]\r\n      ,K2.[PaidSys]\r\n      ,K2.[UpdateDate]\r\n      ,K2.[CreateDate]\r\n      ,K2.[TaxDate]\r\n      ,K2.[FinncPriod]\r\n      ,K2.[UserSign]\r\n      ,K2.[VatPaid]\r\n      ,K2.[VatPaidFC]\r\n      ,K2.[VatPaidSys]\r\n      ,K2.[UserSign2]\r\n      ,CONVERT(NVARCHAR(255),K2.[LicTradNum]) AS 'LicTradNum'\r\n      ,K2.[WTSum]\r\n      ,K2.[WTSumFC]\r\n      ,K2.[WTSumSC]\r\n      ,K2.[WTApplied]\r\n      ,K2.[WTAppliedF]\r\n      ,K2.[WTAppliedS]\r\n      ,K2.[CtlAccount]\r\n      ,K2.[BaseVtAt]\r\n      ,K2.[BaseVtAtSC]\r\n      ,K2.[BaseVtAtFC]\r\n      ,K2.[NnSbVAt]\r\n      ,K2.[NnSbVAtSC]\r\n      ,K2.[NbSbVAtFC]\r\n      ,K2.[PaidSum]\r\n      ,K2.[PaidSumFc]\r\n      ,K2.[PaidSumSc]\r\n      ,K2.[NnSbAmnt]\r\n      ,K2.[NnSbAmntSC]\r\n      ,K2.[NbSbAmntFC]\r\n      ,K2.[BaseAmnt]\r\n      ,K2.[BaseAmntSC]\r\n      ,K2.[BaseAmntFC]\r\n      ,K2.[U_IDA_NumControl]\r\n      ,K2.[U_IDA_TipoTrans]\r\n      ,K2.[U_IDA_CompIVA]\r\n      ,K2.[U_IDA_FechaComp]\r\n      ,K2.[U_IDA_FechaContComp]\r\n      ,K2.[U_IDA_MontoCompIVA]\r\n      ,K2.[U_IDA_RetenTercero]\r\n      ,K2.[U_IDA_TipoRet]\r\n      ,K2.[U_IDA_Tercero]\r\n      ,K2.[U_IDA_CompISLR]\r\n      ,K2.[U_IDA_DateCompISLR]\r\n      ,K2.[U_IDA_DateContISLR]\r\n      ,K2.[U_IDA_CodSerie]\r\n      ,K2.[U_IDA_Serie]\r\n      ,K2.[U_IDA_Fafe]\r\n      ,K2.[U_IDA_NumExport]\r\n      ,K2.[U_IDA_TipoDoc]\r\n      ,K2.[U_IDA_NumFile]\r\n      ,K2.[U_IDA_NumImport]\r\n      ,K2.[U_IDA_MontoFafe]\r\n      ,K2.[U_IDA_FechaFafe]\r\n      ,K2.[U_IDA_IsPlanilla]\r\n      ,K2.[U_IDA_PagoElectronic]\r\n      ,K2.[U_IDA_Alicuota]\r\n      ,K2.[U_IDA_CompMunicipal]\r\n      ,K2.[U_IDA_DateCompMun]\r\n      ,K2.[U_IDA_CorteZ]\r\n      ,K2.[U_IDA_SerialImpre]\r\n      ,K2.[U_IDA_DocAnulado]\r\n      ,K2.[DocSubType]\r\n      ,K2.[DiscPrcnt]\r\n      ,K2.[DiscSum]\r\n      ,K2.[DiscSumFC]\r\n      ,K2.[DiscSumSy]\r\n      ,K2.[DocTime] FROM OPCH K2 (NOLOCK) ,OFPR H1 (NOLOCK)  , OCRD H2 (NOLOCK)  WHERE --H1.Name=@Periodo\r\n\t\t--\tAND \r\n\t\t\t K2.DocDate >= H1.F_RefDate AND K2.DocDate <= H1.T_RefDate AND K2.CardCode=H2.CardCode\r\n\t\t\t --, [@BKV_RECEIPT] K3 WHERE K2.DocEntry= --K2.DocEntry=@DocEntry AND ObjType=@ObjType \r\n\t\t\t\t\r\n\t\t\t\tUNION ALL\r\n\t\t\tSELECT \r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GASTO') -- Rate=12  )-- U_IDA_Alicuota='GASTO') \r\n AS 'AlicuotaGasto'\r\n\t\t\t,\r\n\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GASTO') -- Rate=12  )-- U_IDA_Alicuota='GASTO') \r\n AS 'CodigoAlicuotaGasto'\r\n\t\t\t,\r\n\t\t\t\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GENERAL') -- Rate=12  )-- U_IDA_Alicuota='GENERAL') \r\n AS 'AlicuotaGeneral'\r\n\t\t\t,\r\n\t\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='GENERAL') -- Rate=12  )-- U_IDA_Alicuota='GENERAL') \r\n AS 'CodigoAlicuotaGeneral'\r\n\t\t\t,\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='REDUCIDA')-- Rate = 8 )--U_IDA_Alicuota='REDUCIDA') \r\n AS 'AlicuotaReducida'\r\n\t\t\t,\r\n\t\t\t\r\n\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='REDUCIDA')-- Rate = 8 )--U_IDA_Alicuota='REDUCIDA') \r\n AS 'CodigoAlicuotaReducida'\r\n\t\t\t,\r\n\t\t\t(SELECT Rate FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='ADICIONAL')--Rate=20 )--U_IDA_Alicuota='ADICIONAL') \r\n AS 'AlicuotaAdicional'\r\n\t\t\t,\r\n\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='ADICIONAL')--Rate=20 )--U_IDA_Alicuota='ADICIONAL') \r\n AS 'CodigoAlicuotaAdicional'\r\n\t\t\t,\r\n\t\t\t\t(SELECT Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='EXENTO')--Rate=20 )--U_IDA_Alicuota='ADICIONAL') \r\n AS 'CodigoAlicuotaExento'\r\n\t\t\t,\r\n\t\t\t\r\n\t\t\tH2.U_IDA_TipoPersona AS 'TipoPersona',\r\n\t\t\t'' AS 'NF', '' AS 'ND',  NumAtCard AS 'NC',K2.U_IDA_Fafe AS 'FAFE',\r\n\t\t\tISNULL(K2.U_IDA_Serie,'') + ISNULL(K2.U_IDA_NumControl,'') AS 'NroControl', U_IDA_TipoTrans  AS 'TipoTran', \r\n\t\t\tISNULL(K2.U_IDA_CompIVA,'') AS 'NroComprobante',ISNULL(K2.DocDate,'') \r\n\t\t\tAS 'FechaComp' ,\r\n\t\t\tISNULL(K2.U_IDA_NumFile,'') AS 'NroImportacion', ISNULL(K2.U_IDA_NumFile,'') AS 'ExpedienteImp',\r\n\t\t\tISNULL(U_IDA_RetenTercero,'N') AS 'RetencionTercero',\r\n\t\t\tISNULL(U_IDA_Tercero,'') AS 'Tercero',\r\n\t\t\tISNULL(U_IDA_TipoRet,'') AS 'TipoRet',\r\n\t\t\tISNULL(K2.U_IDA_CompMunicipal,'') AS 'CompMunicipal',K2.[DocEntry]\r\n      ,K2.[DocNum]\r\n      ,K2.[Max1099]\r\n      ,K2.[DocType]\r\n      ,K2.[CANCELED]\r\n      ,K2.[DocStatus]\r\n      ,K2.[InvntSttus]\r\n      ,K2.[DocDate]\r\n      ,K2.[DocDueDate]\r\n      ,K2.[CardCode]\r\n      ,K2.[CardName]\r\n      ,K2.[Address]\r\n      ,K2.[Address2]\r\n      ,K2.[ObjType]\r\n      ,K2.[NumAtCard]\r\n      ,K2.[VatSum]\r\n      ,K2.[VatSumFC]\r\n      ,K2.[DocCur]\r\n      ,K2.[DocTotal]\r\n      ,K2.[DocTotalFC]\r\n      ,K2.[PaidToDate]\r\n      ,K2.[PaidFC]\r\n      ,K2.[Ref1]\r\n      ,K2.[Comments]\r\n      ,K2.[JrnlMemo]\r\n      ,K2.[TransId]\r\n      ,K2.[DocRate]\r\n      ,K2.[SysRate]\r\n      ,K2.[VatSumSy]\r\n      ,K2.[DocTotalSy]\r\n      ,K2.[PaidSys]\r\n      ,K2.[UpdateDate]\r\n      ,K2.[CreateDate]\r\n      ,K2.[TaxDate]\r\n      ,K2.[FinncPriod]\r\n      ,K2.[UserSign]\r\n      ,K2.[VatPaid]\r\n      ,K2.[VatPaidFC]\r\n      ,K2.[VatPaidSys]\r\n      ,K2.[UserSign2]\r\n      ,CONVERT(NVARCHAR(255),K2.[LicTradNum]) AS 'LicTradNum'\r\n      ,K2.[WTSum]\r\n      ,K2.[WTSumFC]\r\n      ,K2.[WTSumSC]\r\n      ,K2.[WTApplied]\r\n      ,K2.[WTAppliedF]\r\n      ,K2.[WTAppliedS]\r\n      ,K2.[CtlAccount]\r\n      ,K2.[BaseVtAt]\r\n      ,K2.[BaseVtAtSC]\r\n      ,K2.[BaseVtAtFC]\r\n      ,K2.[NnSbVAt]\r\n      ,K2.[NnSbVAtSC]\r\n      ,K2.[NbSbVAtFC]\r\n      ,K2.[PaidSum]\r\n      ,K2.[PaidSumFc]\r\n      ,K2.[PaidSumSc]\r\n      ,K2.[NnSbAmnt]\r\n      ,K2.[NnSbAmntSC]\r\n      ,K2.[NbSbAmntFC]\r\n      ,K2.[BaseAmnt]\r\n      ,K2.[BaseAmntSC]\r\n      ,K2.[BaseAmntFC]\r\n      ,K2.[U_IDA_NumControl]\r\n      ,K2.[U_IDA_TipoTrans]\r\n      ,K2.[U_IDA_CompIVA]\r\n      ,K2.[U_IDA_FechaComp]\r\n      ,K2.[U_IDA_FechaContComp]\r\n      ,K2.[U_IDA_MontoCompIVA]\r\n      ,K2.[U_IDA_RetenTercero]\r\n      ,K2.[U_IDA_TipoRet]\r\n      ,K2.[U_IDA_Tercero]\r\n      ,K2.[U_IDA_CompISLR]\r\n      ,K2.[U_IDA_DateCompISLR]\r\n      ,K2.[U_IDA_DateContISLR]\r\n      ,K2.[U_IDA_CodSerie]\r\n      ,K2.[U_IDA_Serie]\r\n      ,K2.[U_IDA_Fafe]\r\n      ,K2.[U_IDA_NumExport]\r\n      ,K2.[U_IDA_TipoDoc]\r\n      ,K2.[U_IDA_NumFile]\r\n      ,K2.[U_IDA_NumImport]\r\n      ,K2.[U_IDA_MontoFafe]\r\n      ,K2.[U_IDA_FechaFafe]\r\n      ,K2.[U_IDA_IsPlanilla]\r\n      ,K2.[U_IDA_PagoElectronic]\r\n      ,K2.[U_IDA_Alicuota]\r\n      ,K2.[U_IDA_CompMunicipal]\r\n      ,K2.[U_IDA_DateCompMun]\r\n      ,K2.[U_IDA_CorteZ]\r\n      ,K2.[U_IDA_SerialImpre]\r\n      ,K2.[U_IDA_DocAnulado]\r\n      ,K2.[DocSubType]\r\n      ,K2.[DiscPrcnt]\r\n      ,K2.[DiscSum]\r\n      ,K2.[DiscSumFC]\r\n      ,K2.[DiscSumSy]\r\n      ,K2.[DocTime] FROM ORPC K2 (NOLOCK),OFPR H1 (NOLOCK) , OCRD H2 (NOLOCK) WHERE --H1.Name=@Periodo \r\n\t\t\t--AND \r\n\t\t\tK2.DocDate >= H1.F_RefDate AND K2.DocDate <= H1.T_RefDate AND K2.CardCode=H2.CardCode\r\n\t\t\t--WHERE H1.Name=@Periodo\r\n\t\t\t--WHERE K2.DocEntry=@DocEntry AND ObjType=@ObjType\r\n\r\n)\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[IDA_DireccionTercero]\r\n(\r\n\t@Tercero AS VARCHAR(MAX)\r\n    \r\n)\r\nRETURNS VARCHAR(250)\r\n\r\nAS\r\nBEGIN\r\n\t-- Declare the return variable here\r\n\tDECLARE @ResultVar AS VARCHAR(250)\r\n\r\n\r\nSELECT TOP 1 @ResultVar=( ISNULL(T0.City,'') + ' '+ CONVERT(VARCHAR,ISNULL(T0.Building,''))  \r\n+ ' '+ ISNULL(T0.StreetNo,'') + ' ' + ISNULL(T0.Street,'') ) FROM CRD1 T0 WHERE T0.CardCode=(SELECT \r\nT2.CardCode FROM OCRD T2 WHERE T2.CardName=@Tercero AND T2.CardType='S') \r\nAND T0.AdresType='B'\r\n\r\n\t-- Return the result of the function\r\n\tRETURN @ResultVar\r\n\r\nEND\r\n\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\n\r\nCREATE FUNCTION [dbo].[IDA_Quincena] \r\n(\r\n\t@Quincena AS VARCHAR(20),\r\n\t@ANO as VARCHAR(20),\r\n\t@MES as VARCHAR(20),\r\n\t@Date\tas DATETIME\r\n\t\r\n)\r\nRETURNS VARCHAR(100)\r\n\r\nAS\r\nBEGIN\r\n\t-- Declare the return variable here\r\n\tDECLARE @ResultVar AS VARCHAR(100)\r\n\tDECLARE @From AS DATETIME\r\n\tDECLARE @To AS DATETIME\r\n\t\r\n\t\t\r\n\tIF(@Quincena='01')\r\n\tBEGIN\r\n\t\tSET @From=@ANO+@MES+'01'\r\n\t\tSET @To=@ANO+@MES+'15'\r\n\tEND\r\n\t\tELSE\r\n\tBEGIN\r\n\t\tSET @From=@ANO+@MES+'16'\r\n\t\tSET @To=CONVERT(VARCHAR,DATEADD(s,-1,DATEADD(mm, DATEDIFF(m,0,(@ANO+@MES+'01'))+1,0)),112)\r\n\tEND\r\n\t\r\n\tIF(@From <= @Date AND @To >= @Date)\r\n\tBEGIN\r\n\t\tSET @ResultVar='TRUE'\r\n\tEND\r\n\tELSE\r\n\tBEGIN\r\n\t\tSET @ResultVar='FALSE'\r\n\tEND\r\n\t-- Return the result of the function\r\n\tRETURN @ResultVar\r\n\r\nEND\r\n\r\n\r\nGO\r\n/****** Object:  StoredProcedure [dbo].[GenerarComprobanteIVA]    Script Date: 14/7/2020 9:45:05 p. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROCEDURE [dbo].[GenerarComprobanteIVA] \r\n\t-- Add the parameters for the stored procedure here\r\n @Card1 AS VARCHAR(100),\r\n @Card2 AS VARCHAR(100),\r\n @Quincena AS VARCHAR(100),\r\n @Mes AS VARCHAR(100),\r\n @Ano AS VARCHAR(100),\r\n @Tipo AS VARCHAR(100)\r\n\r\n\r\nAS\r\nBEGIN\r\n\t-- SET NOCOUNT ON added to prevent extra result sets from\r\n\t-- interfering with SELECT statements.\r\n\tSET NOCOUNT ON;\r\n\r\n\r\nDECLARE @Siguiente AS BIGINT\r\nDECLARE @Row AS BIGINT\r\nDECLARE @NroComprobante AS BIGINT\r\nDECLARE @NroComprobanteIni AS BIGINT\r\nDECLARE @Nro AS BIGINT\r\nDECLARE @Result AS INT\r\nDECLARE @Msg AS NVARCHAR(MAX)\r\n\r\nIF (@Tipo<>'03')\r\n\r\nBEGIN\r\n\r\nIF EXISTS (SELECT * FROM sysobjects WHERE name='COMP_IVA_TEMP') \r\nBEGIN\r\nDROP TABLE COMP_IVA_TEMP\r\nEND\r\n\r\nSET @NroComprobante=0\r\n\r\n--- INSERTAR COMPROBANTES EN LA TABLA DE COMPROBANTES---  dbo.[@IDA_COMPROBANTES]\r\nSELECT @Siguiente=Siguiente FROM dbo.[NRO_COMPROBANTE] WHERE TipoSerie='IVA' AND Activo='Y'\r\n\r\n--INSERT INTO dbo.[@IDA_COMPROBANTES]\r\n\r\nSELECT --(CONVERT(VARCHAR,RT2.U_IDA_DocEntry)+CONVERT(VARCHAR,RT2.U_IDA_ObjType)) + RT2.U_IDA_Row \r\n CONVERT(BIGINT,ISNULL((SELECT MAX(CONVERT(BIGINT,Code)) FROM dbo.[@IDA_COMPROBANTES]),0))+ CONVERT(BIGINT,ROW_NUMBER() OVER ( ORDER BY RT2.U_IDA_DocEntry))  AS 'Code'\r\n,\r\n--(CONVERT(VARCHAR,RT2.U_IDA_DocEntry)+CONVERT(VARCHAR,RT2.U_IDA_ObjType)) + RT2.U_IDA_Row \r\n CONVERT(BIGINT,ISNULL((SELECT MAX(CONVERT(BIGINT,Code)) FROM dbo.[@IDA_COMPROBANTES]),0))+ CONVERT(BIGINT,ROW_NUMBER() OVER ( ORDER BY RT2.U_IDA_DocEntry))   AS 'Name'\r\n,RT2.U_IDA_NroControl,RT2.U_IDA_FechaFact\r\n,RT2.U_IDA_ObjType,RT2.U_IDA_DocEntry,RT2.U_IDA_Alicuota,RT2.U_IDA_IVA,\r\nRT2.U_IDA_BaseImp,U_IDA_Retencion,((U_IDA_Total) + (CASE WHEN RT2.U_IDA_Row=1 THEN dbo.IDA_BaseImponible(RT2.U_IDA_ObjType,RT2.U_IDA_DocEntry, 0,(SELECT TOP 1 Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='EXENTO'),'C') ELSE 0 END )) AS  'U_IDA_Total'--,U_IDA_Total\r\n ,CASE WHEN RT2.U_IDA_Row=1 THEN dbo.IDA_BaseImponible(RT2.U_IDA_ObjType,RT2.U_IDA_DocEntry, 0,(SELECT TOP 1 Code FROM OSTC (NOLOCK) WHERE \r\n[ValidForAP] = 'Y' and [Lock] = 'N' AND U_IDA_Alicuota='EXENTO'),'C') ELSE 0 END AS 'U_IDA_Exento'--'Exento B' \r\n,\r\nU_IDA_Fafe,U_IDA_Factura,U_IDA_Credito,U_IDA_Debito,U_IDA_TipoTran,U_IDA_CardCode,\r\nU_IDA_CardName,U_IDA_Agente,U_IDA_NroComp,U_IDA_LicTradNum,U_IDA_TaxIdNo,U_IDA_FechaComp,U_IDA_Row\r\n,'01' AS 'U_IDA_Status', U_IDA_PrcntRet, U_IDA_CompanyAddress,U_IDA_Address,U_IDA_DocSubType,  \r\n(CONVERT(VARCHAR,@Ano)+'-' + CONVERT(VARCHAR,@Mes)) AS 'U_IDA_Periodo', @Quincena AS 'U_IDA_Quincena'\r\nINTO COMP_IVA_TEMP FROM \r\n(SELECT CONVERT(VARCHAR,ROW_NUMBER() OVER ( PARTITION by RT.U_IDA_DocEntry ORDER BY RT.U_IDA_DocEntry)) AS 'U_IDA_Row',* FROM (\r\n\r\nSELECT  \r\n\r\nDISTINCT\r\nCONVERT(VARCHAR,YEAR(GETDATE()))+RIGHT('0'+CONVERT(VARCHAR,MONTH(GETDATE())),2)+\r\n+RIGHT('00000000'+CONVERT(VARCHAR,(CASE WHEN @Tipo='01' THEN \r\n\tCONVERT(VARCHAR, DENSE_RANK() over (ORDER BY T0.CardCode) + @Siguiente - 1 )\r\nELSE\r\n\tCONVERT(VARCHAR, DENSE_RANK() over (ORDER BY T0.CardCode, T0.DocEntry, T0.ObjType, T0.DocSubType) + @Siguiente - 1 )\r\nEND )),8) --+ @Siguiente - 1 \r\n AS 'U_IDA_NroComp',\r\n--CONVERT(VARCHAR,GETDATE(),112) \r\nT0.DocDate AS 'U_IDA_FechaComp',\r\nT0.ObjType AS 'U_IDA_ObjType' ,\r\nT0.DocSubType AS 'U_IDA_DocSubType',\r\nT5.CompnyName as 'U_IDA_Agente', \r\nT5.TaxIdNum AS 'U_IDA_TaxIdNo',\r\nT0.NF AS 'U_IDA_Factura',\r\nT0.ND as 'U_IDA_Debito' ,\r\nT0.NC as 'U_IDA_Credito',\r\nISNULL(T5.CompnyAddr,'') AS 'U_IDA_CompanyAddress',\r\nT0.FAFE as 'U_IDA_Fafe',\r\nT0.DocEntry AS 'U_IDA_DocEntry',\r\n--T0.DocDate,\r\n--T0.CardName as 'Sujeto Retenido',\r\nCASE WHEN T0.RetencionTercero='Y' THEN CASE WHEN T0.TipoRet='IVA' THEN (SELECT TOP 1 LicTradNum FROM OCRD WHERE CardName=T0.Tercero AND CardType = 'S') WHEN T0.TipoRet='Todas' THEN (SELECT TOP 1 LicTradNum FROM OCRD WHERE CardName=T0.Tercero AND CardType = 'S') ELSE T0.LicTradNum  END  ELSE T0.LicTradNum  END as 'U_IDA_LicTradNum',\r\nCASE WHEN T0.RetencionTercero='Y' THEN [dbo].[IDA_DireccionTercero](T0.Tercero) ELSE ISNULL(T0.Address,'') END AS 'U_IDA_Address',\r\nT0.CardCode AS 'U_IDA_CardCode',\r\nCASE WHEN T0.RetencionTercero='Y' THEN CASE WHEN T0.TipoRet='IVA' THEN T0.Tercero  WHEN T0.TipoRet='Todas' THEN T0.Tercero ELSE T0.CardName END ELSE T0.CardName END AS 'U_IDA_CardName',\r\nT1.VatPrcnt AS 'U_IDA_Alicuota',\r\nT1.VatGroup AS 'U_IDA_CodigoAlicuota',\r\nT0.TaxDate AS 'U_IDA_FechaFact',\r\nT0.NroControl  AS 'U_IDA_NroControl',\r\nT0.U_IDA_TipoTrans AS 'U_IDA_TipoTran',\r\n--T2.WTAmnt*T1.VatPrcnt/dbo.IDA_PrcntTotal(T0.ObjType,T0.DocEntry) AS 'Retencion',\r\n--(((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T1.VatPrcnt,'C') *T1.VatPrcnt)/100)  * T4.PrctBsAmnt )/100 AS 'U_IDA_Retencion',\r\n(((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T1.VatPrcnt,T1.VatGroup,'C') *T1.VatPrcnt)/100)  * T4.Rate )/100 AS 'U_IDA_Retencion',\r\n((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T1.VatPrcnt,T1.VatGroup,'C') *T1.VatPrcnt)/100) AS 'U_IDA_IVA',\r\n--T4.PrctBsAmnt AS 'U_IDA_PrcntRet',\r\nT4.Rate AS 'U_IDA_PrcntRet',\r\ndbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T1.VatPrcnt,T1.VatGroup,'C') AS 'U_IDA_BaseImp',\r\n--dbo.IDA_PrcntTotal(T0.ObjType,T0.DocEntry) as 'r',\r\n--t1.VatPrcnt,\r\n--dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, 0,'C') AS 'Exento A',\r\n\r\ndbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T1.VatPrcnt,T1.VatGroup,'C')+ \r\n((dbo.IDA_BaseImponible(T0.ObjType,T0.DocEntry, T1.VatPrcnt,T1.VatGroup,'C') *T1.VatPrcnt)/100) \r\n AS 'U_IDA_Total'  -- base imponible + iva + excento\r\nFROM \r\ndbo.O_IDAR() T0,\r\ndbo.O_IDA1() T1, \r\ndbo.O_IDA5() T2, \r\nOWHT T4, \r\nOADM T5\r\nWHERE \r\nT0.DocEntry=T1.DocEntry  AND \r\nT0.DocEntry=T2.AbsEntry  AND\r\nT0.ObjType = T1.ObjType AND\r\nT0.ObjType = T2.ObjType AND\r\nT2.BaseType='V' AND \r\nT1.VatPrcnt>0 AND T0.TipoTran<>'05' AND --T0.U_IDA_TipoTrans<>'05' AND\r\n--T0.DocNum=17089 and\r\ndbo.IDA_Quincena(@Quincena,@Ano,@Mes,T0.DocDate)='TRUE' AND\r\nT4.WTCode=T2.WTCode AND \r\nT4.U_IDA_TipoRetencion='IVA' \r\nAND \r\n(\r\n\t(T0.CardCode >= @Card1 OR @Card1='') AND \r\n\t(T0.CardCode <= @Card2 OR @Card2='')\r\n)\r\n--AND (T0.U_IDA_CompIVA IS NULL OR T0.U_IDA_CompIVA='')\r\nAND (T0.NroComprobante IS NULL OR T0.NroComprobante='')\r\n) RT\r\n) RT2\r\n\r\nORDER BY CONVERT(BIGINT,RT2.U_IDA_DocEntry)--RT2.U_IDA_Row)--RT2.Row)\r\n\r\nINSERT INTO dbo.[@IDA_COMPROBANTES]  \r\nSELECT * FROM COMP_IVA_TEMP\r\n----- FIN INSERTAR COMPROBANTES-----\r\n\r\n----- OBTENER COMPROBANTES DESDE - HASTA\r\n\r\nSELECT @NroComprobante=MAX(RT2.Nro),\r\n @NroComprobanteIni =MIN(RT2.Nro)\r\nFROM (\r\n\r\nSELECT U_IDA_NroComp AS 'Nro' FROM COMP_IVA_TEMP\r\n) \r\n RT2\r\n----   ASIGNAR COMPROBANTE FACTURA\r\n\r\nUPDATE OPCH SET U_IDA_CompIVA= RT2.Nro\r\n, U_IDA_FechaComp=RT2.U_IDA_FechaComp\r\nFROM \r\nOPCH,\r\n(\r\nSELECT U_IDA_FechaComp, U_IDA_DocEntry AS 'DocEntry' , U_IDA_DocSubType,\r\nU_IDA_NroComp AS 'Nro' FROM COMP_IVA_TEMP WHERE U_IDA_ObjType='18'\r\n) RT2\r\nWHERE OPCH.DocEntry=RT2.DocEntry AND OPCH.DocSubtype=RT2.U_IDA_DocSubType\r\n\r\n------ FIN ASIGNAR COMPROBANTE FACTURA\r\n\r\n\r\n---- ASIGNAR COMPROBANTE  NC\r\n\r\nUPDATE ORPC SET U_IDA_CompIVA= RT2.Nro\r\n, U_IDA_FechaComp=RT2.U_IDA_FechaComp\r\nFROM \r\nORPC,\r\n(\r\nSELECT U_IDA_FechaComp, U_IDA_DocEntry AS 'DocEntry' , \r\nU_IDA_NroComp AS 'Nro' FROM COMP_IVA_TEMP WHERE U_IDA_ObjType='19'\r\n) RT2\r\nWHERE ORPC.DocEntry=RT2.DocEntry \r\n\r\n------ FIN ASIGNAR COMPROBANTE NOTA DE CREDITO\r\n\r\n\r\n\r\n--- ACTUALIZAR NRO DE COMPROBANTE TABLA [@IDA_NRO_COMPROBANTE]\r\n\r\n\r\nIF (@NroComprobante<>0)\r\nBEGIN\r\nDECLARE @NroSig AS BIGINT\r\nSET @Result=1\r\nSET @NroSig=CONVERT(BIGINT,RIGHT(@NroComprobante,8))\r\nUPDATE [NRO_COMPROBANTE] SET Siguiente=@NroSig + 1 WHERE TipoSerie='IVA' AND Activo='Y'\r\n\r\n\r\nSET @Msg=(SELECT 'Se Asignaron los Comprobantes Desde: '+ CONVERT(VARCHAR,@NroComprobanteIni) \r\n+ ' Hasta: ' + CONVERT(VARCHAR,@NroComprobante))\r\n\r\nSELECT @Msg AS 'Message',@Result AS 'Result'\r\n--------------------------------------------------------------   \r\nEND\r\n ELSE\r\n BEGIN\r\n SET @Result=0\r\n SET @Msg=(SELECT 'No existen documentos para los parametros seleccionados')\r\n\r\n SELECT @Msg AS 'Message',@Result AS 'Result'\r\n END\r\n\r\n\r\nEND\r\nELSE\r\nBEGIN\r\nSET @Result=0\r\nSET @Msg=( SELECT 'Los comprobantes de retencion de IVA solo pueden generar por Operacion o Quincenal')\r\n\r\nSELECT @Msg AS 'Message',@Result AS 'Result'\r\nEND\r\n\r\nEND\r\nGO\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE FUNCTION [dbo].[IDA_ComprobantesAnuladosIVA] \r\n(\t\r\n  @NroComp AS VARCHAR(MAX)\r\n \r\n)\r\n\r\nRETURNS TABLE\r\n \r\nAS\r\nRETURN \r\n(\r\n\r\n SELECT \r\nT0.U_IDA_NroComp AS 'COMP',\r\nT0.U_IDA_NroComp AS 'COMP2',\r\nT0.U_IDA_FechaFact AS 'FECHA',\r\nT0.U_IDA_FechaComp AS 'FECHACOMP',\r\nT0.U_IDA_Factura AS 'NroFactura',\r\nT0.U_IDA_NroControl AS 'NroControl',\r\nT0.U_IDA_Credito AS 'NroCredito',\r\nT0.U_IDA_Debito AS 'NroDebito',\r\nT0.U_IDA_TipoTran AS 'TipoTrans',\r\nT0.U_IDA_Total AS 'Total',\r\nCONVERT(DECIMAL(11,2),T0.U_IDA_Alicuota) AS 'Alicuota',\r\nCONVERT(VARCHAR,YEAR(T0.U_IDA_FechaComp)) AS 'Year',\r\nRIGHT('0'+CONVERT(VARCHAR,MONTH(T0.U_IDA_FechaComp)),2) AS 'Month',\r\n*\r\nFROM [@IDA_COMPROBANTES] T0 \r\n\r\n       WHERE T0.U_IDA_NroComp=@NroComp AND \r\n  T0.U_IDA_Status='02'\r\n\r\n)\r\n\r\n\r\nGO\r\n\r\n\r\nGO\r\nSET ANSI_NULLS, QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROCEDURE [dbo].[IDA_AnularComprobanteIVA] \r\n @Desde AS VARCHAR(100),\r\n @Hasta AS VARCHAR(100)\r\n\r\n\r\nAS\r\nBEGIN\r\n\tSET NOCOUNT ON;\r\n\r\nUPDATE [@IDA_COMPROBANTES] SET U_IDA_Status='02'  \r\nWHERE U_IDA_NroComp>=@Desde\r\nAND U_IDA_NroComp<=@Hasta AND U_IDA_Status='01' \r\n\r\nUPDATE OPCH SET U_IDA_CompIVA='', U_IDA_FechaComp='' WHERE U_IDA_CompIVA>=@Desde \r\nAND U_IDA_CompIVA<=@Hasta\r\n\r\nUPDATE ORPC SET U_IDA_CompIVA='', U_IDA_FechaComp='' WHERE U_IDA_CompIVA>=@Desde \r\nAND U_IDA_CompIVA<=@Hasta\r\n\r\nSELECT 'Fueron anulados los comprobandes desde : ' +@Desde + ' hasta: ' + @Hasta AS 'Message'\r\nEND\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateCodigosFiscalesLines]\r\n\r\n@STCCode nvarchar(8),\r\n@LineId int,\r\n@STACode nvarchar(8), \r\n@EfctivRate numeric(19,6)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE STC1 SET STCCode=@STCCode, Line_ID=@LineId, STACode=@STACode, EfctivRate=@EfctivRate WHERE STCCode=@STCCode AND Line_ID=@LineId\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindCodigosFiscalesLines]\r\n\r\n@Code nvarchar(8)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @STACode nvarchar(8)\r\n\r\nSET @STACode=(SELECT TOP 1 STACode FROM STC1 WHERE STCCode=@Code)\r\n\r\nSELECT Code AS 'Code_OSTA', Name AS 'Name_OSTA', Rate AS 'Rate_OSTA', PurchTax, SalesTax FROM OSTA WHERE Code=@STACode\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertCodigosFiscalesLines]\r\n\r\n@STCCode nvarchar(8),\r\n@LineId int,\r\n@STACode nvarchar(8), \r\n@EfctivRate numeric(19,6)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO STC1 (STCCode,Line_ID,STACode,EfctivRate) VALUES (@STCCode,@LineId,@STACode,@EfctivRate)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindClasesImpuestos]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT Code,Name, Rate, PurchTax,SalesTax FROM OSTA\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[AddDeterminacionCuentaMayor]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO ODCM(LinkAct_1,LinkAct_2,LinkAct_3,LinkAct_4,LinkAct_5,LinkAct_6,LinkAct_7) VALUES (NULL,NULL,NULL,NULL,NULL,NULL,NULL)\r\n\r\n\r\nEND\r\n\r\nGO\r\n/****** Object:  StoredProcedure [dbo].[SelectDocNumOVPM]    Script Date: 17/7/2020 6:35:47 p. m. ******/\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[SelectDocNumORCT]\r\n\r\nAS\r\n\r\nDECLARE @DocNum int\r\n\r\nBEGIN\r\n\r\nSET @DocNum =(SELECT (SELECT DISTINCT TOP 1 DocNum FROM ORCT ORDER BY DocNum DESC) + 1 AS DocNum)\r\n\r\nIF(@DocNum IS NULL)\r\nBEGIN \r\nSELECT 1 AS DocNum\r\nEND\r\nELSE\r\nBEGIN\r\nSELECT @DocNum AS DocNum\r\nEND\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdatePaymentMade]\r\n\r\n@DocEntry int,\r\n@DocDate datetime,\r\n@TaxDate datetime,\r\n@DocDueDate datetime,\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar(15),\r\n@Address nvarchar(254),\r\n@CounterRef nvarchar(8),\r\n@JrnlMemo nvarchar(50)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE OVPM SET DocDate=@DocDate, TaxDate=@TaxDate, DocDueDate=@DocDueDate, CardCode=@CardCode, CardName=@CardName, Address=@Address, CounterRef=@CounterRef, JrnlMemo=@JrnlMemo,UpdateDate=GETDATE() WHERE DocEntry=@DocEntry\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindSalesInvoiceBusinessPartner]\r\n\r\n@CardCode nvarchar(15)\r\n\r\nAS\r\n\r\nBEGIN\r\n;WITH jdt1 AS \r\n(\r\n\r\nSELECT \r\nT0.[TransId] AS 'DocEntry',\r\nT0.[Line_ID] AS 'Line_ID',\r\nT0.[TransId] AS 'DocNum',\r\nT0.[TransType] AS 'TransType',\r\nT0.[Account] AS 'CtlAccount',\r\nCAST(CONVERT(nvarchar,T0.RefDate,103)AS nvarchar) AS 'DocDate',\r\nT1.[TransCurr] 'DocCur',\r\nT0.[SYSDeb]-T0.[SYSCred] AS 'DocTotalSy',\r\nT0.[BalScDeb]-T0.[BalScCred] AS 'PaidSys',\r\n\r\nCASE \r\n\t\t\tWHEN T1.[TransCurr]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[Debit] AS decimal (19,2))-CAST(T0.[Credit] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[FCDebit] AS decimal (19,2))-CAST(T0.[FCCredit] AS decimal (19,2))\r\n\t\t\tEND AS 'DocTotal',\r\nCASE \r\n\t\t\tWHEN T1.[TransCurr]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[FCDebit] AS decimal (19,2))-CAST(T0.[FCCredit] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[Debit] AS decimal (19,2))-CAST(T0.[Credit] AS decimal (19,2))\r\n\t\t\tEND AS 'DocTotalFrgn',\t\r\n\t\t\t\r\nCASE \r\n\t\t\tWHEN T1.[TransCurr]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[BalDueDeb] AS decimal (19,2))-CAST(T0.[BalDueCred] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[BalFcDeb] AS decimal (19,2))-CAST(T0.[BalFcCred] AS decimal (19,2))\r\n\t\t\tEND AS 'Paid',\r\nCASE \r\n\t\t\tWHEN T1.[TransCurr]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[BalFcDeb] AS decimal (19,2))-CAST(T0.[BalFcCred] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[BalDueDeb] AS decimal (19,2))-CAST(T0.[BalDueCred] AS decimal (19,2))\r\n\t\t\tEND AS 'PaidFC',\r\n\r\n\r\n'--' AS 'DocSubType',\r\nT0.[LineMemo] AS 'LineMemo',\r\n\r\nCASE \r\n\t\t\tWHEN T1.[FcTotal]=0 THEN CAST(0 AS decimal (19,2))\r\n\t\t\tELSE CAST(T1.[LocTotal]/T1.[FcTotal] AS decimal (19,2))\r\n\t\t\tEND AS 'DocRate',\r\n\r\nCAST(T1.[LocTotal]/T1.[SysTotal] AS decimal (19,2)) AS 'SysRate',\r\nT0.[TransId] AS 'TransId',\r\nT0.[WTSum]  AS 'WTSum',\r\nT0.[WTSumFC]  AS 'WTSumFC',\r\nT0.[WTSumSC]  AS 'WTSumSC',\r\n0  AS 'VatSum',\r\n0  AS 'VatSumFC',\r\n0  AS 'VatSumSy',\r\n0 AS 'WTImporte',\r\n0 AS 'WTImporteFC',\r\n0 AS 'WTImporteSC',\r\n'N' AS 'IsDocument'\r\n\r\n\r\nFROM  [dbo].[JDT1] T0  INNER  JOIN [dbo].[OJDT] T1  ON  T0.[TransId] = T1.[TransId]   INNER  JOIN [dbo].[OCRD] T2\r\n\r\nON  T0.[ShortName] = T2.[CardCode]   WHERE\r\n\r\n((T0.[TransType] <> ('13')  AND  T0.[TransType] <> ('203')  AND  ((T0.[TransType] <> ('24')  AND  T0.[TransType] <> ('-5') ) OR  (T0.[TransType] <> ('24')) OR  (T0.[TransType] = ('-5'))) AND  T0.[TransType] <> ('165')  AND  T0.[TransType] <> ('166')  AND  T0.[TransType] <> ('163')  AND  T0.[TransType] <> ('164')  AND  T0.[TransType] <> ('14')  AND  T0.[TransType] <> ('182') )) AND  T0.[ShortName] = (@CardCode) AND  (T0.[BalDueCred] <> (0)  OR  T0.[BalDueDeb] <> (0) ) AND  (T0.[TransType] <> ('-2') AND T0.[TransType] <> ('-3')) \r\n\r\n)\r\nSELECT \r\nDocEntry,\r\nLine_ID,\r\nDocNum,\r\nTransType,\r\nCtlAccount,\r\nDocDate,\r\nDocCur,\r\nDocTotalSy,\r\n(DocTotalSy-PaidSys) AS 'PaidSys',\r\nDocTotal,\r\nDocTotalFrgn,\t\t\t\t\r\n(DocTotal-Paid) AS 'Paid',\r\n(DocTotalFrgn-PaidFC) AS 'PaidFC',\r\nDocSubType,\r\nLineMemo,\r\nDocRate,\r\nSysRate,\r\nTransId,\r\nWTSum,\r\nWTSumFC,\r\nWTSumSC,\r\nVatSum,\r\nVatSumFC,\r\nVatSumSy,\r\nWTImporte,\r\nWTImporteFC,\r\nWTImporteSC, \r\nIsDocument\r\nFROM \r\n\r\njdt1\r\nUNION\r\n\r\nSELECT \r\nT0.DocEntry AS 'DocEntry',\r\n0 AS 'Line_ID',\r\nT0.DocNum AS 'DocNum',\r\nT0.ObjType AS 'TransType',\r\nT0.CtlAccount AS 'CtlAccount',\r\nCAST(CONVERT(nvarchar,T0.DocDate,103)AS nvarchar) AS 'DocDate',\r\nT0.DocCur AS 'DocCur',\r\nCAST(T0.DocTotalSy AS decimal (19,2)) AS 'DocTotalSy',\r\nCAST(T0.PaidSys AS decimal (19,2)) AS 'PaidSys',\r\nCASE \r\n\t\t\tWHEN T0.DocCur=(SELECT MainCurncy FROM OADM) THEN CAST(T0.DocTotal AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.DocTotalFC AS decimal (19,2))\r\n\t\t\tEND AS 'DocTotal',\r\nCASE \r\n\t\t\tWHEN T0.DocCur=(SELECT MainCurncy FROM OADM) THEN CAST(T0.DocTotalFC AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.DocTotal AS decimal (19,2))\r\n\t\t\tEND AS 'DocTotalFrgn',\t\r\n\t\t\t\r\nCASE \r\n\t\t\tWHEN T0.DocCur=(SELECT MainCurncy FROM OADM) THEN CAST(T0.PaidToDate AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.PaidFC AS decimal (19,2))\r\n\t\t\tEND AS 'Paid',\r\nCASE \r\n\t\t\tWHEN T0.DocCur=(SELECT MainCurncy FROM OADM) THEN CAST(T0.PaidFC AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.PaidToDate AS decimal (19,2))\r\n\t\t\tEND AS 'PaidFC',\r\n\r\n\r\n\r\nT0.[DocSubType] AS 'DocSubType',\r\nT0.[Comments] AS 'LineMemo',\r\nT0.[DocRate] AS 'DocRate', \r\nT0.[SysRate]  AS 'SysRate',\r\nT0.[TransId]  AS 'TransId',\r\nT0.[WTSum]  AS 'WTSum',\r\nT0.[WTSumFC]  AS 'WTSumFC',\r\nT0.[WTSumSC]  AS 'WTSumSC',\r\nT0.[VatSum]  AS 'VatSum',\r\nT0.[VatSumFC]  AS 'VatSumFC',\r\nT0.[VatSumSy]  AS 'VatSumSy',\r\n\r\nCASE \r\n\t\t\tWHEN T0.DocCur=(SELECT MainCurncy FROM OADM) THEN ISNULL((SELECT SUM(TaxbleAmnt) FROM INV5 WHERE AbsEntry=T0.[DocEntry] AND Category='P'),0)\r\n\t\t\tELSE ISNULL((SELECT SUM(TaxbleAmntFC) FROM INV5 WHERE AbsEntry=T0.[DocEntry] AND Category='P'),0)\r\n\t\t\tEND AS 'WTImporte',\r\nCASE \r\n\t\t\tWHEN T0.DocCur=(SELECT MainCurncy FROM OADM) THEN ISNULL((SELECT SUM(TaxbleAmntFC) FROM INV5 WHERE AbsEntry=T0.[DocEntry] AND Category='P'),0)\r\n\t\t\tELSE ISNULL((SELECT SUM(TaxbleAmnt) FROM INV5 WHERE AbsEntry=T0.[DocEntry] AND Category='P'),0)\r\n\t\t\tEND AS 'WTImporteFC',\r\n\r\nISNULL((SELECT SUM(TaxbleAmntSC) FROM INV5 WHERE AbsEntry=T0.[DocEntry] AND Category='P'),0) AS 'WTImporteSC',\r\n'Y' AS 'IsDocument'\r\n\r\nFROM [OINV] T0  INNER  JOIN [dbo].[INV1] T1  ON  T1.[DocEntry] = T0.[DocEntry] \r\n INNER  JOIN [dbo].[JDT1] T2  ON  T2.[TransId] = T0.[TransId]\r\nWHERE T0.[CardCode] = (@CardCode) AND  T0.[DocStatus] = ('O')\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertPaymentReceived]\r\n\r\n@DocNum int,\r\n@DocDate datetime,\r\n@TaxDate datetime,\r\n@DocDueDate datetime,\r\n@Comments nvarchar(254),\r\n@DocType char(1),\r\n@Canceled char(1),\r\n@UserSign int,\r\n@UpdateDate datetime,\r\n@FinncPriod int,\r\n@Address nvarchar(254),\r\n@ObjType nvarchar(20),\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar(100),\r\n@JrnlMemo nvarchar(50),\r\n@DocCurr nvarchar(3),\r\n@DocTotal numeric (19,6),\r\n@DocTotalFC numeric (19,6),\r\n@DocTotalSy numeric (19,6),\r\n@TransId int,\r\n@SysRate numeric (19,6),\r\n@DocRate numeric (19,6),\r\n@BpAct nvarchar(15),\r\n@CashAcct nvarchar(15),\r\n@CashSum numeric (19,6),\r\n@CashSumFC numeric (19,6),\r\n@CashSumSy numeric (19,6),\r\n@TrsfrAcct nvarchar(15),\r\n@TrsfrSum numeric (19,6),\r\n@TrsfrSumFC numeric (19,6),\r\n@TrsfrSumSy numeric (19,6),\r\n@TrsfrDate datetime,\r\n@TrsfrRef nvarchar(27),\r\n@CheckAcct nvarchar (15),\r\n@CheckSum numeric (19,6),\r\n@CheckSumFC numeric (19,6),\r\n@CheckSumSy numeric (19,6),\r\n@PayNoDoc char(1),\r\n@NoDocSum numeric (19,6),\r\n@NoDocSumFC numeric (19,6),\r\n@NoDocSumSy numeric (19,6),\r\n@CounterRef nvarchar(8)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO ORCT (DocNum,DocDate,TaxDate,DocDueDate,Comments,DocType,Canceled,UserSign,UpdateDate, FinncPriod,Address, ObjType, CardCode,CardName,JrnlMemo, DocCurr, DocTotal, DocTotalFC,DocTotalSy,TransId,SysRate,DocRate,BpAct,CashAcct,CashSum,CashSumFC,CashSumSy,TrsfrAcct,TrsfrSum,TrsfrSumFC,TrsfrSumSy,TrsfrDate,TrsfrRef,CheckAcct,CheckSum,CheckSumSy,CheckSumFC,PayNoDoc,NoDocSum,NoDocSumFC,NoDocSumSy,CounterRef ) VALUES(@DocNum,@DocDate,@TaxDate,@DocDueDate,@Comments,@DocType,@Canceled,@UserSign,@UpdateDate, @FinncPriod,@Address, @ObjType, @CardCode,@CardName,@JrnlMemo, @DocCurr, @DocTotal, @DocTotalFC,@DocTotalSy,@TransId,@SysRate,@DocRate,@BpAct,@CashAcct,@CashSum,@CashSumFC,@CashSumSy,@TrsfrAcct,@TrsfrSum,@TrsfrSumFC,@TrsfrSumSy,@TrsfrDate,@TrsfrRef,@CheckAcct,@CheckSum,@CheckSumSy,@CheckSumFC,@PayNoDoc,@NoDocSum,@NoDocSumFC,@NoDocSumSy,@CounterRef) \r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertPaymentReceivedLines]\r\n\r\n@DocNum int,\r\n@InvoiceId int,\r\n@DocEntry int,\r\n@SumApplied numeric (19,6),\r\n@AppliedFC numeric (19,6),\r\n@AppliedSys numeric (19,6),\r\n@VatApplied numeric (19,6),\r\n@VatAppldFC numeric (19,6),\r\n@VatAppldSy numeric (19,6),\r\n@WtInvCatS numeric (19,6),\r\n@WtInvCatSF numeric (19,6),\r\n@WtInvCatSS numeric (19,6),\r\n@InvType nvarchar(20),\r\n@ObjType nvarchar(20),\r\n@DocSubType nvarchar(2),\r\n@DocTransId int,\r\n@DocRate numeric (19,6),\r\n@U_IDA_CompIVA nvarchar(20),\r\n@U_IDA_FechaComp datetime,\r\n@U_IDA_MontoCompIVA numeric (19,6),\r\n@U_IDA_CompISLR nvarchar(20),\r\n@U_IDA_DateCompISLR datetime\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO RCT2 (DocNum,InvoiceId,DocEntry,SumApplied,AppliedFC,AppliedSys,vatApplied,vatAppldFC,vatAppldSy, WtInvCatS,WtInvCatSF,WtInvCatSS,InvType,ObjType,DocSubType,DocTransId,DocRate,U_IDA_CompIVA,U_IDA_FechaComp,U_IDA_MontoCompIVA,U_IDA_CompISLR,U_IDA_DateCompISLR) VALUES(@DocNum,@InvoiceId,@DocEntry,@SumApplied,@AppliedFC,@AppliedSys,@vatApplied,@vatAppldFC,@vatAppldSy, @WtInvCatS,@WtInvCatSF,@WtInvCatSS,@InvType,@ObjType,@DocSubType,@DocTransId,@DocRate,@U_IDA_CompIVA,@U_IDA_FechaComp,@U_IDA_MontoCompIVA,@U_IDA_CompISLR,@U_IDA_DateCompISLR) \r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindSalesSpecific]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT * FROM OINV WHERE DocNum=@DocNum\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GetDocumentAccountOINV]\r\n\r\n@DocEntry int,\r\n@TransType nvarchar(20)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result nvarchar(15)\r\n\r\nSET @Result= (SELECT CtlAccount FROM OINV WHERE DocEntry=@DocEntry AND ObjType=@TransType)\r\n\r\nIF(@Result <> '')\r\nBEGIN\r\nSELECT @Result AS 'CtlAccount'\r\nEND\r\nELSE\r\nBEGIN\r\nSET @Result= (SELECT TOP 1 Account FROM JDT1 WHERE TransId=@DocEntry AND TransType=@TransType)\r\nSELECT @Result AS 'CtlAccount'\r\nEND\r\n\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdatePaymentReceivedSales]\r\n\r\n@DocEntry int,\r\n@PaidToDate numeric (19,6),\r\n@PaidFC numeric (19,6),\r\n@PaidSys numeric (19,6),\r\n@PaidSum numeric (19,6),\r\n@PaidSumFc numeric (19,6),\r\n@PaidSumSc numeric (19,6)\r\n\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\n\r\nDECLARE @PaidSumResult numeric(19,6)\r\n\r\nUPDATE OINV SET PaidToDate=@PaidToDate, PaidFC=@PaidFC, PaidSys=@PaidSys, PaidSum=@PaidSum, PaidSumFc=@PaidSumFc, PaidSumSc=@PaidSumSc WHERE DocEntry=@DocEntry\r\n\r\nSET @PaidSumResult=(SELECT PaidSum FROM OINV WHERE DocEntry=@DocEntry)\r\n\r\nIF(@PaidSumResult<=0)\r\nBEGIN\r\nUPDATE OINV SET DocStatus='C' WHERE DocEntry=@DocEntry\r\nEND\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[PreviousPaymentReceived]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result int\r\n\r\nSET @Result=(SELECT Previous\r\nFROM\r\n    (Select DocNum,LAG(DocNum) over (order by DocNum) Previous\r\n      from ORCT) AS PreviousPaymentMade\r\n Where DocNum=@DocNum)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM ORCT WHERE DocNum=@Result\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM ORCT ORDER BY DocNum DESC\r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[NextPaymentReceived]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Result int\r\n\r\nSET @Result=(SELECT Siguiente\r\nFROM\r\n    (Select DocNum,LEAD(DocNum) over (order by DocNum) Siguiente\r\n      from ORCT) AS NextQueryPaymentMade\r\n Where DocNum=@DocNum)\r\n\r\n IF(@Result<>'')\r\n BEGIN\r\n SELECT * FROM ORCT WHERE DocNum=@Result\r\n END\r\n ELSE\r\n IF(@Result IS NULL)\r\n BEGIN\r\n SELECT TOP 1 * FROM ORCT ORDER BY DocNum\r\n END\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FirstPaymentReceived]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Query int\r\n\r\nSET @Query=(SELECT COUNT(*) FROM ORCT)\r\n\r\nIF(@Query>0)\r\nBEGIN\r\nSELECT TOP 1 * FROM ORCT ORDER BY DocNum\r\nEND\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[LastPaymentReceived]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Query int\r\n\r\nSET @Query=(SELECT COUNT(*) FROM ORCT)\r\n\r\nIF(@Query>0)\r\nBEGIN\r\nSELECT TOP 1 * FROM ORCT ORDER BY DocNum DESC\r\nEND\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindSalesInvoiceCustomerSpecific]\r\n\r\n@DocEntry int,\r\n@TransType nvarchar(20)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nselect\t\r\n\t\tT0.[DocEntry] AS 'DocEntry',\r\n\t\t0 AS 'Line_ID',\r\n\t\tT0.[DocNum] AS 'DocNum',\t\t\r\n\t\tT0.[ObjType] AS 'TransType',\r\n\t\tT0.[CtlAccount] AS 'CtlAccount',\r\n\t\tCAST(CONVERT(nvarchar,T0.DocDate,103)AS nvarchar) AS 'DocDate',\r\n\t\tT0.DocCur AS 'DocCur',\r\n\t\tCAST(T0.DocTotalSy AS decimal (19,2)) AS 'DocTotalSy',\r\n\t\tCAST(T0.PaidSys AS decimal (19,2)) AS 'PaidSys',\r\n\t\t\r\n\t\tCASE \r\n\t\t\tWHEN T0.[DocCur]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[DocTotal] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[DocTotalFC] AS decimal (19,2))\r\n\t\t\tEND AS 'DocTotal',\r\nCASE \r\n\t\t\tWHEN T0.[DocCur]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[DocTotalFC] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[DocTotal] AS decimal (19,2))\r\n\t\t\tEND AS 'DocTotalFrgn',\t\r\nCASE \r\n\t\t\tWHEN T0.[DocCur]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[PaidToDate] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[PaidFC] AS decimal (19,2))\r\n\t\t\tEND AS 'Paid',\r\nCASE \r\n\t\t\tWHEN T0.[DocCur]=(SELECT MainCurncy FROM OADM) THEN CAST([PaidFC] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[PaidToDate] AS decimal (19,2))\r\n\t\t\tEND AS 'PaidFC',\r\n\r\n\t\t\tT0.[DocSubType] AS 'DocSubType',\r\n\t\t\tT0.[Comments] AS 'LineMemo',\r\n\t\t\tT0.[DocRate] AS 'DocRate', \r\n\t\t\tT0.[SysRate]  AS 'SysRate',\r\n\t\t\tT0.[TransId]  AS 'TransId',\r\n\t\t\tT0.[WTSum]  AS 'WTSum',\r\n\t\t\tT0.[WTSumFC]  AS 'WTSumFC',\r\n\t\t\tT0.[WTSumSC]  AS 'WTSumSC',\r\n\t\t\tT0.[VatSum]  AS 'VatSum',\r\n\t\t\tT0.[VatSumFC]  AS 'VatSumFC',\r\n\t\t\tT0.[VatSumSy]  AS 'VatSumSy',\r\n\r\nCASE \r\n\t\t\tWHEN T0.DocCur=(SELECT MainCurncy FROM OADM) THEN ISNULL((SELECT SUM(TaxbleAmnt) FROM PCH5 WHERE AbsEntry=T0.[DocEntry] AND Category='P'),0)\r\n\t\t\tELSE ISNULL((SELECT SUM(TaxbleAmntFC) FROM PCH5 WHERE AbsEntry=T0.[DocEntry] AND Category='P'),0)\r\n\t\t\tEND AS 'WTImporte',\r\nCASE \r\n\t\t\tWHEN T0.DocCur=(SELECT MainCurncy FROM OADM) THEN ISNULL((SELECT SUM(TaxbleAmntFC) FROM PCH5 WHERE AbsEntry=T0.[DocEntry] AND Category='P'),0)\r\n\t\t\tELSE ISNULL((SELECT SUM(TaxbleAmnt) FROM PCH5 WHERE AbsEntry=T0.[DocEntry] AND Category='P'),0)\r\n\t\t\tEND AS 'WTImporteFC',\r\n\r\nISNULL((SELECT SUM(TaxbleAmntSC) FROM PCH5 WHERE AbsEntry=T0.[DocEntry] AND Category='P'),0) AS 'WTImporteSC',\r\n\r\n\t\t\t\r\n\t\tT1.[U_IDA_CompIVA],\r\n\t\tT1.[U_IDA_FechaComp],\r\n\t\tT1.[U_IDA_MontoCompIVA],\r\n\t\tT1.[U_IDA_DateCompISLR],\r\n\t\tT1.[U_IDA_CompISLR],\r\n\t\t'Y' AS 'IsDocument'\r\n\r\n\t\tfrom [OINV] T0\r\n\t    INNER JOIN [RCT2] T1 ON T1.[DocEntry]=T0.[DocEntry]\r\n\t\tWHERE T1.[DocNum]=@DocEntry AND T1.InvType=@TransType\r\n\r\n\t\tUNION \r\n\r\n\t\tSELECT \r\nT0.[TransId] AS 'DocEntry',\r\nT0.[Line_ID] AS 'Line_ID',\r\nT0.[TransId] AS 'DocNum',\r\nT0.[TransType] AS 'TransType',\r\nT0.[Account] AS 'CtlAccount',\r\nCAST(CONVERT(nvarchar,T0.RefDate,103)AS nvarchar) AS 'DocDate',\r\nT1.[TransCurr] 'DocCur',\r\nT0.[SYSDeb]-T0.[SYSCred] AS 'DocTotalSy',\r\nT0.[BalScDeb]-T0.[BalScCred] AS 'PaidSys',\r\n\r\nCASE \r\n\t\t\tWHEN T1.[TransCurr]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[Debit] AS decimal (19,2))-CAST(T0.[Credit] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[FCDebit] AS decimal (19,2))-CAST(T0.[FCCredit] AS decimal (19,2))\r\n\t\t\tEND AS 'DocTotal',\r\nCASE \r\n\t\t\tWHEN T1.[TransCurr]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[FCDebit] AS decimal (19,2))-CAST(T0.[FCCredit] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[Debit] AS decimal (19,2))-CAST(T0.[Credit] AS decimal (19,2))\r\n\t\t\tEND AS 'DocTotalFrgn',\t\r\n\t\t\t\r\nCASE \r\n\t\t\tWHEN T1.[TransCurr]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[BalDueDeb] AS decimal (19,2))-CAST(T0.[BalDueCred] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[BalFcDeb] AS decimal (19,2))-CAST(T0.[BalFcCred] AS decimal (19,2))\r\n\t\t\tEND AS 'Paid',\r\nCASE \r\n\t\t\tWHEN T1.[TransCurr]=(SELECT MainCurncy FROM OADM) THEN CAST(T0.[BalFcDeb] AS decimal (19,2))-CAST(T0.[BalFcCred] AS decimal (19,2))\r\n\t\t\tELSE CAST(T0.[BalDueDeb] AS decimal (19,2))-CAST(T0.[BalDueCred] AS decimal (19,2))\r\n\t\t\tEND AS 'PaidFC',\r\n\r\n\r\n'--' AS 'DocSubType',\r\nT0.[LineMemo] AS 'LineMemo',\r\n\r\nCASE \r\n\t\t\tWHEN T1.[FcTotal]=0 THEN CAST(0 AS decimal (19,2))\r\n\t\t\tELSE CAST(T1.[LocTotal]/T1.[FcTotal] AS decimal (19,2))\r\n\t\t\tEND AS 'DocRate',\r\n\r\nCAST(T1.[LocTotal]/T1.[SysTotal] AS decimal (19,2)) AS 'SysRate',\r\nT0.[TransId] AS 'TransId',\r\nT0.[WTSum]  AS 'WTSum',\r\nT0.[WTSumFC]  AS 'WTSumFC',\r\nT0.[WTSumSC]  AS 'WTSumSC',\r\n0 AS 'VatSum',\r\n0  AS 'VatSumFC',\r\n0 AS 'VatSumSy',\r\n0 AS 'WTImporte',\r\n0 AS 'WTImporteFC',\r\n0 AS 'WTImporteSC',\r\nT3.[U_IDA_CompIVA],\r\n\t\tT3.[U_IDA_FechaComp],\r\n\t\tT3.[U_IDA_MontoCompIVA],\r\n\t\tT3.[U_IDA_DateCompISLR],\r\n\t\tT3.[U_IDA_CompISLR],\r\n\t\t'N' AS 'IsDocument'\r\n\r\n\r\nFROM  [dbo].[JDT1] T0  INNER  JOIN [dbo].[OJDT] T1  ON  T0.[TransId] = T1.[TransId]   INNER  JOIN [dbo].[OCRD] T2\r\n\r\nON  T0.[ShortName] = T2.[CardCode] \r\n\r\nINNER JOIN [RCT2] T3 ON T1.[TransId]=T3.[DocTransId]\r\n\t\tWHERE \r\n\r\nT3.[DocNum]=@DocEntry AND T3.InvType=@TransType AND ((T0.[TransType] <> ('13')  AND  T0.[TransType] <> ('204')  AND  ((T0.[TransType] <> ('46')  AND  T0.[TransType] <> ('-5') ) OR  (T0.[TransType] <> ('46')) OR  (T0.[TransType] = ('-5'))) AND  T0.[TransType] <> ('165')  AND  T0.[TransType] <> ('166')  AND  T0.[TransType] <> ('163')  AND  T0.[TransType] <> ('164')  AND  T0.[TransType] <> ('19')  AND  T0.[TransType] <> ('182') )) AND  (T0.[TransType] <> ('-2') AND T0.[TransType] <> ('-3')) \r\n\r\n\r\nEND\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindPaymentReceivedLines]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT DocNum, InvType FROM RCT2 WHERE DocNum=@DocEntry\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindPaymentReceived]\r\n\r\n@DocNum int,\r\n@DocDate datetime, \r\n@TaxDate datetime,\r\n@DocDueDate datetime,\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar(100),\r\n@Address nvarchar(254),\r\n@CounterRef nvarchar(8),\r\n@JrnlMemo nvarchar(50),\r\n@TransId int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\n\r\nSELECT * FROM ORCT WHERE DocNum LIKE CAST(@DocNum AS nvarchar)+ '%' OR DocDate LIKE CAST(@DocDate AS nvarchar) + '%' OR TaxDate LIKE CAST(@TaxDate AS nvarchar)+ '%' OR DocDueDate LIKE CAST(@DocDueDate AS NVARCHAR) + '%' OR CardCode LIKE @CardCode + '%' OR CardName LIKE @CardName + '%' OR Address LIKE @Address + '%' OR CounterRef LIKE @CounterRef + '%' OR JrnlMemo LIKE @JrnlMemo + '%' OR TransId LIKE CAST(@TransId AS nvarchar) + '%'\r\n\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdatePaymentReceived]\r\n\r\n@DocEntry int,\r\n@DocDate datetime,\r\n@TaxDate datetime,\r\n@DocDueDate datetime,\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar(15),\r\n@Address nvarchar(254),\r\n@CounterRef nvarchar(8),\r\n@JrnlMemo nvarchar(50)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE ORCT SET DocDate=@DocDate, TaxDate=@TaxDate, DocDueDate=@DocDueDate, CardCode=@CardCode, CardName=@CardName, Address=@Address, CounterRef=@CounterRef, JrnlMemo=@JrnlMemo,UpdateDate=GETDATE() WHERE DocEntry=@DocEntry\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GetAccountTransferAc]\r\n\r\n@ItemCode nvarchar(50)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\n\r\nSELECT TransferAc FROM OITM WHERE ItemCode=@ItemCode\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindEntradaMercanciaLines]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT DocEntry,ItemCode,Dscription,Quantity,Price,Currency,LineTotal,TotalSumSy,TotalFrgn,DocDate,VatGroup,VatPrcnt,WtLiable,AcctCode, VatSum, VatSumSy, VatSumFrgn, GTotal, GTotalFC, GTotalSC, DataSource, UomCode,UomEntry,NumPerMsr, UomCode2, UomEntry2, NumPerMsr2, unitMsr, unitMsr2 FROM PDN1 WHERE DocEntry=@DocEntry\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindEntradaMercancia]\r\n\r\n@DocNum int,\r\n@DocDate datetime, \r\n@TaxDate datetime,\r\n@DocDueDate datetime,\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar(100),\r\n@NumAtCard nvarchar(100),\r\n@Comments nvarchar(254)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT * FROM OPDN WHERE DocNum LIKE CAST(@DocNum AS nvarchar)+ '%' OR DocDate LIKE CAST(@DocDate AS nvarchar) + '%' OR TaxDate LIKE CAST(@TaxDate AS nvarchar)+ '%' OR DocDueDate LIKE CAST(@DocDueDate AS NVARCHAR) + '%' OR CardCode LIKE @CardCode + '%' OR CardName LIKE @CardName + '%' OR NumAtCard LIKE @NumAtCard + '%' OR Comments LIKE @Comments + '%'\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GetAccountSaleCostAc]\r\n\r\n@ItemCode nvarchar(50)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\n\r\nSELECT SaleCostAc FROM OITM WHERE ItemCode=@ItemCode\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeleteEntregaMercancia]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @CON INT\r\n\r\nSET @CON=@DocEntry\r\n\r\nSET @CON=@CON-1\r\n\r\nDELETE FROM ODLN WHERE DocEntry=@DocEntry\r\n\r\nDBCC CHECKIDENT ('ODLN', RESEED, @CON)\r\nDBCC CHECKIDENT ('ODLN', RESEED, @CON)\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeleteEntregaMercanciaLines]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDELETE FROM DLN1 WHERE DocEntry=@DocEntry\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindEntregaMercancia]\r\n\r\n@DocNum int,\r\n@DocDate datetime, \r\n@TaxDate datetime,\r\n@DocDueDate datetime,\r\n@CardCode nvarchar(15),\r\n@CardName nvarchar(100),\r\n@NumAtCard nvarchar(100),\r\n@Comments nvarchar(254)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT * FROM ODLN WHERE DocNum LIKE CAST(@DocNum AS nvarchar)+ '%' OR DocDate LIKE CAST(@DocDate AS nvarchar) + '%' OR TaxDate LIKE CAST(@TaxDate AS nvarchar)+ '%' OR DocDueDate LIKE CAST(@DocDueDate AS NVARCHAR) + '%' OR CardCode LIKE @CardCode + '%' OR CardName LIKE @CardName + '%' OR NumAtCard LIKE @NumAtCard + '%' OR Comments LIKE @Comments + '%'\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindEntregaMercanciaLines]\r\n\r\n@DocEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT DocEntry,ItemCode,Dscription,Quantity,Price,Currency,LineTotal,TotalSumSy,TotalFrgn,DocDate,VatGroup,VatPrcnt,WtLiable,AcctCode, VatSum, VatSumSy, VatSumFrgn, GTotal, GTotalFC, GTotalSC, DataSource,UomCode,UomEntry,NumPerMsr, UomCode2, UomEntry2, NumPerMsr2, unitMsr, unitMsr2, IsTax, StartValue FROM DLN1 WHERE DocEntry=@DocEntry\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GetBaseRef]\r\n\r\n@ObjType nvarchar(20)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT COUNT(*)+1 AS 'BaseRef' FROM OJDT WHERE TransType=@ObjType\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GetLastTransSeq]\r\n\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1 TransSeq FROM OINM ORDER BY TransSeq DESC\r\n\r\nEND\r\n\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindPerdidaDiferenciaTipoCambio]\r\n\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT LinkAct_4 AS 'AcctCode' FROM ODCM\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindBeneficioDiferenciaTipoCambio]\r\n\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT LinkAct_3 AS 'AcctCode' FROM ODCM\r\n\r\nEND\r\n\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindBeneficioDiferenciaConversion]\r\n\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT LinkAct_5 AS 'AcctCode' FROM ODCM\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindPerdidaDiferenciaConversion]\r\n\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT LinkAct_6 AS 'AcctCode' FROM ODCM\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindDocEntryOVPM]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT DocEntry FROM OVPM WHERE DocNum=@DocNum\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindDocEntryORCT]\r\n\r\n@DocNum int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT DocEntry FROM ORCT WHERE DocNum=@DocNum\r\n\r\nEND\r\n\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[VerifyCuentasNoAsociadas]\r\n\r\n@AcctCode nvarchar(15)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT AcctCode, AcctName FROM OACT WHERE LocManTran='N' AND Postable='Y' AND AcctCode=@AcctCode\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GenerateExchangeRateDifferenceAccountAlternate]\r\n\r\n@AccountGanancia nvarchar(15),\r\n@AccountPerdida nvarchar(15),\r\n@F_DueDate datetime,\r\n@T_DueDate datetime,\r\n@AcctCode nvarchar(15),\r\n@Rate numeric(19,6)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\n\r\nSELECT\r\nT0.[Account],\r\nT0.[ShortName],\r\nT2.[AcctName],\r\nCAST(SUM(T0.[Credit]-T0.[Debit])AS decimal(19,2)) AS 'SaldoME',\r\nCAST(SUM(T0.[Credit]-T0.[Debit]) AS decimal(19,2)) AS 'Saldo',\r\nCAST((SUM(T0.[FCCredit]-T0.[FCDebit])*@Rate)-SUM(T0.[Credit]-T0.[Debit])AS decimal(19,2)) AS 'Diferencia',\r\nT0.[FCCurrency],\r\nISNULL(T4.[CardType],'N') AS 'Type'\r\nFROM  [dbo].[JDT1] T0  INNER  JOIN [dbo].[OJDT] T1  ON  T1.[TransId] = T0.[TransId]\r\nINNER  JOIN [dbo].[OACT] T2  ON  T2.[AcctCode] = T0.[Account]\r\nLEFT JOIN [dbo].[OCRD] T4 ON T4.[CardCode]=T0.[ShortName]\r\nWHERE T0.[FCCurrency]<>(SELECT MainCurncy FROM OADM) AND T0.[Account] = (@AcctCode) AND  T0.[DueDate] >= (@F_DueDate)  AND  T0.[DueDate] <= (@T_DueDate) AND T2.[ActType]='N' AND T0.[Account]<>@AccountGanancia AND T0.[Account]<>@AccountPerdida  GROUP BY T0.[Account], T0.[FCCurrency], T4.[CardType], T0.[ShortName], T2.[AcctName] HAVING CAST((SUM(T0.[FCCredit]-T0.[FCDebit])*@Rate)-SUM(T0.[Credit]-T0.[Debit])AS decimal(19,2))<>0\r\n\r\n\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GenerateExchangeConversionAccountAlternate]\r\n\r\n@AcctCode nvarchar(15),\r\n@Rate numeric(19,6)\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @SysCurrency nvarchar(3)\r\n\r\nSET @SysCurrency=(SELECT TOP 1 SysCurrncy from OADM)\r\n\r\nSELECT\r\nT0.[Account],\r\nT0.[ShortName],\r\nT2.[AcctName],\r\nCAST((SUM(T0.[SYSCred]-T0.[SYSDeb]))AS decimal(19,2)) AS 'SaldoMS',\r\nCAST((SUM(T0.[Credit]-T0.[Debit]))AS decimal(19,2)) AS 'Saldo',\r\nCAST((SUM(T0.[Credit]-T0.[Debit]))/(@Rate)AS decimal(19,2)) AS 'SaldoConvertido',\r\nCAST(((SUM(T0.[Credit]-T0.[Debit]))/(@Rate)-(SUM(T0.[SYSCred]-T0.[SYSDeb])))AS decimal(19,2)) AS 'Diferencia',\r\nISNULL(T4.[CardType],'N') AS 'Type'\r\nFROM  [dbo].[JDT1_PRUEBA] T0  INNER  JOIN [dbo].[OJDT_PRUEBA] T1  ON  T1.[TransId] = T0.[TransId]\r\nLEFT  JOIN [dbo].[OACT] T2  ON  T2.[AcctCode] = T0.[Account]\r\nLEFT JOIN [dbo].[OCRD] T4 ON T4.[CardCode]=T0.[ShortName]\r\nWHERE T0.[Account] =@AcctCode AND T2.[ActType]='N' GROUP BY T0.Account, T0.ShortName, T2.AcctName, T4.CardType HAVING CAST(((SUM(T0.[Credit]-T0.[Debit]))/@Rate)-(SUM(T0.[SYSCred]-T0.[SYSDeb])) AS decimal(19,2))<>0\r\n\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[DeleteJournalEntrysTests]\r\n\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDELETE FROM OJDT_PRUEBA\r\n\r\nDELETE FROM JDT1_PRUEBA\r\n\r\nEND\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertJournalEntryTest]\r\n\r\n@TransId int,\r\n@RefDate datetime,\r\n@TaxDate datetime,\r\n@DueDate datetime,\r\n@Memo nvarchar(50),\r\n@Ref1 nvarchar(100),\r\n@Ref2 nvarchar(100),\r\n@CreateDate datetime,\r\n@UserSign int,\r\n@TransCurr nvarchar(3),\r\n@BaseRef int,\r\n@FinncPriod int,\r\n@LocTotal numeric(19,6),\r\n@SysTotal numeric(19,6),\r\n@FcTotal numeric(19,6),\r\n@TransType nvarchar(20)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO OJDT_PRUEBA (TransId,RefDate,TaxDate,DueDate,Memo,Ref1,Ref2,CreateDate,UserSign, TransCurr, BaseRef, FinncPriod, LocTotal, SysTotal, FcTotal, TransType) VALUES(@TransId,@RefDate,@TaxDate,@DueDate,@Memo,@Ref1, @Ref2, @CreateDate, @UserSign,@TransCurr, @BaseRef, @FinncPriod, @LocTotal, @SysTotal, @FcTotal,@TransType)\r\n\r\nEND\r\n\r\n\r\nGO\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[InsertJournalEntryLinesTest]\r\n\r\n@TransId int,\r\n@LineId int,\r\n@RefDate datetime,\r\n@TaxDate datetime,\r\n@DueDate datetime,\r\n@Account nvarchar(15),\r\n@ShortName nvarchar(15),\r\n@LineMemo nvarchar(50),\r\n@TransType nvarchar(20),\r\n@Debit numeric (19,6),\r\n@Credit numeric (19,6),\r\n@SysCred numeric (19,6),\r\n@SysDeb numeric (19,6),\r\n@FCDebit numeric (19,6),\r\n@FCCredit numeric (19,6),\r\n@BalDueDeb numeric (19,6),\r\n@BalDueCred numeric (19,6),\r\n@BalFcDeb numeric (19,6),\r\n@BalFcCred numeric (19,6),\r\n@BalScCred numeric (19,6),\r\n@BalScDeb numeric (19,6),\r\n@UserSign int,\r\n@FinncPriod int,\r\n@FCCurrency nvarchar(3),\r\n@DataSource char(1),\r\n@ContraAct nvarchar(15)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nINSERT INTO JDT1_PRUEBA(TransId,Line_ID,RefDate,DueDate,TaxDate,Account,ShortName,LineMemo,TransType, Debit, Credit, FCDebit, FCCredit, SYSDeb, SYSCred, BalDueDeb, BalDueCred, BalFcDeb, BalFcCred,BalScDeb, BalScCred, UserSign, FinncPriod, FCCurrency, DataSource, ContraAct) VALUES(@TransId,@LineId,@RefDate,@DueDate,@TaxDate,@Account,@ShortName,@LineMemo,@TransType, @Debit, @Credit, @FCDebit, @FCCredit, @SysDeb, @SysCred,@BalDueDeb, @BalDueCred, @BalFcDeb, @BalFcCred,@BalScDeb, @BalScCred, @UserSign, @FinncPriod, @FCCurrency, @DataSource,@ContraAct)\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindAccountBalanceAlternate]\r\n\r\n@AcctCode nvarchar(15),\r\n@F_RefDate datetime,\r\n@T_RefDate datetime\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @Date datetime\r\n\r\nSET @Date=(SELECT TOP 1 CONVERT(nvarchar,RefDate,23)AS nvarchar FROM JDT1_PRUEBA Order BY RefDate)\r\n\r\nIF(@F_RefDate IS NULL)\r\nBEGIN\r\n\r\nSELECT T1.[AcctCode],\r\nT1.[AcctName], \r\nSUM(T0.[Debit]) AS 'Debit',\r\nSUM(T0.[Credit]) AS 'Credit',\r\nSUM(T0.Debit - T0.Credit) AS 'Saldo',\r\nSUM(T0.[SYSDeb]) AS 'SYSDeb',\r\nSUM(T0.[SYSCred]) AS 'SYSCred',\r\nSUM(T0.SYSDeb - T0.SYSCred) AS 'SaldoSYS',\r\nSUM(T0.[FCDebit]) AS 'FCDebit',\r\nSUM(T0.[FCCredit]) AS 'FCCredit', \r\nSUM(T0.FCDebit-T0.FCCredit) AS 'FCSaldo',\r\nCASE \r\n\t\t\tWHEN (SELECT COUNT(DISTINCT FCCurrency) FROM JDT1 WHERE FCCurrency<>(SELECT MainCurncy FROM OADM))=1\r\n\t\t\tTHEN (SELECT DISTINCT TOP 1 FCCurrency FROM JDT1 WHERE FCCurrency<>(SELECT MainCurncy FROM OADM))\r\n\t\t\tELSE (SELECT '****')\r\n\t\t\tEND AS 'FCCurrency'\r\nFROM JDT1_PRUEBA T0 INNER JOIN OACT T1 ON T0.[Account] = T1.[AcctCode]\r\nWHERE T0.[Account] = @AcctCode AND CAST(CONVERT(nvarchar,T0.[RefDate],23)AS nvarchar)>=@Date AND CAST(CONVERT(nvarchar,T0.[RefDate],23)AS nvarchar) <= @T_RefDate\r\nGROUP BY T1.[AcctCode], T1.[AcctName]\r\nEND\r\nELSE\r\nBEGIN\r\n\r\nSELECT T1.[AcctCode],\r\nT1.[AcctName], \r\nSUM(T0.[Debit]) AS 'Debit', \r\nSUM(T0.[Credit]) AS 'Credit', \r\nSUM(T0.Debit - T0.Credit) AS 'Saldo',\r\nSUM(T0.[SYSDeb]) AS 'SYSDeb', \r\nSUM(T0.[SYSCred]) AS 'SYSCred',  \r\nSUM(T0.SYSDeb - T0.SYSCred) AS 'SaldoSYS',\r\nSUM(T0.[FCDebit]) AS 'FCDebit',\r\nSUM(T0.[FCCredit]) AS 'FCCredit',\r\nSUM(T0.FCDebit-T0.FCCredit) AS 'FCSaldo',\r\nCASE \r\n\t\t\tWHEN (SELECT COUNT(DISTINCT FCCurrency) FROM JDT1 WHERE FCCurrency<>(SELECT MainCurncy FROM OADM))=1\r\n\t\t\tTHEN (SELECT DISTINCT TOP 1 FCCurrency FROM JDT1 WHERE FCCurrency<>(SELECT MainCurncy FROM OADM))\r\n\t\t\tELSE (SELECT '****')\r\n\t\t\tEND AS 'FCCurrency'\r\nFROM JDT1_PRUEBA T0 INNER JOIN OACT T1 ON T0.[Account] = T1.[AcctCode]\r\nWHERE T0.[Account] = @AcctCode AND CAST(CONVERT(nvarchar,T0.[RefDate],23)AS nvarchar)>=@F_RefDate AND CAST(CONVERT(nvarchar,T0.[RefDate],23)AS nvarchar) <= @T_RefDate\r\nGROUP BY T1.[AcctCode], T1.[AcctName]\r\nEND\r\n\r\n\r\nEND\r\n\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GetRetencionImpuestoOPCH]\r\n\r\n@DocEntry int,\r\n@ObjType nvarchar(20)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT AbsEntry, WTCode,Rate,TaxbleAmnt,TaxbleAmntSC,TaxbleAmntFC,WTAmnt,WTAmntSC,WTAmntFC,Category,Account,Type,BaseType,LineNum,BaseAmnt, BaseAmntSC, BaseAmntFC, ObjType FROM PCH5 WHERE AbsEntry=@DocEntry AND Category='P' AND ObjType=@ObjType ORDER BY LineNum\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GetRetencionImpuestoOINV]\r\n\r\n@DocEntry int,\r\n@ObjType nvarchar(20)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT WTCode,Rate,TaxbleAmnt,TaxbleAmntSC,TaxbleAmntFC,WTAmnt,WTAmntSC,WTAmntFC,Category,Account,Type,BaseType,LineNum,BaseAmnt, BaseAmntSC, BaseAmntFC FROM INV5 WHERE AbsEntry=@DocEntry AND Category='P' AND ObjType=@ObjType ORDER BY LineNum\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[ReduceSaldoAdeudadoJDT1]\r\n\r\n@CardCode nvarchar(15),\r\n@DocTransId int,\r\n@Line_ID int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE JDT1 SET BalDueCred=0, BalDueDeb=0, BalFcCred=0, BalFcDeb=0, BalScCred=0, BalScDeb=0 WHERE ShortName=@CardCode AND TransId=@DocTransId AND Line_ID=@Line_ID\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[ReduceSaldoAdeudadoSN]\r\n\r\n@CardCode nvarchar(15),\r\n@DocTransId int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nUPDATE JDT1 SET BalDueCred=0, BalDueDeb=0, BalFcCred=0, BalFcDeb=0, BalScCred=0, BalScDeb=0 WHERE ShortName=@CardCode AND TransId=@DocTransId\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindRateUSD]\r\n\r\n@RateDate datetime\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT Rate FROM ORTT WHERE RateDate=@RateDate AND Currency='USD'\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindUSDColumn]\r\n\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT CurrCode FROM OCRN WHERE CurrCode='USD'\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[UpdateDocumentReconciliation]\r\n\r\n@TransId int,\r\n@SrcObjTyp nvarchar(20),\r\n@ReconSum numeric(19,6),\r\n@ReconSumFC numeric(19,6),\r\n@ReconSumSC numeric(19,6),\r\n@WTSum numeric(19,6),\r\n@WTSumFC numeric(19,6),\r\n@WTSumSC numeric(19,6)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nDECLARE @PaidToDate numeric(19,6)\r\nDECLARE @DocTotal numeric(19,6)\r\n\r\nIF(@SrcObjTyp='13')--FACTURA DEUDORES/ND\r\nBEGIN\r\nUPDATE OINV SET PaidToDate=(PaidToDate+@ReconSum), PaidFC=(PaidFC+@ReconSumFC), PaidSys=(PaidSys+@ReconSumSC), WTApplied=(WTApplied+@WTSum),  WTAppliedF=(WTAppliedF+@WTSumFC), WTAppliedS=(WTAppliedS+@WTSumSC) WHERE TransId=@TransId AND ObjType=@SrcObjTyp \r\n\r\nSET @PaidToDate=(SELECT PaidToDate FROM OINV WHERE TransId=@TransId AND ObjType=@SrcObjTyp)\r\nSET @DocTotal=(SELECT DocTotal FROM OINV WHERE TransId=@TransId AND ObjType=@SrcObjTyp)\r\n\r\nIF(@PaidToDate=@DocTotal)\r\nBEGIN\r\nUPDATE OINV SET DocStatus='C' WHERE TransId=@TransId AND ObjType=@SrcObjTyp  \r\nEND\r\n\r\nEND\r\nELSE IF(@SrcObjTyp='18')--FACTURA PROVEEDORES/ND\r\nBEGIN\r\nUPDATE OPCH SET PaidToDate=(PaidToDate+@ReconSum), PaidFC=(PaidFC+@ReconSumFC), PaidSys=(PaidSys+@ReconSumSC), WTApplied=(WTApplied+@WTSum),  WTAppliedF=(WTAppliedF+@WTSumFC), WTAppliedS=(WTAppliedS+@WTSumSC) WHERE TransId=@TransId AND ObjType=@SrcObjTyp \r\n\r\nSET @PaidToDate=(SELECT PaidToDate FROM OPCH WHERE TransId=@TransId AND ObjType=@SrcObjTyp)\r\nSET @DocTotal=(SELECT DocTotal FROM OPCH WHERE TransId=@TransId AND ObjType=@SrcObjTyp)\r\n\r\nIF(@PaidToDate=@DocTotal)\r\nBEGIN\r\nUPDATE OPCH SET DocStatus='C' WHERE TransId=@TransId AND ObjType=@SrcObjTyp  \r\n\r\nEND\r\n\r\nEND\r\n\r\nELSE IF(@SrcObjTyp='14')--NOTA CREDITO DEUDORES\r\nBEGIN\r\nUPDATE ORIN SET PaidToDate=(PaidToDate+@ReconSum), PaidFC=(PaidFC+@ReconSumFC), PaidSys=(PaidSys+@ReconSumSC), WTApplied=(WTApplied+@WTSum),  WTAppliedF=(WTAppliedF+@WTSumFC), WTAppliedS=(WTAppliedS+@WTSumSC) WHERE TransId=@TransId AND ObjType=@SrcObjTyp \r\n\r\nSET @PaidToDate=(SELECT PaidToDate FROM ORIN WHERE TransId=@TransId AND ObjType=@SrcObjTyp)\r\nSET @DocTotal=(SELECT DocTotal FROM ORIN WHERE TransId=@TransId AND ObjType=@SrcObjTyp)\r\n\r\nIF(@PaidToDate=@DocTotal)\r\nBEGIN\r\nUPDATE ORIN SET DocStatus='C' WHERE TransId=@TransId AND ObjType=@SrcObjTyp  \r\n\r\nEND\r\n\r\nEND\r\nELSE IF(@SrcObjTyp='19')--NOTA CREDITO PROVEEDORES\r\nBEGIN\r\nUPDATE ORPC SET PaidToDate=(PaidToDate+@ReconSum), PaidFC=(PaidFC+@ReconSumFC), PaidSys=(PaidSys+@ReconSumSC), WTApplied=(WTApplied+@WTSum),  WTAppliedF=(WTAppliedF+@WTSumFC), WTAppliedS=(WTAppliedS+@WTSumSC) WHERE TransId=@TransId AND ObjType=@SrcObjTyp  \r\n\r\nSET @PaidToDate=(SELECT PaidToDate FROM ORPC WHERE TransId=@TransId AND ObjType=@SrcObjTyp)\r\nSET @DocTotal=(SELECT DocTotal FROM ORPC WHERE TransId=@TransId AND ObjType=@SrcObjTyp)\r\n\r\nIF(@PaidToDate=@DocTotal)\r\nBEGIN\r\nUPDATE ORPC SET DocStatus='C' WHERE TransId=@TransId AND ObjType=@SrcObjTyp  \r\n\r\nEND\r\n\r\nEND\r\n \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindDefinicionUnidadesMedida]\r\n\r\n@UgpEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT\r\n\r\nT0.UgpEntry,\r\nT0.UomEntry,\r\nT2.UomCode,\r\nT2.UomName,\r\nT1.BaseUom AS 'BaseUom',\r\nT0.AltQty,\r\nT0.BaseQty,\r\nT0.LineNum,\r\nT1.UgpCode\r\n\r\nFROM UGP1 T0\r\n\r\nINNER JOIN OUGP T1 ON T0.[UgpEntry] = T1.[UgpEntry]\r\nINNER JOIN OUOM T2 ON T0.[UomEntry] = T2.[UomEntry]\r\n\r\nWHERE T1.UgpEntry=@UgpEntry\r\nORDER BY T0.UgpEntry,T0.LineNum \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindUnidadesBaseMedidas]\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT UomEntry, UomCode, UomName FROM OUOM\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[AddUpdateUnidadesMedidaDefinicion]\r\n\r\n@OldUomCode nvarchar(20),\r\n@UomCode nvarchar(20), \r\n@UomName nvarchar(20),\r\n@UserSign smallint,\r\n@UpdateDate datetime,\r\n@Length numeric(19,6),\r\n@Width numeric(19,6),\r\n@Height numeric(19,6),\r\n@Volume numeric(19,6),\r\n@Weight numeric(19,6),\r\n@VolUnit smallint\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nIF EXISTS (SELECT * FROM OUOM WHERE UomCode=@OldUomCode)\r\nBEGIN\r\nUPDATE OUOM SET UomCode=@UomCode, UomName=@UomName, UserSign2=@UserSign, UpdateDate=@UpdateDate, Length1=@Length, Width1=@Width, Height1=@Height, Volume=@Volume, Weight1=@Weight, VolUnit=@VolUnit WHERE UomCode=@OldUomCode\r\nEND\r\nELSE\r\nBEGIN\r\nINSERT INTO OUOM(UomCode,UomName,UserSign,CreateDate,Length1,Width1,Height1,Volume,Weight1, VolUnit ) VALUES (@UomCode,@UomName,@UserSign,@UpdateDate,@Length,@Width,@Height,@Volume,@Weight,@VolUnit)\r\nEND\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[AddUpdateGruposUnidadesMedidaCabecera]\r\n\r\n@OldUgpCode nvarchar(20),\r\n@UgpCode nvarchar(20), \r\n@UgpName nvarchar(100),\r\n@BaseUom int,\r\n@UserSign int,\r\n@LogInstanc int,\r\n@UpdateDate datetime\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nIF EXISTS (SELECT * FROM OUGP WHERE UgpCode=@OldUgpCode)\r\nBEGIN\r\nUPDATE OUGP SET UgpCode=@UgpCode, UgpName=@UgpName, BaseUom=@BaseUom, UpdateDate=@UpdateDate, UserSign2=@UserSign, LogInstanc=@LogInstanc WHERE UgpCode=@OldUgpCode\r\nEND\r\nELSE\r\nBEGIN\r\nINSERT INTO OUGP(UgpCode,UgpName,BaseUom,CreateDate,UserSign,LogInstanc) VALUES (@UgpCode,@UgpName,@BaseUom,@UpdateDate,@UserSign,@LogInstanc)\r\nEND\r\nEND\r\n\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[AddUpdateGruposUnidadesMedidaDetalleFirstLine]\r\n\r\n@UgpEntry int,\r\n@UomEntry int,\r\n@AltQty numeric(19,6),\r\n@BaseQty numeric(19,6),\r\n@LogInstanc int,\r\n@LineNum int,\r\n@WghtFactor smallint,\r\n@UdfFactor int\r\n\r\nAS\r\n\r\nBEGIN\r\nIF EXISTS (SELECT * FROM UGP1 WHERE UgpEntry=@UgpEntry AND LineNum=1)\r\nBEGIN\r\nUPDATE UGP1 SET UomEntry=@UomEntry, AltQty=@AltQty, BaseQty=@BaseQty, LineNum=@LineNum, LogInstanc=@LogInstanc, WghtFactor=@WghtFactor, UdfFactor=@UdfFactor WHERE UgpEntry=@UgpEntry AND LineNum=1\r\nEND\r\nELSE\r\nBEGIN\r\nINSERT INTO UGP1(UgpEntry,UomEntry,AltQty,BaseQty,LogInstanc,LineNum,WghtFactor,UdfFactor) VALUES (@UgpEntry,@UomEntry,@AltQty,@BaseQty,@LogInstanc,@LineNum,@WghtFactor,@UdfFactor)\r\nEND\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindUnidadesBaseMedidasSpecific]\r\n\r\n@BaseUom int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT UomEntry, UomCode, UomName FROM OUOM WHERE UomEntry<>@BaseUom\r\n\r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[AddUpdateGruposUnidadesMedidaDetalle]\r\n\r\n@UgpEntry int,\r\n@UomEntry int,\r\n@AltQty numeric(19,6),\r\n@BaseQty numeric(19,6),\r\n@LogInstanc int,\r\n@LineNum int,\r\n@WghtFactor smallint,\r\n@UdfFactor int\r\n\r\nAS\r\n\r\nBEGIN\r\nIF EXISTS (SELECT * FROM UGP1 WHERE UgpEntry=@UgpEntry AND LineNum=@LineNum)\r\nBEGIN\r\nUPDATE UGP1 SET UomEntry=@UomEntry, AltQty=@AltQty, BaseQty=@BaseQty, LineNum=@LineNum, LogInstanc=@LogInstanc, WghtFactor=@WghtFactor, UdfFactor=@UdfFactor WHERE UgpEntry=@UgpEntry AND LineNum=@LineNum\r\nEND\r\nELSE\r\nBEGIN\r\nINSERT INTO UGP1(UgpEntry,UomEntry,AltQty,BaseQty,LogInstanc,LineNum,WghtFactor,UdfFactor) VALUES (@UgpEntry,@UomEntry,@AltQty,@BaseQty,@LogInstanc,@LineNum,@WghtFactor,@UdfFactor)\r\nEND\r\nEND\r\n\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindUgpEntry]\r\n\r\n@UgpCode nvarchar(20)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT UgpEntry FROM OUGP WHERE UgpCode=@UgpCode\r\n\r\nEND\r\n\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindGrupoUnidadesMedida]\r\n\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT * FROM OUGP\r\n\r\nEND\r\n\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindDefinicionUnidadesMedidaFirst]\r\n\r\n@UgpEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT TOP 1\r\n\r\nT0.UomEntry,\r\nT2.UomCode,\r\nT2.UomName,\r\nT1.BaseUom,\r\nT0.AltQty,\r\nT0.BaseQty\r\n\r\nFROM UGP1 T0\r\n\r\nINNER JOIN OUGP T1 ON T0.[UgpEntry] = T1.[UgpEntry]\r\nINNER JOIN OUOM T2 ON T0.[UomEntry] = T2.[UomEntry]\r\n\r\nWHERE T1.UgpEntry=@UgpEntry AND T0.LineNum=1\r\nORDER BY T0.UgpEntry,T0.LineNum \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[FindStockAuditUnidades]\r\n\r\n@UgpEntry int\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT \r\n\r\nT1.UomCode,\r\nT0.AltQty AS 'Quantity'\r\n\r\nFROM UGP1 T0\r\n\r\nINNER JOIN OUOM T1 ON T0.UomEntry=T1.UomEntry\r\n\r\nWHERE T0.UgpEntry=@UgpEntry ORDER BY T0.LineNum \r\nEND\r\n\r\nSET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\nCREATE PROC [dbo].[GenerarTXTQuincenal]\r\n\r\n\t@Quincena AS VARCHAR(100),\r\n\t@Mes AS VARCHAR(100),\r\n\t@Ano AS VARCHAR(100)\r\n\r\nAS\r\n\r\nBEGIN\r\n\r\nSELECT U_IDA_TaxIdNo, U_IDA_Periodo, U_IDA_FechaFact, U_IDA_Factura, U_IDA_TipoOperacion, U_IDA_TipoTran,U_IDA_LicTradNum, U_IDA_NumAtCard, U_IDA_NroControl,U_IDA_Total,U_IDA_BaseImp, U_IDA_Retencion, U_IDA_Fafe,U_IDA_NroComp, U_IDA_Exento,U_IDA_Alicuota,U_IDA_NroFile FROM IDA_RETENCION_TXT_IVA(@Quincena,@Mes,@Ano);\r\n\r\nEND\r\n\r\n\r\n";
        public static string EmpresaActual { get => empresaActual; set => empresaActual = value; }       

        private static string baseDatosActual;
        public static string BaseDatosActual { get => baseDatosActual; set => baseDatosActual = value; }
        public static string UserID { get => userID; set => userID = value; }
        public static string ServerName { get => serverName; set => serverName = value; }
        public static string Password { get => password; set => password = value; }
        public static string Script { get => script; }
    }
}
